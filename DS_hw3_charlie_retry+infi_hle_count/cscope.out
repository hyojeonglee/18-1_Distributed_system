cscope 15 /home/dcslab/charlie/18_coursework/DS_hw3_hj_retry+infi               0000954621
	@atomic_ops/aligned_atomic_load_store.h

28 
AO_INLINE
 
AO_t


29 
	$AO_lßd
(cÚ¡ vŞ©
AO_t
 *
addr
)

31 
	`as£¹
(((
size_t
)
addr
 & ((
AO_t
) - 1)) == 0);

34  *(
AO_t
 *)
addr
;

35 
	}
}

37 
	#AO_HAVE_lßd


	)

39 
AO_INLINE
 

40 
	$AO_¡Üe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Ãw_v®
)

42 
	`as£¹
(((
size_t
)
addr
 & ((
AO_t
) - 1)) == 0);

43 (*(
AO_t
 *)
addr
èğ
Ãw_v®
;

44 
	}
}

46 
	#AO_HAVE_¡Üe


	)

	@atomic_ops/all_acquire_release_volatile.h

47 #ià!
defšed
(
AO_GCC_BARRIER
)

48 #ià
defšed
(
__GNUC__
)

49 
	#AO_GCC_BARRIER
(è
	`AO_comp”_b¬r›r
()

	)

51 
	#AO_GCC_BARRIER
()

	)

55 
AO_INLINE
 
AO_t


56 
	$AO_lßd_acquœe
(cÚ¡ vŞ©
AO_t
 *
p
)

58 
AO_t
 
»suÉ
 = *
p
;

60 
	`AO_GCC_BARRIER
();

61  
»suÉ
;

62 
	}
}

63 
	#AO_HAVE_lßd_acquœe


	)

65 
AO_INLINE
 

66 
	$AO_¡Üe_»Ëa£
(vŞ©
AO_t
 *
p
, AO_ˆ
v®
)

68 
	`AO_GCC_BARRIER
();

70 *
p
 = 
v®
;

71 
	}
}

72 
	#AO_HAVE_¡Üe_»Ëa£


	)

79 #ià!
defšed
(
AO_GCC_BARRIER
)

80 #ià
defšed
(
__GNUC__
)

81 
	#AO_GCC_BARRIER
(è
	`AO_comp”_b¬r›r
()

	)

83 
	#AO_GCC_BARRIER
()

	)

87 
AO_INLINE
 

88 
	$AO_ch¬_lßd_acquœe
(cÚ¡ vŞ©*
p
)

90 
»suÉ
 = *
p
;

92 
	`AO_GCC_BARRIER
();

93  
»suÉ
;

94 
	}
}

95 
	#AO_HAVE_ch¬_lßd_acquœe


	)

97 
AO_INLINE
 

98 
	$AO_ch¬_¡Üe_»Ëa£
(vŞ©*
p
, 
v®
)

100 
	`AO_GCC_BARRIER
();

102 *
p
 = 
v®
;

103 
	}
}

104 
	#AO_HAVE_ch¬_¡Üe_»Ëa£


	)

111 #ià!
defšed
(
AO_GCC_BARRIER
)

112 #ià
defšed
(
__GNUC__
)

113 
	#AO_GCC_BARRIER
(è
	`AO_comp”_b¬r›r
()

	)

115 
	#AO_GCC_BARRIER
()

	)

119 
AO_INLINE
 

120 
	$AO_shÜt_lßd_acquœe
(cÚ¡ vŞ©*
p
)

122 
»suÉ
 = *
p
;

124 
	`AO_GCC_BARRIER
();

125  
»suÉ
;

126 
	}
}

127 
	#AO_HAVE_shÜt_lßd_acquœe


	)

129 
AO_INLINE
 

130 
	$AO_shÜt_¡Üe_»Ëa£
(vŞ©*
p
, 
v®
)

132 
	`AO_GCC_BARRIER
();

134 *
p
 = 
v®
;

135 
	}
}

136 
	#AO_HAVE_shÜt_¡Üe_»Ëa£


	)

143 #ià!
defšed
(
AO_GCC_BARRIER
)

144 #ià
defšed
(
__GNUC__
)

145 
	#AO_GCC_BARRIER
(è
	`AO_comp”_b¬r›r
()

	)

147 
	#AO_GCC_BARRIER
()

	)

151 
AO_INLINE
 

152 
	$AO_št_lßd_acquœe
(cÚ¡ vŞ©*
p
)

154 
»suÉ
 = *
p
;

156 
	`AO_GCC_BARRIER
();

157  
»suÉ
;

158 
	}
}

159 
	#AO_HAVE_št_lßd_acquœe


	)

161 
AO_INLINE
 

162 
	$AO_št_¡Üe_»Ëa£
(vŞ©*
p
, 
v®
)

164 
	`AO_GCC_BARRIER
();

166 *
p
 = 
v®
;

167 
	}
}

168 
	#AO_HAVE_št_¡Üe_»Ëa£


	)

	@atomic_ops/ao_t_is_int.h

31 #ià
defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
) && \

32 !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_fuÎ
)

33 
	#AO_št_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãw_v®
) \

34 
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)(
addr
), \

35 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

36 
	#AO_HAVE_št_com·»_ªd_sw­_fuÎ


	)

39 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
) && \

40 !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_acquœe
)

41 
	#AO_št_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, 
Ãw_v®
) \

42 
	`AO_com·»_ªd_sw­_acquœe
((vŞ©
AO_t
 *)(
addr
), \

43 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

44 
	#AO_HAVE_št_com·»_ªd_sw­_acquœe


	)

47 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£
) && \

48 !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_»Ëa£
)

49 
	#AO_št_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, 
Ãw_v®
) \

50 
	`AO_com·»_ªd_sw­_»Ëa£
((vŞ©
AO_t
 *)(
addr
), \

51 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

52 
	#AO_HAVE_št_com·»_ªd_sw­_»Ëa£


	)

55 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_wr™e
) && \

56 !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_wr™e
)

57 
	#AO_št_com·»_ªd_sw­_wr™e
(
addr
, 
Şd
, 
Ãw_v®
) \

58 
	`AO_com·»_ªd_sw­_wr™e
((vŞ©
AO_t
 *)(
addr
), \

59 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

60 
	#AO_HAVE_št_com·»_ªd_sw­_wr™e


	)

63 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_»ad
) && \

64 !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_»ad
)

65 
	#AO_št_com·»_ªd_sw­_»ad
(
addr
, 
Şd
, 
Ãw_v®
) \

66 
	`AO_com·»_ªd_sw­_»ad
((vŞ©
AO_t
 *)(
addr
), \

67 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

68 
	#AO_HAVE_št_com·»_ªd_sw­_»ad


	)

71 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­
) && \

72 !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­
)

73 
	#AO_št_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
) \

74 
	`AO_com·»_ªd_sw­
((vŞ©
AO_t
 *)(
addr
), \

75 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

76 
	#AO_HAVE_št_com·»_ªd_sw­


	)

79 #ià
	`defšed
(
AO_HAVE_lßd_acquœe
) && \

80 !
	$defšed
(
AO_HAVE_št_lßd_acquœe
)

81 
	#AO_št_lßd_acquœe
(
addr
) \

82 ()
	`AO_lßd_acquœe
((cÚ¡ vŞ©
AO_t
 *)(
addr
))

	)

83 
	#AO_HAVE_št_lßd_acquœe


	)

86 #ià
	`defšed
(
AO_HAVE_¡Üe_»Ëa£
) && \

87 !
	$defšed
(
AO_HAVE_št_¡Üe_»Ëa£
)

88 
	#AO_št_¡Üe_»Ëa£
(
addr
, 
v®
) \

89 
	`AO_¡Üe_»Ëa£
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

90 
	#AO_HAVE_št_¡Üe_»Ëa£


	)

93 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_fuÎ
) && \

94 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_fuÎ
)

95 
	#AO_št_ãtch_ªd_add_fuÎ
(
addr
, 
šü
) \

96 ()
	`AO_ãtch_ªd_add_fuÎ
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
šü
))

	)

97 
	#AO_HAVE_št_ãtch_ªd_add_fuÎ


	)

100 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe
) && \

101 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe
)

102 
	#AO_št_ãtch_ªd_add1_acquœe
(
addr
) \

103 ()
	`AO_ãtch_ªd_add1_acquœe
((vŞ©
AO_t
 *)(
addr
))

	)

104 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe


	)

107 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£
) && \

108 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£
)

109 
	#AO_št_ãtch_ªd_add1_»Ëa£
(
addr
) \

110 ()
	`AO_ãtch_ªd_add1_»Ëa£
((vŞ©
AO_t
 *)(
addr
))

	)

111 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£


	)

114 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe
) && \

115 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe
)

116 
	#AO_št_ãtch_ªd_sub1_acquœe
(
addr
) \

117 ()
	`AO_ãtch_ªd_sub1_acquœe
((vŞ©
AO_t
 *)(
addr
))

	)

118 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe


	)

121 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£
) && \

122 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£
)

123 
	#AO_št_ãtch_ªd_sub1_»Ëa£
(
addr
) \

124 ()
	`AO_ãtch_ªd_sub1_»Ëa£
((vŞ©
AO_t
 *)(
addr
))

	)

125 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£


	)

	@atomic_ops/atomic_ops.h

23 #iâdeà
ATOMIC_OPS_H


25 
	#ATOMIC_OPS_H


	)

27 
	~<as£¹.h
>

28 
	~<¡ddef.h
>

142 
	#AO_t
 
size_t


	)

147 
	#AO_TS_INITIALIZER
 (
AO_t
)
AO_TS_CLEAR


	)

150 #ià
defšed
(
__GNUC__
è|| defšed(
_MSC_VER
è|| defšed(
__INTEL_COMPILER
) \

151 || 
defšed
(
__DMC__
è|| 
	$defšed
(
__WATCOMC__
)

152 
	#AO_INLINE
 
__šlše


	)

153 #–ià
	`defšed
(
__sun
)

154 
	#AO_INLINE
 
šlše


	)

156 
	#AO_INLINE
 

	)

159 #ià
	`defšed
(
__GNUC__
è&& !defšed(
__INTEL_COMPILER
)

160 
	#AO_comp”_b¬r›r
(è
__asm__
 
	`__vŞ©e__
("" : : : "memÜy")

	)

161 #–ià
	`defšed
(
_MSC_VER
è|| defšed(
__DMC__
è|| defšed(
__BORLANDC__
) \

162 || 
	$defšed
(
__WATCOMC__
)

163 #ià
	`defšed
(
_AMD64_
è|| defšed(
_M_X64
è|| 
_MSC_VER
 >= 1400

164 #ià
	`defšed
(
_WIN32_WCE
)

166 #–ià
	`defšed
(
_MSC_VER
)

167 
	~<šŒš.h
>

169 #´agm¨
	`šŒšsic
(
_R—dWr™eB¬r›r
)

170 
	#AO_comp”_b¬r›r
(è
	`_R—dWr™eB¬r›r
()

	)

174 
	#AO_comp”_b¬r›r
(è
__asm
 { 
	}

	)
}

178 #–ià
defšed
(
__INTEL_COMPILER
)

179 
	#AO_comp”_b¬r›r
(è
	`__memÜy_b¬r›r
(è

	)

180 #–ià
defšed
(
_HPUX_SOURCE
)

181 #ià
defšed
(
__Ÿ64
)

182 
	~<machše/sys/šlše.h
>

183 
	#AO_comp”_b¬r›r
(è
	`_Asm_sched_ãnû
()

	)

187 vŞ©
	gAO_b¬r›r_dummy
;

188 
	#AO_comp”_b¬r›r
(è
AO_b¬r›r_dummy
 = 
	)
AO_barrier_dummy

193 
	#AO_comp”_b¬r›r
(è
	`asm
("")

	)

196 #ià
defšed
(
AO_USE_PTHREAD_DEFS
)

197 
	~"©omic_İs/sysd•s/g’”ic_±h»ad.h
"

200 #ià
defšed
(
__GNUC__
è&& !defšed(
AO_USE_PTHREAD_DEFS
) \

201 && !
	$defšed
(
__INTEL_COMPILER
)

202 #ià
	`defšed
(
__i386__
)

206 
	~"x86.h
"

208 #ià
	`defšed
(
__x86_64__
)

209 #ià
__GNUC__
 > 4 || (__GNUC__ =ğ4 && 
__GNUC_MINOR__
 >= 2)

211 
	#AO_USE_SYNC_CAS_BUILTIN


	)

213 
	~"x86_64.h
"

215 #ià
	`defšed
(
__Ÿ64__
)

216 
	~"Ÿ64.h
"

217 
	#AO_GENERALIZE_TWICE


	)

219 #ià
	`defšed
(
__hµa__
)

220 
	~"©omic_İs/sysd•s/gcc/hµa.h
"

221 
	#AO_CAN_EMUL_CAS


	)

223 #ià
	`defšed
(
__®pha__
)

224 
	~"©omic_İs/sysd•s/gcc/®pha.h
"

225 
	#AO_GENERALIZE_TWICE


	)

227 #ià
	`defšed
(
__s390__
)

228 
	~"©omic_İs/sysd•s/gcc/s390.h
"

230 #ià
	`defšed
(
__¥¬c__
)

231 
	~"¥¬c.h
"

232 
	#AO_CAN_EMUL_CAS


	)

234 #ià
	`defšed
(
__m68k__
)

235 
	~"©omic_İs/sysd•s/gcc/m68k.h
"

237 #ià
	`defšed
(
__pow”pc__
è|| defšed(
__µc__
è|| defšed(
__PPC__
) \

238 || 
	`defšed
(
__pow”pc64__
è|| 
	$defšed
(
__µc64__
)

239 
	~"pow”pc.h
"

241 #ià
	`defšed
(
__¬m__
è&& !defšed(
AO_USE_PTHREAD_DEFS
)

242 
	~"©omic_İs/sysd•s/gcc/¬m.h
"

243 
	#AO_CAN_EMUL_CAS


	)

245 #ià
	`defšed
(
__üis__
è|| defšed(
CRIS
)

246 
	~"©omic_İs/sysd•s/gcc/üis.h
"

248 #ià
	`defšed
(
__ms__
)

249 
	~"©omic_İs/sysd•s/gcc/ms.h
"

251 #ià
	`defšed
(
__sh__
è|| defšed(
SH4
)

252 
	~"©omic_İs/sysd•s/gcc/sh.h
"

253 
	#AO_CAN_EMUL_CAS


	)

257 #ià
	`defšed
(
__INTEL_COMPILER
è&& !defšed(
AO_USE_PTHREAD_DEFS
)

258 #ià
	`defšed
(
__Ÿ64__
)

259 
	~"Ÿ64.h
"

260 
	#AO_GENERALIZE_TWICE


	)

262 #ià
	`defšed
(
__GNUC__
)

264 #ià
	`defšed
(
__i386__
)

265 
	~"x86.h
"

267 #ià
	`defšed
(
__x86_64__
)

268 #ià
__INTEL_COMPILER
 > 1110

269 
	#AO_USE_SYNC_CAS_BUILTIN


	)

271 
	~"x86_64.h
"

276 #ià
	`defšed
(
_HPUX_SOURCE
è&& !defšed(
__GNUC__
è&& !defšed(
AO_USE_PTHREAD_DEFS
)

277 #ià
	`defšed
(
__Ÿ64
)

278 
	~"©omic_İs/sysd•s/hpc/Ÿ64.h
"

279 
	#AO_GENERALIZE_TWICE


	)

281 
	~"©omic_İs/sysd•s/hpc/hµa.h
"

282 
	#AO_CAN_EMUL_CAS


	)

286 #ià
	`defšed
(
__sun
è&& !defšed(
__GNUC__
è&& !defšed(
AO_USE_PTHREAD_DEFS
)

288 #ià
	`defšed
(
__i386
)

289 
	~"©omic_İs/sysd•s/sunc/x86.h
"

291 #ià
	`defšed
(
__x86_64
è|| defšed(
__amd64
)

292 
	~"©omic_İs/sysd•s/sunc/x86_64.h
"

296 #ià!
	`defšed
(
__GNUC__
è&& (defšed(
¥¬c
è|| defšed(
__¥¬c
)) \

297 && !
	$defšed
(
AO_USE_PTHREAD_DEFS
)

298 
	~"©omic_İs/sysd•s/sunc/¥¬c.h
"

299 
	#AO_CAN_EMUL_CAS


	)

302 #ià
	`defšed
(
_MSC_VER
è|| defšed(
__DMC__
è|| defšed(
__BORLANDC__
) \

303 || (
	`defšed
(
__WATCOMC__
è&& 
	$defšed
(
__NT__
))

304 #ià
	`defšed
(
_AMD64_
è|| defšed(
_M_X64
)

305 
	~"©omic_İs/sysd•s/msác/x86_64.h
"

306 #–ià
	`defšed
(
_M_IX86
è|| defšed(
x86
)

307 
	~"©omic_İs/sysd•s/msác/x86.h
"

308 #–ià
	`defšed
(
_M_ARM
è|| defšed(
ARM
è|| defšed(
_ARM_
)

309 
	~"©omic_İs/sysd•s/msác/¬m.h
"

313 #ià
	`defšed
(
AO_REQUIRE_CAS
è&& !defšed(
AO_HAVE_com·»_ªd_sw­
) \

314 && !
	`defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
) \

315 && !
	$defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
)

316 #ià
	`defšed
(
AO_CAN_EMUL_CAS
)

317 
	~"©omic_İs/sysd•s/emul_ÿs.h
"

319 #”rÜ 
CªnÙ
 
im¶em’t
 
AO_com·»_ªd_sw­_fuÎ
 
Ú
 
this
 
¬ch™eùu»
.

325 #ià
AO_AO_TS_T
 && !
	`defšed
(
AO_CLEAR
)

326 
	#AO_CLEAR
(
addr
è
	`AO_¡Üe_»Ëa£
((
AO_TS_t
 *)×ddr), 
AO_TS_CLEAR
)

	)

328 #ià
AO_CHAR_TS_T
 && !
	`defšed
(
AO_CLEAR
)

329 
	#AO_CLEAR
(
addr
è
	`AO_ch¬_¡Üe_»Ëa£
((
AO_TS_t
 *)×ddr), 
AO_TS_CLEAR
)

	)

338 
	~"g’”®ize.h
"

339 #ifdeà
AO_GENERALIZE_TWICE


340 
	~"g’”®ize.h
"

344 
	#AO_TS_T
 
AO_TS_t


	)

345 
	#AO_T
 
AO_t


	)

346 
	#AO_TS_VAL
 
AO_TS_VAL_t


	)

	@atomic_ops/generalize-small.h

2 #ià
defšed
(
AO_HAVE_ch¬_lßd_acquœe
è&& !defšed(
AO_HAVE_ch¬_lßd
)

3 
	#AO_ch¬_lßd
(
addr
è
	`AO_ch¬_lßd_acquœe
×ddr)

	)

4 
	#AO_HAVE_ch¬_lßd


	)

7 #ià
defšed
(
AO_HAVE_ch¬_lßd_fuÎ
è&& !defšed(
AO_HAVE_ch¬_lßd_acquœe
)

8 
	#AO_ch¬_lßd_acquœe
(
addr
è
	`AO_ch¬_lßd_fuÎ
×ddr)

	)

9 
	#AO_HAVE_ch¬_lßd_acquœe


	)

12 #ià
defšed
(
AO_HAVE_ch¬_lßd_fuÎ
è&& !defšed(
AO_HAVE_ch¬_lßd_»ad
)

13 
	#AO_ch¬_lßd_»ad
(
addr
è
	`AO_ch¬_lßd_fuÎ
×ddr)

	)

14 
	#AO_HAVE_ch¬_lßd_»ad


	)

17 #ià!
defšed
(
AO_HAVE_ch¬_lßd_acquœe_»ad
è&& defšed(
AO_HAVE_ch¬_lßd_acquœe
)

18 
	#AO_ch¬_lßd_acquœe_»ad
(
addr
è
	`AO_ch¬_lßd_acquœe
×ddr)

	)

19 
	#AO_HAVE_ch¬_lßd_acquœe_»ad


	)

22 #ià
defšed
(
AO_HAVE_ch¬_lßd
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

23 !
	$defšed
(
AO_HAVE_ch¬_lßd_acquœe
)

24 
AO_INLINE
 

25 
	$AO_ch¬_lßd_acquœe
(cÚ¡ vŞ©*
addr
)

27 
»suÉ
 = 
	`AO_ch¬_lßd
(
addr
);

30 
	`AO_nİ_fuÎ
();

31  
»suÉ
;

32 
	}
}

33 
	#AO_HAVE_ch¬_lßd_acquœe


	)

36 #ià
defšed
(
AO_HAVE_ch¬_lßd
è&& defšed(
AO_HAVE_nİ_»ad
) && \

37 !
	$defšed
(
AO_HAVE_ch¬_lßd_»ad
)

38 
AO_INLINE
 

39 
	$AO_ch¬_lßd_»ad
(cÚ¡ vŞ©*
addr
)

41 
»suÉ
 = 
	`AO_ch¬_lßd
(
addr
);

44 
	`AO_nİ_»ad
();

45  
»suÉ
;

46 
	}
}

47 
	#AO_HAVE_ch¬_lßd_»ad


	)

50 #ià
defšed
(
AO_HAVE_ch¬_lßd_acquœe
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

51 !
	$defšed
(
AO_HAVE_ch¬_lßd_fuÎ
)

52 
	#AO_ch¬_lßd_fuÎ
(
addr
è(
	`AO_nİ_fuÎ
(), 
	`AO_ch¬_lßd_acquœe
×ddr))

	)

53 
	#AO_HAVE_ch¬_lßd_fuÎ


	)

56 #ià!
	`defšed
(
AO_HAVE_ch¬_lßd_acquœe_»ad
è&& defšed(
AO_HAVE_ch¬_lßd_»ad
)

57 
	#AO_ch¬_lßd_acquœe_»ad
(
addr
è
	`AO_ch¬_lßd_»ad
×ddr)

	)

58 
	#AO_HAVE_ch¬_lßd_acquœe_»ad


	)

61 #ià
	`defšed
(
AO_HAVE_ch¬_lßd_acquœe_»ad
è&& !defšed(
AO_HAVE_ch¬_lßd
)

62 
	#AO_ch¬_lßd
(
addr
è
	`AO_ch¬_lßd_acquœe_»ad
×ddr)

	)

63 
	#AO_HAVE_ch¬_lßd


	)

66 #ifdeà
AO_NO_DD_ORDERING


67 #ià
	`defšed
(
AO_HAVE_ch¬_lßd_acquœe_»ad
)

68 
	#AO_ch¬_lßd_dd_acquœe_»ad
(
addr
) \

69 
	`AO_ch¬_lßd_acquœe_»ad
(
addr
)

	)

70 
	#AO_HAVE_ch¬_lßd_dd_acquœe_»ad


	)

73 #ià
	`defšed
(
AO_HAVE_ch¬_lßd
)

74 
	#AO_ch¬_lßd_dd_acquœe_»ad
(
addr
) \

75 
	`AO_ch¬_lßd
(
addr
)

	)

76 
	#AO_HAVE_ch¬_lßd_dd_acquœe_»ad


	)

83 #ià
	`defšed
(
AO_HAVE_ch¬_¡Üe_»Ëa£
è&& !defšed(
AO_HAVE_ch¬_¡Üe
)

84 
	#AO_ch¬_¡Üe
(
addr
, 
v®
è
	`AO_ch¬_¡Üe_»Ëa£
×ddr,v®)

	)

85 
	#AO_HAVE_ch¬_¡Üe


	)

88 #ià
	`defšed
(
AO_HAVE_ch¬_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_ch¬_¡Üe_»Ëa£
)

89 
	#AO_ch¬_¡Üe_»Ëa£
(
addr
,
v®
è
	`AO_ch¬_¡Üe_fuÎ
×ddr,v®)

	)

90 
	#AO_HAVE_ch¬_¡Üe_»Ëa£


	)

93 #ià
	`defšed
(
AO_HAVE_ch¬_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_ch¬_¡Üe_wr™e
)

94 
	#AO_ch¬_¡Üe_wr™e
(
addr
,
v®
è
	`AO_ch¬_¡Üe_fuÎ
×ddr,v®)

	)

95 
	#AO_HAVE_ch¬_¡Üe_wr™e


	)

98 #ià
	`defšed
(
AO_HAVE_ch¬_¡Üe_»Ëa£
) && \

99 !
	$defšed
(
AO_HAVE_ch¬_¡Üe_»Ëa£_wr™e
)

100 
	#AO_ch¬_¡Üe_»Ëa£_wr™e
(
addr
, 
v®
) \

101 
	`AO_ch¬_¡Üe_»Ëa£
(
addr
,
v®
)

	)

102 
	#AO_HAVE_ch¬_¡Üe_»Ëa£_wr™e


	)

105 #ià
	`defšed
(
AO_HAVE_ch¬_¡Üe_wr™e
è&& !defšed(
AO_HAVE_ch¬_¡Üe
)

106 
	#AO_ch¬_¡Üe
(
addr
, 
v®
è
	`AO_ch¬_¡Üe_wr™e
×ddr,v®)

	)

107 
	#AO_HAVE_ch¬_¡Üe


	)

110 #ià
	`defšed
(
AO_HAVE_ch¬_¡Üe
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

111 !
	$defšed
(
AO_HAVE_ch¬_¡Üe_»Ëa£
)

112 
	#AO_ch¬_¡Üe_»Ëa£
(
addr
,
v®
) \

113 (
	`AO_nİ_fuÎ
(), 
	`AO_ch¬_¡Üe
(
addr
,
v®
))

	)

114 
	#AO_HAVE_ch¬_¡Üe_»Ëa£


	)

117 #ià
	`defšed
(
AO_HAVE_nİ_wr™e
è&& defšed(
AO_HAVE_ch¬_¡Üe
) && \

118 !
	$defšed
(
AO_HAVE_ch¬_¡Üe_wr™e
)

119 
	#AO_ch¬_¡Üe_wr™e
(
addr
, 
v®
) \

120 (
	`AO_nİ_wr™e
(), 
	`AO_ch¬_¡Üe
(
addr
,
v®
))

	)

121 
	#AO_HAVE_ch¬_¡Üe_wr™e


	)

124 #ià
	`defšed
(
AO_HAVE_ch¬_¡Üe_wr™e
) && \

125 !
	$defšed
(
AO_HAVE_ch¬_¡Üe_»Ëa£_wr™e
)

126 
	#AO_ch¬_¡Üe_»Ëa£_wr™e
(
addr
, 
v®
è
	`AO_ch¬_¡Üe_wr™e
×ddr,v®)

	)

127 
	#AO_HAVE_ch¬_¡Üe_»Ëa£_wr™e


	)

130 #ià
	`defšed
(
AO_HAVE_ch¬_¡Üe_»Ëa£
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

131 !
	$defšed
(
AO_HAVE_ch¬_¡Üe_fuÎ
)

132 
	#AO_ch¬_¡Üe_fuÎ
(
addr
, 
v®
) \

133 (
	`AO_ch¬_¡Üe_»Ëa£
(
addr
, 
v®
), 
	`AO_nİ_fuÎ
())

	)

134 
	#AO_HAVE_ch¬_¡Üe_fuÎ


	)

139 #ià
	`defšed
(
AO_HAVE_ch¬_com·»_ªd_sw­_fuÎ
) && \

140 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_fuÎ
)

141 
AO_INLINE
 
AO_t


142 
	$AO_ch¬_ãtch_ªd_add_fuÎ
(vŞ©*
addr
,

143 
šü
)

145 
Şd
;

148 
Şd
 = *
addr
;

150 !
	`AO_ch¬_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, old+
šü
));

151  
Şd
;

152 
	}
}

153 
	#AO_HAVE_ch¬_ãtch_ªd_add_fuÎ


	)

156 #ià
defšed
(
AO_HAVE_ch¬_com·»_ªd_sw­_acquœe
) && \

157 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe
)

158 
AO_INLINE
 
AO_t


159 
	$AO_ch¬_ãtch_ªd_add_acquœe
(vŞ©*
addr
,

160 
šü
)

162 
Şd
;

165 
Şd
 = *
addr
;

167 !
	`AO_ch¬_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, old+
šü
));

168  
Şd
;

169 
	}
}

170 
	#AO_HAVE_ch¬_ãtch_ªd_add_acquœe


	)

173 #ià
defšed
(
AO_HAVE_ch¬_com·»_ªd_sw­_»Ëa£
) && \

174 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£
)

175 
AO_INLINE
 
AO_t


176 
	$AO_ch¬_ãtch_ªd_add_»Ëa£
(vŞ©*
addr
,

177 
šü
)

179 
Şd
;

182 
Şd
 = *
addr
;

184 !
	`AO_ch¬_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, old+
šü
));

185  
Şd
;

186 
	}
}

187 
	#AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£


	)

190 #ià
defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_fuÎ
)

191 #ià!
defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£
)

192 
	#AO_ch¬_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
) \

193 
	`AO_ch¬_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

194 
	#AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£


	)

196 #ià!
defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe
)

197 
	#AO_ch¬_ãtch_ªd_add_acquœe
(
addr
, 
v®
) \

198 
	`AO_ch¬_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

199 
	#AO_HAVE_ch¬_ãtch_ªd_add_acquœe


	)

201 #ià!
defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_wr™e
)

202 
	#AO_ch¬_ãtch_ªd_add_wr™e
(
addr
, 
v®
) \

203 
	`AO_ch¬_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

204 
	#AO_HAVE_ch¬_ãtch_ªd_add_wr™e


	)

206 #ià!
defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»ad
)

207 
	#AO_ch¬_ãtch_ªd_add_»ad
(
addr
, 
v®
) \

208 
	`AO_ch¬_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

209 
	#AO_HAVE_ch¬_ãtch_ªd_add_»ad


	)

213 #ià!
defšed
(
AO_HAVE_ch¬_ãtch_ªd_add
) && \

214 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£
)

215 
	#AO_ch¬_ãtch_ªd_add
(
addr
, 
v®
) \

216 
	`AO_ch¬_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
)

	)

217 
	#AO_HAVE_ch¬_ãtch_ªd_add


	)

219 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add
) && \

220 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe
)

221 
	#AO_ch¬_ãtch_ªd_add
(
addr
, 
v®
) \

222 
	`AO_ch¬_ãtch_ªd_add_acquœe
(
addr
, 
v®
)

	)

223 
	#AO_HAVE_ch¬_ãtch_ªd_add


	)

225 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add
) && \

226 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_wr™e
)

227 
	#AO_ch¬_ãtch_ªd_add
(
addr
, 
v®
) \

228 
	`AO_ch¬_ãtch_ªd_add_wr™e
(
addr
, 
v®
)

	)

229 
	#AO_HAVE_ch¬_ãtch_ªd_add


	)

231 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add
) && \

232 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»ad
)

233 
	#AO_ch¬_ãtch_ªd_add
(
addr
, 
v®
) \

234 
	`AO_ch¬_ãtch_ªd_add_»ad
(
addr
, 
v®
)

	)

235 
	#AO_HAVE_ch¬_ãtch_ªd_add


	)

238 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe
) &&\

239 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

240 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_fuÎ
)

241 
	#AO_ch¬_ãtch_ªd_add_fuÎ
(
addr
, 
v®
) \

242 (
	`AO_nİ_fuÎ
(), 
	`AO_ch¬_ãtch_ªd_add_acquœe
(
addr
, 
v®
))

	)

245 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£_wr™e
) && \

246 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_wr™e
)

247 
	#AO_ch¬_ãtch_ªd_add_»Ëa£_wr™e
(
addr
, 
v®
) \

248 
	`AO_ch¬_ãtch_ªd_add_wr™e
(
addr
, 
v®
)

	)

249 
	#AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£_wr™e


	)

251 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£_wr™e
) && \

252 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£
)

253 
	#AO_ch¬_ãtch_ªd_add_»Ëa£_wr™e
(
addr
, 
v®
) \

254 
	`AO_ch¬_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
)

	)

255 
	#AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£_wr™e


	)

257 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe_»ad
) && \

258 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»ad
)

259 
	#AO_ch¬_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
) \

260 
	`AO_ch¬_ãtch_ªd_add_»ad
(
addr
, 
v®
)

	)

261 
	#AO_HAVE_ch¬_ãtch_ªd_add_acquœe_»ad


	)

263 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe_»ad
) && \

264 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe
)

265 
	#AO_ch¬_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
) \

266 
	`AO_ch¬_ãtch_ªd_add_acquœe
(
addr
, 
v®
)

	)

267 
	#AO_HAVE_ch¬_ãtch_ªd_add_acquœe_»ad


	)

270 #ifdeà
AO_NO_DD_ORDERING


271 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe_»ad
)

272 
	#AO_ch¬_ãtch_ªd_add_dd_acquœe_»ad
(
addr
, 
v®
) \

273 
	`AO_ch¬_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
)

	)

274 
	#AO_HAVE_ch¬_ãtch_ªd_add_dd_acquœe_»ad


	)

277 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add
)

278 
	#AO_ch¬_ãtch_ªd_add_dd_acquœe_»ad
(
addr
, 
v®
) \

279 
	`AO_ch¬_ãtch_ªd_add
(
addr
, 
v®
)

	)

280 
	#AO_HAVE_ch¬_ãtch_ªd_add_dd_acquœe_»ad


	)

286 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_fuÎ
) &&\

287 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_fuÎ
)

288 
	#AO_ch¬_ãtch_ªd_add1_fuÎ
(
addr
) \

289 
	`AO_ch¬_ãtch_ªd_add_fuÎ
(
addr
,1)

	)

290 
	#AO_HAVE_ch¬_ãtch_ªd_add1_fuÎ


	)

292 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£
) &&\

293 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£
)

294 
	#AO_ch¬_ãtch_ªd_add1_»Ëa£
(
addr
) \

295 
	`AO_ch¬_ãtch_ªd_add_»Ëa£
(
addr
,1)

	)

296 
	#AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£


	)

298 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe
) &&\

299 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe
)

300 
	#AO_ch¬_ãtch_ªd_add1_acquœe
(
addr
) \

301 
	`AO_ch¬_ãtch_ªd_add_acquœe
(
addr
,1)

	)

302 
	#AO_HAVE_ch¬_ãtch_ªd_add1_acquœe


	)

304 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_wr™e
) &&\

305 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_wr™e
)

306 
	#AO_ch¬_ãtch_ªd_add1_wr™e
(
addr
) \

307 
	`AO_ch¬_ãtch_ªd_add_wr™e
(
addr
,1)

	)

308 
	#AO_HAVE_ch¬_ãtch_ªd_add1_wr™e


	)

310 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»ad
) &&\

311 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»ad
)

312 
	#AO_ch¬_ãtch_ªd_add1_»ad
(
addr
) \

313 
	`AO_ch¬_ãtch_ªd_add_»ad
(
addr
,1)

	)

314 
	#AO_HAVE_ch¬_ãtch_ªd_add1_»ad


	)

316 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£_wr™e
) &&\

317 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£_wr™e
)

318 
	#AO_ch¬_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

319 
	`AO_ch¬_ãtch_ªd_add_»Ëa£_wr™e
(
addr
,1)

	)

320 
	#AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£_wr™e


	)

322 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe_»ad
) &&\

323 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe_»ad
)

324 
	#AO_ch¬_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

325 
	`AO_ch¬_ãtch_ªd_add_acquœe_»ad
(
addr
,1)

	)

326 
	#AO_HAVE_ch¬_ãtch_ªd_add1_acquœe_»ad


	)

328 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add
) &&\

329 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1
)

330 
	#AO_ch¬_ãtch_ªd_add1
(
addr
) \

331 
	`AO_ch¬_ãtch_ªd_add
(
addr
,1)

	)

332 
	#AO_HAVE_ch¬_ãtch_ªd_add1


	)

335 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_fuÎ
)

336 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£
)

337 
	#AO_ch¬_ãtch_ªd_add1_»Ëa£
(
addr
) \

338 
	`AO_ch¬_ãtch_ªd_add1_fuÎ
(
addr
)

	)

339 
	#AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£


	)

341 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe
)

342 
	#AO_ch¬_ãtch_ªd_add1_acquœe
(
addr
) \

343 
	`AO_ch¬_ãtch_ªd_add1_fuÎ
(
addr
)

	)

344 
	#AO_HAVE_ch¬_ãtch_ªd_add1_acquœe


	)

346 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_wr™e
)

347 
	#AO_ch¬_ãtch_ªd_add1_wr™e
(
addr
) \

348 
	`AO_ch¬_ãtch_ªd_add1_fuÎ
(
addr
)

	)

349 
	#AO_HAVE_ch¬_ãtch_ªd_add1_wr™e


	)

351 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»ad
)

352 
	#AO_ch¬_ãtch_ªd_add1_»ad
(
addr
) \

353 
	`AO_ch¬_ãtch_ªd_add1_fuÎ
(
addr
)

	)

354 
	#AO_HAVE_ch¬_ãtch_ªd_add1_»ad


	)

358 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1
) && \

359 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£
)

360 
	#AO_ch¬_ãtch_ªd_add1
(
addr
) \

361 
	`AO_ch¬_ãtch_ªd_add1_»Ëa£
(
addr
)

	)

362 
	#AO_HAVE_ch¬_ãtch_ªd_add1


	)

364 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1
) && \

365 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe
)

366 
	#AO_ch¬_ãtch_ªd_add1
(
addr
) \

367 
	`AO_ch¬_ãtch_ªd_add1_acquœe
(
addr
)

	)

368 
	#AO_HAVE_ch¬_ãtch_ªd_add1


	)

370 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1
) && \

371 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_wr™e
)

372 
	#AO_ch¬_ãtch_ªd_add1
(
addr
) \

373 
	`AO_ch¬_ãtch_ªd_add1_wr™e
(
addr
)

	)

374 
	#AO_HAVE_ch¬_ãtch_ªd_add1


	)

376 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1
) && \

377 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»ad
)

378 
	#AO_ch¬_ãtch_ªd_add1
(
addr
) \

379 
	`AO_ch¬_ãtch_ªd_add1_»ad
(
addr
)

	)

380 
	#AO_HAVE_ch¬_ãtch_ªd_add1


	)

383 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe
) &&\

384 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

385 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_fuÎ
)

386 
	#AO_ch¬_ãtch_ªd_add1_fuÎ
(
addr
) \

387 (
	`AO_nİ_fuÎ
(), 
	`AO_ch¬_ãtch_ªd_add1_acquœe
(
addr
))

	)

388 
	#AO_HAVE_ch¬_ãtch_ªd_add1_fuÎ


	)

391 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£_wr™e
) && \

392 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_wr™e
)

393 
	#AO_ch¬_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

394 
	`AO_ch¬_ãtch_ªd_add1_wr™e
(
addr
)

	)

395 
	#AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£_wr™e


	)

397 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£_wr™e
) && \

398 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£
)

399 
	#AO_ch¬_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

400 
	`AO_ch¬_ãtch_ªd_add1_»Ëa£
(
addr
)

	)

401 
	#AO_HAVE_ch¬_ãtch_ªd_add1_»Ëa£_wr™e


	)

403 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe_»ad
) && \

404 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_»ad
)

405 
	#AO_ch¬_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

406 
	`AO_ch¬_ãtch_ªd_add1_»ad
(
addr
)

	)

407 
	#AO_HAVE_ch¬_ãtch_ªd_add1_acquœe_»ad


	)

409 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe_»ad
) && \

410 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe
)

411 
	#AO_ch¬_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

412 
	`AO_ch¬_ãtch_ªd_add1_acquœe
(
addr
)

	)

413 
	#AO_HAVE_ch¬_ãtch_ªd_add1_acquœe_»ad


	)

416 #ifdeà
AO_NO_DD_ORDERING


417 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1_acquœe_»ad
)

418 
	#AO_ch¬_ãtch_ªd_add1_dd_acquœe_»ad
(
addr
) \

419 
	`AO_ch¬_ãtch_ªd_add1_acquœe_»ad
(
addr
)

	)

420 
	#AO_HAVE_ch¬_ãtch_ªd_add1_dd_acquœe_»ad


	)

423 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add1
)

424 
	#AO_ch¬_ãtch_ªd_add1_dd_acquœe_»ad
(
addr
) \

425 
	`AO_ch¬_ãtch_ªd_add1
(
addr
)

	)

426 
	#AO_HAVE_ch¬_ãtch_ªd_add1_dd_acquœe_»ad


	)

432 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_fuÎ
) &&\

433 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_fuÎ
)

434 
	#AO_ch¬_ãtch_ªd_sub1_fuÎ
(
addr
) \

435 
	`AO_ch¬_ãtch_ªd_add_fuÎ
(
addr
,()(-1))

	)

436 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_fuÎ


	)

438 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£
) &&\

439 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£
)

440 
	#AO_ch¬_ãtch_ªd_sub1_»Ëa£
(
addr
) \

441 
	`AO_ch¬_ãtch_ªd_add_»Ëa£
(
addr
,()(-1))

	)

442 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£


	)

444 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe
) &&\

445 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe
)

446 
	#AO_ch¬_ãtch_ªd_sub1_acquœe
(
addr
) \

447 
	`AO_ch¬_ãtch_ªd_add_acquœe
(
addr
,()(-1))

	)

448 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe


	)

450 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_wr™e
) &&\

451 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_wr™e
)

452 
	#AO_ch¬_ãtch_ªd_sub1_wr™e
(
addr
) \

453 
	`AO_ch¬_ãtch_ªd_add_wr™e
(
addr
,()(-1))

	)

454 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_wr™e


	)

456 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»ad
) &&\

457 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»ad
)

458 
	#AO_ch¬_ãtch_ªd_sub1_»ad
(
addr
) \

459 
	`AO_ch¬_ãtch_ªd_add_»ad
(
addr
,()(-1))

	)

460 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_»ad


	)

462 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_»Ëa£_wr™e
) &&\

463 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e
)

464 
	#AO_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

465 
	`AO_ch¬_ãtch_ªd_add_»Ëa£_wr™e
(
addr
,()(-1))

	)

466 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e


	)

468 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add_acquœe_»ad
) &&\

469 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe_»ad
)

470 
	#AO_ch¬_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

471 
	`AO_ch¬_ãtch_ªd_add_acquœe_»ad
(
addr
,()(-1))

	)

472 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe_»ad


	)

474 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_add
) &&\

475 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1
)

476 
	#AO_ch¬_ãtch_ªd_sub1
(
addr
) \

477 
	`AO_ch¬_ãtch_ªd_add
(
addr
,()(-1))

	)

478 
	#AO_HAVE_ch¬_ãtch_ªd_sub1


	)

481 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_fuÎ
)

482 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£
)

483 
	#AO_ch¬_ãtch_ªd_sub1_»Ëa£
(
addr
) \

484 
	`AO_ch¬_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

485 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£


	)

487 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe
)

488 
	#AO_ch¬_ãtch_ªd_sub1_acquœe
(
addr
) \

489 
	`AO_ch¬_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

490 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe


	)

492 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_wr™e
)

493 
	#AO_ch¬_ãtch_ªd_sub1_wr™e
(
addr
) \

494 
	`AO_ch¬_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

495 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_wr™e


	)

497 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»ad
)

498 
	#AO_ch¬_ãtch_ªd_sub1_»ad
(
addr
) \

499 
	`AO_ch¬_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

500 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_»ad


	)

504 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1
) && \

505 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£
)

506 
	#AO_ch¬_ãtch_ªd_sub1
(
addr
) \

507 
	`AO_ch¬_ãtch_ªd_sub1_»Ëa£
(
addr
)

	)

508 
	#AO_HAVE_ch¬_ãtch_ªd_sub1


	)

510 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1
) && \

511 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe
)

512 
	#AO_ch¬_ãtch_ªd_sub1
(
addr
) \

513 
	`AO_ch¬_ãtch_ªd_sub1_acquœe
(
addr
)

	)

514 
	#AO_HAVE_ch¬_ãtch_ªd_sub1


	)

516 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1
) && \

517 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_wr™e
)

518 
	#AO_ch¬_ãtch_ªd_sub1
(
addr
) \

519 
	`AO_ch¬_ãtch_ªd_sub1_wr™e
(
addr
)

	)

520 
	#AO_HAVE_ch¬_ãtch_ªd_sub1


	)

522 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1
) && \

523 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»ad
)

524 
	#AO_ch¬_ãtch_ªd_sub1
(
addr
) \

525 
	`AO_ch¬_ãtch_ªd_sub1_»ad
(
addr
)

	)

526 
	#AO_HAVE_ch¬_ãtch_ªd_sub1


	)

529 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe
) &&\

530 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

531 !
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_fuÎ
)

532 
	#AO_ch¬_ãtch_ªd_sub1_fuÎ
(
addr
) \

533 (
	`AO_nİ_fuÎ
(), 
	`AO_ch¬_ãtch_ªd_sub1_acquœe
(
addr
))

	)

534 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_fuÎ


	)

537 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e
) && \

538 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_wr™e
)

539 
	#AO_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

540 
	`AO_ch¬_ãtch_ªd_sub1_wr™e
(
addr
)

	)

541 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e


	)

543 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e
) && \

544 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£
)

545 
	#AO_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

546 
	`AO_ch¬_ãtch_ªd_sub1_»Ëa£
(
addr
)

	)

547 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_»Ëa£_wr™e


	)

549 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe_»ad
) && \

550 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_»ad
)

551 
	#AO_ch¬_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

552 
	`AO_ch¬_ãtch_ªd_sub1_»ad
(
addr
)

	)

553 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe_»ad


	)

555 #ià!
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe_»ad
) && \

556 
	$defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe
)

557 
	#AO_ch¬_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

558 
	`AO_ch¬_ãtch_ªd_sub1_acquœe
(
addr
)

	)

559 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe_»ad


	)

562 #ifdeà
AO_NO_DD_ORDERING


563 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1_acquœe_»ad
)

564 
	#AO_ch¬_ãtch_ªd_sub1_dd_acquœe_»ad
(
addr
) \

565 
	`AO_ch¬_ãtch_ªd_sub1_acquœe_»ad
(
addr
)

	)

566 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_dd_acquœe_»ad


	)

569 #ià
	`defšed
(
AO_HAVE_ch¬_ãtch_ªd_sub1
)

570 
	#AO_ch¬_ãtch_ªd_sub1_dd_acquœe_»ad
(
addr
) \

571 
	`AO_ch¬_ãtch_ªd_sub1
(
addr
)

	)

572 
	#AO_HAVE_ch¬_ãtch_ªd_sub1_dd_acquœe_»ad


	)

577 #ià
	`defšed
(
AO_HAVE_shÜt_lßd_acquœe
è&& !defšed(
AO_HAVE_shÜt_lßd
)

578 
	#AO_shÜt_lßd
(
addr
è
	`AO_shÜt_lßd_acquœe
×ddr)

	)

579 
	#AO_HAVE_shÜt_lßd


	)

582 #ià
	`defšed
(
AO_HAVE_shÜt_lßd_fuÎ
è&& !defšed(
AO_HAVE_shÜt_lßd_acquœe
)

583 
	#AO_shÜt_lßd_acquœe
(
addr
è
	`AO_shÜt_lßd_fuÎ
×ddr)

	)

584 
	#AO_HAVE_shÜt_lßd_acquœe


	)

587 #ià
	`defšed
(
AO_HAVE_shÜt_lßd_fuÎ
è&& !defšed(
AO_HAVE_shÜt_lßd_»ad
)

588 
	#AO_shÜt_lßd_»ad
(
addr
è
	`AO_shÜt_lßd_fuÎ
×ddr)

	)

589 
	#AO_HAVE_shÜt_lßd_»ad


	)

592 #ià!
	`defšed
(
AO_HAVE_shÜt_lßd_acquœe_»ad
è&& defšed(
AO_HAVE_shÜt_lßd_acquœe
)

593 
	#AO_shÜt_lßd_acquœe_»ad
(
addr
è
	`AO_shÜt_lßd_acquœe
×ddr)

	)

594 
	#AO_HAVE_shÜt_lßd_acquœe_»ad


	)

597 #ià
	`defšed
(
AO_HAVE_shÜt_lßd
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

598 !
	$defšed
(
AO_HAVE_shÜt_lßd_acquœe
)

599 
AO_INLINE
 

600 
	$AO_shÜt_lßd_acquœe
(cÚ¡ vŞ©*
addr
)

602 
»suÉ
 = 
	`AO_shÜt_lßd
(
addr
);

605 
	`AO_nİ_fuÎ
();

606  
»suÉ
;

607 
	}
}

608 
	#AO_HAVE_shÜt_lßd_acquœe


	)

611 #ià
defšed
(
AO_HAVE_shÜt_lßd
è&& defšed(
AO_HAVE_nİ_»ad
) && \

612 !
	$defšed
(
AO_HAVE_shÜt_lßd_»ad
)

613 
AO_INLINE
 

614 
	$AO_shÜt_lßd_»ad
(cÚ¡ vŞ©*
addr
)

616 
»suÉ
 = 
	`AO_shÜt_lßd
(
addr
);

619 
	`AO_nİ_»ad
();

620  
»suÉ
;

621 
	}
}

622 
	#AO_HAVE_shÜt_lßd_»ad


	)

625 #ià
defšed
(
AO_HAVE_shÜt_lßd_acquœe
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

626 !
	$defšed
(
AO_HAVE_shÜt_lßd_fuÎ
)

627 
	#AO_shÜt_lßd_fuÎ
(
addr
è(
	`AO_nİ_fuÎ
(), 
	`AO_shÜt_lßd_acquœe
×ddr))

	)

628 
	#AO_HAVE_shÜt_lßd_fuÎ


	)

631 #ià!
	`defšed
(
AO_HAVE_shÜt_lßd_acquœe_»ad
è&& defšed(
AO_HAVE_shÜt_lßd_»ad
)

632 
	#AO_shÜt_lßd_acquœe_»ad
(
addr
è
	`AO_shÜt_lßd_»ad
×ddr)

	)

633 
	#AO_HAVE_shÜt_lßd_acquœe_»ad


	)

636 #ià
	`defšed
(
AO_HAVE_shÜt_lßd_acquœe_»ad
è&& !defšed(
AO_HAVE_shÜt_lßd
)

637 
	#AO_shÜt_lßd
(
addr
è
	`AO_shÜt_lßd_acquœe_»ad
×ddr)

	)

638 
	#AO_HAVE_shÜt_lßd


	)

641 #ifdeà
AO_NO_DD_ORDERING


642 #ià
	`defšed
(
AO_HAVE_shÜt_lßd_acquœe_»ad
)

643 
	#AO_shÜt_lßd_dd_acquœe_»ad
(
addr
) \

644 
	`AO_shÜt_lßd_acquœe_»ad
(
addr
)

	)

645 
	#AO_HAVE_shÜt_lßd_dd_acquœe_»ad


	)

648 #ià
	`defšed
(
AO_HAVE_shÜt_lßd
)

649 
	#AO_shÜt_lßd_dd_acquœe_»ad
(
addr
) \

650 
	`AO_shÜt_lßd
(
addr
)

	)

651 
	#AO_HAVE_shÜt_lßd_dd_acquœe_»ad


	)

658 #ià
	`defšed
(
AO_HAVE_shÜt_¡Üe_»Ëa£
è&& !defšed(
AO_HAVE_shÜt_¡Üe
)

659 
	#AO_shÜt_¡Üe
(
addr
, 
v®
è
	`AO_shÜt_¡Üe_»Ëa£
×ddr,v®)

	)

660 
	#AO_HAVE_shÜt_¡Üe


	)

663 #ià
	`defšed
(
AO_HAVE_shÜt_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_shÜt_¡Üe_»Ëa£
)

664 
	#AO_shÜt_¡Üe_»Ëa£
(
addr
,
v®
è
	`AO_shÜt_¡Üe_fuÎ
×ddr,v®)

	)

665 
	#AO_HAVE_shÜt_¡Üe_»Ëa£


	)

668 #ià
	`defšed
(
AO_HAVE_shÜt_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_shÜt_¡Üe_wr™e
)

669 
	#AO_shÜt_¡Üe_wr™e
(
addr
,
v®
è
	`AO_shÜt_¡Üe_fuÎ
×ddr,v®)

	)

670 
	#AO_HAVE_shÜt_¡Üe_wr™e


	)

673 #ià
	`defšed
(
AO_HAVE_shÜt_¡Üe_»Ëa£
) && \

674 !
	$defšed
(
AO_HAVE_shÜt_¡Üe_»Ëa£_wr™e
)

675 
	#AO_shÜt_¡Üe_»Ëa£_wr™e
(
addr
, 
v®
) \

676 
	`AO_shÜt_¡Üe_»Ëa£
(
addr
,
v®
)

	)

677 
	#AO_HAVE_shÜt_¡Üe_»Ëa£_wr™e


	)

680 #ià
	`defšed
(
AO_HAVE_shÜt_¡Üe_wr™e
è&& !defšed(
AO_HAVE_shÜt_¡Üe
)

681 
	#AO_shÜt_¡Üe
(
addr
, 
v®
è
	`AO_shÜt_¡Üe_wr™e
×ddr,v®)

	)

682 
	#AO_HAVE_shÜt_¡Üe


	)

685 #ià
	`defšed
(
AO_HAVE_shÜt_¡Üe
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

686 !
	$defšed
(
AO_HAVE_shÜt_¡Üe_»Ëa£
)

687 
	#AO_shÜt_¡Üe_»Ëa£
(
addr
,
v®
) \

688 (
	`AO_nİ_fuÎ
(), 
	`AO_shÜt_¡Üe
(
addr
,
v®
))

	)

689 
	#AO_HAVE_shÜt_¡Üe_»Ëa£


	)

692 #ià
	`defšed
(
AO_HAVE_nİ_wr™e
è&& defšed(
AO_HAVE_shÜt_¡Üe
) && \

693 !
	$defšed
(
AO_HAVE_shÜt_¡Üe_wr™e
)

694 
	#AO_shÜt_¡Üe_wr™e
(
addr
, 
v®
) \

695 (
	`AO_nİ_wr™e
(), 
	`AO_shÜt_¡Üe
(
addr
,
v®
))

	)

696 
	#AO_HAVE_shÜt_¡Üe_wr™e


	)

699 #ià
	`defšed
(
AO_HAVE_shÜt_¡Üe_wr™e
) && \

700 !
	$defšed
(
AO_HAVE_shÜt_¡Üe_»Ëa£_wr™e
)

701 
	#AO_shÜt_¡Üe_»Ëa£_wr™e
(
addr
, 
v®
è
	`AO_shÜt_¡Üe_wr™e
×ddr,v®)

	)

702 
	#AO_HAVE_shÜt_¡Üe_»Ëa£_wr™e


	)

705 #ià
	`defšed
(
AO_HAVE_shÜt_¡Üe_»Ëa£
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

706 !
	$defšed
(
AO_HAVE_shÜt_¡Üe_fuÎ
)

707 
	#AO_shÜt_¡Üe_fuÎ
(
addr
, 
v®
) \

708 (
	`AO_shÜt_¡Üe_»Ëa£
(
addr
, 
v®
), 
	`AO_nİ_fuÎ
())

	)

709 
	#AO_HAVE_shÜt_¡Üe_fuÎ


	)

714 #ià
	`defšed
(
AO_HAVE_shÜt_com·»_ªd_sw­_fuÎ
) && \

715 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_fuÎ
)

716 
AO_INLINE
 
AO_t


717 
	$AO_shÜt_ãtch_ªd_add_fuÎ
(vŞ©*
addr
,

718 
šü
)

720 
Şd
;

723 
Şd
 = *
addr
;

725 !
	`AO_shÜt_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, old+
šü
));

726  
Şd
;

727 
	}
}

728 
	#AO_HAVE_shÜt_ãtch_ªd_add_fuÎ


	)

731 #ià
defšed
(
AO_HAVE_shÜt_com·»_ªd_sw­_acquœe
) && \

732 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe
)

733 
AO_INLINE
 
AO_t


734 
	$AO_shÜt_ãtch_ªd_add_acquœe
(vŞ©*
addr
,

735 
šü
)

737 
Şd
;

740 
Şd
 = *
addr
;

742 !
	`AO_shÜt_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, old+
šü
));

743  
Şd
;

744 
	}
}

745 
	#AO_HAVE_shÜt_ãtch_ªd_add_acquœe


	)

748 #ià
defšed
(
AO_HAVE_shÜt_com·»_ªd_sw­_»Ëa£
) && \

749 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£
)

750 
AO_INLINE
 
AO_t


751 
	$AO_shÜt_ãtch_ªd_add_»Ëa£
(vŞ©*
addr
,

752 
šü
)

754 
Şd
;

757 
Şd
 = *
addr
;

759 !
	`AO_shÜt_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, old+
šü
));

760  
Şd
;

761 
	}
}

762 
	#AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£


	)

765 #ià
defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_fuÎ
)

766 #ià!
defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£
)

767 
	#AO_shÜt_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
) \

768 
	`AO_shÜt_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

769 
	#AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£


	)

771 #ià!
defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe
)

772 
	#AO_shÜt_ãtch_ªd_add_acquœe
(
addr
, 
v®
) \

773 
	`AO_shÜt_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

774 
	#AO_HAVE_shÜt_ãtch_ªd_add_acquœe


	)

776 #ià!
defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_wr™e
)

777 
	#AO_shÜt_ãtch_ªd_add_wr™e
(
addr
, 
v®
) \

778 
	`AO_shÜt_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

779 
	#AO_HAVE_shÜt_ãtch_ªd_add_wr™e


	)

781 #ià!
defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»ad
)

782 
	#AO_shÜt_ãtch_ªd_add_»ad
(
addr
, 
v®
) \

783 
	`AO_shÜt_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

784 
	#AO_HAVE_shÜt_ãtch_ªd_add_»ad


	)

788 #ià!
defšed
(
AO_HAVE_shÜt_ãtch_ªd_add
) && \

789 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£
)

790 
	#AO_shÜt_ãtch_ªd_add
(
addr
, 
v®
) \

791 
	`AO_shÜt_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
)

	)

792 
	#AO_HAVE_shÜt_ãtch_ªd_add


	)

794 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add
) && \

795 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe
)

796 
	#AO_shÜt_ãtch_ªd_add
(
addr
, 
v®
) \

797 
	`AO_shÜt_ãtch_ªd_add_acquœe
(
addr
, 
v®
)

	)

798 
	#AO_HAVE_shÜt_ãtch_ªd_add


	)

800 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add
) && \

801 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_wr™e
)

802 
	#AO_shÜt_ãtch_ªd_add
(
addr
, 
v®
) \

803 
	`AO_shÜt_ãtch_ªd_add_wr™e
(
addr
, 
v®
)

	)

804 
	#AO_HAVE_shÜt_ãtch_ªd_add


	)

806 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add
) && \

807 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»ad
)

808 
	#AO_shÜt_ãtch_ªd_add
(
addr
, 
v®
) \

809 
	`AO_shÜt_ãtch_ªd_add_»ad
(
addr
, 
v®
)

	)

810 
	#AO_HAVE_shÜt_ãtch_ªd_add


	)

813 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe
) &&\

814 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

815 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_fuÎ
)

816 
	#AO_shÜt_ãtch_ªd_add_fuÎ
(
addr
, 
v®
) \

817 (
	`AO_nİ_fuÎ
(), 
	`AO_shÜt_ãtch_ªd_add_acquœe
(
addr
, 
v®
))

	)

820 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£_wr™e
) && \

821 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_wr™e
)

822 
	#AO_shÜt_ãtch_ªd_add_»Ëa£_wr™e
(
addr
, 
v®
) \

823 
	`AO_shÜt_ãtch_ªd_add_wr™e
(
addr
, 
v®
)

	)

824 
	#AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£_wr™e


	)

826 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£_wr™e
) && \

827 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£
)

828 
	#AO_shÜt_ãtch_ªd_add_»Ëa£_wr™e
(
addr
, 
v®
) \

829 
	`AO_shÜt_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
)

	)

830 
	#AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£_wr™e


	)

832 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe_»ad
) && \

833 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»ad
)

834 
	#AO_shÜt_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
) \

835 
	`AO_shÜt_ãtch_ªd_add_»ad
(
addr
, 
v®
)

	)

836 
	#AO_HAVE_shÜt_ãtch_ªd_add_acquœe_»ad


	)

838 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe_»ad
) && \

839 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe
)

840 
	#AO_shÜt_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
) \

841 
	`AO_shÜt_ãtch_ªd_add_acquœe
(
addr
, 
v®
)

	)

842 
	#AO_HAVE_shÜt_ãtch_ªd_add_acquœe_»ad


	)

845 #ifdeà
AO_NO_DD_ORDERING


846 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe_»ad
)

847 
	#AO_shÜt_ãtch_ªd_add_dd_acquœe_»ad
(
addr
, 
v®
) \

848 
	`AO_shÜt_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
)

	)

849 
	#AO_HAVE_shÜt_ãtch_ªd_add_dd_acquœe_»ad


	)

852 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add
)

853 
	#AO_shÜt_ãtch_ªd_add_dd_acquœe_»ad
(
addr
, 
v®
) \

854 
	`AO_shÜt_ãtch_ªd_add
(
addr
, 
v®
)

	)

855 
	#AO_HAVE_shÜt_ãtch_ªd_add_dd_acquœe_»ad


	)

861 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_fuÎ
) &&\

862 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_fuÎ
)

863 
	#AO_shÜt_ãtch_ªd_add1_fuÎ
(
addr
) \

864 
	`AO_shÜt_ãtch_ªd_add_fuÎ
(
addr
,1)

	)

865 
	#AO_HAVE_shÜt_ãtch_ªd_add1_fuÎ


	)

867 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£
) &&\

868 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£
)

869 
	#AO_shÜt_ãtch_ªd_add1_»Ëa£
(
addr
) \

870 
	`AO_shÜt_ãtch_ªd_add_»Ëa£
(
addr
,1)

	)

871 
	#AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£


	)

873 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe
) &&\

874 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe
)

875 
	#AO_shÜt_ãtch_ªd_add1_acquœe
(
addr
) \

876 
	`AO_shÜt_ãtch_ªd_add_acquœe
(
addr
,1)

	)

877 
	#AO_HAVE_shÜt_ãtch_ªd_add1_acquœe


	)

879 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_wr™e
) &&\

880 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_wr™e
)

881 
	#AO_shÜt_ãtch_ªd_add1_wr™e
(
addr
) \

882 
	`AO_shÜt_ãtch_ªd_add_wr™e
(
addr
,1)

	)

883 
	#AO_HAVE_shÜt_ãtch_ªd_add1_wr™e


	)

885 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»ad
) &&\

886 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»ad
)

887 
	#AO_shÜt_ãtch_ªd_add1_»ad
(
addr
) \

888 
	`AO_shÜt_ãtch_ªd_add_»ad
(
addr
,1)

	)

889 
	#AO_HAVE_shÜt_ãtch_ªd_add1_»ad


	)

891 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£_wr™e
) &&\

892 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£_wr™e
)

893 
	#AO_shÜt_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

894 
	`AO_shÜt_ãtch_ªd_add_»Ëa£_wr™e
(
addr
,1)

	)

895 
	#AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£_wr™e


	)

897 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe_»ad
) &&\

898 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe_»ad
)

899 
	#AO_shÜt_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

900 
	`AO_shÜt_ãtch_ªd_add_acquœe_»ad
(
addr
,1)

	)

901 
	#AO_HAVE_shÜt_ãtch_ªd_add1_acquœe_»ad


	)

903 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add
) &&\

904 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1
)

905 
	#AO_shÜt_ãtch_ªd_add1
(
addr
) \

906 
	`AO_shÜt_ãtch_ªd_add
(
addr
,1)

	)

907 
	#AO_HAVE_shÜt_ãtch_ªd_add1


	)

910 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_fuÎ
)

911 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£
)

912 
	#AO_shÜt_ãtch_ªd_add1_»Ëa£
(
addr
) \

913 
	`AO_shÜt_ãtch_ªd_add1_fuÎ
(
addr
)

	)

914 
	#AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£


	)

916 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe
)

917 
	#AO_shÜt_ãtch_ªd_add1_acquœe
(
addr
) \

918 
	`AO_shÜt_ãtch_ªd_add1_fuÎ
(
addr
)

	)

919 
	#AO_HAVE_shÜt_ãtch_ªd_add1_acquœe


	)

921 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_wr™e
)

922 
	#AO_shÜt_ãtch_ªd_add1_wr™e
(
addr
) \

923 
	`AO_shÜt_ãtch_ªd_add1_fuÎ
(
addr
)

	)

924 
	#AO_HAVE_shÜt_ãtch_ªd_add1_wr™e


	)

926 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»ad
)

927 
	#AO_shÜt_ãtch_ªd_add1_»ad
(
addr
) \

928 
	`AO_shÜt_ãtch_ªd_add1_fuÎ
(
addr
)

	)

929 
	#AO_HAVE_shÜt_ãtch_ªd_add1_»ad


	)

933 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1
) && \

934 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£
)

935 
	#AO_shÜt_ãtch_ªd_add1
(
addr
) \

936 
	`AO_shÜt_ãtch_ªd_add1_»Ëa£
(
addr
)

	)

937 
	#AO_HAVE_shÜt_ãtch_ªd_add1


	)

939 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1
) && \

940 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe
)

941 
	#AO_shÜt_ãtch_ªd_add1
(
addr
) \

942 
	`AO_shÜt_ãtch_ªd_add1_acquœe
(
addr
)

	)

943 
	#AO_HAVE_shÜt_ãtch_ªd_add1


	)

945 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1
) && \

946 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_wr™e
)

947 
	#AO_shÜt_ãtch_ªd_add1
(
addr
) \

948 
	`AO_shÜt_ãtch_ªd_add1_wr™e
(
addr
)

	)

949 
	#AO_HAVE_shÜt_ãtch_ªd_add1


	)

951 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1
) && \

952 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»ad
)

953 
	#AO_shÜt_ãtch_ªd_add1
(
addr
) \

954 
	`AO_shÜt_ãtch_ªd_add1_»ad
(
addr
)

	)

955 
	#AO_HAVE_shÜt_ãtch_ªd_add1


	)

958 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe
) &&\

959 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

960 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_fuÎ
)

961 
	#AO_shÜt_ãtch_ªd_add1_fuÎ
(
addr
) \

962 (
	`AO_nİ_fuÎ
(), 
	`AO_shÜt_ãtch_ªd_add1_acquœe
(
addr
))

	)

963 
	#AO_HAVE_shÜt_ãtch_ªd_add1_fuÎ


	)

966 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£_wr™e
) && \

967 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_wr™e
)

968 
	#AO_shÜt_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

969 
	`AO_shÜt_ãtch_ªd_add1_wr™e
(
addr
)

	)

970 
	#AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£_wr™e


	)

972 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£_wr™e
) && \

973 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£
)

974 
	#AO_shÜt_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

975 
	`AO_shÜt_ãtch_ªd_add1_»Ëa£
(
addr
)

	)

976 
	#AO_HAVE_shÜt_ãtch_ªd_add1_»Ëa£_wr™e


	)

978 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe_»ad
) && \

979 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_»ad
)

980 
	#AO_shÜt_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

981 
	`AO_shÜt_ãtch_ªd_add1_»ad
(
addr
)

	)

982 
	#AO_HAVE_shÜt_ãtch_ªd_add1_acquœe_»ad


	)

984 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe_»ad
) && \

985 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe
)

986 
	#AO_shÜt_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

987 
	`AO_shÜt_ãtch_ªd_add1_acquœe
(
addr
)

	)

988 
	#AO_HAVE_shÜt_ãtch_ªd_add1_acquœe_»ad


	)

991 #ifdeà
AO_NO_DD_ORDERING


992 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1_acquœe_»ad
)

993 
	#AO_shÜt_ãtch_ªd_add1_dd_acquœe_»ad
(
addr
) \

994 
	`AO_shÜt_ãtch_ªd_add1_acquœe_»ad
(
addr
)

	)

995 
	#AO_HAVE_shÜt_ãtch_ªd_add1_dd_acquœe_»ad


	)

998 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add1
)

999 
	#AO_shÜt_ãtch_ªd_add1_dd_acquœe_»ad
(
addr
) \

1000 
	`AO_shÜt_ãtch_ªd_add1
(
addr
)

	)

1001 
	#AO_HAVE_shÜt_ãtch_ªd_add1_dd_acquœe_»ad


	)

1007 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_fuÎ
) &&\

1008 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_fuÎ
)

1009 
	#AO_shÜt_ãtch_ªd_sub1_fuÎ
(
addr
) \

1010 
	`AO_shÜt_ãtch_ªd_add_fuÎ
(
addr
,()(-1))

	)

1011 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_fuÎ


	)

1013 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£
) &&\

1014 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£
)

1015 
	#AO_shÜt_ãtch_ªd_sub1_»Ëa£
(
addr
) \

1016 
	`AO_shÜt_ãtch_ªd_add_»Ëa£
(
addr
,()(-1))

	)

1017 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£


	)

1019 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe
) &&\

1020 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe
)

1021 
	#AO_shÜt_ãtch_ªd_sub1_acquœe
(
addr
) \

1022 
	`AO_shÜt_ãtch_ªd_add_acquœe
(
addr
,()(-1))

	)

1023 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe


	)

1025 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_wr™e
) &&\

1026 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_wr™e
)

1027 
	#AO_shÜt_ãtch_ªd_sub1_wr™e
(
addr
) \

1028 
	`AO_shÜt_ãtch_ªd_add_wr™e
(
addr
,()(-1))

	)

1029 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_wr™e


	)

1031 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»ad
) &&\

1032 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»ad
)

1033 
	#AO_shÜt_ãtch_ªd_sub1_»ad
(
addr
) \

1034 
	`AO_shÜt_ãtch_ªd_add_»ad
(
addr
,()(-1))

	)

1035 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_»ad


	)

1037 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_»Ëa£_wr™e
) &&\

1038 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e
)

1039 
	#AO_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

1040 
	`AO_shÜt_ãtch_ªd_add_»Ëa£_wr™e
(
addr
,()(-1))

	)

1041 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e


	)

1043 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add_acquœe_»ad
) &&\

1044 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe_»ad
)

1045 
	#AO_shÜt_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

1046 
	`AO_shÜt_ãtch_ªd_add_acquœe_»ad
(
addr
,()(-1))

	)

1047 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe_»ad


	)

1049 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_add
) &&\

1050 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1
)

1051 
	#AO_shÜt_ãtch_ªd_sub1
(
addr
) \

1052 
	`AO_shÜt_ãtch_ªd_add
(
addr
,()(-1))

	)

1053 
	#AO_HAVE_shÜt_ãtch_ªd_sub1


	)

1056 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_fuÎ
)

1057 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£
)

1058 
	#AO_shÜt_ãtch_ªd_sub1_»Ëa£
(
addr
) \

1059 
	`AO_shÜt_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

1060 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£


	)

1062 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe
)

1063 
	#AO_shÜt_ãtch_ªd_sub1_acquœe
(
addr
) \

1064 
	`AO_shÜt_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

1065 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe


	)

1067 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_wr™e
)

1068 
	#AO_shÜt_ãtch_ªd_sub1_wr™e
(
addr
) \

1069 
	`AO_shÜt_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

1070 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_wr™e


	)

1072 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»ad
)

1073 
	#AO_shÜt_ãtch_ªd_sub1_»ad
(
addr
) \

1074 
	`AO_shÜt_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

1075 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_»ad


	)

1079 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1
) && \

1080 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£
)

1081 
	#AO_shÜt_ãtch_ªd_sub1
(
addr
) \

1082 
	`AO_shÜt_ãtch_ªd_sub1_»Ëa£
(
addr
)

	)

1083 
	#AO_HAVE_shÜt_ãtch_ªd_sub1


	)

1085 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1
) && \

1086 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe
)

1087 
	#AO_shÜt_ãtch_ªd_sub1
(
addr
) \

1088 
	`AO_shÜt_ãtch_ªd_sub1_acquœe
(
addr
)

	)

1089 
	#AO_HAVE_shÜt_ãtch_ªd_sub1


	)

1091 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1
) && \

1092 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_wr™e
)

1093 
	#AO_shÜt_ãtch_ªd_sub1
(
addr
) \

1094 
	`AO_shÜt_ãtch_ªd_sub1_wr™e
(
addr
)

	)

1095 
	#AO_HAVE_shÜt_ãtch_ªd_sub1


	)

1097 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1
) && \

1098 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»ad
)

1099 
	#AO_shÜt_ãtch_ªd_sub1
(
addr
) \

1100 
	`AO_shÜt_ãtch_ªd_sub1_»ad
(
addr
)

	)

1101 
	#AO_HAVE_shÜt_ãtch_ªd_sub1


	)

1104 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe
) &&\

1105 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

1106 !
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_fuÎ
)

1107 
	#AO_shÜt_ãtch_ªd_sub1_fuÎ
(
addr
) \

1108 (
	`AO_nİ_fuÎ
(), 
	`AO_shÜt_ãtch_ªd_sub1_acquœe
(
addr
))

	)

1109 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_fuÎ


	)

1112 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e
) && \

1113 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_wr™e
)

1114 
	#AO_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

1115 
	`AO_shÜt_ãtch_ªd_sub1_wr™e
(
addr
)

	)

1116 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e


	)

1118 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e
) && \

1119 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£
)

1120 
	#AO_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

1121 
	`AO_shÜt_ãtch_ªd_sub1_»Ëa£
(
addr
)

	)

1122 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_»Ëa£_wr™e


	)

1124 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe_»ad
) && \

1125 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_»ad
)

1126 
	#AO_shÜt_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

1127 
	`AO_shÜt_ãtch_ªd_sub1_»ad
(
addr
)

	)

1128 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe_»ad


	)

1130 #ià!
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe_»ad
) && \

1131 
	$defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe
)

1132 
	#AO_shÜt_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

1133 
	`AO_shÜt_ãtch_ªd_sub1_acquœe
(
addr
)

	)

1134 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe_»ad


	)

1137 #ifdeà
AO_NO_DD_ORDERING


1138 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1_acquœe_»ad
)

1139 
	#AO_shÜt_ãtch_ªd_sub1_dd_acquœe_»ad
(
addr
) \

1140 
	`AO_shÜt_ãtch_ªd_sub1_acquœe_»ad
(
addr
)

	)

1141 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_dd_acquœe_»ad


	)

1144 #ià
	`defšed
(
AO_HAVE_shÜt_ãtch_ªd_sub1
)

1145 
	#AO_shÜt_ãtch_ªd_sub1_dd_acquœe_»ad
(
addr
) \

1146 
	`AO_shÜt_ãtch_ªd_sub1
(
addr
)

	)

1147 
	#AO_HAVE_shÜt_ãtch_ªd_sub1_dd_acquœe_»ad


	)

1152 #ià
	`defšed
(
AO_HAVE_št_lßd_acquœe
è&& !defšed(
AO_HAVE_št_lßd
)

1153 
	#AO_št_lßd
(
addr
è
	`AO_št_lßd_acquœe
×ddr)

	)

1154 
	#AO_HAVE_št_lßd


	)

1157 #ià
	`defšed
(
AO_HAVE_št_lßd_fuÎ
è&& !defšed(
AO_HAVE_št_lßd_acquœe
)

1158 
	#AO_št_lßd_acquœe
(
addr
è
	`AO_št_lßd_fuÎ
×ddr)

	)

1159 
	#AO_HAVE_št_lßd_acquœe


	)

1162 #ià
	`defšed
(
AO_HAVE_št_lßd_fuÎ
è&& !defšed(
AO_HAVE_št_lßd_»ad
)

1163 
	#AO_št_lßd_»ad
(
addr
è
	`AO_št_lßd_fuÎ
×ddr)

	)

1164 
	#AO_HAVE_št_lßd_»ad


	)

1167 #ià!
	`defšed
(
AO_HAVE_št_lßd_acquœe_»ad
è&& defšed(
AO_HAVE_št_lßd_acquœe
)

1168 
	#AO_št_lßd_acquœe_»ad
(
addr
è
	`AO_št_lßd_acquœe
×ddr)

	)

1169 
	#AO_HAVE_št_lßd_acquœe_»ad


	)

1172 #ià
	`defšed
(
AO_HAVE_št_lßd
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

1173 !
	$defšed
(
AO_HAVE_št_lßd_acquœe
)

1174 
AO_INLINE
 

1175 
	$AO_št_lßd_acquœe
(cÚ¡ vŞ©*
addr
)

1177 
»suÉ
 = 
	`AO_št_lßd
(
addr
);

1180 
	`AO_nİ_fuÎ
();

1181  
»suÉ
;

1182 
	}
}

1183 
	#AO_HAVE_št_lßd_acquœe


	)

1186 #ià
defšed
(
AO_HAVE_št_lßd
è&& defšed(
AO_HAVE_nİ_»ad
) && \

1187 !
	$defšed
(
AO_HAVE_št_lßd_»ad
)

1188 
AO_INLINE
 

1189 
	$AO_št_lßd_»ad
(cÚ¡ vŞ©*
addr
)

1191 
»suÉ
 = 
	`AO_št_lßd
(
addr
);

1194 
	`AO_nİ_»ad
();

1195  
»suÉ
;

1196 
	}
}

1197 
	#AO_HAVE_št_lßd_»ad


	)

1200 #ià
defšed
(
AO_HAVE_št_lßd_acquœe
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

1201 !
	$defšed
(
AO_HAVE_št_lßd_fuÎ
)

1202 
	#AO_št_lßd_fuÎ
(
addr
è(
	`AO_nİ_fuÎ
(), 
	`AO_št_lßd_acquœe
×ddr))

	)

1203 
	#AO_HAVE_št_lßd_fuÎ


	)

1206 #ià!
	`defšed
(
AO_HAVE_št_lßd_acquœe_»ad
è&& defšed(
AO_HAVE_št_lßd_»ad
)

1207 
	#AO_št_lßd_acquœe_»ad
(
addr
è
	`AO_št_lßd_»ad
×ddr)

	)

1208 
	#AO_HAVE_št_lßd_acquœe_»ad


	)

1211 #ià
	`defšed
(
AO_HAVE_št_lßd_acquœe_»ad
è&& !defšed(
AO_HAVE_št_lßd
)

1212 
	#AO_št_lßd
(
addr
è
	`AO_št_lßd_acquœe_»ad
×ddr)

	)

1213 
	#AO_HAVE_št_lßd


	)

1216 #ifdeà
AO_NO_DD_ORDERING


1217 #ià
	`defšed
(
AO_HAVE_št_lßd_acquœe_»ad
)

1218 
	#AO_št_lßd_dd_acquœe_»ad
(
addr
) \

1219 
	`AO_št_lßd_acquœe_»ad
(
addr
)

	)

1220 
	#AO_HAVE_št_lßd_dd_acquœe_»ad


	)

1223 #ià
	`defšed
(
AO_HAVE_št_lßd
)

1224 
	#AO_št_lßd_dd_acquœe_»ad
(
addr
) \

1225 
	`AO_št_lßd
(
addr
)

	)

1226 
	#AO_HAVE_št_lßd_dd_acquœe_»ad


	)

1233 #ià
	`defšed
(
AO_HAVE_št_¡Üe_»Ëa£
è&& !defšed(
AO_HAVE_št_¡Üe
)

1234 
	#AO_št_¡Üe
(
addr
, 
v®
è
	`AO_št_¡Üe_»Ëa£
×ddr,v®)

	)

1235 
	#AO_HAVE_št_¡Üe


	)

1238 #ià
	`defšed
(
AO_HAVE_št_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_št_¡Üe_»Ëa£
)

1239 
	#AO_št_¡Üe_»Ëa£
(
addr
,
v®
è
	`AO_št_¡Üe_fuÎ
×ddr,v®)

	)

1240 
	#AO_HAVE_št_¡Üe_»Ëa£


	)

1243 #ià
	`defšed
(
AO_HAVE_št_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_št_¡Üe_wr™e
)

1244 
	#AO_št_¡Üe_wr™e
(
addr
,
v®
è
	`AO_št_¡Üe_fuÎ
×ddr,v®)

	)

1245 
	#AO_HAVE_št_¡Üe_wr™e


	)

1248 #ià
	`defšed
(
AO_HAVE_št_¡Üe_»Ëa£
) && \

1249 !
	$defšed
(
AO_HAVE_št_¡Üe_»Ëa£_wr™e
)

1250 
	#AO_št_¡Üe_»Ëa£_wr™e
(
addr
, 
v®
) \

1251 
	`AO_št_¡Üe_»Ëa£
(
addr
,
v®
)

	)

1252 
	#AO_HAVE_št_¡Üe_»Ëa£_wr™e


	)

1255 #ià
	`defšed
(
AO_HAVE_št_¡Üe_wr™e
è&& !defšed(
AO_HAVE_št_¡Üe
)

1256 
	#AO_št_¡Üe
(
addr
, 
v®
è
	`AO_št_¡Üe_wr™e
×ddr,v®)

	)

1257 
	#AO_HAVE_št_¡Üe


	)

1260 #ià
	`defšed
(
AO_HAVE_št_¡Üe
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

1261 !
	$defšed
(
AO_HAVE_št_¡Üe_»Ëa£
)

1262 
	#AO_št_¡Üe_»Ëa£
(
addr
,
v®
) \

1263 (
	`AO_nİ_fuÎ
(), 
	`AO_št_¡Üe
(
addr
,
v®
))

	)

1264 
	#AO_HAVE_št_¡Üe_»Ëa£


	)

1267 #ià
	`defšed
(
AO_HAVE_nİ_wr™e
è&& defšed(
AO_HAVE_št_¡Üe
) && \

1268 !
	$defšed
(
AO_HAVE_št_¡Üe_wr™e
)

1269 
	#AO_št_¡Üe_wr™e
(
addr
, 
v®
) \

1270 (
	`AO_nİ_wr™e
(), 
	`AO_št_¡Üe
(
addr
,
v®
))

	)

1271 
	#AO_HAVE_št_¡Üe_wr™e


	)

1274 #ià
	`defšed
(
AO_HAVE_št_¡Üe_wr™e
) && \

1275 !
	$defšed
(
AO_HAVE_št_¡Üe_»Ëa£_wr™e
)

1276 
	#AO_št_¡Üe_»Ëa£_wr™e
(
addr
, 
v®
è
	`AO_št_¡Üe_wr™e
×ddr,v®)

	)

1277 
	#AO_HAVE_št_¡Üe_»Ëa£_wr™e


	)

1280 #ià
	`defšed
(
AO_HAVE_št_¡Üe_»Ëa£
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

1281 !
	$defšed
(
AO_HAVE_št_¡Üe_fuÎ
)

1282 
	#AO_št_¡Üe_fuÎ
(
addr
, 
v®
) \

1283 (
	`AO_št_¡Üe_»Ëa£
(
addr
, 
v®
), 
	`AO_nİ_fuÎ
())

	)

1284 
	#AO_HAVE_št_¡Üe_fuÎ


	)

1289 #ià
	`defšed
(
AO_HAVE_št_com·»_ªd_sw­_fuÎ
) && \

1290 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_fuÎ
)

1291 
AO_INLINE
 
AO_t


1292 
	$AO_št_ãtch_ªd_add_fuÎ
(vŞ©*
addr
,

1293 
šü
)

1295 
Şd
;

1298 
Şd
 = *
addr
;

1300 !
	`AO_št_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, old+
šü
));

1301  
Şd
;

1302 
	}
}

1303 
	#AO_HAVE_št_ãtch_ªd_add_fuÎ


	)

1306 #ià
defšed
(
AO_HAVE_št_com·»_ªd_sw­_acquœe
) && \

1307 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe
)

1308 
AO_INLINE
 
AO_t


1309 
	$AO_št_ãtch_ªd_add_acquœe
(vŞ©*
addr
,

1310 
šü
)

1312 
Şd
;

1315 
Şd
 = *
addr
;

1317 !
	`AO_št_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, old+
šü
));

1318  
Şd
;

1319 
	}
}

1320 
	#AO_HAVE_št_ãtch_ªd_add_acquœe


	)

1323 #ià
defšed
(
AO_HAVE_št_com·»_ªd_sw­_»Ëa£
) && \

1324 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£
)

1325 
AO_INLINE
 
AO_t


1326 
	$AO_št_ãtch_ªd_add_»Ëa£
(vŞ©*
addr
,

1327 
šü
)

1329 
Şd
;

1332 
Şd
 = *
addr
;

1334 !
	`AO_št_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, old+
šü
));

1335  
Şd
;

1336 
	}
}

1337 
	#AO_HAVE_št_ãtch_ªd_add_»Ëa£


	)

1340 #ià
defšed
(
AO_HAVE_št_ãtch_ªd_add_fuÎ
)

1341 #ià!
defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£
)

1342 
	#AO_št_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
) \

1343 
	`AO_št_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

1344 
	#AO_HAVE_št_ãtch_ªd_add_»Ëa£


	)

1346 #ià!
defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe
)

1347 
	#AO_št_ãtch_ªd_add_acquœe
(
addr
, 
v®
) \

1348 
	`AO_št_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

1349 
	#AO_HAVE_št_ãtch_ªd_add_acquœe


	)

1351 #ià!
defšed
(
AO_HAVE_št_ãtch_ªd_add_wr™e
)

1352 
	#AO_št_ãtch_ªd_add_wr™e
(
addr
, 
v®
) \

1353 
	`AO_št_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

1354 
	#AO_HAVE_št_ãtch_ªd_add_wr™e


	)

1356 #ià!
defšed
(
AO_HAVE_št_ãtch_ªd_add_»ad
)

1357 
	#AO_št_ãtch_ªd_add_»ad
(
addr
, 
v®
) \

1358 
	`AO_št_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

1359 
	#AO_HAVE_št_ãtch_ªd_add_»ad


	)

1363 #ià!
defšed
(
AO_HAVE_št_ãtch_ªd_add
) && \

1364 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£
)

1365 
	#AO_št_ãtch_ªd_add
(
addr
, 
v®
) \

1366 
	`AO_št_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
)

	)

1367 
	#AO_HAVE_št_ãtch_ªd_add


	)

1369 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add
) && \

1370 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe
)

1371 
	#AO_št_ãtch_ªd_add
(
addr
, 
v®
) \

1372 
	`AO_št_ãtch_ªd_add_acquœe
(
addr
, 
v®
)

	)

1373 
	#AO_HAVE_št_ãtch_ªd_add


	)

1375 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add
) && \

1376 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_wr™e
)

1377 
	#AO_št_ãtch_ªd_add
(
addr
, 
v®
) \

1378 
	`AO_št_ãtch_ªd_add_wr™e
(
addr
, 
v®
)

	)

1379 
	#AO_HAVE_št_ãtch_ªd_add


	)

1381 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add
) && \

1382 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_»ad
)

1383 
	#AO_št_ãtch_ªd_add
(
addr
, 
v®
) \

1384 
	`AO_št_ãtch_ªd_add_»ad
(
addr
, 
v®
)

	)

1385 
	#AO_HAVE_št_ãtch_ªd_add


	)

1388 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe
) &&\

1389 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

1390 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_fuÎ
)

1391 
	#AO_št_ãtch_ªd_add_fuÎ
(
addr
, 
v®
) \

1392 (
	`AO_nİ_fuÎ
(), 
	`AO_št_ãtch_ªd_add_acquœe
(
addr
, 
v®
))

	)

1395 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£_wr™e
) && \

1396 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_wr™e
)

1397 
	#AO_št_ãtch_ªd_add_»Ëa£_wr™e
(
addr
, 
v®
) \

1398 
	`AO_št_ãtch_ªd_add_wr™e
(
addr
, 
v®
)

	)

1399 
	#AO_HAVE_št_ãtch_ªd_add_»Ëa£_wr™e


	)

1401 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£_wr™e
) && \

1402 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£
)

1403 
	#AO_št_ãtch_ªd_add_»Ëa£_wr™e
(
addr
, 
v®
) \

1404 
	`AO_št_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
)

	)

1405 
	#AO_HAVE_št_ãtch_ªd_add_»Ëa£_wr™e


	)

1407 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe_»ad
) && \

1408 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_»ad
)

1409 
	#AO_št_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
) \

1410 
	`AO_št_ãtch_ªd_add_»ad
(
addr
, 
v®
)

	)

1411 
	#AO_HAVE_št_ãtch_ªd_add_acquœe_»ad


	)

1413 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe_»ad
) && \

1414 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe
)

1415 
	#AO_št_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
) \

1416 
	`AO_št_ãtch_ªd_add_acquœe
(
addr
, 
v®
)

	)

1417 
	#AO_HAVE_št_ãtch_ªd_add_acquœe_»ad


	)

1420 #ifdeà
AO_NO_DD_ORDERING


1421 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe_»ad
)

1422 
	#AO_št_ãtch_ªd_add_dd_acquœe_»ad
(
addr
, 
v®
) \

1423 
	`AO_št_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
)

	)

1424 
	#AO_HAVE_št_ãtch_ªd_add_dd_acquœe_»ad


	)

1427 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add
)

1428 
	#AO_št_ãtch_ªd_add_dd_acquœe_»ad
(
addr
, 
v®
) \

1429 
	`AO_št_ãtch_ªd_add
(
addr
, 
v®
)

	)

1430 
	#AO_HAVE_št_ãtch_ªd_add_dd_acquœe_»ad


	)

1436 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_fuÎ
) &&\

1437 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_fuÎ
)

1438 
	#AO_št_ãtch_ªd_add1_fuÎ
(
addr
) \

1439 
	`AO_št_ãtch_ªd_add_fuÎ
(
addr
,1)

	)

1440 
	#AO_HAVE_št_ãtch_ªd_add1_fuÎ


	)

1442 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£
) &&\

1443 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£
)

1444 
	#AO_št_ãtch_ªd_add1_»Ëa£
(
addr
) \

1445 
	`AO_št_ãtch_ªd_add_»Ëa£
(
addr
,1)

	)

1446 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£


	)

1448 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe
) &&\

1449 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe
)

1450 
	#AO_št_ãtch_ªd_add1_acquœe
(
addr
) \

1451 
	`AO_št_ãtch_ªd_add_acquœe
(
addr
,1)

	)

1452 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe


	)

1454 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_wr™e
) &&\

1455 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_wr™e
)

1456 
	#AO_št_ãtch_ªd_add1_wr™e
(
addr
) \

1457 
	`AO_št_ãtch_ªd_add_wr™e
(
addr
,1)

	)

1458 
	#AO_HAVE_št_ãtch_ªd_add1_wr™e


	)

1460 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_»ad
) &&\

1461 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»ad
)

1462 
	#AO_št_ãtch_ªd_add1_»ad
(
addr
) \

1463 
	`AO_št_ãtch_ªd_add_»ad
(
addr
,1)

	)

1464 
	#AO_HAVE_št_ãtch_ªd_add1_»ad


	)

1466 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£_wr™e
) &&\

1467 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£_wr™e
)

1468 
	#AO_št_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

1469 
	`AO_št_ãtch_ªd_add_»Ëa£_wr™e
(
addr
,1)

	)

1470 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£_wr™e


	)

1472 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe_»ad
) &&\

1473 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe_»ad
)

1474 
	#AO_št_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

1475 
	`AO_št_ãtch_ªd_add_acquœe_»ad
(
addr
,1)

	)

1476 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe_»ad


	)

1478 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add
) &&\

1479 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1
)

1480 
	#AO_št_ãtch_ªd_add1
(
addr
) \

1481 
	`AO_št_ãtch_ªd_add
(
addr
,1)

	)

1482 
	#AO_HAVE_št_ãtch_ªd_add1


	)

1485 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_fuÎ
)

1486 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£
)

1487 
	#AO_št_ãtch_ªd_add1_»Ëa£
(
addr
) \

1488 
	`AO_št_ãtch_ªd_add1_fuÎ
(
addr
)

	)

1489 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£


	)

1491 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe
)

1492 
	#AO_št_ãtch_ªd_add1_acquœe
(
addr
) \

1493 
	`AO_št_ãtch_ªd_add1_fuÎ
(
addr
)

	)

1494 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe


	)

1496 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_wr™e
)

1497 
	#AO_št_ãtch_ªd_add1_wr™e
(
addr
) \

1498 
	`AO_št_ãtch_ªd_add1_fuÎ
(
addr
)

	)

1499 
	#AO_HAVE_št_ãtch_ªd_add1_wr™e


	)

1501 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_»ad
)

1502 
	#AO_št_ãtch_ªd_add1_»ad
(
addr
) \

1503 
	`AO_št_ãtch_ªd_add1_fuÎ
(
addr
)

	)

1504 
	#AO_HAVE_št_ãtch_ªd_add1_»ad


	)

1508 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1
) && \

1509 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£
)

1510 
	#AO_št_ãtch_ªd_add1
(
addr
) \

1511 
	`AO_št_ãtch_ªd_add1_»Ëa£
(
addr
)

	)

1512 
	#AO_HAVE_št_ãtch_ªd_add1


	)

1514 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1
) && \

1515 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe
)

1516 
	#AO_št_ãtch_ªd_add1
(
addr
) \

1517 
	`AO_št_ãtch_ªd_add1_acquœe
(
addr
)

	)

1518 
	#AO_HAVE_št_ãtch_ªd_add1


	)

1520 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1
) && \

1521 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_wr™e
)

1522 
	#AO_št_ãtch_ªd_add1
(
addr
) \

1523 
	`AO_št_ãtch_ªd_add1_wr™e
(
addr
)

	)

1524 
	#AO_HAVE_št_ãtch_ªd_add1


	)

1526 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1
) && \

1527 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»ad
)

1528 
	#AO_št_ãtch_ªd_add1
(
addr
) \

1529 
	`AO_št_ãtch_ªd_add1_»ad
(
addr
)

	)

1530 
	#AO_HAVE_št_ãtch_ªd_add1


	)

1533 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe
) &&\

1534 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

1535 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_fuÎ
)

1536 
	#AO_št_ãtch_ªd_add1_fuÎ
(
addr
) \

1537 (
	`AO_nİ_fuÎ
(), 
	`AO_št_ãtch_ªd_add1_acquœe
(
addr
))

	)

1538 
	#AO_HAVE_št_ãtch_ªd_add1_fuÎ


	)

1541 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£_wr™e
) && \

1542 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_wr™e
)

1543 
	#AO_št_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

1544 
	`AO_št_ãtch_ªd_add1_wr™e
(
addr
)

	)

1545 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£_wr™e


	)

1547 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£_wr™e
) && \

1548 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£
)

1549 
	#AO_št_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

1550 
	`AO_št_ãtch_ªd_add1_»Ëa£
(
addr
)

	)

1551 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£_wr™e


	)

1553 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe_»ad
) && \

1554 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»ad
)

1555 
	#AO_št_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

1556 
	`AO_št_ãtch_ªd_add1_»ad
(
addr
)

	)

1557 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe_»ad


	)

1559 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe_»ad
) && \

1560 
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe
)

1561 
	#AO_št_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

1562 
	`AO_št_ãtch_ªd_add1_acquœe
(
addr
)

	)

1563 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe_»ad


	)

1566 #ifdeà
AO_NO_DD_ORDERING


1567 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe_»ad
)

1568 
	#AO_št_ãtch_ªd_add1_dd_acquœe_»ad
(
addr
) \

1569 
	`AO_št_ãtch_ªd_add1_acquœe_»ad
(
addr
)

	)

1570 
	#AO_HAVE_št_ãtch_ªd_add1_dd_acquœe_»ad


	)

1573 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add1
)

1574 
	#AO_št_ãtch_ªd_add1_dd_acquœe_»ad
(
addr
) \

1575 
	`AO_št_ãtch_ªd_add1
(
addr
)

	)

1576 
	#AO_HAVE_št_ãtch_ªd_add1_dd_acquœe_»ad


	)

1582 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_fuÎ
) &&\

1583 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_fuÎ
)

1584 
	#AO_št_ãtch_ªd_sub1_fuÎ
(
addr
) \

1585 
	`AO_št_ãtch_ªd_add_fuÎ
(
addr
,()(-1))

	)

1586 
	#AO_HAVE_št_ãtch_ªd_sub1_fuÎ


	)

1588 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£
) &&\

1589 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£
)

1590 
	#AO_št_ãtch_ªd_sub1_»Ëa£
(
addr
) \

1591 
	`AO_št_ãtch_ªd_add_»Ëa£
(
addr
,()(-1))

	)

1592 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£


	)

1594 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe
) &&\

1595 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe
)

1596 
	#AO_št_ãtch_ªd_sub1_acquœe
(
addr
) \

1597 
	`AO_št_ãtch_ªd_add_acquœe
(
addr
,()(-1))

	)

1598 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe


	)

1600 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_wr™e
) &&\

1601 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_wr™e
)

1602 
	#AO_št_ãtch_ªd_sub1_wr™e
(
addr
) \

1603 
	`AO_št_ãtch_ªd_add_wr™e
(
addr
,()(-1))

	)

1604 
	#AO_HAVE_št_ãtch_ªd_sub1_wr™e


	)

1606 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_»ad
) &&\

1607 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»ad
)

1608 
	#AO_št_ãtch_ªd_sub1_»ad
(
addr
) \

1609 
	`AO_št_ãtch_ªd_add_»ad
(
addr
,()(-1))

	)

1610 
	#AO_HAVE_št_ãtch_ªd_sub1_»ad


	)

1612 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£_wr™e
) &&\

1613 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£_wr™e
)

1614 
	#AO_št_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

1615 
	`AO_št_ãtch_ªd_add_»Ëa£_wr™e
(
addr
,()(-1))

	)

1616 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£_wr™e


	)

1618 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe_»ad
) &&\

1619 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe_»ad
)

1620 
	#AO_št_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

1621 
	`AO_št_ãtch_ªd_add_acquœe_»ad
(
addr
,()(-1))

	)

1622 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe_»ad


	)

1624 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_add
) &&\

1625 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1
)

1626 
	#AO_št_ãtch_ªd_sub1
(
addr
) \

1627 
	`AO_št_ãtch_ªd_add
(
addr
,()(-1))

	)

1628 
	#AO_HAVE_št_ãtch_ªd_sub1


	)

1631 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_fuÎ
)

1632 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£
)

1633 
	#AO_št_ãtch_ªd_sub1_»Ëa£
(
addr
) \

1634 
	`AO_št_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

1635 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£


	)

1637 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe
)

1638 
	#AO_št_ãtch_ªd_sub1_acquœe
(
addr
) \

1639 
	`AO_št_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

1640 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe


	)

1642 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_wr™e
)

1643 
	#AO_št_ãtch_ªd_sub1_wr™e
(
addr
) \

1644 
	`AO_št_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

1645 
	#AO_HAVE_št_ãtch_ªd_sub1_wr™e


	)

1647 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»ad
)

1648 
	#AO_št_ãtch_ªd_sub1_»ad
(
addr
) \

1649 
	`AO_št_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

1650 
	#AO_HAVE_št_ãtch_ªd_sub1_»ad


	)

1654 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1
) && \

1655 
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£
)

1656 
	#AO_št_ãtch_ªd_sub1
(
addr
) \

1657 
	`AO_št_ãtch_ªd_sub1_»Ëa£
(
addr
)

	)

1658 
	#AO_HAVE_št_ãtch_ªd_sub1


	)

1660 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1
) && \

1661 
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe
)

1662 
	#AO_št_ãtch_ªd_sub1
(
addr
) \

1663 
	`AO_št_ãtch_ªd_sub1_acquœe
(
addr
)

	)

1664 
	#AO_HAVE_št_ãtch_ªd_sub1


	)

1666 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1
) && \

1667 
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_wr™e
)

1668 
	#AO_št_ãtch_ªd_sub1
(
addr
) \

1669 
	`AO_št_ãtch_ªd_sub1_wr™e
(
addr
)

	)

1670 
	#AO_HAVE_št_ãtch_ªd_sub1


	)

1672 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1
) && \

1673 
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»ad
)

1674 
	#AO_št_ãtch_ªd_sub1
(
addr
) \

1675 
	`AO_št_ãtch_ªd_sub1_»ad
(
addr
)

	)

1676 
	#AO_HAVE_št_ãtch_ªd_sub1


	)

1679 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe
) &&\

1680 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

1681 !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_fuÎ
)

1682 
	#AO_št_ãtch_ªd_sub1_fuÎ
(
addr
) \

1683 (
	`AO_nİ_fuÎ
(), 
	`AO_št_ãtch_ªd_sub1_acquœe
(
addr
))

	)

1684 
	#AO_HAVE_št_ãtch_ªd_sub1_fuÎ


	)

1687 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£_wr™e
) && \

1688 
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_wr™e
)

1689 
	#AO_št_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

1690 
	`AO_št_ãtch_ªd_sub1_wr™e
(
addr
)

	)

1691 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£_wr™e


	)

1693 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£_wr™e
) && \

1694 
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£
)

1695 
	#AO_št_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

1696 
	`AO_št_ãtch_ªd_sub1_»Ëa£
(
addr
)

	)

1697 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£_wr™e


	)

1699 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe_»ad
) && \

1700 
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»ad
)

1701 
	#AO_št_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

1702 
	`AO_št_ãtch_ªd_sub1_»ad
(
addr
)

	)

1703 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe_»ad


	)

1705 #ià!
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe_»ad
) && \

1706 
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe
)

1707 
	#AO_št_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

1708 
	`AO_št_ãtch_ªd_sub1_acquœe
(
addr
)

	)

1709 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe_»ad


	)

1712 #ifdeà
AO_NO_DD_ORDERING


1713 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe_»ad
)

1714 
	#AO_št_ãtch_ªd_sub1_dd_acquœe_»ad
(
addr
) \

1715 
	`AO_št_ãtch_ªd_sub1_acquœe_»ad
(
addr
)

	)

1716 
	#AO_HAVE_št_ãtch_ªd_sub1_dd_acquœe_»ad


	)

1719 #ià
	`defšed
(
AO_HAVE_št_ãtch_ªd_sub1
)

1720 
	#AO_št_ãtch_ªd_sub1_dd_acquœe_»ad
(
addr
) \

1721 
	`AO_št_ãtch_ªd_sub1
(
addr
)

	)

1722 
	#AO_HAVE_št_ãtch_ªd_sub1_dd_acquœe_»ad


	)

	@atomic_ops/generalize.h

46 #iâdeà
ATOMIC_OPS_H


47 #”rÜ 
Atomic_İs_g’”®ize
.
h
 
should
 
nÙ
 
be
 
šşuded
 
dœeùly
.

50 #ià
AO_CHAR_TS_T


51 
	#AO_TS_COMPARE_AND_SWAP_FULL
(
a
,
o
,
n
) \

52 
	`AO_ch¬_com·»_ªd_sw­_fuÎ
(
a
,
o
,
n
)

	)

53 
	#AO_TS_COMPARE_AND_SWAP_ACQUIRE
(
a
,
o
,
n
) \

54 
	`AO_ch¬_com·»_ªd_sw­_acquœe
(
a
,
o
,
n
)

	)

55 
	#AO_TS_COMPARE_AND_SWAP_RELEASE
(
a
,
o
,
n
) \

56 
	`AO_ch¬_com·»_ªd_sw­_»Ëa£
(
a
,
o
,
n
)

	)

57 
	#AO_TS_COMPARE_AND_SWAP
(
a
,
o
,
n
) \

58 
	`AO_ch¬_com·»_ªd_sw­
(
a
,
o
,
n
)

	)

61 #ià
AO_AO_TS_T


62 
	#AO_TS_COMPARE_AND_SWAP_FULL
(
a
,
o
,
n
) \

63 
	`AO_com·»_ªd_sw­_fuÎ
(
a
,
o
,
n
)

	)

64 
	#AO_TS_COMPARE_AND_SWAP_ACQUIRE
(
a
,
o
,
n
) \

65 
	`AO_com·»_ªd_sw­_acquœe
(
a
,
o
,
n
)

	)

66 
	#AO_TS_COMPARE_AND_SWAP_RELEASE
(
a
,
o
,
n
) \

67 
	`AO_com·»_ªd_sw­_»Ëa£
(
a
,
o
,
n
)

	)

68 
	#AO_TS_COMPARE_AND_SWAP
(
a
,
o
,
n
) \

69 
	`AO_com·»_ªd_sw­
(
a
,
o
,
n
)

	)

73 #ià!
defšed
(
AO_HAVE_‹¡_ªd_£t
) && \

74 !
defšed
(
AO_HAVE_‹¡_ªd_£t_»Ëa£
) && \

75 !
defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe
) && \

76 !
defšed
(
AO_HAVE_‹¡_ªd_£t_»ad
) && \

77 !
	$defšed
(
AO_HAVE_‹¡_ªd_£t_fuÎ
)

78 #ià
AO_AO_TS_T
 && 
	`defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
) || \

79 
AO_CHAR_TS_T
 && 
	$defšed
(
AO_HAVE_ch¬_com·»_ªd_sw­_fuÎ
)

80 
AO_INLINE
 
AO_TS_VAL_t


81 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

83 ià(
	`AO_TS_COMPARE_AND_SWAP_FULL
(
addr
, 
AO_TS_CLEAR
, 
AO_TS_SET
))

84  
AO_TS_CLEAR
;

86  
AO_TS_SET
;

87 
	}
}

88 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

91 #ià
AO_AO_TS_T
 && 
defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
) || \

92 
	gAO_CHAR_TS_T
 && 
	$defšed
(
AO_HAVE_ch¬_com·»_ªd_sw­_acquœe
)

93 
AO_INLINE
 
AO_TS_VAL_t


94 
	$AO_‹¡_ªd_£t_acquœe
(vŞ©
AO_TS_t
 *
addr
)

96 ià(
	`AO_TS_COMPARE_AND_SWAP_ACQUIRE
(
addr
, 
AO_TS_CLEAR
, 
AO_TS_SET
))

97  
AO_TS_CLEAR
;

99  
AO_TS_SET
;

100 
	}
}

101 
	#AO_HAVE_‹¡_ªd_£t_acquœe


	)

104 #ià
AO_AO_TS_T
 && 
defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£
) || \

105 
	gAO_CHAR_TS_T
 && 
	$defšed
(
AO_HAVE_ch¬_com·»_ªd_sw­_»Ëa£
)

106 
AO_INLINE
 
AO_TS_VAL_t


107 
	$AO_‹¡_ªd_£t_»Ëa£
(vŞ©
AO_TS_t
 *
addr
)

109 ià(
	`AO_TS_COMPARE_AND_SWAP_RELEASE
(
addr
, 
AO_TS_CLEAR
, 
AO_TS_SET
))

110  
AO_TS_CLEAR
;

112  
AO_TS_SET
;

113 
	}
}

114 
	#AO_HAVE_‹¡_ªd_£t_»Ëa£


	)

117 #ià
AO_AO_TS_T
 && 
defšed
(
AO_HAVE_com·»_ªd_sw­
) || \

118 
	gAO_CHAR_TS_T
 && 
	$defšed
(
AO_HAVE_ch¬_com·»_ªd_sw­
)

119 
AO_INLINE
 
AO_TS_VAL_t


120 
	$AO_‹¡_ªd_£t
(vŞ©
AO_TS_t
 *
addr
)

122 ià(
	`AO_TS_COMPARE_AND_SWAP
(
addr
, 
AO_TS_CLEAR
, 
AO_TS_SET
))

123  
AO_TS_CLEAR
;

125  
AO_TS_SET
;

126 
	}
}

127 
	#AO_HAVE_‹¡_ªd_£t


	)

130 #ià
defšed
(
AO_HAVE_‹¡_ªd_£t
è&& defšed(
AO_HAVE_nİ_fuÎ
) \

131 && !
	$defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe
)

132 
AO_INLINE
 
AO_TS_VAL_t


133 
	$AO_‹¡_ªd_£t_acquœe
(vŞ©
AO_TS_t
 *
addr
)

135 
AO_TS_VAL_t
 
»suÉ
 = 
	`AO_‹¡_ªd_£t
(
addr
);

136 
	`AO_nİ_fuÎ
();

137  
»suÉ
;

138 
	}
}

139 
	#AO_HAVE_‹¡_ªd_£t_acquœe


	)

145 #ià!
defšed
(
AO_HAVE_nİ
)

146 
AO_INLINE
 
	$AO_nİ
(è{
	}
}

147 
	#AO_HAVE_nİ


	)

150 #ià
defšed
(
AO_HAVE_‹¡_ªd_£t_fuÎ
è&& !defšed(
AO_HAVE_nİ_fuÎ
)

151 
AO_INLINE
 

152 
	$AO_nİ_fuÎ
()

154 
AO_TS_t
 
dummy
 = 
AO_TS_INITIALIZER
;

155 
	`AO_‹¡_ªd_£t_fuÎ
(&
dummy
);

156 
	}
}

157 
	#AO_HAVE_nİ_fuÎ


	)

160 #ià
defšed
(
AO_HAVE_nİ_acquœe
)

161 #”rÜ 
AO_nİ_acquœe
 
is
 
u£Ëss
: 
dÚt
 
defše
.

163 #ià
defšed
(
AO_HAVE_nİ_»Ëa£
)

164 #”rÜ 
AO_nİ_»Ëa£
 
is
 
u£Ëss
: 
dÚt
 
defše
.

167 #ià
defšed
(
AO_HAVE_nİ_fuÎ
è&& !defšed(
AO_HAVE_nİ_»ad
)

168 
	#AO_nİ_»ad
(è
	`AO_nİ_fuÎ
()

	)

169 
	#AO_HAVE_nİ_»ad


	)

172 #ià
defšed
(
AO_HAVE_nİ_fuÎ
è&& !defšed(
AO_HAVE_nİ_wr™e
)

173 
	#AO_nİ_wr™e
(è
	`AO_nİ_fuÎ
()

	)

174 
	#AO_HAVE_nİ_wr™e


	)

178 #ià
defšed
(
AO_HAVE_lßd_fuÎ
è&& !defšed(
AO_HAVE_lßd_acquœe
)

179 
	#AO_lßd_acquœe
(
addr
è
	`AO_lßd_fuÎ
×ddr)

	)

180 
	#AO_HAVE_lßd_acquœe


	)

183 #ià
defšed
(
AO_HAVE_lßd_acquœe
è&& !defšed(
AO_HAVE_lßd
)

184 
	#AO_lßd
(
addr
è
	`AO_lßd_acquœe
×ddr)

	)

185 
	#AO_HAVE_lßd


	)

188 #ià
defšed
(
AO_HAVE_lßd_fuÎ
è&& !defšed(
AO_HAVE_lßd_»ad
)

189 
	#AO_lßd_»ad
(
addr
è
	`AO_lßd_fuÎ
×ddr)

	)

190 
	#AO_HAVE_lßd_»ad


	)

193 #ià!
defšed
(
AO_HAVE_lßd_acquœe_»ad
è&& defšed(
AO_HAVE_lßd_acquœe
)

194 
	#AO_lßd_acquœe_»ad
(
addr
è
	`AO_lßd_acquœe
×ddr)

	)

195 
	#AO_HAVE_lßd_acquœe_»ad


	)

198 #ià
defšed
(
AO_HAVE_lßd
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

199 !
	$defšed
(
AO_HAVE_lßd_acquœe
)

200 
AO_INLINE
 
AO_t


201 
	$AO_lßd_acquœe
(cÚ¡ vŞ©
AO_t
 *
addr
)

203 
AO_t
 
»suÉ
 = 
	`AO_lßd
(
addr
);

206 
	`AO_nİ_fuÎ
();

207  
»suÉ
;

208 
	}
}

209 
	#AO_HAVE_lßd_acquœe


	)

212 #ià
defšed
(
AO_HAVE_lßd
è&& defšed(
AO_HAVE_nİ_»ad
) && \

213 !
	$defšed
(
AO_HAVE_lßd_»ad
)

214 
AO_INLINE
 
AO_t


215 
	$AO_lßd_»ad
(cÚ¡ vŞ©
AO_t
 *
addr
)

217 
AO_t
 
»suÉ
 = 
	`AO_lßd
(
addr
);

220 
	`AO_nİ_»ad
();

221  
»suÉ
;

222 
	}
}

223 
	#AO_HAVE_lßd_»ad


	)

226 #ià
defšed
(
AO_HAVE_lßd_acquœe
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

227 !
	$defšed
(
AO_HAVE_lßd_fuÎ
)

228 
	#AO_lßd_fuÎ
(
addr
è(
	`AO_nİ_fuÎ
(), 
	`AO_lßd_acquœe
×ddr))

	)

229 
	#AO_HAVE_lßd_fuÎ


	)

232 #ià!
	`defšed
(
AO_HAVE_lßd_acquœe_»ad
è&& defšed(
AO_HAVE_lßd_»ad
)

233 
	#AO_lßd_acquœe_»ad
(
addr
è
	`AO_lßd_»ad
×ddr)

	)

234 
	#AO_HAVE_lßd_acquœe_»ad


	)

237 #ià
	`defšed
(
AO_HAVE_lßd_acquœe_»ad
è&& !defšed(
AO_HAVE_lßd
)

238 
	#AO_lßd
(
addr
è
	`AO_lßd_acquœe_»ad
×ddr)

	)

239 
	#AO_HAVE_lßd


	)

242 #ifdeà
AO_NO_DD_ORDERING


243 #ià
	`defšed
(
AO_HAVE_lßd_acquœe_»ad
)

244 
	#AO_lßd_dd_acquœe_»ad
(
addr
è
	`AO_lßd_acquœe_»ad
×ddr)

	)

245 
	#AO_HAVE_lßd_dd_acquœe_»ad


	)

248 #ià
	`defšed
(
AO_HAVE_lßd
)

249 
	#AO_lßd_dd_acquœe_»ad
(
addr
è
	`AO_lßd
×ddr)

	)

250 
	#AO_HAVE_lßd_dd_acquœe_»ad


	)

257 #ià
	`defšed
(
AO_HAVE_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_¡Üe_»Ëa£
)

258 
	#AO_¡Üe_»Ëa£
(
addr
,
v®
è
	`AO_¡Üe_fuÎ
×ddr,v®)

	)

259 
	#AO_HAVE_¡Üe_»Ëa£


	)

262 #ià
	`defšed
(
AO_HAVE_¡Üe_»Ëa£
è&& !defšed(
AO_HAVE_¡Üe
)

263 
	#AO_¡Üe
(
addr
, 
v®
è
	`AO_¡Üe_»Ëa£
×ddr,v®)

	)

264 
	#AO_HAVE_¡Üe


	)

267 #ià
	`defšed
(
AO_HAVE_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_¡Üe_wr™e
)

268 
	#AO_¡Üe_wr™e
(
addr
,
v®
è
	`AO_¡Üe_fuÎ
×ddr,v®)

	)

269 
	#AO_HAVE_¡Üe_wr™e


	)

272 #ià
	`defšed
(
AO_HAVE_¡Üe_»Ëa£
è&& !defšed(
AO_HAVE_¡Üe_»Ëa£_wr™e
)

273 
	#AO_¡Üe_»Ëa£_wr™e
(
addr
, 
v®
è
	`AO_¡Üe_»Ëa£
×ddr,v®)

	)

274 
	#AO_HAVE_¡Üe_»Ëa£_wr™e


	)

277 #ià
	`defšed
(
AO_HAVE_¡Üe_wr™e
è&& !defšed(
AO_HAVE_¡Üe
)

278 
	#AO_¡Üe
(
addr
, 
v®
è
	`AO_¡Üe_wr™e
×ddr,v®)

	)

279 
	#AO_HAVE_¡Üe


	)

282 #ià
	`defšed
(
AO_HAVE_¡Üe
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

283 !
	$defšed
(
AO_HAVE_¡Üe_»Ëa£
)

284 
	#AO_¡Üe_»Ëa£
(
addr
,
v®
è(
	`AO_nİ_fuÎ
(), 
	`AO_¡Üe
×ddr,v®))

	)

285 
	#AO_HAVE_¡Üe_»Ëa£


	)

288 #ià
	`defšed
(
AO_HAVE_nİ_wr™e
è&& defšed(
AO_HAVE_¡Üe
) && \

289 !
	$defšed
(
AO_HAVE_¡Üe_wr™e
)

290 
	#AO_¡Üe_wr™e
(
addr
, 
v®
è(
	`AO_nİ_wr™e
(), 
	`AO_¡Üe
×ddr,v®))

	)

291 
	#AO_HAVE_¡Üe_wr™e


	)

294 #ià
	`defšed
(
AO_HAVE_¡Üe_wr™e
è&& !defšed(
AO_HAVE_¡Üe_»Ëa£_wr™e
)

295 
	#AO_¡Üe_»Ëa£_wr™e
(
addr
, 
v®
è
	`AO_¡Üe_wr™e
×ddr,v®)

	)

296 
	#AO_HAVE_¡Üe_»Ëa£_wr™e


	)

299 #ià
	`defšed
(
AO_HAVE_¡Üe_»Ëa£
è&& defšed(
AO_HAVE_nİ_fuÎ
) && \

300 !
	$defšed
(
AO_HAVE_¡Üe_fuÎ
)

301 
	#AO_¡Üe_fuÎ
(
addr
, 
v®
è(
	`AO_¡Üe_»Ëa£
×ddr, v®), 
	`AO_nİ_fuÎ
())

	)

302 
	#AO_HAVE_¡Üe_fuÎ


	)

306 #ià
	`defšed
(
AO_HAVE_‹¡_ªd_£t
) && \

307 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

308 !
	$defšed
(
AO_HAVE_‹¡_ªd_£t_»Ëa£
)

309 
	#AO_‹¡_ªd_£t_»Ëa£
(
addr
) \

310 (
	`AO_nİ_fuÎ
(), 
	`AO_‹¡_ªd_£t
(
addr
))

	)

311 
	#AO_HAVE_‹¡_ªd_£t_»Ëa£


	)

314 #ià
	`defšed
(
AO_HAVE_‹¡_ªd_£t
) && \

315 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

316 !
	$defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe
)

317 
AO_INLINE
 
AO_TS_t


318 
	$AO_‹¡_ªd_£t_acquœe
(vŞ©
AO_TS_t
 *
addr
)

320 
AO_TS_t
 
»s
 = 
	`AO_‹¡_ªd_£t
(
addr
);

321 
	`AO_nİ_fuÎ
();

322  
»s
;

323 
	}
}

324 
	#AO_HAVE_‹¡_ªd_£t_acquœe


	)

332 #ià
defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
) && \

333 !
	$defšed
(
AO_HAVE_ãtch_ªd_add_fuÎ
)

334 
AO_INLINE
 
AO_t


335 
	$AO_ãtch_ªd_add_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
)

337 
AO_t
 
Şd
;

340 
Şd
 = *
addr
;

342 !
	`AO_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, old+
šü
));

343  
Şd
;

344 
	}
}

345 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

348 #ià
defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
) && \

349 !
	$defšed
(
AO_HAVE_ãtch_ªd_add_acquœe
)

350 
AO_INLINE
 
AO_t


351 
	$AO_ãtch_ªd_add_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
)

353 
AO_t
 
Şd
;

356 
Şd
 = *
addr
;

358 !
	`AO_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, old+
šü
));

359  
Şd
;

360 
	}
}

361 
	#AO_HAVE_ãtch_ªd_add_acquœe


	)

364 #ià
defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£
) && \

365 !
	$defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£
)

366 
AO_INLINE
 
AO_t


367 
	$AO_ãtch_ªd_add_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
)

369 
AO_t
 
Şd
;

372 
Şd
 = *
addr
;

374 !
	`AO_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, old+
šü
));

375  
Şd
;

376 
	}
}

377 
	#AO_HAVE_ãtch_ªd_add_»Ëa£


	)

380 #ià
defšed
(
AO_HAVE_com·»_ªd_sw­
) && \

381 !
	$defšed
(
AO_HAVE_ãtch_ªd_add
)

382 
AO_INLINE
 
AO_t


383 
	$AO_ãtch_ªd_add
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
)

385 
AO_t
 
Şd
;

388 
Şd
 = *
addr
;

390 !
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, old+
šü
));

391  
Şd
;

392 
	}
}

393 
	#AO_HAVE_ãtch_ªd_add


	)

396 #ià
defšed
(
AO_HAVE_ãtch_ªd_add_fuÎ
)

397 #ià!
defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£
)

398 
	#AO_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
) \

399 
	`AO_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

400 
	#AO_HAVE_ãtch_ªd_add_»Ëa£


	)

402 #ià!
defšed
(
AO_HAVE_ãtch_ªd_add_acquœe
)

403 
	#AO_ãtch_ªd_add_acquœe
(
addr
, 
v®
) \

404 
	`AO_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

405 
	#AO_HAVE_ãtch_ªd_add_acquœe


	)

407 #ià!
defšed
(
AO_HAVE_ãtch_ªd_add_wr™e
)

408 
	#AO_ãtch_ªd_add_wr™e
(
addr
, 
v®
) \

409 
	`AO_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

410 
	#AO_HAVE_ãtch_ªd_add_wr™e


	)

412 #ià!
defšed
(
AO_HAVE_ãtch_ªd_add_»ad
)

413 
	#AO_ãtch_ªd_add_»ad
(
addr
, 
v®
) \

414 
	`AO_ãtch_ªd_add_fuÎ
(
addr
, 
v®
)

	)

415 
	#AO_HAVE_ãtch_ªd_add_»ad


	)

419 #ià!
defšed
(
AO_HAVE_ãtch_ªd_add
) && \

420 
	$defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£
)

421 
	#AO_ãtch_ªd_add
(
addr
, 
v®
) \

422 
	`AO_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
)

	)

423 
	#AO_HAVE_ãtch_ªd_add


	)

425 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add
) && \

426 
	$defšed
(
AO_HAVE_ãtch_ªd_add_acquœe
)

427 
	#AO_ãtch_ªd_add
(
addr
, 
v®
) \

428 
	`AO_ãtch_ªd_add_acquœe
(
addr
, 
v®
)

	)

429 
	#AO_HAVE_ãtch_ªd_add


	)

431 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add
) && \

432 
	$defšed
(
AO_HAVE_ãtch_ªd_add_wr™e
)

433 
	#AO_ãtch_ªd_add
(
addr
, 
v®
) \

434 
	`AO_ãtch_ªd_add_wr™e
(
addr
, 
v®
)

	)

435 
	#AO_HAVE_ãtch_ªd_add


	)

437 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add
) && \

438 
	$defšed
(
AO_HAVE_ãtch_ªd_add_»ad
)

439 
	#AO_ãtch_ªd_add
(
addr
, 
v®
) \

440 
	`AO_ãtch_ªd_add_»ad
(
addr
, 
v®
)

	)

441 
	#AO_HAVE_ãtch_ªd_add


	)

444 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe
) &&\

445 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

446 !
	$defšed
(
AO_HAVE_ãtch_ªd_add_fuÎ
)

447 
	#AO_ãtch_ªd_add_fuÎ
(
addr
, 
v®
) \

448 (
	`AO_nİ_fuÎ
(), 
	`AO_ãtch_ªd_add_acquœe
(
addr
, 
v®
))

	)

449 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

452 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£_wr™e
) && \

453 
	$defšed
(
AO_HAVE_ãtch_ªd_add_wr™e
)

454 
	#AO_ãtch_ªd_add_»Ëa£_wr™e
(
addr
, 
v®
) \

455 
	`AO_ãtch_ªd_add_wr™e
(
addr
, 
v®
)

	)

456 
	#AO_HAVE_ãtch_ªd_add_»Ëa£_wr™e


	)

458 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£_wr™e
) && \

459 
	$defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£
)

460 
	#AO_ãtch_ªd_add_»Ëa£_wr™e
(
addr
, 
v®
) \

461 
	`AO_ãtch_ªd_add_»Ëa£
(
addr
, 
v®
)

	)

462 
	#AO_HAVE_ãtch_ªd_add_»Ëa£_wr™e


	)

464 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe_»ad
) && \

465 
	$defšed
(
AO_HAVE_ãtch_ªd_add_»ad
)

466 
	#AO_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
) \

467 
	`AO_ãtch_ªd_add_»ad
(
addr
, 
v®
)

	)

468 
	#AO_HAVE_ãtch_ªd_add_acquœe_»ad


	)

470 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe_»ad
) && \

471 
	$defšed
(
AO_HAVE_ãtch_ªd_add_acquœe
)

472 
	#AO_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
) \

473 
	`AO_ãtch_ªd_add_acquœe
(
addr
, 
v®
)

	)

474 
	#AO_HAVE_ãtch_ªd_add_acquœe_»ad


	)

477 #ifdeà
AO_NO_DD_ORDERING


478 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe_»ad
)

479 
	#AO_ãtch_ªd_add_dd_acquœe_»ad
(
addr
, 
v®
) \

480 
	`AO_ãtch_ªd_add_acquœe_»ad
(
addr
, 
v®
)

	)

481 
	#AO_HAVE_ãtch_ªd_add_dd_acquœe_»ad


	)

484 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add
)

485 
	#AO_ãtch_ªd_add_dd_acquœe_»ad
(
addr
, 
v®
) \

486 
	`AO_ãtch_ªd_add
(
addr
, 
v®
)

	)

487 
	#AO_HAVE_ãtch_ªd_add_dd_acquœe_»ad


	)

493 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_fuÎ
) &&\

494 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1_fuÎ
)

495 
	#AO_ãtch_ªd_add1_fuÎ
(
addr
è
	`AO_ãtch_ªd_add_fuÎ
×ddr,1)

	)

496 
	#AO_HAVE_ãtch_ªd_add1_fuÎ


	)

498 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£
) &&\

499 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£
)

500 
	#AO_ãtch_ªd_add1_»Ëa£
(
addr
è
	`AO_ãtch_ªd_add_»Ëa£
×ddr,1)

	)

501 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£


	)

503 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe
) &&\

504 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe
)

505 
	#AO_ãtch_ªd_add1_acquœe
(
addr
è
	`AO_ãtch_ªd_add_acquœe
×ddr,1)

	)

506 
	#AO_HAVE_ãtch_ªd_add1_acquœe


	)

508 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_wr™e
) &&\

509 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1_wr™e
)

510 
	#AO_ãtch_ªd_add1_wr™e
(
addr
è
	`AO_ãtch_ªd_add_wr™e
×ddr,1)

	)

511 
	#AO_HAVE_ãtch_ªd_add1_wr™e


	)

513 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_»ad
) &&\

514 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1_»ad
)

515 
	#AO_ãtch_ªd_add1_»ad
(
addr
è
	`AO_ãtch_ªd_add_»ad
×ddr,1)

	)

516 
	#AO_HAVE_ãtch_ªd_add1_»ad


	)

518 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£_wr™e
) &&\

519 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£_wr™e
)

520 
	#AO_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

521 
	`AO_ãtch_ªd_add_»Ëa£_wr™e
(
addr
,1)

	)

522 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£_wr™e


	)

524 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe_»ad
) &&\

525 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe_»ad
)

526 
	#AO_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

527 
	`AO_ãtch_ªd_add_acquœe_»ad
(
addr
,1)

	)

528 
	#AO_HAVE_ãtch_ªd_add1_acquœe_»ad


	)

530 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add
) &&\

531 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1
)

532 
	#AO_ãtch_ªd_add1
(
addr
) \

533 
	`AO_ãtch_ªd_add
(
addr
,1)

	)

534 
	#AO_HAVE_ãtch_ªd_add1


	)

537 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_fuÎ
)

538 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£
)

539 
	#AO_ãtch_ªd_add1_»Ëa£
(
addr
) \

540 
	`AO_ãtch_ªd_add1_fuÎ
(
addr
)

	)

541 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£


	)

543 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe
)

544 
	#AO_ãtch_ªd_add1_acquœe
(
addr
) \

545 
	`AO_ãtch_ªd_add1_fuÎ
(
addr
)

	)

546 
	#AO_HAVE_ãtch_ªd_add1_acquœe


	)

548 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1_wr™e
)

549 
	#AO_ãtch_ªd_add1_wr™e
(
addr
) \

550 
	`AO_ãtch_ªd_add1_fuÎ
(
addr
)

	)

551 
	#AO_HAVE_ãtch_ªd_add1_wr™e


	)

553 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1_»ad
)

554 
	#AO_ãtch_ªd_add1_»ad
(
addr
) \

555 
	`AO_ãtch_ªd_add1_fuÎ
(
addr
)

	)

556 
	#AO_HAVE_ãtch_ªd_add1_»ad


	)

560 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1
) && \

561 
	$defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£
)

562 
	#AO_ãtch_ªd_add1
(
addr
) \

563 
	`AO_ãtch_ªd_add1_»Ëa£
(
addr
)

	)

564 
	#AO_HAVE_ãtch_ªd_add1


	)

566 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1
) && \

567 
	$defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe
)

568 
	#AO_ãtch_ªd_add1
(
addr
) \

569 
	`AO_ãtch_ªd_add1_acquœe
(
addr
)

	)

570 
	#AO_HAVE_ãtch_ªd_add1


	)

572 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1
) && \

573 
	$defšed
(
AO_HAVE_ãtch_ªd_add1_wr™e
)

574 
	#AO_ãtch_ªd_add1
(
addr
) \

575 
	`AO_ãtch_ªd_add1_wr™e
(
addr
)

	)

576 
	#AO_HAVE_ãtch_ªd_add1


	)

578 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1
) && \

579 
	$defšed
(
AO_HAVE_ãtch_ªd_add1_»ad
)

580 
	#AO_ãtch_ªd_add1
(
addr
) \

581 
	`AO_ãtch_ªd_add1_»ad
(
addr
)

	)

582 
	#AO_HAVE_ãtch_ªd_add1


	)

585 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe
) &&\

586 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

587 !
	$defšed
(
AO_HAVE_ãtch_ªd_add1_fuÎ
)

588 
	#AO_ãtch_ªd_add1_fuÎ
(
addr
) \

589 (
	`AO_nİ_fuÎ
(), 
	`AO_ãtch_ªd_add1_acquœe
(
addr
))

	)

590 
	#AO_HAVE_ãtch_ªd_add1_fuÎ


	)

593 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£_wr™e
) && \

594 
	$defšed
(
AO_HAVE_ãtch_ªd_add1_wr™e
)

595 
	#AO_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

596 
	`AO_ãtch_ªd_add1_wr™e
(
addr
)

	)

597 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£_wr™e


	)

599 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£_wr™e
) && \

600 
	$defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£
)

601 
	#AO_ãtch_ªd_add1_»Ëa£_wr™e
(
addr
) \

602 
	`AO_ãtch_ªd_add1_»Ëa£
(
addr
)

	)

603 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£_wr™e


	)

605 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe_»ad
) && \

606 
	$defšed
(
AO_HAVE_ãtch_ªd_add1_»ad
)

607 
	#AO_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

608 
	`AO_ãtch_ªd_add1_»ad
(
addr
)

	)

609 
	#AO_HAVE_ãtch_ªd_add1_acquœe_»ad


	)

611 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe_»ad
) && \

612 
	$defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe
)

613 
	#AO_ãtch_ªd_add1_acquœe_»ad
(
addr
) \

614 
	`AO_ãtch_ªd_add1_acquœe
(
addr
)

	)

615 
	#AO_HAVE_ãtch_ªd_add1_acquœe_»ad


	)

618 #ifdeà
AO_NO_DD_ORDERING


619 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe_»ad
)

620 
	#AO_ãtch_ªd_add1_dd_acquœe_»ad
(
addr
) \

621 
	`AO_ãtch_ªd_add1_acquœe_»ad
(
addr
)

	)

622 
	#AO_HAVE_ãtch_ªd_add1_dd_acquœe_»ad


	)

625 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1
)

626 
	#AO_ãtch_ªd_add1_dd_acquœe_»ad
(
addr
è
	`AO_ãtch_ªd_add1
×ddr)

	)

627 
	#AO_HAVE_ãtch_ªd_add1_dd_acquœe_»ad


	)

633 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_fuÎ
) &&\

634 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_fuÎ
)

635 
	#AO_ãtch_ªd_sub1_fuÎ
(
addr
è
	`AO_ãtch_ªd_add_fuÎ
×ddr,(
AO_t
)(-1))

	)

636 
	#AO_HAVE_ãtch_ªd_sub1_fuÎ


	)

638 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£
) &&\

639 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£
)

640 
	#AO_ãtch_ªd_sub1_»Ëa£
(
addr
) \

641 
	`AO_ãtch_ªd_add_»Ëa£
(
addr
,(
AO_t
)(-1))

	)

642 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£


	)

644 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe
) &&\

645 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe
)

646 
	#AO_ãtch_ªd_sub1_acquœe
(
addr
) \

647 
	`AO_ãtch_ªd_add_acquœe
(
addr
,(
AO_t
)(-1))

	)

648 
	#AO_HAVE_ãtch_ªd_sub1_acquœe


	)

650 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_wr™e
) &&\

651 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_wr™e
)

652 
	#AO_ãtch_ªd_sub1_wr™e
(
addr
) \

653 
	`AO_ãtch_ªd_add_wr™e
(
addr
,(
AO_t
)(-1))

	)

654 
	#AO_HAVE_ãtch_ªd_sub1_wr™e


	)

656 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_»ad
) &&\

657 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_»ad
)

658 
	#AO_ãtch_ªd_sub1_»ad
(
addr
) \

659 
	`AO_ãtch_ªd_add_»ad
(
addr
,(
AO_t
)(-1))

	)

660 
	#AO_HAVE_ãtch_ªd_sub1_»ad


	)

662 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£_wr™e
) &&\

663 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£_wr™e
)

664 
	#AO_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

665 
	`AO_ãtch_ªd_add_»Ëa£_wr™e
(
addr
,(
AO_t
)(-1))

	)

666 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£_wr™e


	)

668 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe_»ad
) &&\

669 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe_»ad
)

670 
	#AO_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

671 
	`AO_ãtch_ªd_add_acquœe_»ad
(
addr
,(
AO_t
)(-1))

	)

672 
	#AO_HAVE_ãtch_ªd_sub1_acquœe_»ad


	)

674 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add
) &&\

675 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1
)

676 
	#AO_ãtch_ªd_sub1
(
addr
) \

677 
	`AO_ãtch_ªd_add
(
addr
,(
AO_t
)(-1))

	)

678 
	#AO_HAVE_ãtch_ªd_sub1


	)

681 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_fuÎ
)

682 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£
)

683 
	#AO_ãtch_ªd_sub1_»Ëa£
(
addr
) \

684 
	`AO_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

685 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£


	)

687 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe
)

688 
	#AO_ãtch_ªd_sub1_acquœe
(
addr
) \

689 
	`AO_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

690 
	#AO_HAVE_ãtch_ªd_sub1_acquœe


	)

692 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_wr™e
)

693 
	#AO_ãtch_ªd_sub1_wr™e
(
addr
) \

694 
	`AO_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

695 
	#AO_HAVE_ãtch_ªd_sub1_wr™e


	)

697 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_»ad
)

698 
	#AO_ãtch_ªd_sub1_»ad
(
addr
) \

699 
	`AO_ãtch_ªd_sub1_fuÎ
(
addr
)

	)

700 
	#AO_HAVE_ãtch_ªd_sub1_»ad


	)

704 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1
) && \

705 
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£
)

706 
	#AO_ãtch_ªd_sub1
(
addr
) \

707 
	`AO_ãtch_ªd_sub1_»Ëa£
(
addr
)

	)

708 
	#AO_HAVE_ãtch_ªd_sub1


	)

710 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1
) && \

711 
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe
)

712 
	#AO_ãtch_ªd_sub1
(
addr
) \

713 
	`AO_ãtch_ªd_sub1_acquœe
(
addr
)

	)

714 
	#AO_HAVE_ãtch_ªd_sub1


	)

716 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1
) && \

717 
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_wr™e
)

718 
	#AO_ãtch_ªd_sub1
(
addr
) \

719 
	`AO_ãtch_ªd_sub1_wr™e
(
addr
)

	)

720 
	#AO_HAVE_ãtch_ªd_sub1


	)

722 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1
) && \

723 
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_»ad
)

724 
	#AO_ãtch_ªd_sub1
(
addr
) \

725 
	`AO_ãtch_ªd_sub1_»ad
(
addr
)

	)

726 
	#AO_HAVE_ãtch_ªd_sub1


	)

729 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe
) &&\

730 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

731 !
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_fuÎ
)

732 
	#AO_ãtch_ªd_sub1_fuÎ
(
addr
) \

733 (
	`AO_nİ_fuÎ
(), 
	`AO_ãtch_ªd_sub1_acquœe
(
addr
))

	)

734 
	#AO_HAVE_ãtch_ªd_sub1_fuÎ


	)

737 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£_wr™e
) && \

738 
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_wr™e
)

739 
	#AO_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

740 
	`AO_ãtch_ªd_sub1_wr™e
(
addr
)

	)

741 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£_wr™e


	)

743 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£_wr™e
) && \

744 
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£
)

745 
	#AO_ãtch_ªd_sub1_»Ëa£_wr™e
(
addr
) \

746 
	`AO_ãtch_ªd_sub1_»Ëa£
(
addr
)

	)

747 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£_wr™e


	)

749 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe_»ad
) && \

750 
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_»ad
)

751 
	#AO_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

752 
	`AO_ãtch_ªd_sub1_»ad
(
addr
)

	)

753 
	#AO_HAVE_ãtch_ªd_sub1_acquœe_»ad


	)

755 #ià!
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe_»ad
) && \

756 
	$defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe
)

757 
	#AO_ãtch_ªd_sub1_acquœe_»ad
(
addr
) \

758 
	`AO_ãtch_ªd_sub1_acquœe
(
addr
)

	)

759 
	#AO_HAVE_ãtch_ªd_sub1_acquœe_»ad


	)

762 #ifdeà
AO_NO_DD_ORDERING


763 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe_»ad
)

764 
	#AO_ãtch_ªd_sub1_dd_acquœe_»ad
(
addr
) \

765 
	`AO_ãtch_ªd_sub1_acquœe_»ad
(
addr
)

	)

766 
	#AO_HAVE_ãtch_ªd_sub1_dd_acquœe_»ad


	)

769 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1
)

770 
	#AO_ãtch_ªd_sub1_dd_acquœe_»ad
(
addr
è
	`AO_ãtch_ªd_sub1
×ddr)

	)

771 
	#AO_HAVE_ãtch_ªd_sub1_dd_acquœe_»ad


	)

776 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
) && \

777 !
	$defšed
(
AO_HAVE_Ü_fuÎ
)

778 
AO_INLINE
 

779 
	$AO_Ü_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
)

781 
AO_t
 
Şd
;

784 
Şd
 = *
addr
;

786 !
	`AO_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, (Şd | 
šü
)));

787 
	}
}

788 
	#AO_HAVE_Ü_fuÎ


	)

791 #ià
defšed
(
AO_HAVE_Ü_fuÎ
)

792 #ià!
defšed
(
AO_HAVE_Ü_»Ëa£
)

793 
	#AO_Ü_»Ëa£
(
addr
, 
v®
) \

794 
	`AO_Ü_fuÎ
(
addr
, 
v®
)

	)

795 
	#AO_HAVE_Ü_»Ëa£


	)

797 #ià!
defšed
(
AO_HAVE_Ü_acquœe
)

798 
	#AO_Ü_acquœe
(
addr
, 
v®
) \

799 
	`AO_Ü_fuÎ
(
addr
, 
v®
)

	)

800 
	#AO_HAVE_Ü_acquœe


	)

802 #ià!
defšed
(
AO_HAVE_Ü_wr™e
)

803 
	#AO_Ü_wr™e
(
addr
, 
v®
) \

804 
	`AO_Ü_fuÎ
(
addr
, 
v®
)

	)

805 
	#AO_HAVE_Ü_wr™e


	)

807 #ià!
defšed
(
AO_HAVE_Ü_»ad
)

808 
	#AO_Ü_»ad
(
addr
, 
v®
) \

809 
	`AO_Ü_fuÎ
(
addr
, 
v®
)

	)

810 
	#AO_HAVE_Ü_»ad


	)

814 #ià!
defšed
(
AO_HAVE_Ü
) && \

815 
	$defšed
(
AO_HAVE_Ü_»Ëa£
)

816 
	#AO_Ü
(
addr
, 
v®
) \

817 
	`AO_Ü_»Ëa£
(
addr
, 
v®
)

	)

818 
	#AO_HAVE_Ü


	)

820 #ià!
	`defšed
(
AO_HAVE_Ü
) && \

821 
	$defšed
(
AO_HAVE_Ü_acquœe
)

822 
	#AO_Ü
(
addr
, 
v®
) \

823 
	`AO_Ü_acquœe
(
addr
, 
v®
)

	)

824 
	#AO_HAVE_Ü


	)

826 #ià!
	`defšed
(
AO_HAVE_Ü
) && \

827 
	$defšed
(
AO_HAVE_Ü_wr™e
)

828 
	#AO_Ü
(
addr
, 
v®
) \

829 
	`AO_Ü_wr™e
(
addr
, 
v®
)

	)

830 
	#AO_HAVE_Ü


	)

832 #ià!
	`defšed
(
AO_HAVE_Ü
) && \

833 
	$defšed
(
AO_HAVE_Ü_»ad
)

834 
	#AO_Ü
(
addr
, 
v®
) \

835 
	`AO_Ü_»ad
(
addr
, 
v®
)

	)

836 
	#AO_HAVE_Ü


	)

839 #ià
	`defšed
(
AO_HAVE_Ü_acquœe
) &&\

840 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

841 !
	$defšed
(
AO_HAVE_Ü_fuÎ
)

842 
	#AO_Ü_fuÎ
(
addr
, 
v®
) \

843 (
	`AO_nİ_fuÎ
(), 
	`AO_Ü_acquœe
(
addr
, 
v®
))

	)

846 #ià!
	`defšed
(
AO_HAVE_Ü_»Ëa£_wr™e
) && \

847 
	$defšed
(
AO_HAVE_Ü_wr™e
)

848 
	#AO_Ü_»Ëa£_wr™e
(
addr
, 
v®
) \

849 
	`AO_Ü_wr™e
(
addr
, 
v®
)

	)

850 
	#AO_HAVE_Ü_»Ëa£_wr™e


	)

852 #ià!
	`defšed
(
AO_HAVE_Ü_»Ëa£_wr™e
) && \

853 
	$defšed
(
AO_HAVE_Ü_»Ëa£
)

854 
	#AO_Ü_»Ëa£_wr™e
(
addr
, 
v®
) \

855 
	`AO_Ü_»Ëa£
(
addr
, 
v®
)

	)

856 
	#AO_HAVE_Ü_»Ëa£_wr™e


	)

858 #ià!
	`defšed
(
AO_HAVE_Ü_acquœe_»ad
) && \

859 
	$defšed
(
AO_HAVE_Ü_»ad
)

860 
	#AO_Ü_acquœe_»ad
(
addr
, 
v®
) \

861 
	`AO_Ü_»ad
(
addr
, 
v®
)

	)

862 
	#AO_HAVE_Ü_acquœe_»ad


	)

864 #ià!
	`defšed
(
AO_HAVE_Ü_acquœe_»ad
) && \

865 
	$defšed
(
AO_HAVE_Ü_acquœe
)

866 
	#AO_Ü_acquœe_»ad
(
addr
, 
v®
) \

867 
	`AO_Ü_acquœe
(
addr
, 
v®
)

	)

868 
	#AO_HAVE_Ü_acquœe_»ad


	)

875 #ià
	`defšed
(
AO_HAVE_‹¡_ªd_£t_fuÎ
)

876 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t_»Ëa£
)

877 
	#AO_‹¡_ªd_£t_»Ëa£
(
addr
) \

878 
	`AO_‹¡_ªd_£t_fuÎ
(
addr
)

	)

879 
	#AO_HAVE_‹¡_ªd_£t_»Ëa£


	)

881 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe
)

882 
	#AO_‹¡_ªd_£t_acquœe
(
addr
) \

883 
	`AO_‹¡_ªd_£t_fuÎ
(
addr
)

	)

884 
	#AO_HAVE_‹¡_ªd_£t_acquœe


	)

886 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t_wr™e
)

887 
	#AO_‹¡_ªd_£t_wr™e
(
addr
) \

888 
	`AO_‹¡_ªd_£t_fuÎ
(
addr
)

	)

889 
	#AO_HAVE_‹¡_ªd_£t_wr™e


	)

891 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t_»ad
)

892 
	#AO_‹¡_ªd_£t_»ad
(
addr
) \

893 
	`AO_‹¡_ªd_£t_fuÎ
(
addr
)

	)

894 
	#AO_HAVE_‹¡_ªd_£t_»ad


	)

898 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t
) && \

899 
	$defšed
(
AO_HAVE_‹¡_ªd_£t_»Ëa£
)

900 
	#AO_‹¡_ªd_£t
(
addr
) \

901 
	`AO_‹¡_ªd_£t_»Ëa£
(
addr
)

	)

902 
	#AO_HAVE_‹¡_ªd_£t


	)

904 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t
) && \

905 
	$defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe
)

906 
	#AO_‹¡_ªd_£t
(
addr
) \

907 
	`AO_‹¡_ªd_£t_acquœe
(
addr
)

	)

908 
	#AO_HAVE_‹¡_ªd_£t


	)

910 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t
) && \

911 
	$defšed
(
AO_HAVE_‹¡_ªd_£t_wr™e
)

912 
	#AO_‹¡_ªd_£t
(
addr
) \

913 
	`AO_‹¡_ªd_£t_wr™e
(
addr
)

	)

914 
	#AO_HAVE_‹¡_ªd_£t


	)

916 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t
) && \

917 
	$defšed
(
AO_HAVE_‹¡_ªd_£t_»ad
)

918 
	#AO_‹¡_ªd_£t
(
addr
) \

919 
	`AO_‹¡_ªd_£t_»ad
(
addr
)

	)

920 
	#AO_HAVE_‹¡_ªd_£t


	)

923 #ià
	`defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe
) &&\

924 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

925 !
	$defšed
(
AO_HAVE_‹¡_ªd_£t_fuÎ
)

926 
	#AO_‹¡_ªd_£t_fuÎ
(
addr
) \

927 (
	`AO_nİ_fuÎ
(), 
	`AO_‹¡_ªd_£t_acquœe
(
addr
))

	)

928 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

931 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t_»Ëa£_wr™e
) && \

932 
	$defšed
(
AO_HAVE_‹¡_ªd_£t_wr™e
)

933 
	#AO_‹¡_ªd_£t_»Ëa£_wr™e
(
addr
) \

934 
	`AO_‹¡_ªd_£t_wr™e
(
addr
)

	)

935 
	#AO_HAVE_‹¡_ªd_£t_»Ëa£_wr™e


	)

937 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t_»Ëa£_wr™e
) && \

938 
	$defšed
(
AO_HAVE_‹¡_ªd_£t_»Ëa£
)

939 
	#AO_‹¡_ªd_£t_»Ëa£_wr™e
(
addr
) \

940 
	`AO_‹¡_ªd_£t_»Ëa£
(
addr
)

	)

941 
	#AO_HAVE_‹¡_ªd_£t_»Ëa£_wr™e


	)

943 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe_»ad
) && \

944 
	$defšed
(
AO_HAVE_‹¡_ªd_£t_»ad
)

945 
	#AO_‹¡_ªd_£t_acquœe_»ad
(
addr
) \

946 
	`AO_‹¡_ªd_£t_»ad
(
addr
)

	)

947 
	#AO_HAVE_‹¡_ªd_£t_acquœe_»ad


	)

949 #ià!
	`defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe_»ad
) && \

950 
	$defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe
)

951 
	#AO_‹¡_ªd_£t_acquœe_»ad
(
addr
) \

952 
	`AO_‹¡_ªd_£t_acquœe
(
addr
)

	)

953 
	#AO_HAVE_‹¡_ªd_£t_acquœe_»ad


	)

956 #ifdeà
AO_NO_DD_ORDERING


957 #ià
	`defšed
(
AO_HAVE_‹¡_ªd_£t_acquœe_»ad
)

958 
	#AO_‹¡_ªd_£t_dd_acquœe_»ad
(
addr
) \

959 
	`AO_‹¡_ªd_£t_acquœe_»ad
(
addr
)

	)

960 
	#AO_HAVE_‹¡_ªd_£t_dd_acquœe_»ad


	)

963 #ià
	`defšed
(
AO_HAVE_‹¡_ªd_£t
)

964 
	#AO_‹¡_ªd_£t_dd_acquœe_»ad
(
addr
è
	`AO_‹¡_ªd_£t
×ddr)

	)

965 
	#AO_HAVE_‹¡_ªd_£t_dd_acquœe_»ad


	)

970 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­
è&& defšed(
AO_HAVE_nİ_fuÎ
)\

971 && !
	$defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
)

972 
AO_INLINE
 

973 
	$AO_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

975 
»suÉ
 = 
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

976 
	`AO_nİ_fuÎ
();

977  
»suÉ
;

978 
	}
}

979 
	#AO_HAVE_com·»_ªd_sw­_acquœe


	)

981 #ià
defšed
(
AO_HAVE_com·»_ªd_sw­
è&& defšed(
AO_HAVE_nİ_fuÎ
)\

982 && !
	$defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£
)

983 
	#AO_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, 
Ãw_v®
) \

984 (
	`AO_nİ_fuÎ
(), 
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
))

	)

985 
	#AO_HAVE_com·»_ªd_sw­_»Ëa£


	)

987 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
)

988 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£
)

989 
	#AO_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, 
Ãw_v®
) \

990 
	`AO_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãw_v®
)

	)

991 
	#AO_HAVE_com·»_ªd_sw­_»Ëa£


	)

993 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
)

994 
	#AO_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, 
Ãw_v®
) \

995 
	`AO_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãw_v®
)

	)

996 
	#AO_HAVE_com·»_ªd_sw­_acquœe


	)

998 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_wr™e
)

999 
	#AO_com·»_ªd_sw­_wr™e
(
addr
, 
Şd
, 
Ãw_v®
) \

1000 
	`AO_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1001 
	#AO_HAVE_com·»_ªd_sw­_wr™e


	)

1003 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_»ad
)

1004 
	#AO_com·»_ªd_sw­_»ad
(
addr
, 
Şd
, 
Ãw_v®
) \

1005 
	`AO_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1006 
	#AO_HAVE_com·»_ªd_sw­_»ad


	)

1010 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­
) && \

1011 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£
)

1012 
	#AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
) \

1013 
	`AO_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1014 
	#AO_HAVE_com·»_ªd_sw­


	)

1016 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­
) && \

1017 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
)

1018 
	#AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
) \

1019 
	`AO_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1020 
	#AO_HAVE_com·»_ªd_sw­


	)

1022 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­
) && \

1023 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_wr™e
)

1024 
	#AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
) \

1025 
	`AO_com·»_ªd_sw­_wr™e
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1026 
	#AO_HAVE_com·»_ªd_sw­


	)

1028 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­
) && \

1029 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_»ad
)

1030 
	#AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
) \

1031 
	`AO_com·»_ªd_sw­_»ad
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1032 
	#AO_HAVE_com·»_ªd_sw­


	)

1035 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
) &&\

1036 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

1037 !
	$defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
)

1038 
	#AO_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãw_v®
) \

1039 (
	`AO_nİ_fuÎ
(), 
	`AO_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, 
Ãw_v®
))

	)

1040 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

1043 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£_wr™e
) && \

1044 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_wr™e
)

1045 
	#AO_com·»_ªd_sw­_»Ëa£_wr™e
(
addr
, 
Şd
, 
Ãw_v®
) \

1046 
	`AO_com·»_ªd_sw­_wr™e
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1047 
	#AO_HAVE_com·»_ªd_sw­_»Ëa£_wr™e


	)

1049 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£_wr™e
) && \

1050 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£
)

1051 
	#AO_com·»_ªd_sw­_»Ëa£_wr™e
(
addr
, 
Şd
, 
Ãw_v®
) \

1052 
	`AO_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1053 
	#AO_HAVE_com·»_ªd_sw­_»Ëa£_wr™e


	)

1055 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe_»ad
) && \

1056 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_»ad
)

1057 
	#AO_com·»_ªd_sw­_acquœe_»ad
(
addr
, 
Şd
, 
Ãw_v®
) \

1058 
	`AO_com·»_ªd_sw­_»ad
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1059 
	#AO_HAVE_com·»_ªd_sw­_acquœe_»ad


	)

1061 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe_»ad
) && \

1062 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
)

1063 
	#AO_com·»_ªd_sw­_acquœe_»ad
(
addr
, 
Şd
, 
Ãw_v®
) \

1064 
	`AO_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1065 
	#AO_HAVE_com·»_ªd_sw­_acquœe_»ad


	)

1068 #ifdeà
AO_NO_DD_ORDERING


1069 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe_»ad
)

1070 
	#AO_com·»_ªd_sw­_dd_acquœe_»ad
(
addr
, 
Şd
, 
Ãw_v®
) \

1071 
	`AO_com·»_ªd_sw­_acquœe_»ad
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1072 
	#AO_HAVE_com·»_ªd_sw­_dd_acquœe_»ad


	)

1075 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­
)

1076 
	#AO_com·»_ªd_sw­_dd_acquœe_»ad
(
addr
, 
Şd
, 
Ãw_v®
) \

1077 
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
)

	)

1078 
	#AO_HAVE_com·»_ªd_sw­_dd_acquœe_»ad


	)

1082 
	~"g’”®ize-sm®l.h
"

1085 #ià
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË
è&& defšed(
AO_HAVE_nİ_fuÎ
)\

1086 && !
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe
)

1087 
AO_INLINE
 

1088 
	$AO_com·»_doubË_ªd_sw­_doubË_acquœe
(vŞ©
AO_doubË_t
 *
addr
,

1089 
AO_t
 
o1
, AO_ˆ
o2
,

1090 
AO_t
 
n1
, AO_ˆ
n2
)

1092 
»suÉ
 = 
	`AO_com·»_doubË_ªd_sw­_doubË
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
);

1093 
	`AO_nİ_fuÎ
();

1094  
»suÉ
;

1095 
	}
}

1096 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe


	)

1098 #ià
defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË
) \

1099 && 
defšed
(
AO_HAVE_nİ_fuÎ
)\

1100 && !
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£
)

1101 
	#AO_com·»_doubË_ªd_sw­_doubË_»Ëa£
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1102 (
	`AO_nİ_fuÎ
(), 
	`AO_com·»_doubË_ªd_sw­_doubË
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
))

	)

1103 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£


	)

1105 #ià
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ
)

1106 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£
)

1107 
	#AO_com·»_doubË_ªd_sw­_doubË_»Ëa£
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1108 
	`AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1109 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£


	)

1111 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe
)

1112 
	#AO_com·»_doubË_ªd_sw­_doubË_acquœe
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1113 
	`AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1114 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe


	)

1116 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_wr™e
)

1117 
	#AO_com·»_doubË_ªd_sw­_doubË_wr™e
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1118 
	`AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1119 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_wr™e


	)

1121 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»ad
)

1122 
	#AO_com·»_doubË_ªd_sw­_doubË_»ad
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1123 
	`AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1124 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_»ad


	)

1128 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË
) && \

1129 
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£
)

1130 
	#AO_com·»_doubË_ªd_sw­_doubË
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1131 
	`AO_com·»_doubË_ªd_sw­_doubË_»Ëa£
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1132 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË


	)

1134 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË
) && \

1135 
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe
)

1136 
	#AO_com·»_doubË_ªd_sw­_doubË
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1137 
	`AO_com·»_doubË_ªd_sw­_doubË_acquœe
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1138 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË


	)

1140 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË
) && \

1141 
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_wr™e
)

1142 
	#AO_com·»_doubË_ªd_sw­_doubË
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1143 
	`AO_com·»_doubË_ªd_sw­_doubË_wr™e
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1144 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË


	)

1146 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË
) && \

1147 
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»ad
)

1148 
	#AO_com·»_doubË_ªd_sw­_doubË
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1149 
	`AO_com·»_doubË_ªd_sw­_doubË_»ad
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1150 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË


	)

1153 #ià
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe
) &&\

1154 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

1155 !
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ
)

1156 
	#AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1157 (
	`AO_nİ_fuÎ
(), 
	`AO_com·»_doubË_ªd_sw­_doubË_acquœe
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
))

	)

1158 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

1161 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£_wr™e
) && \

1162 
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_wr™e
)

1163 
	#AO_com·»_doubË_ªd_sw­_doubË_»Ëa£_wr™e
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1164 
	`AO_com·»_doubË_ªd_sw­_doubË_wr™e
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1165 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£_wr™e


	)

1167 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£_wr™e
) && \

1168 
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£
)

1169 
	#AO_com·»_doubË_ªd_sw­_doubË_»Ëa£_wr™e
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1170 
	`AO_com·»_doubË_ªd_sw­_doubË_»Ëa£
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1171 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£_wr™e


	)

1173 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe_»ad
) && \

1174 
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»ad
)

1175 
	#AO_com·»_doubË_ªd_sw­_doubË_acquœe_»ad
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1176 
	`AO_com·»_doubË_ªd_sw­_doubË_»ad
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1177 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe_»ad


	)

1179 #ià!
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe_»ad
) && \

1180 
	$defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe
)

1181 
	#AO_com·»_doubË_ªd_sw­_doubË_acquœe_»ad
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1182 
	`AO_com·»_doubË_ªd_sw­_doubË_acquœe
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1183 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe_»ad


	)

1186 #ifdeà
AO_NO_DD_ORDERING


1187 #ià
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe_»ad
)

1188 
	#AO_com·»_doubË_ªd_sw­_doubË_dd_acquœe_»ad
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1189 
	`AO_com·»_doubË_ªd_sw­_doubË_acquœe_»ad
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1190 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_dd_acquœe_»ad


	)

1193 #ià
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË
)

1194 
	#AO_com·»_doubË_ªd_sw­_doubË_dd_acquœe_»ad
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
) \

1195 
	`AO_com·»_doubË_ªd_sw­_doubË
(
addr
, 
o1
, 
o2
, 
n1
, 
n2
)

	)

1196 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_dd_acquœe_»ad


	)

1201 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË
è&& defšed(
AO_HAVE_nİ_fuÎ
)\

1202 && !
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_acquœe
)

1203 
AO_INLINE
 

1204 
	$AO_com·»_ªd_sw­_doubË_acquœe
(vŞ©
AO_doubË_t
 *
addr
,

1205 
AO_t
 
o1
,

1206 
AO_t
 
n1
, AO_ˆ
n2
)

1208 
»suÉ
 = 
	`AO_com·»_ªd_sw­_doubË
(
addr
, 
o1
, 
n1
, 
n2
);

1209 
	`AO_nİ_fuÎ
();

1210  
»suÉ
;

1211 
	}
}

1212 
	#AO_HAVE_com·»_ªd_sw­_doubË_acquœe


	)

1214 #ià
defšed
(
AO_HAVE_com·»_ªd_sw­_doubË
) \

1215 && 
defšed
(
AO_HAVE_nİ_fuÎ
)\

1216 && !
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£
)

1217 
	#AO_com·»_ªd_sw­_doubË_»Ëa£
(
addr
, 
o1
, 
n1
, 
n2
) \

1218 (
	`AO_nİ_fuÎ
(), 
	`AO_com·»_ªd_sw­_doubË
(
addr
, 
o1
, 
n1
, 
n2
))

	)

1219 
	#AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£


	)

1221 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_fuÎ
)

1222 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£
)

1223 
	#AO_com·»_ªd_sw­_doubË_»Ëa£
(
addr
, 
o1
, 
n1
, 
n2
) \

1224 
	`AO_com·»_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1225 
	#AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£


	)

1227 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_acquœe
)

1228 
	#AO_com·»_ªd_sw­_doubË_acquœe
(
addr
, 
o1
, 
n1
, 
n2
) \

1229 
	`AO_com·»_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1230 
	#AO_HAVE_com·»_ªd_sw­_doubË_acquœe


	)

1232 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_wr™e
)

1233 
	#AO_com·»_ªd_sw­_doubË_wr™e
(
addr
, 
o1
, 
n1
, 
n2
) \

1234 
	`AO_com·»_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1235 
	#AO_HAVE_com·»_ªd_sw­_doubË_wr™e


	)

1237 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»ad
)

1238 
	#AO_com·»_ªd_sw­_doubË_»ad
(
addr
, 
o1
, 
n1
, 
n2
) \

1239 
	`AO_com·»_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1240 
	#AO_HAVE_com·»_ªd_sw­_doubË_»ad


	)

1244 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË
) && \

1245 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£
)

1246 
	#AO_com·»_ªd_sw­_doubË
(
addr
, 
o1
, 
n1
, 
n2
) \

1247 
	`AO_com·»_ªd_sw­_doubË_»Ëa£
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1248 
	#AO_HAVE_com·»_ªd_sw­_doubË


	)

1250 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË
) && \

1251 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_acquœe
)

1252 
	#AO_com·»_ªd_sw­_doubË
(
addr
, 
o1
, 
n1
, 
n2
) \

1253 
	`AO_com·»_ªd_sw­_doubË_acquœe
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1254 
	#AO_HAVE_com·»_ªd_sw­_doubË


	)

1256 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË
) && \

1257 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_wr™e
)

1258 
	#AO_com·»_ªd_sw­_doubË
(
addr
, 
o1
, 
n1
, 
n2
) \

1259 
	`AO_com·»_ªd_sw­_doubË_wr™e
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1260 
	#AO_HAVE_com·»_ªd_sw­_doubË


	)

1262 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË
) && \

1263 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»ad
)

1264 
	#AO_com·»_ªd_sw­_doubË
(
addr
, 
o1
, 
n1
, 
n2
) \

1265 
	`AO_com·»_ªd_sw­_doubË_»ad
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1266 
	#AO_HAVE_com·»_ªd_sw­_doubË


	)

1269 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_acquœe
) &&\

1270 
	`defšed
(
AO_HAVE_nİ_fuÎ
) && \

1271 !
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_fuÎ
)

1272 
	#AO_com·»_ªd_sw­_doubË_fuÎ
(
addr
, 
o1
, 
n1
, 
n2
) \

1273 (
	`AO_nİ_fuÎ
(), 
	`AO_com·»_ªd_sw­_doubË_acquœe
(
addr
, 
o1
, 
n1
, 
n2
))

	)

1274 
	#AO_HAVE_com·»_ªd_sw­_doubË_fuÎ


	)

1277 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£_wr™e
) && \

1278 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_wr™e
)

1279 
	#AO_com·»_ªd_sw­_doubË_»Ëa£_wr™e
(
addr
, 
o1
, 
n1
, 
n2
) \

1280 
	`AO_com·»_ªd_sw­_doubË_wr™e
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1281 
	#AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£_wr™e


	)

1283 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£_wr™e
) && \

1284 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£
)

1285 
	#AO_com·»_ªd_sw­_doubË_»Ëa£_wr™e
(
addr
, 
o1
, 
n1
, 
n2
) \

1286 
	`AO_com·»_ªd_sw­_doubË_»Ëa£
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1287 
	#AO_HAVE_com·»_ªd_sw­_doubË_»Ëa£_wr™e


	)

1289 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_acquœe_»ad
) && \

1290 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_»ad
)

1291 
	#AO_com·»_ªd_sw­_doubË_acquœe_»ad
(
addr
, 
o1
, 
n1
, 
n2
) \

1292 
	`AO_com·»_ªd_sw­_doubË_»ad
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1293 
	#AO_HAVE_com·»_ªd_sw­_doubË_acquœe_»ad


	)

1295 #ià!
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_acquœe_»ad
) && \

1296 
	$defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_acquœe
)

1297 
	#AO_com·»_ªd_sw­_doubË_acquœe_»ad
(
addr
, 
o1
, 
n1
, 
n2
) \

1298 
	`AO_com·»_ªd_sw­_doubË_acquœe
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1299 
	#AO_HAVE_com·»_ªd_sw­_doubË_acquœe_»ad


	)

1302 #ifdeà
AO_NO_DD_ORDERING


1303 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË_acquœe_»ad
)

1304 
	#AO_com·»_ªd_sw­_doubË_dd_acquœe_»ad
(
addr
, 
o1
, 
n1
, 
n2
) \

1305 
	`AO_com·»_ªd_sw­_doubË_acquœe_»ad
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1306 
	#AO_HAVE_com·»_ªd_sw­_doubË_dd_acquœe_»ad


	)

1309 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_doubË
)

1310 
	#AO_com·»_ªd_sw­_doubË_dd_acquœe_»ad
(
addr
, 
o1
, 
n1
, 
n2
) \

1311 
	`AO_com·»_ªd_sw­_doubË
(
addr
, 
o1
, 
n1
, 
n2
)

	)

1312 
	#AO_HAVE_com·»_ªd_sw­_doubË_dd_acquœe_»ad


	)

1318 #ià
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_»Ëa£
) && \

1319 !
	$defšed
(
AO_HAVE_doubË_com·»_ªd_sw­_»Ëa£
)

1320 
AO_INLINE
 

1321 
	$AO_doubË_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_doubË_t
 *
addr
,

1322 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

1324  
	`AO_com·»_doubË_ªd_sw­_doubË_»Ëa£
(
addr
,

1325 
Şd_v®
.
AO_v®1
, old_v®.
AO_v®2
,

1326 
Ãw_v®
.
AO_v®1
,‚ew_v®.
AO_v®2
);

1327 
	}
}

1328 
	#AO_HAVE_doubË_com·»_ªd_sw­_»Ëa£


	)

1331 #ià
defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_acquœe
) && \

1332 !
	$defšed
(
AO_HAVE_doubË_com·»_ªd_sw­_acquœe
)

1333 
AO_INLINE
 

1334 
	$AO_doubË_com·»_ªd_sw­_acquœe
(vŞ©
AO_doubË_t
 *
addr
,

1335 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

1337  
	`AO_com·»_doubË_ªd_sw­_doubË_acquœe
(
addr
,

1338 
Şd_v®
.
AO_v®1
, old_v®.
AO_v®2
,

1339 
Ãw_v®
.
AO_v®1
,‚ew_v®.
AO_v®2
);

1340 
	}
}

1341 
	#AO_HAVE_doubË_com·»_ªd_sw­_acquœe


	)

1344 #ià
defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ
) && \

1345 !
	$defšed
(
AO_HAVE_doubË_com·»_ªd_sw­_fuÎ
)

1346 
AO_INLINE
 

1347 
	$AO_doubË_com·»_ªd_sw­_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

1348 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

1350  
	`AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(
addr
,

1351 
Şd_v®
.
AO_v®1
, old_v®.
AO_v®2
,

1352 
Ãw_v®
.
AO_v®1
,‚ew_v®.
AO_v®2
);

1353 
	}
}

1354 
	#AO_HAVE_doubË_com·»_ªd_sw­_fuÎ


	)

	@atomic_ops/ia64.h

23 
	~"®igÃd_©omic_lßd_¡Üe.h
"

25 
	~"®l_acquœe_»Ëa£_vŞ©e.h
"

27 
	~"‹¡_ªd_£t_t_is_ch¬.h
"

29 #ifdeà
_ILP32


34 
	#AO_LEN
 "4"

	)

45 
	#AO_IN_ADDR
 "1"(
addr
)

	)

46 
	#AO_OUT_ADDR
 , "ô"(
addr
)

	)

47 
	#AO_SWIZZLE
 "addp4 %1=0,%1;;\n"

	)

48 
	#AO_MASK
(
±r
è
	`__asm__
("zxt4 %1=%1": "ô"ÕŒè: "0"ÕŒ));

	)

50 
	#AO_LEN
 "8"

	)

51 
	#AO_IN_ADDR
 "r"(
addr
)

	)

52 
	#AO_OUT_ADDR


	)

53 
	#AO_SWIZZLE


	)

54 
	#AO_MASK
(
±r
)

	)

57 
AO_INLINE
 

58 
	$AO_nİ_fuÎ
()

60 
__asm__
 
	`__vŞ©e__
("mf" : : : "memory");

61 
	}
}

62 
	#AO_HAVE_nİ_fuÎ


	)

64 
AO_INLINE
 
AO_t


65 
	$AO_ãtch_ªd_add1_acquœe
 (vŞ©
AO_t
 *
addr
)

67 
AO_t
 
»suÉ
;

69 
__asm__
 
	`__vŞ©e__
 (
AO_SWIZZLE


70 "ãtchadd" 
AO_LEN
 ".acq %0=[%1],1":

71 "ô" (
»suÉ
è
AO_OUT_ADDR
: 
AO_IN_ADDR
 :"memory");

72  
»suÉ
;

73 
	}
}

74 
	#AO_HAVE_ãtch_ªd_add1_acquœe


	)

76 
AO_INLINE
 
AO_t


77 
	$AO_ãtch_ªd_add1_»Ëa£
 (vŞ©
AO_t
 *
addr
)

79 
AO_t
 
»suÉ
;

81 
__asm__
 
	`__vŞ©e__
 (
AO_SWIZZLE


82 "ãtchadd" 
AO_LEN
 ".rel %0=[%1],1":

83 "ô" (
»suÉ
è
AO_OUT_ADDR
: 
AO_IN_ADDR
 :"memory");

84  
»suÉ
;

85 
	}
}

87 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£


	)

89 
AO_INLINE
 
AO_t


90 
	$AO_ãtch_ªd_sub1_acquœe
 (vŞ©
AO_t
 *
addr
)

92 
AO_t
 
»suÉ
;

94 
__asm__
 
	`__vŞ©e__
 (
AO_SWIZZLE


95 "ãtchadd" 
AO_LEN
 ".acq %0=[%1],-1":

96 "ô" (
»suÉ
è
AO_OUT_ADDR
: 
AO_IN_ADDR
 :"memory");

97  
»suÉ
;

98 
	}
}

100 
	#AO_HAVE_ãtch_ªd_sub1_acquœe


	)

102 
AO_INLINE
 
AO_t


103 
	$AO_ãtch_ªd_sub1_»Ëa£
 (vŞ©
AO_t
 *
addr
)

105 
AO_t
 
»suÉ
;

107 
__asm__
 
	`__vŞ©e__
 (
AO_SWIZZLE


108 "ãtchadd" 
AO_LEN
 ".rel %0=[%1],-1":

109 "ô" (
»suÉ
è
AO_OUT_ADDR
: 
AO_IN_ADDR
 :"memory");

110  
»suÉ
;

111 
	}
}

113 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£


	)

115 #iâdeà
_ILP32


117 
AO_INLINE
 

118 
	$AO_št_ãtch_ªd_add1_acquœe
 (vŞ©*
addr
)

120 
»suÉ
;

122 
__asm__
 
	`__vŞ©e__
 ("fetchadd4.acq %0=[%1],1":

123 "ô" (
»suÉ
): 
AO_IN_ADDR
 :"memory");

124  
»suÉ
;

125 
	}
}

126 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe


	)

128 
AO_INLINE
 

129 
	$AO_št_ãtch_ªd_add1_»Ëa£
 (vŞ©*
addr
)

131 
»suÉ
;

133 
__asm__
 
	`__vŞ©e__
 ("fetchadd4.rel %0=[%1],1":

134 "ô" (
»suÉ
): 
AO_IN_ADDR
 :"memory");

135  
»suÉ
;

136 
	}
}

138 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£


	)

140 
AO_INLINE
 

141 
	$AO_št_ãtch_ªd_sub1_acquœe
 (vŞ©*
addr
)

143 
»suÉ
;

145 
__asm__
 
	`__vŞ©e__
 ("fetchadd4.acq %0=[%1],-1":

146 "ô" (
»suÉ
): 
AO_IN_ADDR
 :"memory");

147  
»suÉ
;

148 
	}
}

150 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe


	)

152 
AO_INLINE
 

153 
	$AO_št_ãtch_ªd_sub1_»Ëa£
 (vŞ©*
addr
)

155 
»suÉ
;

157 
__asm__
 
	`__vŞ©e__
 ("fetchadd4.rel %0=[%1],-1":

158 "ô" (
»suÉ
): 
AO_IN_ADDR
 :"memory");

159  
»suÉ
;

160 
	}
}

162 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£


	)

166 
AO_INLINE
 

167 
	$AO_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
,

168 
AO_t
 
Şd
, AO_ˆ
Ãw_v®
)

170 
AO_t
 
Şdv®
;

171 
	`AO_MASK
(
Şd
);

172 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


173 "mov‡r.ccv=%[Şd] ;; cmpxchg" 
AO_LEN


175 : "ô"(
Şdv®
è
AO_OUT_ADDR


176 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"(old)

178  (
Şdv®
 =ğ
Şd
);

179 
	}
}

181 
	#AO_HAVE_com·»_ªd_sw­_acquœe


	)

183 
AO_INLINE
 

184 
	$AO_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_t
 *
addr
,

185 
AO_t
 
Şd
, AO_ˆ
Ãw_v®
)

187 
AO_t
 
Şdv®
;

188 
	`AO_MASK
(
Şd
);

189 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


190 "mov‡r.ccv=%[Şd] ;; cmpxchg" 
AO_LEN


192 : "ô"(
Şdv®
è
AO_OUT_ADDR


193 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"(old)

195  (
Şdv®
 =ğ
Şd
);

196 
	}
}

198 
	#AO_HAVE_com·»_ªd_sw­_»Ëa£


	)

200 
AO_INLINE
 

201 
	$AO_ch¬_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

202 
Şd
, 
Ãw_v®
)

204 
Şdv®
;

205 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


207 : "ô"(
Şdv®
è
AO_OUT_ADDR


208 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"((
AO_t
)old)

210  (
Şdv®
 =ğ
Şd
);

211 
	}
}

213 
	#AO_HAVE_ch¬_com·»_ªd_sw­_acquœe


	)

215 
AO_INLINE
 

216 
	$AO_ch¬_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

217 
Şd
, 
Ãw_v®
)

219 
Şdv®
;

220 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


222 : "ô"(
Şdv®
è
AO_OUT_ADDR


223 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"((
AO_t
)old)

225  (
Şdv®
 =ğ
Şd
);

226 
	}
}

228 
	#AO_HAVE_ch¬_com·»_ªd_sw­_»Ëa£


	)

230 
AO_INLINE
 

231 
	$AO_shÜt_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

232 
Şd
, 
Ãw_v®
)

234 
Şdv®
;

235 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


237 : "ô"(
Şdv®
è
AO_OUT_ADDR


238 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"((
AO_t
)old)

240  (
Şdv®
 =ğ
Şd
);

241 
	}
}

243 
	#AO_HAVE_shÜt_com·»_ªd_sw­_acquœe


	)

245 
AO_INLINE
 

246 
	$AO_shÜt_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

247 
Şd
, 
Ãw_v®
)

249 
Şdv®
;

250 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


252 : "ô"(
Şdv®
è
AO_OUT_ADDR


253 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"((
AO_t
)old)

255  (
Şdv®
 =ğ
Şd
);

256 
	}
}

258 
	#AO_HAVE_shÜt_com·»_ªd_sw­_»Ëa£


	)

260 #iâdeà
_ILP32


262 
AO_INLINE
 

263 
	$AO_št_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

264 
Şd
, 
Ãw_v®
)

266 
Şdv®
;

267 
__asm__
 
	`__vŞ©e__
("mov‡r.ccv=%3 ;; cmpxchg4.acq %0=[%1],%2,ar.ccv"

268 : "ô"(
Şdv®
)

269 : 
AO_IN_ADDR
, "r"(
Ãw_v®
), "r"((
AO_t
)
Şd
) : "memory");

270  (
Şdv®
 =ğ
Şd
);

271 
	}
}

273 
	#AO_HAVE_št_com·»_ªd_sw­_acquœe


	)

275 
AO_INLINE
 

276 
	$AO_št_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

277 
Şd
, 
Ãw_v®
)

279 
Şdv®
;

280 
__asm__
 
	`__vŞ©e__
("mov‡r.ccv=%3 ;; cmpxchg4.rel %0=[%1],%2,ar.ccv"

281 : "ô"(
Şdv®
)

282 : 
AO_IN_ADDR
, "r"(
Ãw_v®
), "r"((
AO_t
)
Şd
) : "memory");

283  (
Şdv®
 =ğ
Şd
);

284 
	}
}

286 
	#AO_HAVE_št_com·»_ªd_sw­_»Ëa£


	)

295 #ifdeà
_ILP32


296 
	~"ao_t_is_št.h
"

	@atomic_ops/ordered_except_wr.h

30 
	~"»ad_Üd”ed.h
"

32 
AO_INLINE
 

33 
	$AO_nİ_wr™e
()

35 
	`AO_comp”_b¬r›r
();

38 
	}
}

40 
	#AO_HAVE_NOP_WRITE


	)

42 #ià
defšed
(
AO_HAVE_¡Üe
)

44 
AO_INLINE
 

45 
	$AO_¡Üe_wr™e
(vŞ©
AO_t
 *
addr
, AO_ˆ
v®
)

47 
	`AO_comp”_b¬r›r
();

48 
	`AO_¡Üe
(
addr
, 
v®
);

49 
	}
}

50 
	#AO_HAVE_¡Üe_wr™e


	)

52 
	#AO_¡Üe_»Ëa£
(
addr
, 
v®
è
	`AO_¡Üe_wr™e
×ddr, v®)

	)

53 
	#AO_HAVE_¡Üe_»Ëa£


	)

57 #ià
defšed
(
AO_HAVE_ch¬_¡Üe
)

59 
AO_INLINE
 

60 
	$AO_ch¬_¡Üe_wr™e
(vŞ©*
addr
, 
v®
)

62 
	`AO_comp”_b¬r›r
();

63 
	`AO_ch¬_¡Üe
(
addr
, 
v®
);

64 
	}
}

65 
	#AO_HAVE_ch¬_¡Üe_wr™e


	)

67 
	#AO_ch¬_¡Üe_»Ëa£
(
addr
, 
v®
è
	`AO_ch¬_¡Üe_wr™e
×ddr, v®)

	)

68 
	#AO_HAVE_ch¬_¡Üe_»Ëa£


	)

72 #ià
defšed
(
AO_HAVE_shÜt_¡Üe
)

74 
AO_INLINE
 

75 
	$AO_shÜt_¡Üe_wr™e
(vŞ©*
addr
, 
v®
)

77 
	`AO_comp”_b¬r›r
();

78 
	`AO_shÜt_¡Üe
(
addr
, 
v®
);

79 
	}
}

80 
	#AO_HAVE_shÜt_¡Üe_wr™e


	)

82 
	#AO_shÜt_¡Üe_»Ëa£
(
addr
, 
v®
è
	`AO_shÜt_¡Üe_wr™e
×ddr, v®)

	)

83 
	#AO_HAVE_shÜt_¡Üe_»Ëa£


	)

87 #ià
defšed
(
AO_HAVE_št_¡Üe
)

89 
AO_INLINE
 

90 
	$AO_št_¡Üe_wr™e
(vŞ©*
addr
, 
v®
)

92 
	`AO_comp”_b¬r›r
();

93 
	`AO_št_¡Üe
(
addr
, 
v®
);

94 
	}
}

95 
	#AO_HAVE_št_¡Üe_wr™e


	)

97 
	#AO_št_¡Üe_»Ëa£
(
addr
, 
v®
è
	`AO_št_¡Üe_wr™e
×ddr, v®)

	)

98 
	#AO_HAVE_št_¡Üe_»Ëa£


	)

	@atomic_ops/powerpc.h

33 
	~"®igÃd_©omic_lßd_¡Üe.h
"

35 
	~"‹¡_ªd_£t_t_is_ao_t.h
"

39 
AO_INLINE
 

40 
	$AO_nİ_fuÎ
()

42 
__asm__
 
	`__vŞ©e__
("sync" : : : "memory");

43 
	}
}

45 
	#AO_HAVE_nİ_fuÎ


	)

48 
AO_INLINE
 

49 
	$AO_lwsync
()

51 #ifdeà
__NO_LWSYNC__


52 
__asm__
 
	`__vŞ©e__
("sync" : : : "memory");

54 
__asm__
 
	`__vŞ©e__
("lwsync" : : : "memory");

56 
	}
}

58 
	#AO_nİ_wr™e
(è
	`AO_lwsync
()

	)

59 
	#AO_HAVE_nİ_wr™e


	)

61 
	#AO_nİ_»ad
(è
	`AO_lwsync
()

	)

62 
	#AO_HAVE_nİ_»ad


	)

71 #ià
defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

72 
AO_INLINE
 
AO_t


73 
	$AO_lßd_acquœe
(cÚ¡ vŞ©
AO_t
 *
addr
)

75 
AO_t
 
»suÉ
;

77 
__asm__
 
	`__vŞ©e__
 (

82 : "ô" (
»suÉ
)

83 : "m"(*
addr
) : "memory", "cr0");

84  
»suÉ
;

85 
	}
}

87 
AO_INLINE
 
AO_t


88 
	$AO_lßd_acquœe
(cÚ¡ vŞ©
AO_t
 *
addr
)

90 
AO_t
 
»suÉ
;

95 
__asm__
 
	`__vŞ©e__
 (

100 : "ô" (
»suÉ
)

101 : "m"(*
addr
) : "memory", "cc");

102  
»suÉ
;

103 
	}
}

105 
	#AO_HAVE_lßd_acquœe


	)

109 
AO_INLINE
 

110 
	$AO_¡Üe_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
v®ue
)

112 
	`AO_lwsync
();

113 *
addr
 = 
v®ue
;

114 
	}
}

116 
	#AO_HAVE_lßd_acquœe


	)

121 #ià
defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

123 
AO_INLINE
 
AO_TS_VAL_t


124 
	$AO_‹¡_ªd_£t
(vŞ©
AO_TS_t
 *
addr
) {

125 
Şdv®
;

126 
‹mp
 = 1;

128 
__asm__
 
	`__vŞ©e__
(

135 : "=&r"(
Şdv®
)

136 : "r"(
addr
), "r"(
‹mp
)

139  (
AO_TS_VAL_t
)
Şdv®
;

140 
	}
}

144 
AO_INLINE
 
AO_TS_VAL_t


145 
	$AO_‹¡_ªd_£t
(vŞ©
AO_TS_t
 *
addr
) {

146 
Şdv®
;

147 
‹mp
 = 1;

149 
__asm__
 
	`__vŞ©e__
(

156 : "=&r"(
Şdv®
)

157 : "r"(
addr
), "r"(
‹mp
)

160  (
AO_TS_VAL_t
)
Şdv®
;

161 
	}
}

165 
	#AO_HAVE_‹¡_ªd_£t


	)

167 
AO_INLINE
 
AO_TS_VAL_t


168 
	$AO_‹¡_ªd_£t_acquœe
(vŞ©
AO_TS_t
 *
addr
) {

169 
AO_TS_VAL_t
 
»suÉ
 = 
	`AO_‹¡_ªd_£t
(
addr
);

170 
	`AO_lwsync
();

171  
»suÉ
;

172 
	}
}

174 
	#AO_HAVE_‹¡_ªd_£t_acquœe


	)

176 
AO_INLINE
 
AO_TS_VAL_t


177 
	$AO_‹¡_ªd_£t_»Ëa£
(vŞ©
AO_TS_t
 *
addr
) {

178 
	`AO_lwsync
();

179  
	`AO_‹¡_ªd_£t
(
addr
);

180 
	}
}

182 
	#AO_HAVE_‹¡_ªd_£t_»Ëa£


	)

184 
AO_INLINE
 
AO_TS_VAL_t


185 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
) {

186 
AO_TS_VAL_t
 
»suÉ
;

187 
	`AO_lwsync
();

188 
»suÉ
 = 
	`AO_‹¡_ªd_£t
(
addr
);

189 
	`AO_lwsync
();

190  
»suÉ
;

191 
	}
}

193 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

195 #ià
defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

197 
AO_INLINE
 

198 
	$AO_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
) {

199 
AO_t
 
Şdv®
;

200 
»suÉ
 = 0;

202 
__asm__
 
	`__vŞ©e__
(

210 : "=&r"(
Şdv®
), "=&r"(
»suÉ
)

211 : "r"(
addr
), "r"(
Ãw_v®
), "r"(
Şd
), "1"(
»suÉ
)

214  
»suÉ
;

215 
	}
}

219 
AO_INLINE
 

220 
	$AO_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
) {

221 
AO_t
 
Şdv®
;

222 
»suÉ
 = 0;

224 
__asm__
 
	`__vŞ©e__
(

232 : "=&r"(
Şdv®
), "=&r"(
»suÉ
)

233 : "r"(
addr
), "r"(
Ãw_v®
), "r"(
Şd
), "1"(
»suÉ
)

236  
»suÉ
;

237 
	}
}

240 
	#AO_HAVE_com·»_ªd_sw­


	)

242 
AO_INLINE
 

243 
	$AO_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
) {

244 
»suÉ
 = 
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

245 
	`AO_lwsync
();

246  
»suÉ
;

247 
	}
}

249 
	#AO_HAVE_com·»_ªd_sw­_acquœe


	)

251 
AO_INLINE
 

252 
	$AO_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
) {

253 
	`AO_lwsync
();

254  
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

255 
	}
}

257 
	#AO_HAVE_com·»_ªd_sw­_»Ëa£


	)

259 
AO_INLINE
 

260 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
) {

261 
AO_t
 
»suÉ
;

262 
	`AO_lwsync
();

263 
»suÉ
 = 
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

264 
	`AO_lwsync
();

265  
»suÉ
;

266 
	}
}

268 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

270 #ià
defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

273 
AO_INLINE
 
AO_t


274 
	$AO_ãtch_ªd_add
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

275 
AO_t
 
Şdv®
;

276 
AO_t
 
Ãwv®
;

278 
__asm__
 
	`__vŞ©e__
(

283 : "=&r"(
Şdv®
), "=&r"(
Ãwv®
)

284 : "r"(
addr
), "r"(
šü
)

287  
Şdv®
;

288 
	}
}

290 
	#AO_HAVE_ãtch_ªd_add


	)

294 
AO_INLINE
 
AO_t


295 
	$AO_ãtch_ªd_add
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

296 
AO_t
 
Şdv®
;

297 
AO_t
 
Ãwv®
;

299 
__asm__
 
	`__vŞ©e__
(

304 : "=&r"(
Şdv®
), "=&r"(
Ãwv®
)

305 : "r"(
addr
), "r"(
šü
)

308  
Şdv®
;

309 
	}
}

311 
	#AO_HAVE_ãtch_ªd_add


	)

315 
AO_INLINE
 
AO_t


316 
	$AO_ãtch_ªd_add_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

317 
AO_t
 
»suÉ
 = 
	`AO_ãtch_ªd_add
(
addr
, 
šü
);

318 
	`AO_lwsync
();

319  
»suÉ
;

320 
	}
}

322 
	#AO_HAVE_ãtch_ªd_add_acquœe


	)

324 
AO_INLINE
 
AO_t


325 
	$AO_ãtch_ªd_add_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

326 
	`AO_lwsync
();

327  
	`AO_ãtch_ªd_add
(
addr
, 
šü
);

328 
	}
}

330 
	#AO_HAVE_ãtch_ªd_add_»Ëa£


	)

332 
AO_INLINE
 
AO_t


333 
	$AO_ãtch_ªd_add_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

334 
AO_t
 
»suÉ
;

335 
	`AO_lwsync
();

336 
»suÉ
 = 
	`AO_ãtch_ªd_add
(
addr
, 
šü
);

337 
	`AO_lwsync
();

338  
»suÉ
;

339 
	}
}

341 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

343 #ià
defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

345 
	~"ao_t_is_št.h
"

	@atomic_ops/read_ordered.h

30 
AO_INLINE
 

31 
	$AO_nİ_»ad
()

33 
	`AO_comp”_b¬r›r
();

34 
	}
}

36 
	#AO_HAVE_NOP_READ


	)

38 #ifdeà
AO_HAVE_lßd


40 
AO_INLINE
 
AO_t


41 
	$AO_lßd_»ad
(cÚ¡ vŞ©
AO_t
 *
addr
)

43 
AO_t
 
»suÉ
 = 
	`AO_lßd
(
addr
);

44 
	`AO_comp”_b¬r›r
();

45  
»suÉ
;

46 
	}
}

47 
	#AO_HAVE_lßd_»ad


	)

49 
	#AO_lßd_acquœe
(
addr
è
	`AO_lßd_»ad
×ddr)

	)

50 
	#AO_HAVE_lßd_acquœe


	)

54 #ifdeà
AO_HAVE_ch¬_lßd


56 
AO_INLINE
 
AO_t


57 
	$AO_ch¬_lßd_»ad
(cÚ¡ vŞ©*
addr
)

59 
AO_t
 
»suÉ
 = 
	`AO_ch¬_lßd
(
addr
);

60 
	`AO_comp”_b¬r›r
();

61  
»suÉ
;

62 
	}
}

63 
	#AO_HAVE_ch¬_lßd_»ad


	)

65 
	#AO_ch¬_lßd_acquœe
(
addr
è
	`AO_ch¬_lßd_»ad
×ddr)

	)

66 
	#AO_HAVE_ch¬_lßd_acquœe


	)

70 #ifdeà
AO_HAVE_shÜt_lßd


72 
AO_INLINE
 
AO_t


73 
	$AO_shÜt_lßd_»ad
(cÚ¡ vŞ©*
addr
)

75 
AO_t
 
»suÉ
 = 
	`AO_shÜt_lßd
(
addr
);

76 
	`AO_comp”_b¬r›r
();

77  
»suÉ
;

78 
	}
}

79 
	#AO_HAVE_shÜt_lßd_»ad


	)

81 
	#AO_shÜt_lßd_acquœe
(
addr
è
	`AO_shÜt_lßd_»ad
×ddr)

	)

82 
	#AO_HAVE_shÜt_lßd_acquœe


	)

86 #ifdeà
AO_HAVE_št_lßd


88 
AO_INLINE
 
AO_t


89 
	$AO_št_lßd_»ad
(cÚ¡ vŞ©*
addr
)

91 
AO_t
 
»suÉ
 = 
	`AO_št_lßd
(
addr
);

92 
	`AO_comp”_b¬r›r
();

93  
»suÉ
;

94 
	}
}

95 
	#AO_HAVE_št_lßd_»ad


	)

97 
	#AO_št_lßd_acquœe
(
addr
è
	`AO_št_lßd_»ad
×ddr)

	)

98 
	#AO_HAVE_št_lßd_acquœe


	)

	@atomic_ops/sparc.h

22 
	~"®igÃd_©omic_lßd_¡Üe.h
"

25 
	~"Üd”ed_exû±_wr.h
"

28 
	~"‹¡_ªd_£t_t_is_ch¬.h
"

30 
AO_INLINE
 
AO_TS_VAL_t


31 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
) {

32 
AO_TS_VAL_t
 
Şdv®
;

34 
__asm__
 
	`__vŞ©e__
("ldstub %1,%0"

35 : "ô"(
Şdv®
), "=m"(*
addr
)

36 : "m"(*
addr
) : "memory");

37  
Şdv®
;

38 
	}
}

40 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

42 #iâdeà
AO_NO_SPARC_V9


44 
AO_INLINE
 

45 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
) {

46 
»t
;

47 
__asm__
 
	`__vŞ©e__
 ("membar #StoreLoad | #LoadLoad\n\t"

48 #ià
	`defšed
(
__¬ch64__
)

59 : "ô" (
»t
), "+r" (
Ãw_v®
)

60 : "r" (
addr
), "0" (
Şd
)

62  ()
»t
;

63 
	}
}

65 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

	@atomic_ops/standard_ao_double_t.h

7 #ià(
defšed
(
__x86_64__
è&& defšed(
__GNUC__
)è|| defšed(
_WIN64
)

8 
	~<xmmšŒš.h
>

9 
__m128
 
	tdoubË_±r_¡Üage
;

10 #–ià
defšed
(
_WIN32
è&& !defšed(
__GNUC__
)

11 
	t__št64
 
	tdoubË_±r_¡Üage
;

13 
	tdoubË_±r_¡Üage
;

16 
	#AO_HAVE_DOUBLE_PTR_STORAGE


	)

19 
doubË_±r_¡Üage
 
	mAO_whŞe
;

20 ¡ruù {
AO_t
 
	mAO_v1
; AO_ˆ
	mAO_v2
;} 
	mAO_·¹s
;

21 } 
	tAO_doubË_t
;

23 
	#AO_HAVE_doubË_t


	)

24 
	#AO_v®1
 
AO_·¹s
.
AO_v1


	)

25 
	#AO_v®2
 
AO_·¹s
.
AO_v2


	)

	@atomic_ops/test_and_set_t_is_ao_t.h

29 ’um {
	mAO_TS_ş—r
 = 0, 
	mAO_TS_£t
 = 1} 
	tAO_TS_v®
;

30 
	#AO_TS_VAL_t
 
AO_TS_v®


	)

31 
	#AO_TS_CLEAR
 
AO_TS_ş—r


	)

32 
	#AO_TS_SET
 
AO_TS_£t


	)

34 
	#AO_TS_t
 
AO_t


	)

36 
	#AO_AO_TS_T
 1

	)

	@atomic_ops/test_and_set_t_is_char.h

29 
	#AO_TS_t
 

	)

30 ’um {
	mAO_BYTE_TS_ş—r
 = 0, 
	mAO_BYTE_TS_£t
 = 0xff} 
	tAO_BYTE_TS_v®
;

31 
	#AO_TS_VAL_t
 
AO_BYTE_TS_v®


	)

32 
	#AO_TS_CLEAR
 
AO_BYTE_TS_ş—r


	)

33 
	#AO_TS_SET
 
AO_BYTE_TS_£t


	)

35 
	#AO_CHAR_TS_T
 1

	)

	@atomic_ops/x86.h

24 
	~"®igÃd_©omic_lßd_¡Üe.h
"

33 
	~"Üd”ed_exû±_wr.h
"

35 
	~"‹¡_ªd_£t_t_is_ch¬.h
"

37 
	~"¡ªd¬d_ao_doubË_t.h
"

39 #ià
defšed
(
AO_USE_PENTIUM4_INSTRS
)

40 
AO_INLINE
 

41 
	$AO_nİ_fuÎ
()

43 
__asm__
 
	`__vŞ©e__
("mfence" : : : "memory");

44 
	}
}

46 
	#AO_HAVE_nİ_fuÎ


	)

60 
AO_INLINE
 
AO_t


61 
	$AO_ãtch_ªd_add_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

63 
AO_t
 
»suÉ
;

65 
__asm__
 
	`__vŞ©e__
 ("lock; xaddl %0, %1" :

66 "ô" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

68  
»suÉ
;

69 
	}
}

71 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

73 
AO_INLINE
 

74 
	$AO_ch¬_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

76 
»suÉ
;

78 
__asm__
 
	`__vŞ©e__
 ("lock; xaddb %0, %1" :

79 "=q" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

81  
»suÉ
;

82 
	}
}

84 
	#AO_HAVE_ch¬_ãtch_ªd_add_fuÎ


	)

86 
AO_INLINE
 

87 
	$AO_shÜt_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

89 
»suÉ
;

91 
__asm__
 
	`__vŞ©e__
 ("lock; xaddw %0, %1" :

92 "ô" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

94  
»suÉ
;

95 
	}
}

97 
	#AO_HAVE_shÜt_ãtch_ªd_add_fuÎ


	)

100 
AO_INLINE
 

101 
	$AO_Ü_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

103 
__asm__
 
	`__vŞ©e__
 ("lock; orl %1, %0" :

104 "=m" (*
p
è: "r" (
šü
), "m" (*p) : "memory");

105 
	}
}

107 
	#AO_HAVE_Ü_fuÎ


	)

109 
AO_INLINE
 
AO_TS_VAL_t


110 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

112 
Şdv®
;

114 
__asm__
 
	`__vŞ©e__
("xchgb %0, %1"

115 : "=q"(
Şdv®
), "=m"(*
addr
)

116 : "0"(0xff), "m"(*
addr
) : "memory");

117  (
AO_TS_VAL_t
)
Şdv®
;

118 
	}
}

120 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

123 
AO_INLINE
 

124 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

126 #ifdeà
AO_USE_SYNC_CAS_BUILTIN


127  ()
	`__sync_boŞ_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

129 
»suÉ
;

130 
__asm__
 
	`__vŞ©e__
("lock; cmpxchgl %3, %0; setz %1"

131 : "=m" (*
addr
), "÷" (
»suÉ
)

132 : "m" (*
addr
), "r" (
Ãw_v®
), "a" (
Şd
) : "memory");

133  ()
»suÉ
;

135 
	}
}

137 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

141 
AO_INLINE
 

142 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

143 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

144 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

146 
»suÉ
;

147 #ià
__PIC__


151 
__asm__
 
	`__vŞ©e__
("pushl %%ebx;"

155 : "=m"(*
addr
), "÷"(
»suÉ
)

156 : "m"(*
addr
), "d" (
Şd_v®2
), "a" (
Şd_v®1
),

157 "c" (
Ãw_v®2
), "m" (
Ãw_v®1
) : "memory");

163 
__asm__
 
	`__vŞ©e__
("lock; cmpxchg8b %0; setz %1;"

164 : "=m"(*
addr
), "÷"(
»suÉ
)

165 : "m"(*
addr
), "d" (
Şd_v®2
), "a" (
Şd_v®1
),

166 "c" (
Ãw_v®2
), "b" (
Ãw_v®1
) : "memory");

168  (è
»suÉ
;

169 
	}
}

171 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

173 
	~"ao_t_is_št.h
"

	@atomic_ops/x86_64.h

19 
	~"®igÃd_©omic_lßd_¡Üe.h
"

28 
	~"Üd”ed_exû±_wr.h
"

30 
	~"‹¡_ªd_£t_t_is_ch¬.h
"

32 
	~"¡ªd¬d_ao_doubË_t.h
"

34 
AO_INLINE
 

35 
	$AO_nİ_fuÎ
()

38 
__asm__
 
	`__vŞ©e__
("mfence" : : : "memory");

39 
	}
}

41 
	#AO_HAVE_nİ_fuÎ


	)

46 
AO_INLINE
 
AO_t


47 
	$AO_ãtch_ªd_add_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

49 
AO_t
 
»suÉ
;

51 
__asm__
 
	`__vŞ©e__
 ("lock; xaddq %0, %1" :

52 "ô" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

54  
»suÉ
;

55 
	}
}

57 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

59 
AO_INLINE
 

60 
	$AO_ch¬_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

62 
»suÉ
;

64 
__asm__
 
	`__vŞ©e__
 ("lock; xaddb %0, %1" :

65 "=q" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

67  
»suÉ
;

68 
	}
}

70 
	#AO_HAVE_ch¬_ãtch_ªd_add_fuÎ


	)

72 
AO_INLINE
 

73 
	$AO_shÜt_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

75 
»suÉ
;

77 
__asm__
 
	`__vŞ©e__
 ("lock; xaddw %0, %1" :

78 "ô" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

80  
»suÉ
;

81 
	}
}

83 
	#AO_HAVE_shÜt_ãtch_ªd_add_fuÎ


	)

85 
AO_INLINE
 

86 
	$AO_št_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

88 
»suÉ
;

90 
__asm__
 
	`__vŞ©e__
 ("lock; xaddl %0, %1" :

91 "ô" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

93  
»suÉ
;

94 
	}
}

96 
	#AO_HAVE_št_ãtch_ªd_add_fuÎ


	)

98 
AO_INLINE
 

99 
	$AO_Ü_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

101 
__asm__
 
	`__vŞ©e__
 ("lock; orq %1, %0" :

102 "=m" (*
p
è: "r" (
šü
), "m" (*p) : "memory");

103 
	}
}

105 
	#AO_HAVE_Ü_fuÎ


	)

107 
AO_INLINE
 
AO_TS_VAL_t


108 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

110 
Şdv®
;

112 
__asm__
 
	`__vŞ©e__
("xchgb %0, %1"

113 : "=q"(
Şdv®
), "=m"(*
addr
)

114 : "0"(0xff), "m"(*
addr
) : "memory");

115  (
AO_TS_VAL_t
)
Şdv®
;

116 
	}
}

118 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

121 
AO_INLINE
 

122 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

124 #ifdeà
AO_USE_SYNC_CAS_BUILTIN


125  ()
	`__sync_boŞ_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

127 
»suÉ
;

128 
__asm__
 
	`__vŞ©e__
("lock; cmpxchgq %3, %0; setz %1"

129 : "=m" (*
addr
), "÷" (
»suÉ
)

130 : "m" (*
addr
), "r" (
Ãw_v®
), "a" (
Şd
) : "memory");

131  (è
»suÉ
;

133 
	}
}

135 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

137 #ifdeà
AO_CMPXCHG16B_AVAILABLE


147 
AO_INLINE
 

148 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

149 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

150 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

152 
»suÉ
;

153 
__asm__
 
	`__vŞ©e__
("lock; cmpxchg16b %0; setz %1"

154 : "=m"(*
addr
), "÷"(
»suÉ
)

155 : "m"(*
addr
), "d" (
Şd_v®2
), "a" (
Şd_v®1
),

156 "c" (
Ãw_v®2
), "b" (
Ãw_v®1
) : "memory");

157  (è
»suÉ
;

158 
	}
}

159 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

165 #ifdeà
AO_WEAK_DOUBLE_CAS_EMULATION


166 
AO_com·»_doubË_ªd_sw­_doubË_emuÏtiÚ
(vŞ©
AO_doubË_t
 *
addr
,

167 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

168 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
);

170 
AO_INLINE
 

171 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

172 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

173 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

175  
	`AO_com·»_doubË_ªd_sw­_doubË_emuÏtiÚ
(
addr
,

176 
Şd_v®1
, 
Şd_v®2
,

177 
Ãw_v®1
, 
Ãw_v®2
);

178 
	}
}

179 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

	@hashtables/lockbased-ht/hashtable-lock.c

27 
	~"hashbË-lock.h
"

28 
	~<immšŒš.h
>

30 
	gmaxh’gth
;

32 
	$ht_d–‘e
(
ht_št£t_t
 *
£t
) {

33 
node_l_t
 *
node
, *
Ãxt
;

34 
i
;

36 
i
=0; i < 
maxh’gth
; i++) {

37 
node
 = 
£t
->
buck‘s
[
i
]->
h—d
;

38 
node
 !ğ
NULL
) {

39 
Ãxt
 = 
node
->next;

40 
	`ä“
(
node
);

41 
node
 = 
Ãxt
;

43 
	`ä“
(
£t
->
buck‘s
[
i
]);

45 
	`ä“
(
£t
);

46 
	}
}

48 
	$ht_size
(
ht_št£t_t
 *
£t
) {

49 
size
 = 0;

50 
node_l_t
 *
node
;

51 
i
;

53 
i
=0; i < 
maxh’gth
; i++) {

54 
node
 = 
£t
->
buck‘s
[
i
]->
h—d
->
Ãxt
;

55 
node
->
Ãxt
) {

56 
size
++;

57 
node
 =‚ode->
Ãxt
;

60  
size
;

61 
	}
}

63 
	$æoÜ_log_2
(
n
) {

64 
pos
 = 0;

65 
	`´štf
("À»suÉ = %d\n", 
n
);

66 ià(
n
 >ğ1<<16è{‚ >>ğ16; 
pos
 += 16; }

67 ià(
n
 >ğ1<< 8è{‚ >>ğ8; 
pos
 += 8; }

68 ià(
n
 >ğ1<< 4è{‚ >>ğ4; 
pos
 += 4; }

69 ià(
n
 >ğ1<< 2è{‚ >>ğ2; 
pos
 += 2; }

70 ià(
n
 >ğ1<< 1è{ 
pos
 += 1; }

71 
	`´štf
("æoÜ„esuÉ = %d\n", 
pos
);

72  ((
n
 =ğ0è? (-1è: 
pos
);

73 
	}
}

75 
ht_št£t_t
 *
	$ht_Ãw
() {

76 
ht_št£t_t
 *
£t
;

77 
i
;

79 ià((
£t
 = (
ht_št£t_t
 *)
	`m®loc
((ht_št£t_t))è=ğ
NULL
) {

80 
	`³¼Ü
("malloc");

81 
	`ex™
(1);

83 
i
=0; i < 
maxh’gth
; i++) {

84 
£t
->
buck‘s
[
i
] = 
	`£t_Ãw_l
();

86  
£t
;

87 
	}
}

89 
	$ht_cÚšs
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

90 
addr
;

93 
addr
 = 
v®
 % 
maxh’gth
;

94  
	`£t_cÚšs_l
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

95 
	}
}

97 
	$ht_add
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

98 
addr
, 
»suÉ
;

101 
addr
 = 
v®
 % 
maxh’gth
;

102 
»suÉ
 = 
	`£t_add_l
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

103  
»suÉ
;

104 
	}
}

106 
	$ht_»move
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

107 
addr
, 
»suÉ
;

110 
addr
 = 
v®
 % 
maxh’gth
;

111 
»suÉ
 = 
	`£t_»move_l
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

113  
»suÉ
;

114 
	}
}

120 
	$ht_move
(
ht_št£t_t
 *
£t
, 
v®1
, 
v®2
, 
Œª§ùiÚ®
) {

121 
node_l_t
 *
´ed1
, *
cu¼1
, *
cu¼2
, *
´ed2
, *
Ãwnode
;

122 
addr1
, 
addr2
, 
»suÉ
 = 0;

124 #ifdeà
DEBUG


125 
	`´štf
("++> ht_move(%d, %d)\n", (è
v®1
, (è
v®2
);

128 ià(
v®1
 =ğ
v®2
)  0;

131 
addr1
 = 
v®1
 % 
maxh’gth
;

132 
´ed1
 = 
£t
->
buck‘s
[
addr1
]->
h—d
;

133 
cu¼1
 = 
´ed1
->
Ãxt
;

134 
cu¼1
->
v®
 < 
v®1
) {

135 
´ed1
 = 
cu¼1
;

136 
cu¼1
 = cu¼1->
Ãxt
;

139 
addr2
 = 
v®2
 % 
maxh’gth
;

140 
´ed2
 = 
£t
->
buck‘s
[
addr2
]->
h—d
;

141 
cu¼2
 = 
´ed2
->
Ãxt
;

142 
cu¼2
->
v®
 < 
v®2
) {

143 
´ed2
 = 
cu¼2
;

144 
cu¼2
 = cu¼2->
Ãxt
;

147 ià(
´ed1
->
v®
 =ğ
´ed2
->v® || 
cu¼1
->val ==…red2->val ||

148 
cu¼2
->
v®
 =ğ
´ed1
->v® || 
cu¼1
->val == curr2->val)

151 ià(
addr1
 < 
addr2
 || (addr1 =ğaddr2 && 
v®1
 < 
v®2
)) {

152 
	`LOCK
(&
´ed1
->
lock
);

153 
	`LOCK
(&
cu¼1
->
lock
);

154 
	`LOCK
(&
´ed2
->
lock
);

155 
	`LOCK
(&
cu¼2
->
lock
);

157 
	`LOCK
(&
´ed2
->
lock
);

158 
	`LOCK
(&
cu¼2
->
lock
);

159 
	`LOCK
(&
´ed1
->
lock
);

160 
	`LOCK
(&
cu¼1
->
lock
);

163 
»suÉ
 = (
	`·r£_v®id©e
(
´ed1
, 
cu¼1
è&& (
v®1
 =ğcu¼1->
v®
) &&

164 
	`·r£_v®id©e
(
´ed2
, 
cu¼2
è&& (cu¼2->
v®
 !ğ
v®2
));

165 ià(
»suÉ
) {

166 
	`£t_m¬k
((è
cu¼1
);

167 
´ed1
->
Ãxt
 = 
cu¼1
->next;

168 
Ãwnode
 = 
	`Ãw_node_l
(
v®2
, 
cu¼2
, 0);

169 
´ed2
->
Ãxt
 = 
Ãwnode
;

172 
	`UNLOCK
(&
´ed2
->
lock
);

173 
	`UNLOCK
(&
´ed1
->
lock
);

174 
	`UNLOCK
(&
cu¼2
->
lock
);

175 
	`UNLOCK
(&
cu¼1
->
lock
);

177  
»suÉ
;

178 
	}
}

184 
	$ht_¢­shÙ_unmovabË
(
ht_št£t_t
 *
£t
, 
Œª§ùiÚ®
) {

185 
node_l_t
 *
Ãxt
, *
cu¼
;

186 
i
;

187 
sum
 = 0;

189 
i
=0; i < 
maxh’gth
; i++) {

190 
cu¼
 = 
£t
->
buck‘s
[
i
]->
h—d
;

191 
Ãxt
 = 
£t
->
buck‘s
[
i
]->
h—d
->next;

194 
	`LOCK
(&
Ãxt
->
lock
);

196 
Ãxt
->next) {

197 
	`UNLOCK
(&
Ãxt
->
lock
);

198 
cu¼
 = 
Ãxt
;

199 ià(!
	`is_m¬ked_»f
((è
Ãxt
)è
sum
 +ğÃxt->
v®
;

200 
Ãxt
 = 
cu¼
->next;

201 
	`LOCK
(&
Ãxt
->
lock
);

203 
	`UNLOCK
(&
Ãxt
->
lock
);

206  
sum
;

207 
	}
}

213 
	$ht_¢­shÙ
(
ht_št£t_t
 *
£t
, 
Œª§ùiÚ®
) {

214 
node_l_t
 *
Ãxt
, *
cu¼
;

215 
i
;

216 
sum
 = 0;

218 
m
 = 
maxh’gth
;

220 
i
=0; i < 
m
; i++) {

222 
	`LOCK
(&
£t
->
buck‘s
[
i
]->
h—d
->
lock
);

223 
	`LOCK
(&
£t
->
buck‘s
[
i
]->
h—d
->
Ãxt
->
lock
);

224 
cu¼
 = 
£t
->
buck‘s
[
i
]->
h—d
;

225 
Ãxt
 = 
£t
->
buck‘s
[
i
]->
h—d
->next;

226 } !
	`·r£_v®id©e
(
cu¼
, 
Ãxt
));

228 
Ãxt
->next) {

230 
	`LOCK
(&
Ãxt
->Ãxt->
lock
);

231 
cu¼
 = 
Ãxt
;

232 
Ãxt
 = 
cu¼
->next;

233 ià(
	`·r£_v®id©e
(
cu¼
, 
Ãxt
)) {

234 ià(!
	`is_m¬ked_»f
((è
Ãxt
)) {

235 
sum
 +ğ
cu¼
->
v®
;

243 
i
=0; i < 
m
; i++) {

244 
cu¼
 = 
£t
->
buck‘s
[
i
]->
h—d
;

245 
Ãxt
 = 
£t
->
buck‘s
[
i
]->
h—d
->next;

247 
	`UNLOCK
(&
cu¼
->
lock
);

248 
	`UNLOCK
(&
Ãxt
->
lock
);

249 
Ãxt
->next) {

250 
cu¼
 = 
Ãxt
;

251 
Ãxt
 = 
cu¼
->next;

252 
	`UNLOCK
(&
Ãxt
->
lock
);

257 
	}
}

	@hashtables/lockbased-ht/hashtable-lock.h

27 
	~"../lškedli¡s/Ïzy-li¡/št£t.h
"

29 
	#DEFAULT_MOVE
 0

	)

30 
	#DEFAULT_SNAPSHOT
 0

	)

31 
	#DEFAULT_LOAD
 1

	)

32 
	#DEFAULT_ELASTICITY
 2

	)

33 
	#DEFAULT_ALTERNATE
 0

	)

34 
	#DEFAULT_EFFECTIVE
 1

	)

36 
	#MAXHTLENGTH
 65536

	)

39 
maxh’gth
;

45 
	sht_št£t
 {

46 
št£t_l_t
 *
	mbuck‘s
[
MAXHTLENGTH
];

47 } 
	tht_št£t_t
;

49 
ht_d–‘e
(
ht_št£t_t
 *
£t
);

50 
ht_size
(
ht_št£t_t
 *
£t
);

51 
æoÜ_log_2
(
n
);

52 
ht_št£t_t
 *
ht_Ãw
();

53 
ht_cÚšs
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
);

54 
ht_add
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
);

55 
ht_»move
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
);

60 
ht_move
(
ht_št£t_t
 *
£t
, 
v®1
, 
v®2
, 
Œª§ùiÚ®
);

66 
ht_¢­shÙ
(
ht_št£t_t
 *
£t
, 
Œª§ùiÚ®
);

	@hashtables/lockbased-ht/test.c

24 
	~"hashbË-lock.h
"

26 
	gmaxh’gth
;

27 
	gg_nb_th»ad
;

29 
	sb¬r›r
 {

30 
±h»ad_cÚd_t
 
	mcom¶‘e
;

31 
±h»ad_mu‹x_t
 
	mmu‹x
;

32 
	mcouÁ
;

33 
	müossšg
;

34 } 
	tb¬r›r_t
;

36 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

38 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

39 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

40 
b
->
couÁ
 = 
n
;

41 
b
->
üossšg
 = 0;

42 
	}
}

44 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

46 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

48 
b
->
üossšg
++;

50 ià(
b
->
üossšg
 < b->
couÁ
) {

51 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

53 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

55 
b
->
üossšg
 = 0;

57 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

58 
	}
}

69 
šlše
 
	$¿nd_¿nge
(
r
) {

70 
m
 = 
RAND_MAX
;

71 
d
, 
v
 = 0;

74 
d
 = (
m
 > 
r
 ?„ : m);

75 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

76 
r
 -ğ
m
;

77 } 
r
 > 0);

78  
v
;

79 
	}
}

80 
¿nd_¿nge
(
r
);

83 
šlše
 
	$¿nd_¿nge_»
(*
£ed
, 
r
) {

84 
m
 = 
RAND_MAX
;

85 
d
, 
v
 = 0;

88 
d
 = (
m
 > 
r
 ?„ : m);

89 
v
 +ğ1 + ()(
d
 * (()
	`¿nd_r
(
£ed
)/(()(
m
)+1.0)));

90 
r
 -ğ
m
;

91 } 
r
 > 0);

92  
v
;

93 
	}
}

94 
¿nd_¿nge_»
(*
£ed
, 
r
);

97 
	sth»ad_d©a
 {

98 
v®_t
 
	mfœ¡
;

99 
	m¿nge
;

100 
	mupd©e
;

101 
	mmove
;

102 
	m¢­shÙ
;

103 
	mun™_tx
;

104 
	m®‹º©e
;

105 
	mefãùive
;

106 
	mnb_add
;

107 
	mnb_added
;

108 
	mnb_»move
;

109 
	mnb_»moved
;

110 
	mnb_cÚšs
;

112 
	mlßd_çùÜ
;

113 
	mnb_move
;

114 
	mnb_moved
;

115 
	mnb_¢­shÙ
;

116 
	mnb_¢­shÙed
;

118 
	mnb_found
;

119 
	mnb_abÜts
;

120 
	mnb_abÜts_locked_»ad
;

121 
	mnb_abÜts_locked_wr™e
;

122 
	mnb_abÜts_v®id©e_»ad
;

123 
	mnb_abÜts_v®id©e_wr™e
;

124 
	mnb_abÜts_v®id©e_comm™
;

125 
	mnb_abÜts_šv®id_memÜy
;

126 
	mmax_»Œ›s
;

127 
	m£ed
;

128 
ht_št£t_t
 *
	m£t
;

129 
b¬r›r_t
 *
	mb¬r›r
;

130 } 
	tth»ad_d©a_t
;

133 *
	$‹¡
(*
d©a
) {

134 
v®_t
 
v®
 = 0;

135 
v®2
, 
numtx
, 
r
, 
Ï¡
 = -1;

136 
uÃxt
, 
mÃxt
, 
úext
;

138 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

141 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

143 
d
->
nb_move
 = 0;

144 
d
->
nb_moved
 = 0;

145 
d
->
nb_add
 = 0;

146 
d
->
nb_added
 = 0;

147 
d
->
nb_»moved
 = 0;

148 
d
->
nb_¢­shÙed
 = 0;

149 
d
->
nb_¢­shÙ
 = 0;

150 
d
->
nb_cÚšs
 = 0;

151 
d
->
nb_found
 = 0;

154 
r
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, 100) - 1;

155 
uÃxt
 = (
r
 < 
d
->
upd©e
);

156 
mÃxt
 = (
r
 < 
d
->
move
);

157 
úext
 = (
r
 >ğ
d
->
upd©e
 + d->
¢­shÙ
);

159 
num_add
 = 0;

160 #ifdeà
ICC


161 
num_add
 < ()(1000/
g_nb_th»ad
)){

163 
num_add
 < ()(1000/
g_nb_th»ad
)) {

165 
num_add
++;

166 ià(
uÃxt
) {

168 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

169 ià(
	`ht_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

170 
d
->
nb_added
++;

171 
Ï¡
 = 
v®
;

173 
d
->
nb_add
++;

175 ià(
mÃxt
) {

177 ià(
Ï¡
 =ğ-1è
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

178 
v®2
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

179 ià(
	`ht_move
(
d
->
£t
, 
v®
, 
v®2
, 
TRANSACTIONAL
)) {

180 
d
->
nb_moved
++;

181 
Ï¡
 = -1;

183 
d
->
nb_move
++;

185 } ià(
Ï¡
 < 0) {

187 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

188 ià(
	`ht_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

189 
d
->
nb_added
++;

190 
Ï¡
 = 
v®
;

192 
d
->
nb_add
++;

196 ià(
d
->
®‹º©e
) {

197 ià(
	`ht_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
)) {

198 
d
->
nb_»moved
++;

199 
Ï¡
 = -1;

203 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

205 ià(
	`ht_»move
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

206 
d
->
nb_»moved
++;

208 
Ï¡
 = -1;

211 
d
->
nb_»move
++;

219 ià(
úext
) {

221 ià(
d
->
®‹º©e
) {

222 ià(
d
->
upd©e
 == 0) {

223 ià(
Ï¡
 < 0) {

224 
v®
 = 
d
->
fœ¡
;

225 
Ï¡
 = 
v®
;

227 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

228 
Ï¡
 = -1;

231 ià(
Ï¡
 < 0) {

232 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

235 
v®
 = 
Ï¡
;

238 } 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

240 ià(
	`ht_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

241 
d
->
nb_found
++;

242 
d
->
nb_cÚšs
++;

246 ià(
	`ht_¢­shÙ
(
d
->
£t
, 
TRANSACTIONAL
))

247 
d
->
nb_¢­shÙed
++;

248 
d
->
nb_¢­shÙ
++;

253 
uÃxt
 = 1;

256 ià(
d
->
efãùive
) {

257 
numtx
 = 
d
->
nb_cÚšs
 + d->
nb_add
 + d->
nb_»move
 + d->
nb_move
 + d->
nb_¢­shÙ
;

258 
uÃxt
 = ((100.0 * (
d
->
nb_added
 + d->
nb_»moved
 + d->
nb_moved
)è< (d->
upd©e
 * 
numtx
));

259 
mÃxt
 = ((100.0 * 
d
->
nb_moved
è< (d->
move
 * 
numtx
));

260 
úext
 = !((100.0 * 
d
->
nb_¢­shÙed
è< (d->
¢­shÙ
 * 
numtx
));

262 
r
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, 100) - 1;

263 
uÃxt
 = (
r
 < 
d
->
upd©e
);

264 
mÃxt
 = (
r
 < 
d
->
move
);

265 
úext
 = (
r
 >ğ
d
->
upd©e
 + d->
¢­shÙ
);

268 #ifdeà
ICC


274  
NULL
;

277 
	`maš
(
¬gc
, **
¬gv
)

279 
İtiÚ
 
lÚg_İtiÚs
[] = {

281 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

282 {"®‹º©e", 
no_¬gum’t
, 
NULL
, 'A'},

283 {"efãùive", 
»quœed_¬gum’t
, 
NULL
, 'f'},

284 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

285 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

286 {"num-th»ads", 
»quœed_¬gum’t
, 
NULL
, 't'},

287 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

288 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 'S'},

289 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

290 {"move-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'a'},

291 {"¢­shÙ-¿‹", 
»quœed_¬gum’t
, 
NULL
, 's'},

292 {"lock-®g", 
»quœed_¬gum’t
, 
NULL
, 'x'},

293 {
NULL
, 0, NULL, 0}

296 
ht_št£t_t
 *
£t
;

297 
i
, 
c
, 
size
;

298 
v®_t
 
Ï¡
 = 0;

299 
v®_t
 
v®
 = 0;

300 
»ads
, 
efä—ds
, 
upd©es
, 
effupds
, 
moves
, 
moved
, 
¢­shÙs
,

301 
¢­shÙed
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

302 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

303 
abÜts_šv®id_memÜy
, 
max_»Œ›s
;

304 
th»ad_d©a_t
 *
d©a
;

305 
±h»ad_t
 *
th»ads
;

306 
±h»ad_©Œ_t
 
©Œ
;

307 
b¬r›r_t
 
b¬r›r
;

308 
timev®
 
¡¬t
, 
’d
;

309 
time¥ec
 
timeout
;

310 
du¿tiÚ
 = 
DEFAULT_DURATION
;

311 
š™Ÿl
 = 
DEFAULT_INITIAL
;

312 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

313 
g_nb_th»ad
 = 
nb_th»ads
;

314 
¿nge
 = 
DEFAULT_RANGE
;

315 
£ed
 = 
DEFAULT_SEED
;

316 
upd©e
 = 
DEFAULT_UPDATE
;

317 
lßd_çùÜ
 = 
DEFAULT_LOAD
;

318 
move
 = 
DEFAULT_MOVE
;

319 
¢­shÙ
 = 
DEFAULT_SNAPSHOT
;

320 
un™_tx
 = 
DEFAULT_ELASTICITY
;

321 
®‹º©e
 = 
DEFAULT_ALTERNATE
;

322 
efãùive
 = 
DEFAULT_EFFECTIVE
;

323 
sig£t_t
 
block_£t
;

325 
i
 = 0;

326 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hAf:d:i:t:r:S:u:a:s:l:x:", 
lÚg_İtiÚs
, &
i
);

328 if(
c
 == -1)

331 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

332 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

334 
c
) {

339 
	`´štf
("intset -- STM stressest "

351 " upd©tx mu¡ƒfãùiv–y wr™(0ñrŸl, 1ófãùive, deçuÉ=" 
	`XSTR
(
DEFAULT_EFFECTIVE
) ")\n"

353 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

355 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

357 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

359 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

361 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

363 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

365 " P”ûÁagoàmovŒª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_MOVE
) ")\n"

367 " P”ûÁagoà¢­shÙ¿n§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_SNAPSHOT
) ")\n"

369 " R©iØoàkey ov” buck‘ (deçuÉ=" 
	`XSTR
(
DEFAULT_LOAD
) ")\n"

380 
	`ex™
(0);

382 
®‹º©e
 = 1;

385 
efãùive
 = 
	`©oi
(
İrg
);

388 
du¿tiÚ
 = 
	`©oi
(
İrg
);

391 
š™Ÿl
 = 
	`©oi
(
İrg
);

394 
nb_th»ads
 = 
	`©oi
(
İrg
);

395 
g_nb_th»ad
 = 
nb_th»ads
;

398 
¿nge
 = 
	`©Ş
(
İrg
);

401 
£ed
 = 
	`©oi
(
İrg
);

404 
upd©e
 = 
	`©oi
(
İrg
);

407 
move
 = 
	`©oi
(
İrg
);

410 
¢­shÙ
 = 
	`©oi
(
İrg
);

413 
lßd_çùÜ
 = 
	`©oi
(
İrg
);

416 
un™_tx
 = 
	`©oi
(
İrg
);

419 
	`´štf
("Use -h or --help for help\n");

420 
	`ex™
(0);

422 
	`ex™
(1);

426 
	`as£¹
(
du¿tiÚ
 >= 0);

427 
	`as£¹
(
š™Ÿl
 >= 0);

428 
	`as£¹
(
nb_th»ads
 > 0);

429 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

430 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

431 
	`as£¹
(
move
 >ğ0 && mov<ğ
upd©e
);

432 
	`as£¹
(
¢­shÙ
 >ğ0 && sÇpshÙ <ğ(100-
upd©e
));

433 
	`as£¹
(
lßd_çùÜ
 >= 1);

435 
	`´štf
("Setype : hashable\n");

436 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

437 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

438 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

439 
	`´štf
("V®u¿ng : %ld\n", 
¿nge
);

440 
	`´štf
("S“d : %d\n", 
£ed
);

441 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

442 
	`´štf
("Lßd faùÜ : %d\n", 
lßd_çùÜ
);

443 
	`´štf
("Mov¿‹ : %d\n", 
move
);

444 
	`´štf
("SÇpshÙ„©e: %d\n", 
¢­shÙ
);

445 
	`´štf
("Lock‡lg. : %d\n", 
un™_tx
);

446 
	`´štf
("AÉ”Ç‹ : %d\n", 
®‹º©e
);

447 
	`´štf
("Efãùiv : %d\n", 
efãùive
);

448 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

452 ()(
ušŒ_t
));

454 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

455 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

457 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

458 
	`³¼Ü
("malloc");

459 
	`ex™
(1);

461 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

462 
	`³¼Ü
("malloc");

463 
	`ex™
(1);

466 ià(
£ed
 == 0)

467 
	`¤ªd
(()
	`time
(0));

469 
	`¤ªd
(
£ed
);

471 
maxh’gth
 = (è
š™Ÿl
 / 
lßd_çùÜ
;

472 
£t
 = 
	`ht_Ãw
();

474 
¡İ
 = 0;

477 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

478 
i
 = 0;

480 
i
 < 
š™Ÿl
) {

481 
v®
 = (
	`¿nd
(è% 
¿nge
) + 1;

482 ià(
	`ht_add
(
£t
, 
v®
, 0)) {

483 
Ï¡
 = 
v®
;

484 
i
++;

487 
size
 = 
	`ht_size
(
£t
);

488 
	`´štf
("S‘ siz : %d\n", 
size
);

489 
	`´štf
("Buck‘‡mouÁ: %d\n", 
maxh’gth
);

490 
	`´štf
("Lßd : %d\n", 
lßd_çùÜ
);

493 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

494 
	`±h»ad_©Œ_š™
(&
©Œ
);

495 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

496 
i
 = 0; i < 
nb_th»ads
; i++) {

497 
	`´štf
("C»©šgh»ad %d\n", 
i
);

498 
d©a
[
i
].
fœ¡
 = 
Ï¡
;

499 
d©a
[
i
].
¿nge
 =„ange;

500 
d©a
[
i
].
upd©e
 = update;

501 
d©a
[
i
].
lßd_çùÜ
 =†oad_factor;

502 
d©a
[
i
].
move
 = move;

503 
d©a
[
i
].
¢­shÙ
 = snapshot;

504 
d©a
[
i
].
un™_tx
 = unit_tx;

505 
d©a
[
i
].
®‹º©e
 =‡lternate;

506 
d©a
[
i
].
efãùive
 =ƒffective;

507 
d©a
[
i
].
nb_add
 = 0;

508 
d©a
[
i
].
nb_added
 = 0;

509 
d©a
[
i
].
nb_»move
 = 0;

510 
d©a
[
i
].
nb_»moved
 = 0;

511 
d©a
[
i
].
nb_move
 = 0;

512 
d©a
[
i
].
nb_moved
 = 0;

513 
d©a
[
i
].
nb_¢­shÙ
 = 0;

514 
d©a
[
i
].
nb_¢­shÙed
 = 0;

515 
d©a
[
i
].
nb_cÚšs
 = 0;

516 
d©a
[
i
].
nb_found
 = 0;

517 
d©a
[
i
].
nb_abÜts
 = 0;

518 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

519 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

520 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

521 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

522 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

523 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

524 
d©a
[
i
].
max_»Œ›s
 = 0;

525 
d©a
[
i
].
£ed
 = 
	`¿nd
();

526 
d©a
[
i
].
£t
 = set;

527 
d©a
[
i
].
b¬r›r
 = &barrier;

528 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

529 
	`årštf
(
¡d”r
, "Error creatinghread\n");

530 
	`ex™
(1);

533 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

536 
	`b¬r›r_üoss
(&
b¬r›r
);

538 
	`´štf
("STARTING...\n");

539 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

540 ià(
du¿tiÚ
 > 0) {

541 
	`Çno¦“p
(&
timeout
, 
NULL
);

546 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

547 
	`g‘timeofday
(&
’d
, 
NULL
);

548 
	`´štf
("STOPPING...\n");

551 
i
 = 0; i < 
nb_th»ads
; i++) {

552 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

553 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

554 
	`ex™
(1);

558 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

559 
abÜts
 = 0;

560 
abÜts_locked_»ad
 = 0;

561 
abÜts_locked_wr™e
 = 0;

562 
abÜts_v®id©e_»ad
 = 0;

563 
abÜts_v®id©e_wr™e
 = 0;

564 
abÜts_v®id©e_comm™
 = 0;

565 
abÜts_šv®id_memÜy
 = 0;

566 
»ads
 = 0;

567 
efä—ds
 = 0;

568 
upd©es
 = 0;

569 
effupds
 = 0;

570 
moves
 = 0;

571 
moved
 = 0;

572 
¢­shÙs
 = 0;

573 
¢­shÙed
 = 0;

574 
max_»Œ›s
 = 0;

575 
i
 = 0; i < 
nb_th»ads
; i++) {

576 
	`´štf
("Th»ad %d\n", 
i
);

577 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

578 
	`´štf
(" #added : %lu\n", 
d©a
[
i
].
nb_added
);

579 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

580 
	`´štf
(" #»moved : %lu\n", 
d©a
[
i
].
nb_»moved
);

581 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

582 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

583 
	`´štf
(" #mov : %lu\n", 
d©a
[
i
].
nb_move
);

584 
	`´štf
(" #moved : %lu\n", 
d©a
[
i
].
nb_moved
);

585 
	`´štf
(" #¢­shÙ : %lu\n", 
d©a
[
i
].
nb_¢­shÙ
);

586 
	`´štf
(" #¢­shÙed : %lu\n", 
d©a
[
i
].
nb_¢­shÙed
);

587 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

588 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

589 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

590 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

591 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

592 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

593 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

594 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

595 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

596 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

597 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

598 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

599 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

600 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

601 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

602 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

603 
efä—ds
 +ğ
d©a
[
i
].
nb_cÚšs
 +

604 (
d©a
[
i
].
nb_add
 - d©a[i].
nb_added
) +

605 (
d©a
[
i
].
nb_»move
 - d©a[i].
nb_»moved
) +

606 (
d©a
[
i
].
nb_move
 - d©a[i].
nb_moved
) +

607 
d©a
[
i
].
nb_¢­shÙed
;

608 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

609 
effupds
 +ğ
d©a
[
i
].
nb_»moved
 + d©a[i].
nb_added
 + d©a[i].
nb_moved
;

610 
moves
 +ğ
d©a
[
i
].
nb_move
;

611 
moved
 +ğ
d©a
[
i
].
nb_moved
;

612 
¢­shÙs
 +ğ
d©a
[
i
].
nb_¢­shÙ
;

613 
¢­shÙed
 +ğ
d©a
[
i
].
nb_¢­shÙed
;

614 
size
 +ğ
d©a
[
i
].
nb_added
 - d©a[i].
nb_»moved
;

615 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

616 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

618 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`ht_size
(
£t
), 
size
);

619 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

620 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
 + 
moves
 + 
¢­shÙs
 , (»ad + upd©e + move + sÇpshÙsè* 1000.0 / 
du¿tiÚ
);

622 
	`´štf
("#readxs : ");

623 ià(
efãùive
) {

624 
	`´štf
("%lu (%à/ s)\n", 
efä—ds
,ƒfä—d * 1000.0 / 
du¿tiÚ
);

625 
	`´štf
(" #cÚš  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

626 } 
	`´štf
("%lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

628 
	`´štf
("#eff. upd„©e: %à\n", 100.0 * 
effupds
 / (effupd + 
efä—ds
));

630 
	`´štf
("#updatexs : ");

631 ià(
efãùive
) {

632 
	`´štf
("%lu (%à/ s)\n", 
effupds
,ƒffupd * 1000.0 / 
du¿tiÚ
);

633 
	`´štf
(" #updrŸl : %lu (%à/ s)\n", 
upd©es
, updates * 1000.0 /

634 
du¿tiÚ
);

635 } 
	`´štf
("%lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

637 
	`´štf
("#movtx  : %lu (%à/ s)\n", 
moves
, move * 1000.0 / 
du¿tiÚ
);

638 
	`´štf
(" #moved : %lu (%à/ s)\n", 
moved
, moved * 1000.0 / 
du¿tiÚ
);

639 
	`´štf
("#¢­shÙx : %lu (%à/ s)\n", 
¢­shÙs
, sÇpshÙ * 1000.0 / 
du¿tiÚ
);

640 
	`´štf
(" #¢­shÙed : %lu (%à/ s)\n", 
¢­shÙed
, sÇpshÙed * 1000.0 / 
du¿tiÚ
);

641 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

642 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

643 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

644 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

645 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

646 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

647 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

648 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

653 
	`ht_d–‘e
(
£t
);

655 
	`ä“
(
th»ads
);

656 
	`ä“
(
d©a
);

	@hashtables/lockfree-ht/hashtable.c

27 
	~"hashbË.h
"

29 
	$ht_d–‘e
(
ht_št£t_t
 *
£t
) {

30 
node_t
 *
node
, *
Ãxt
;

31 
i
;

33 
i
=0; i < 
maxh’gth
; i++) {

34 
node
 = 
£t
->
buck‘s
[
i
]->
h—d
;

35 
node
 !ğ
NULL
) {

36 
Ãxt
 = 
node
->next;

37 
	`ä“
(
node
);

38 
node
 = 
Ãxt
;

40 
	`ä“
(
£t
->
buck‘s
[
i
]);

42 
	`ä“
(
£t
->
buck‘s
);

43 
	`ä“
(
£t
);

44 
	}
}

46 
	$ht_size
(
ht_št£t_t
 *
£t
) {

47 
size
 = 0;

48 
node_t
 *
node
;

49 
i
;

51 
i
=0; i < 
maxh’gth
; i++) {

52 
node
 = 
£t
->
buck‘s
[
i
]->
h—d
->
Ãxt
;

53 
node
->
Ãxt
) {

54 
size
++;

55 
node
 =‚ode->
Ãxt
;

59  
size
;

60 
	}
}

62 
	$æoÜ_log_2
(
n
) {

63 
pos
 = 0;

64 
	`´štf
("À»suÉ = %d\n", 
n
);

65 ià(
n
 >ğ1<<16è{‚ >>ğ16; 
pos
 += 16; }

66 ià(
n
 >ğ1<< 8è{‚ >>ğ8; 
pos
 += 8; }

67 ià(
n
 >ğ1<< 4è{‚ >>ğ4; 
pos
 += 4; }

68 ià(
n
 >ğ1<< 2è{‚ >>ğ2; 
pos
 += 2; }

69 ià(
n
 >ğ1<< 1è{ 
pos
 += 1; }

70 
	`´štf
("æoÜ„esuÉ = %d\n", 
pos
);

71  ((
n
 =ğ0è? (-1è: 
pos
);

72 
	}
}

74 
ht_št£t_t
 *
	$ht_Ãw
() {

75 
ht_št£t_t
 *
£t
;

76 
i
;

78 ià((
£t
 = (
ht_št£t_t
 *)
	`m®loc
((ht_št£t_t))è=ğ
NULL
) {

79 
	`³¼Ü
("malloc");

80 
	`ex™
(1);

82 ià((
£t
->
buck‘s
 = (*)
	`m®loc
((
maxh’gth
 + 1)* (
št£t_t
 *))è=ğ
NULL
) {

83 
	`³¼Ü
("malloc");

84 
	`ex™
(1);

87 
i
=0; i < 
maxh’gth
; i++) {

88 
£t
->
buck‘s
[
i
] = 
	`£t_Ãw
();

90  
£t
;

91 
	}
}

	@hashtables/lockfree-ht/hashtable.h

24 
	~"../../lškedli¡s/lockä“-li¡/št£t.h
"

26 
	#DEFAULT_MOVE
 0

	)

27 
	#DEFAULT_SNAPSHOT
 0

	)

28 
	#DEFAULT_LOAD
 1

	)

29 
	#DEFAULT_ELASTICITY
 4

	)

30 
	#DEFAULT_ALTERNATE
 0

	)

31 
	#DEFAULT_EFFECTIVE
 1

	)

33 
	#MAXHTLENGTH
 65536

	)

36 
maxh’gth
;

39 #ifdeà
TLS


40 
__th»ad
 *
ºg_£ed
;

42 
±h»ad_key_t
 
ºg_£ed_key
;

45 
	sht_št£t
 {

46 
št£t_t
 **
	mbuck‘s
;

47 } 
	tht_št£t_t
;

49 
ht_d–‘e
(
ht_št£t_t
 *
£t
);

50 
ht_size
(
ht_št£t_t
 *
£t
);

51 
æoÜ_log_2
(
n
);

52 
ht_št£t_t
 *
ht_Ãw
();

	@hashtables/lockfree-ht/intset.c

24 
	~"št£t.h
"

26 
	$ht_cÚšs
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

27 
addr
;

29 
addr
 = 
v®
 % 
maxh’gth
;

30 ià(
Œª§ùiÚ®
 == 5)

31  
	`£t_cÚšs
(
£t
->
buck‘s
[
addr
], 
v®
, 4);

33  
	`£t_cÚšs
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

34 
	}
}

36 
	$ht_add
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

37 
addr
;

39 
addr
 = 
v®
 % 
maxh’gth
;

40 ià(
Œª§ùiÚ®
 == 5)

41  
	`£t_add
(
£t
->
buck‘s
[
addr
], 
v®
, 4);

43  
	`£t_add
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

44 
	}
}

46 
	$ht_»move
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

47 
addr
;

49 
addr
 = 
v®
 % 
maxh’gth
;

50 ià(
Œª§ùiÚ®
 == 5)

51  
	`£t_»move
(
£t
->
buck‘s
[
addr
], 
v®
, 4);

53  
	`£t_»move
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

54 
	}
}

64 
	$ht_move_Çive
(
ht_št£t_t
 *
£t
, 
v®1
, 
v®2
, 
Œª§ùiÚ®
) {

65 
»suÉ
 = 0;

67 #ifdeà
SEQUENTIAL


69 
addr1
, 
addr2
;

71 
addr1
 = 
v®1
 % 
maxh’gth
;

72 
addr2
 = 
v®2
 % 
maxh’gth
;

73 
»suÉ
 = (
	`£t_»move
(
£t
->
buck‘s
[
addr1
], 
v®1
, 
Œª§ùiÚ®
) &&

74 
	`£t_add
(
£t
->
buck‘s
[
addr2
], 
v®2
, 
Œª§ùiÚ®
));

76 #–ià
defšed
 
STM


78 
v
, 
addr1
, 
addr2
;

79 
node_t
 *
n
, *
´ev
, *
Ãxt
;

81 ià(
Œª§ùiÚ®
 > 1) {

83 
	`TX_START
(
EL
);

84 
addr1
 = 
v®1
 % 
maxh’gth
;

85 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

86 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

88 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

89 ià(
v
 >ğ
v®1
) ;

90 
´ev
 = 
Ãxt
;

91 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

93 ià(
v
 =ğ
v®1
) {

95 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

96 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

97 
	`FREE
(
Ãxt
, (
node_t
));

99 
addr2
 = 
v®2
 % 
maxh’gth
;

100 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

101 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

103 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

104 ià(
v
 >ğ
v®2
) ;

105 
´ev
 = 
Ãxt
;

106 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

108 ià(
v
 !ğ
v®2
) {

109 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®2
,‚ext, 
Œª§ùiÚ®
));

112 
»suÉ
 = 1;

113 } 
»suÉ
 = 0;

114 
TX_END
;

118 
	`TX_START
(
NL
);

119 
addr1
 = 
v®1
 % 
maxh’gth
;

120 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

121 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

123 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

124 ià(
v
 >ğ
v®1
) ;

125 
´ev
 = 
Ãxt
;

126 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

128 ià(
v
 =ğ
v®1
) {

130 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

131 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

132 
	`FREE
(
Ãxt
, (
node_t
));

134 
addr2
 = 
v®2
 % 
maxh’gth
;

135 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

136 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

138 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

139 ià(
v
 >ğ
v®2
) ;

140 
´ev
 = 
Ãxt
;

141 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

143 ià(
v
 !ğ
v®2
) {

144 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®2
,‚ext, 
Œª§ùiÚ®
));

147 
»suÉ
 = 1;

148 } 
»suÉ
 = 0;

149 
TX_END
;

153 #–ià
defšed
 
LOCKFREE


155 
	`´štf
("ht_snapshot: No other implementation of‡tomic snapshot is‡vailable\n");

156 
	`ex™
(1);

160  
»suÉ
;

161 
	}
}

168 
	$ht_move
(
ht_št£t_t
 *
£t
, 
v®1
, 
v®2
, 
Œª§ùiÚ®
) {

169 
»suÉ
 = 0;

171 #ifdeà
SEQUENTIAL


173 
addr1
, 
addr2
;

175 
addr1
 = 
v®1
 % 
maxh’gth
;

176 
addr2
 = 
v®2
 % 
maxh’gth
;

178 ià(
	`£t_»move
(
£t
->
buck‘s
[
addr1
], 
v®1
, 0))

179 
»suÉ
 = 1;

180 
	`£t_£q_add
(
£t
->
buck‘s
[
addr2
], 
v®2
, 0);

181  
»suÉ
;

183 #–ià
defšed
 
STM


185 
v
, 
addr1
, 
addr2
;

186 
node_t
 *
n
, *
´ev
, *
Ãxt
, *
´ev1
, *
Ãxt1
;

188 ià(
Œª§ùiÚ®
 > 1) {

190 
	`TX_START
(
EL
);

191 
»suÉ
 = 0;

192 
addr1
 = 
v®1
 % 
maxh’gth
;

193 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

194 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

196 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

197 ià(
v
 >ğ
v®1
) ;

198 
´ev
 = 
Ãxt
;

199 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

201 
´ev1
 = 
´ev
;

202 
Ãxt1
 = 
Ãxt
;

203 ià(
v
 =ğ
v®1
) {

205 
addr2
 = 
v®2
 % 
maxh’gth
;

206 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

207 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

209 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

210 ià(
v
 >ğ
v®2
) ;

211 
´ev
 = 
Ãxt
;

212 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

214 ià(
v
 !ğ
v®2
 && 
´ev
 !ğ
´ev1
 &&…»v !ğ
Ãxt1
) {

216 
»suÉ
 = 1;

219 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt1
->
Ãxt
);

220 
	`TX_STORE
(&
´ev1
->
Ãxt
, 
n
);

221 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®2
,‚ext, 
Œª§ùiÚ®
));

222 
	`FREE
(
Ãxt1
, (
node_t
));

224 } 
»suÉ
 = 0;

225 
TX_END
;

229 
	`TX_START
(
NL
);

230 
»suÉ
 = 0;

231 
addr1
 = 
v®1
 % 
maxh’gth
;

232 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

233 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

235 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

236 ià(
v
 >ğ
v®1
) ;

237 
´ev
 = 
Ãxt
;

238 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

240 
´ev1
 = 
´ev
;

241 
Ãxt1
 = 
Ãxt
;

242 ià(
v
 =ğ
v®1
) {

244 
addr2
 = 
v®2
 % 
maxh’gth
;

245 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

246 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

248 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

249 ià(
v
 >ğ
v®2
) ;

250 
´ev
 = 
Ãxt
;

251 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

253 ià(
v
 !ğ
v®2
 && 
´ev
 !ğ
´ev1
 &&…»v !ğ
Ãxt1
) {

255 
»suÉ
 = 1;

258 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt1
->
Ãxt
);

259 
	`TX_STORE
(&
´ev1
->
Ãxt
, 
n
);

260 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®2
,‚ext, 
Œª§ùiÚ®
));

261 
	`FREE
(
Ãxt1
, (
node_t
));

263 } 
»suÉ
 = 0;

264 
TX_END
;

268 #–ià
defšed
 
LOCKFREE


270 
	`´štf
("ht_snapshot: No other implementation of‡tomic snapshot is‡vailable\n");

271 
	`ex™
(1);

275  
»suÉ
;

276 
	}
}

283 
	$ht_move_ÜrŞlback
(
ht_št£t_t
 *
£t
, 
v®1
, 
v®2
, 
Œª§ùiÚ®
) {

284 
»suÉ
 = 0;

286 #ifdeà
SEQUENTIAL


288 
addr1
, 
addr2
;

289 
addr1
 = 
v®1
 % 
maxh’gth
;

290 
addr2
 = 
v®2
 % 
maxh’gth
;

291 
»suÉ
 = (
	`£t_»move
(
£t
->
buck‘s
[
addr1
], 
v®1
, 
Œª§ùiÚ®
) &&

292 
	`£t_add
(
£t
->
buck‘s
[
addr2
], 
v®2
, 
Œª§ùiÚ®
));

294 #–ià
defšed
 
STM


296 
v
, 
addr1
, 
addr2
;

297 
node_t
 *
n
, *
´ev
, *
Ãxt
, *
´ev1
, *
Ãxt1
;

299 ià(
Œª§ùiÚ®
 > 1) {

301 
	`TX_START
(
EL
);

302 
»suÉ
 = 0;

303 
addr1
 = 
v®1
 % 
maxh’gth
;

304 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

305 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

307 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

308 ià(
v
 >ğ
v®1
) ;

309 
´ev
 = 
Ãxt
;

310 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

312 
´ev1
 = 
´ev
;

313 
Ãxt1
 = 
Ãxt
;

314 ià(
v
 =ğ
v®1
) {

316 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

317 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

319 
addr2
 = 
v®2
 % 
maxh’gth
;

320 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

321 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

323 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

324 ià(
v
 >ğ
v®2
) ;

325 
´ev
 = 
Ãxt
;

326 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

328 ià(
v
 !ğ
v®2
) {

329 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®2
,‚ext, 
Œª§ùiÚ®
));

330 
	`FREE
(
Ãxt1
, (
node_t
));

332 
	`TX_STORE
(&
´ev1
->
Ãxt
, 
	`TX_LOAD
(&
Ãxt1
));

335 
»suÉ
 = 1;

336 } 
»suÉ
 = 0;

337 
TX_END
;

342 
	`TX_START
(
NL
);

343 
»suÉ
 = 0;

344 
addr1
 = 
v®1
 % 
maxh’gth
;

345 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

346 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

348 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

349 ià(
v
 >ğ
v®1
) ;

350 
´ev
 = 
Ãxt
;

351 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

353 
´ev1
 = 
´ev
;

354 
Ãxt1
 = 
Ãxt
;

355 ià(
v
 =ğ
v®1
) {

357 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

358 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

360 
addr2
 = 
v®2
 % 
maxh’gth
;

361 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

362 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

364 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

365 ià(
v
 >ğ
v®2
) ;

366 
´ev
 = 
Ãxt
;

367 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

369 ià(
v
 !ğ
v®2
) {

370 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®2
,‚ext, 
Œª§ùiÚ®
));

371 
	`FREE
(
Ãxt1
, (
node_t
));

373 
	`TX_STORE
(&
´ev1
->
Ãxt
, 
	`TX_LOAD
(&
Ãxt1
));

376 
»suÉ
 = 1;

377 } 
»suÉ
 = 0;

378 
TX_END
;

382 #–ià
defšed
 
LOCKFREE


384 
	`´štf
("ht_snapshot: No other implementation of‡tomic snapshot is‡vailable\n");

385 
	`ex™
(1);

389  
»suÉ
;

390 
	}
}

401 
	$ht_¢­shÙ
(
ht_št£t_t
 *
£t
, 
Œª§ùiÚ®
) {

402 
»suÉ
 = 0;

404 #ifdeà
SEQUENTIAL


406 
i
, 
sum
 = 0;

407 
node_t
 *
Ãxt
;

409 
i
=0; i < 
maxh’gth
; i++) {

410 
Ãxt
 = 
£t
->
buck‘s
[
i
]->
h—d
->next;

411 
Ãxt
->next) {

412 
sum
 +ğ
Ãxt
->
v®
;

413 
Ãxt
 =‚ext->next;

416 
»suÉ
 = 1;

418 #–ià
defšed
 
STM


420 
i
, 
sum
 = 0;

421 
node_t
 *
Ãxt
;

424 
	`TX_START
(
NL
);

425 
»suÉ
 = 0;

426 
i
=0; i < 
maxh’gth
; i++) {

427 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
i
]->
h—d
->next);

428 
Ãxt
->next) {

429 
sum
 +ğ
	`TX_LOAD
(&
Ãxt
->
v®
);

430 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&next->next);

433 
TX_END
;

434 
»suÉ
 = 1;

436 #–ià
defšed
 
LOCKFREE


438 
	`´štf
("ht_snapshot: No other implementation of‡tomic snapshot is‡vailable\n");

439 
	`ex™
(1);

443  
»suÉ
;

444 
	}
}

	@hashtables/lockfree-ht/intset.h

25 
	~"hashbË.h
"

27 
ht_cÚšs
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
);

28 
ht_add
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
);

29 
ht_»move
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
);

35 
ht_move
(
ht_št£t_t
 *
£t
, 
v®1
, 
v®2
, 
Œª§ùiÚ®
);

45 
ht_¢­shÙ
(
ht_št£t_t
 *
£t
, 
Œª§ùiÚ®
);

	@hashtables/lockfree-ht/test.c

24 
	~"št£t.h
"

27 
	gmaxh’gth
;

28 
	gg_nb_th»ad
;

31 #ifdeà
TLS


32 
__th»ad
 *
	gºg_£ed
;

34 
±h»ad_key_t
 
	gºg_£ed_key
;

37 
	sb¬r›r
 {

38 
±h»ad_cÚd_t
 
	mcom¶‘e
;

39 
±h»ad_mu‹x_t
 
	mmu‹x
;

40 
	mcouÁ
;

41 
	müossšg
;

42 } 
	tb¬r›r_t
;

45 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

47 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

48 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

49 
b
->
couÁ
 = 
n
;

50 
b
->
üossšg
 = 0;

51 
	}
}

53 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

55 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

57 
b
->
üossšg
++;

59 ià(
b
->
üossšg
 < b->
couÁ
) {

60 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

62 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

64 
b
->
üossšg
 = 0;

66 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

67 
	}
}

77 
šlše
 
	$¿nd_¿nge
(
r
) {

78 
m
 = 
RAND_MAX
;

79 
d
, 
v
 = 0;

82 
d
 = (
m
 > 
r
 ?„ : m);

83 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

84 
r
 -ğ
m
;

85 } 
r
 > 0);

86  
v
;

87 
	}
}

88 
¿nd_¿nge
(
r
);

91 
šlše
 
	$¿nd_¿nge_»
(*
£ed
, 
r
) {

92 
m
 = 
RAND_MAX
;

93 
d
, 
v
 = 0;

96 
d
 = (
m
 > 
r
 ?„ : m);

97 
v
 +ğ1 + ()(
d
 * (()
	`¿nd_r
(
£ed
)/(()(
m
)+1.0)));

98 
r
 -ğ
m
;

99 } 
r
 > 0);

100  
v
;

101 
	}
}

102 
¿nd_¿nge_»
(*
£ed
, 
r
);

104 
	sth»ad_d©a
 {

105 
v®_t
 
	mfœ¡
;

106 
	m¿nge
;

107 
	mupd©e
;

108 
	mmove
;

109 
	m¢­shÙ
;

110 
	mun™_tx
;

111 
	m®‹º©e
;

112 
	mefãùive
;

113 
	mnb_add
;

114 
	mnb_added
;

115 
	mnb_»move
;

116 
	mnb_»moved
;

117 
	mnb_cÚšs
;

119 
	mlßd_çùÜ
;

120 
	mnb_move
;

121 
	mnb_moved
;

122 
	mnb_¢­shÙ
;

123 
	mnb_¢­shÙed
;

125 
	mnb_found
;

126 
	mnb_abÜts
;

127 
	mnb_abÜts_locked_»ad
;

128 
	mnb_abÜts_locked_wr™e
;

129 
	mnb_abÜts_v®id©e_»ad
;

130 
	mnb_abÜts_v®id©e_wr™e
;

131 
	mnb_abÜts_v®id©e_comm™
;

132 
	mnb_abÜts_šv®id_memÜy
;

133 
	mnb_abÜts_doubË_wr™e
;

134 
	mmax_»Œ›s
;

135 
	m£ed
;

136 
ht_št£t_t
 *
	m£t
;

137 
b¬r›r_t
 *
	mb¬r›r
;

138 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

139 } 
	tth»ad_d©a_t
;

142 *
	$‹¡
(*
d©a
) {

143 
v®2
, 
numtx
, 
r
, 
Ï¡
 = -1;

144 
cu¼_»Œy
 = 0;

145 
v®_t
 
v®
 = 0;

146 
uÃxt
, 
mÃxt
, 
úext
;

147 
»t
 = 0;

149 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

152 
	`TM_THREAD_ENTER
();

154 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

157 
r
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, 100) - 1;

158 
uÃxt
 = (
r
 < 
d
->
upd©e
);

159 
mÃxt
 = (
r
 < 
d
->
move
);

160 
úext
 = (
r
 >ğ
d
->
upd©e
 + d->
¢­shÙ
);

162 
num_add
 = 0;

163 #ifdeà
ICC


164 
num_add
 < 10000000/
g_nb_th»ad
) {

167 
num_add
 < 10000000/
g_nb_th»ad
) {

169 
num_add
++;

171 ià(
uÃxt
) {

173 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

175 
cu¼_»Œy
 = 0;

176 (
»t
 = 
	`ht_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) == -1) {

180 
d
->
nb_abÜts
++;

181 
cu¼_»Œy
++;

182 if(
cu¼_»Œy
 > 
d
->
max_»Œ›s
){

183 
d
->
çu»s_beÿu£_cÚ‹ÁiÚ
++;

187 if(
»t
 > 0)

188 
d
->
nb_added
++;

189 
d
->
nb_add
++;

191 ià(
mÃxt
) {

193 ià(
Ï¡
 =ğ-1è
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

194 
v®
 = 
Ï¡
;

195 
v®2
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

196 ià(
	`ht_move
(
d
->
£t
, 
v®
, 
v®2
, 
TRANSACTIONAL
)) {

197 
d
->
nb_moved
++;

198 
Ï¡
 = -1;

200 
d
->
nb_move
++;

202 } ià(
Ï¡
 < 0) {

204 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

205 ià(
	`ht_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

206 
d
->
nb_added
++;

207 
Ï¡
 = 
v®
;

209 
d
->
nb_add
++;

213 ià(
d
->
®‹º©e
) {

214 ià(
	`ht_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
)) {

215 
d
->
nb_»moved
++;

216 
Ï¡
 = -1;

220 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

222 ià(
	`ht_»move
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

223 
d
->
nb_»moved
++;

225 
Ï¡
 = -1;

228 
d
->
nb_»move
++;

234 ià(
úext
) {

236 ià(
d
->
®‹º©e
) {

237 ià(
d
->
upd©e
 == 0) {

238 ià(
Ï¡
 < 0) {

239 
v®
 = 
d
->
fœ¡
;

240 
Ï¡
 = 
v®
;

242 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

243 
Ï¡
 = -1;

246 ià(
Ï¡
 < 0) {

247 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

250 
v®
 = 
Ï¡
;

253 } 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

255 ià(
	`ht_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

256 
d
->
nb_found
++;

257 
d
->
nb_cÚšs
++;

261 ià(
	`ht_¢­shÙ
(
d
->
£t
, 
TRANSACTIONAL
))

262 
d
->
nb_¢­shÙed
++;

263 
d
->
nb_¢­shÙ
++;

268 
uÃxt
 = 1;

271 ià(
d
->
efãùive
) {

272 
numtx
 = 
d
->
nb_cÚšs
 + d->
nb_add
 + d->
nb_»move
 + d->
nb_move
 + d->
nb_¢­shÙ
;

273 
uÃxt
 = ((100.0 * (
d
->
nb_added
 + d->
nb_»moved
 + d->
nb_moved
)è< (d->
upd©e
 * 
numtx
));

274 
mÃxt
 = ((100.0 * 
d
->
nb_moved
è< (d->
move
 * 
numtx
));

275 
úext
 = !((100.0 * 
d
->
nb_¢­shÙed
è< (d->
¢­shÙ
 * 
numtx
));

277 
r
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, 100) - 1;

278 
uÃxt
 = (
r
 < 
d
->
upd©e
);

279 
mÃxt
 = (
r
 < 
d
->
move
);

280 
úext
 = (
r
 >ğ
d
->
upd©e
 + d->
¢­shÙ
);

284 #ifdeà
ICC


291 
	`TM_THREAD_EXIT
();

293  
NULL
;

297 *
	`‹¡2
(*
d©a
)

299 
v®
, 
Ãwv®
, 
Ï¡
, 
æag
 = 1;

300 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

303 
	`TM_THREAD_ENTER
();

305 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

307 
Ï¡
 = 0;

308 
¡İ
 == 0) {

310 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, 100) - 1;

312 ià(
v®
 < 
d
->
upd©e
) {

313 ià(
v®
 >ğ
d
->
move
) {

314 ià(
æag
) {

316 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

317 ià(
	`ht_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

318 
d
->
nb_added
++;

319 
Ï¡
 = 
v®
;

320 
æag
 = 0;

322 
d
->
nb_add
++;

324 ià(
d
->
®‹º©e
) {

326 ià(
	`ht_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
))

327 
d
->
nb_»moved
++;

328 
d
->
nb_»move
++;

329 
æag
 = 1;

332 
Ãwv®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

333 ià(
	`ht_»move
(
d
->
£t
, 
Ãwv®
, 
TRANSACTIONAL
)) {

334 
d
->
nb_»moved
++;

336 
æag
 = 1;

338 
d
->
nb_»move
++;

342 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

343 ià(
	`ht_move
(
d
->
£t
, 
Ï¡
, 
v®
, 
TRANSACTIONAL
)) {

344 
d
->
nb_moved
++;

345 
Ï¡
 = 
v®
;

347 
d
->
nb_move
++;

350 ià(
v®
 >ğ
d
->
upd©e
 + d->
¢­shÙ
) {

352 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

353 ià(
	`ht_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

354 
d
->
nb_found
++;

355 
d
->
nb_cÚšs
++;

357 ià(
	`ht_¢­shÙ
(
d
->
£t
, 
TRANSACTIONAL
))

358 
d
->
nb_¢­shÙed
++;

359 
d
->
nb_¢­shÙ
++;

365 
	`TM_THREAD_EXIT
();

366  
NULL
;

369 
	`´št_£t
(
št£t_t
 *
£t
) {

370 
node_t
 *
cu¼
, *
tmp
;

372 
cu¼
 = 
£t
->
h—d
;

373 
tmp
 = 
cu¼
;

375 
	`´štf
(" - v%d", (è
cu¼
->
v®
);

376 
tmp
 = 
cu¼
;

377 
cu¼
 = 
tmp
->
Ãxt
;

378 } 
cu¼
->
v®
 !ğ
VAL_MAX
);

379 
	`´štf
(" - v%d", (è
cu¼
->
v®
);

380 
	`´štf
("\n");

383 
	`´št_ht
(
ht_št£t_t
 *
£t
) {

384 
i
;

385 
i
=0; i < 
maxh’gth
; i++) {

386 
	`´št_£t
(
£t
->
buck‘s
[
i
]);

390 
	`maš
(
¬gc
, **
¬gv
)

392 
İtiÚ
 
lÚg_İtiÚs
[] = {

394 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

395 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

396 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

397 {"th»ad-num", 
»quœed_¬gum’t
, 
NULL
, 't'},

398 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

399 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 'S'},

400 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

401 {"move-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'a'},

402 {"¢­shÙ-¿‹", 
»quœed_¬gum’t
, 
NULL
, 's'},

403 {"–a¡ic™y", 
»quœed_¬gum’t
, 
NULL
, 'x'},

404 {"»Œy", 
»quœed_¬gum’t
, 
NULL
, 'e'},

405 {
NULL
, 0, NULL, 0}

408 
ht_št£t_t
 *
£t
;

409 
i
, 
c
, 
size
;

410 
v®_t
 
Ï¡
 = 0;

411 
v®_t
 
v®
 = 0;

412 
»ads
, 
efä—ds
, 
upd©es
, 
effupds
, 
moves
, 
moved
, 
¢­shÙs
,

413 
¢­shÙed
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

414 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

415 
abÜts_šv®id_memÜy
, 
abÜts_doubË_wr™e
,

416 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

417 
th»ad_d©a_t
 *
d©a
;

418 
±h»ad_t
 *
th»ads
;

419 
±h»ad_©Œ_t
 
©Œ
;

420 
b¬r›r_t
 
b¬r›r
;

421 
timev®
 
¡¬t
, 
’d
;

422 
time¥ec
 
timeout
;

423 
du¿tiÚ
 = 
DEFAULT_DURATION
;

424 
š™Ÿl
 = 
DEFAULT_INITIAL
;

425 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

426 
¿nge
 = 
DEFAULT_RANGE
;

427 
£ed
 = 
DEFAULT_SEED
;

428 
upd©e
 = 
DEFAULT_UPDATE
;

429 
lßd_çùÜ
 = 
DEFAULT_LOAD
;

430 
move
 = 
DEFAULT_MOVE
;

431 
¢­shÙ
 = 
DEFAULT_SNAPSHOT
;

432 
un™_tx
 = 
DEFAULT_ELASTICITY
;

433 
®‹º©e
 = 
DEFAULT_ALTERNATE
;

434 
efãùive
 = 
DEFAULT_EFFECTIVE
;

435 
»Œy
 = 0;

436 
sig£t_t
 
block_£t
;

439 
i
 = 0;

440 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "e:hAf:d:i:t:r:S:u:a:s:l:x:", 
lÚg_İtiÚs
, &
i
);

442 if(
c
 == -1)

445 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

446 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

448 
c
) {

453 
	`´štf
("intset -- STM stressest "

467 " upd©tx mu¡ƒfãùiv–y wr™(0ñrŸl, 1ófãùive, deçuÉ=" 
	`XSTR
(
DEFAULT_EFFECTIVE
) ")\n"

469 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

471 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

473 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

475 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

477 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

479 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

481 " P”ûÁagoàmovŒª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_MOVE
) ")\n"

483 " P”ûÁagoà¢­shÙ¿n§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_SNAPSHOT
) ")\n"

485 " R©iØoàkey ov” buck‘ (deçuÉ=" 
	`XSTR
(
DEFAULT_LOAD
) ")\n"

495 
	`ex™
(0);

497 
»Œy
 = 
	`©oi
(
İrg
);

500 
®‹º©e
 = 1;

503 
efãùive
 = 
	`©oi
(
İrg
);

506 
du¿tiÚ
 = 
	`©oi
(
İrg
);

509 
š™Ÿl
 = 
	`©oi
(
İrg
);

512 
nb_th»ads
 = 
	`©oi
(
İrg
);

513 
g_nb_th»ad
 = 
nb_th»ads
;

516 
¿nge
 = 
	`©Ş
(
İrg
);

519 
£ed
 = 
	`©oi
(
İrg
);

522 
upd©e
 = 
	`©oi
(
İrg
);

525 
move
 = 
	`©oi
(
İrg
);

528 
¢­shÙ
 = 
	`©oi
(
İrg
);

531 
lßd_çùÜ
 = 
	`©oi
(
İrg
);

534 
un™_tx
 = 
	`©oi
(
İrg
);

537 
	`´štf
("Use -h or --help for help\n");

538 
	`ex™
(0);

540 
	`ex™
(1);

544 
	`as£¹
(
du¿tiÚ
 >= 0);

545 
	`as£¹
(
š™Ÿl
 >= 0);

546 
	`as£¹
(
nb_th»ads
 > 0);

547 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

548 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

549 
	`as£¹
(
move
 >ğ0 && mov<ğ
upd©e
);

550 
	`as£¹
(
¢­shÙ
 >ğ0 && sÇpshÙ <ğ(100-
upd©e
));

551 
	`as£¹
(
š™Ÿl
 < 
MAXHTLENGTH
);

552 
	`as£¹
(
š™Ÿl
 >ğ
lßd_çùÜ
);

554 
	`´štf
("Setype :†ock-free hashable\n");

555 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

556 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

557 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

558 
	`´štf
("V®u¿ng : %ld\n", 
¿nge
);

559 
	`´štf
("S“d : %d\n", 
£ed
);

560 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

561 
	`´štf
("Lßd faùÜ : %d\n", 
lßd_çùÜ
);

562 
	`´štf
("Mov¿‹ : %d\n", 
move
);

563 
	`´štf
("SÇpshÙ„©e: %d\n", 
¢­shÙ
);

564 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

565 
	`´štf
("AÉ”Ç‹ : %d\n", 
®‹º©e
);

566 
	`´štf
("Efãùiv : %d\n", 
efãùive
);

567 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

571 ()(
ušŒ_t
));

573 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

574 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

576 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

577 
	`³¼Ü
("malloc");

578 
	`ex™
(1);

580 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

581 
	`³¼Ü
("malloc");

582 
	`ex™
(1);

585 ià(
£ed
 == 0)

586 
	`¤ªd
(()
	`time
(0));

588 
	`¤ªd
(
£ed
);

590 
maxh’gth
 = (è
š™Ÿl
 / 
lßd_çùÜ
;

591 
£t
 = 
	`ht_Ãw
();

593 
¡İ
 = 0;

596 
	`´štf
("Initializing STM\n");

598 
	`TM_STARTUP
();

601 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

602 
i
 = 0;

603 
maxh’gth
 = (è(
š™Ÿl
 / 
lßd_çùÜ
);

604 
i
 < 
š™Ÿl
) {

605 
v®
 = 
	`¿nd_¿nge
(
¿nge
);

606 ià(
	`ht_add
(
£t
, 
v®
, 0)) {

607 
Ï¡
 = 
v®
;

608 
i
++;

611 
size
 = 
	`ht_size
(
£t
);

612 
	`´štf
("S‘ siz : %d\n", 
size
);

613 
	`´štf
("Buck‘‡mouÁ: %d\n", 
maxh’gth
);

614 
	`´štf
("Lßd : %d\n", 
lßd_çùÜ
);

617 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

618 
	`±h»ad_©Œ_š™
(&
©Œ
);

619 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

620 
i
 = 0; i < 
nb_th»ads
; i++) {

621 
	`´štf
("C»©šgh»ad %d\n", 
i
);

622 
d©a
[
i
].
fœ¡
 = 
Ï¡
;

623 
d©a
[
i
].
¿nge
 =„ange;

624 
d©a
[
i
].
upd©e
 = update;

625 
d©a
[
i
].
lßd_çùÜ
 =†oad_factor;

626 
d©a
[
i
].
move
 = move;

627 
d©a
[
i
].
¢­shÙ
 = snapshot;

628 
d©a
[
i
].
un™_tx
 = unit_tx;

629 
d©a
[
i
].
®‹º©e
 =‡lternate;

630 
d©a
[
i
].
efãùive
 =ƒffective;

631 
d©a
[
i
].
nb_add
 = 0;

632 
d©a
[
i
].
nb_added
 = 0;

633 
d©a
[
i
].
nb_»move
 = 0;

634 
d©a
[
i
].
nb_»moved
 = 0;

635 
d©a
[
i
].
nb_move
 = 0;

636 
d©a
[
i
].
nb_moved
 = 0;

637 
d©a
[
i
].
nb_¢­shÙ
 = 0;

638 
d©a
[
i
].
nb_¢­shÙed
 = 0;

639 
d©a
[
i
].
nb_cÚšs
 = 0;

640 
d©a
[
i
].
nb_found
 = 0;

641 
d©a
[
i
].
nb_abÜts
 = 0;

642 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

643 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

644 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

645 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

646 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

647 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

648 
d©a
[
i
].
nb_abÜts_doubË_wr™e
 = 0;

649 
d©a
[
i
].
max_»Œ›s
 = 
»Œy
;

650 
d©a
[
i
].
£ed
 = 
	`¿nd
();

651 
d©a
[
i
].
£t
 = set;

652 
d©a
[
i
].
b¬r›r
 = &barrier;

653 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

654 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

655 
	`årštf
(
¡d”r
, "Error creatinghread\n");

656 
	`ex™
(1);

659 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

662 
	`b¬r›r_üoss
(&
b¬r›r
);

664 
	`´štf
("STARTING...\n");

665 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

666 ià(
du¿tiÚ
 > 0) {

667 
	`Çno¦“p
(&
timeout
, 
NULL
);

672 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

673 
	`g‘timeofday
(&
’d
, 
NULL
);

674 
	`´štf
("STOPPING...\n");

679 
i
 = 0; i < 
nb_th»ads
; i++) {

680 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

681 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

682 
	`ex™
(1);

685 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

686 
abÜts
 = 0;

687 
abÜts_locked_»ad
 = 0;

688 
abÜts_locked_wr™e
 = 0;

689 
abÜts_v®id©e_»ad
 = 0;

690 
abÜts_v®id©e_wr™e
 = 0;

691 
abÜts_v®id©e_comm™
 = 0;

692 
abÜts_šv®id_memÜy
 = 0;

693 
abÜts_doubË_wr™e
 = 0;

694 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

695 
»ads
 = 0;

696 
efä—ds
 = 0;

697 
upd©es
 = 0;

698 
effupds
 = 0;

699 
moves
 = 0;

700 
moved
 = 0;

701 
¢­shÙs
 = 0;

702 
¢­shÙed
 = 0;

703 
max_»Œ›s
 = 0;

704 
i
 = 0; i < 
nb_th»ads
; i++) {

705 
	`´štf
("Th»ad %d\n", 
i
);

706 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

707 
	`´štf
(" #added : %lu\n", 
d©a
[
i
].
nb_added
);

708 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

709 
	`´štf
(" #»moved : %lu\n", 
d©a
[
i
].
nb_»moved
);

710 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

711 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

712 
	`´štf
(" #mov : %lu\n", 
d©a
[
i
].
nb_move
);

713 
	`´štf
(" #moved : %lu\n", 
d©a
[
i
].
nb_moved
);

714 
	`´štf
(" #¢­shÙ : %lu\n", 
d©a
[
i
].
nb_¢­shÙ
);

715 
	`´štf
(" #¢­shÙed : %lu\n", 
d©a
[
i
].
nb_¢­shÙed
);

716 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

717 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

718 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

719 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

720 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

721 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

722 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

723 
	`´štf
(" #dup-w : %lu\n", 
d©a
[
i
].
nb_abÜts_doubË_wr™e
);

724 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

725 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

726 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

727 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

728 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

729 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

730 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

731 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

732 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

733 
abÜts_doubË_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_doubË_wr™e
;

734 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

735 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

736 
efä—ds
 +ğ
d©a
[
i
].
nb_cÚšs
 +

737 (
d©a
[
i
].
nb_add
 - d©a[i].
nb_added
) +

738 (
d©a
[
i
].
nb_»move
 - d©a[i].
nb_»moved
) +

739 (
d©a
[
i
].
nb_move
 - d©a[i].
nb_moved
) +

740 
d©a
[
i
].
nb_¢­shÙed
;

741 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
 + d©a[i].
nb_move
);

742 
effupds
 +ğ
d©a
[
i
].
nb_»moved
 + d©a[i].
nb_added
 + d©a[i].
nb_moved
;

743 
moves
 +ğ
d©a
[
i
].
nb_move
;

744 
moved
 +ğ
d©a
[
i
].
nb_moved
;

745 
¢­shÙs
 +ğ
d©a
[
i
].
nb_¢­shÙ
;

746 
¢­shÙed
 +ğ
d©a
[
i
].
nb_¢­shÙed
;

747 
size
 +ğ
d©a
[
i
].
nb_added
 - d©a[i].
nb_»moved
;

748 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

749 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

751 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`ht_size
(
£t
), 
size
);

752 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

753 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
 + 
¢­shÙs
, (»ad + upd©e + sÇpshÙsè* 1000.0 / 
du¿tiÚ
);

755 
	`´štf
("#readxs : ");

756 ià(
efãùive
) {

757 
	`´štf
("%lu (%à/ s)\n", 
efä—ds
,ƒfä—d * 1000.0 / 
du¿tiÚ
);

758 
	`´štf
(" #cÚt/¢psht: %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

759 } 
	`´štf
("%lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

761 
	`´štf
("#eff. upd„©e: %à\n", 100.0 * 
effupds
 / (effupd + 
efä—ds
));

763 
	`´štf
("#updatexs : ");

764 ià(
efãùive
) {

765 
	`´štf
("%lu (%à/ s)\n", 
effupds
,ƒffupd * 1000.0 / 
du¿tiÚ
);

766 
	`´štf
(" #updrŸl : %lu (%à/ s)\n", 
upd©es
, updates * 1000.0 /

767 
du¿tiÚ
);

768 } 
	`´štf
("%lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

770 
	`´štf
("#movtx  : %lu (%à/ s)\n", 
moves
, move * 1000.0 / 
du¿tiÚ
);

771 
	`´štf
(" #moved : %lu (%à/ s)\n", 
moved
, moved * 1000.0 / 
du¿tiÚ
);

772 
	`´štf
("#¢­shÙx : %lu (%à/ s)\n", 
¢­shÙs
, sÇpshÙ * 1000.0 / 
du¿tiÚ
);

773 
	`´štf
(" #¢­shÙed : %lu (%à/ s)\n", 
¢­shÙed
, sÇpshÙed * 1000.0 / 
du¿tiÚ
);

774 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

775 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

776 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

777 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

778 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

779 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

780 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

781 
	`´štf
(" #dup-w : %lu (%à/ s)\n", 
abÜts_doubË_wr™e
,‡bÜts_doubË_wr™* 1000.0 / 
du¿tiÚ
);

782 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

783 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

785 
	`´štf
("FAILURE RATE : %f\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
 / 10000000.0);

788 
	`ht_d–‘e
(
£t
);

791 
	`TM_SHUTDOWN
();

793 
	`ä“
(
th»ads
);

794 
	`ä“
(
d©a
);

	@include/estm.h

1 
	~"¡m.h
"

2 
	~"mod_mem.h
"

3 
	#TX_START
(
ty³
è{ 
sigjmp_buf
 *
_e
 = 
	`¡m_g‘_’v
(); 
	`sig£tjmp
(*_e, 0); 
	`¡m_¡¬t
(_e, 0,y³)

	)

4 
	#TX_LOAD
(
addr
è
	`¡m_lßd
((
¡m_wÜd_t
 *ïddr)

	)

5 
	#TX_STORE
(
addr
, 
v®
è
	`¡m_¡Üe
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_t)v®)

	)

6 
	#TX_END
 
	`¡m_comm™
(); }

	)

7 
	#FREE
(
addr
, 
size
è
	`¡m_ä“
×ddr, size)

	)

8 
	#MALLOC
(
size
è
	`¡m_m®loc
(size)

	)

9 
	#TM_CALLABLE


	)

10 
	#TM_ARGDECL_ALONE


	)

11 
	#TM_ARGDECL


	)

12 
	#TM_ARG


	)

13 
	#TM_ARG_LAST


	)

14 
	#TM_ARG_ALONE


	)

15 
	#TM_STARTUP
() \

16 *
s
; \

17 
	`¡m_š™
(); \

18 
	`mod_mem_š™
(); \

19 ià(
	`¡m_g‘_·¿m‘”
("compe_æags", &
s
)) \

20 
	`´štf
("STM fÏg  : %s\n", 
s
)

	)

21 
	#TM_SHUTDOWN
() \

22 
u
; \

23 ià(
	`¡m_g‘_¡©s
("glob®_nb_comm™s", &
u
) != 0) \

24 
	`´štf
("#comm™  : %lu\n", 
u
); \

25 ià(
	`¡m_g‘_¡©s
("glob®_nb_abÜts", &
u
) != 0) \

26 
	`´štf
("#abÜt  : %lu\n", 
u
); \

27 ià(
	`¡m_g‘_¡©s
("glob®_max_»Œ›s", &
u
) != 0) \

28 
	`´štf
("Max„‘r› : %lu\n", 
u
); \

29 
	`¡m_ex™
()

	)

30 
	#TM_THREAD_ENTER
(è
	`¡m_š™_th»ad
()

	)

31 
	#TM_THREAD_EXIT
() \

32 
	`¡m_g‘_¡©s
("nb_abÜts", &
d
->
nb_abÜts
); \

33 
	`¡m_g‘_¡©s
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
); \

34 
	`¡m_g‘_¡©s
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
); \

35 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
); \

36 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
); \

37 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
); \

38 
	`¡m_g‘_¡©s
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
); \

39 
	`¡m_g‘_¡©s
("nb_abÜts_doubË_wr™e", &
d
->
nb_abÜts_šv®id_memÜy
); \

40 
	`¡m_g‘_¡©s
("max_»Œ›s", &
d
->
max_»Œ›s
); \

41 
	`¡m_ex™_th»ad
()

	)

	@include/icc.h

2 
__©Œibu‹__
((
	$tm_w¿µšg
(
m®loc
))è*
	`wÍd¡m_icc_m®loc
(
size_t
 
size
);

3 
	`__©Œibu‹__
((
	$tm_w¿µšg
(
ä“
))è
	`wÍd¡m_icc_ä“
(*
±r
);

4 
	#NL
 1

	)

5 
	#EL
 0

	)

6 
	#START
 
__tm_©omic
 {

	)

7 
	#START_ID
(
ID
è
__tm_©omic
 {

	)

8 
	#START_RO
 
__tm_©omic
 {

	)

9 
	#START_RO_ID
(
ID
è
__tm_©omic
 {

	)

10 
	#LOAD
(
addr
è(*×ddr))

	)

11 
	#STORE
(
addr
, 
v®ue
è(*×ddrèğ(v®ue))

	)

12 
	#COMMIT
 }

	)

13 
	#MALLOC
(
size
è
	`m®loc
(size)

	)

14 
	#FREE
(
addr
, 
size
è
	`ä“
×ddr)

	)

15 
	#TM_CALLABLE
 
	`__©Œibu‹__
 ((
tm_ÿÎabË
))

	)

16 
	#TM_ARGDECL_ALONE


	)

17 
	#TM_ARGDECL


	)

18 
	#TM_ARG


	)

19 
	#TM_ARG_ALONE


	)

20 
	#TM_ARG_LAST


	)

21 
	#TM_STARTUP
(è

	)

22 
	#TM_SHUTDOWN
(è

	)

23 
	#TM_THREAD_ENTER
(è

	)

24 
	#TM_THREAD_EXIT
(è

	)

	@include/lockfree.h

1 
	~<immšŒš.h
>

2 
	#NL
 1

	)

3 
	#EL
 0

	)

4 
	#TX_START
(
ty³
è

	)

5 
	#TX_LOAD
(
addr
è(*×ddr))

	)

6 
	#TX_STORE
(
addr
, 
v®
è(*×ddrèğ(v®))

	)

7 
	#TX_END


	)

8 
	#FREE
(
addr
, 
size
è
	`ä“
×ddr)

	)

9 
	#MALLOC
(
size
è
	`m®loc
(size)

	)

10 
	#TM_CALLABLE


	)

11 
	#TM_ARGDECL_ALONE


	)

12 
	#TM_ARGDECL


	)

13 
	#TM_ARG


	)

14 
	#TM_ARG_ALONE


	)

15 
	#TM_ARG_LAST


	)

16 
	#TM_STARTUP
(è

	)

17 
	#TM_SHUTDOWN
(è

	)

18 
	#TM_STARTUP
(è

	)

19 
	#TM_SHUTDOWN
(è

	)

20 
	#TM_THREAD_ENTER
(è

	)

21 
	#TM_THREAD_EXIT
(è

	)

	@include/lpdwstm.h

2 
	~"¡m.h
"

3 
	#NL
 1

	)

4 
	#EL
 0

	)

5 
	#TX_START
(
ty³
è
BEGIN_TRANSACTION


	)

6 
	#TX_LOAD
(
addr
è
	`wÍd¡m_»ad_wÜd
((
WÜd
 *)×ddr))

	)

7 
	#TX_STORE
(
addr
, 
v®
è
	`wÍd¡m_wr™e_wÜd
((
WÜd
 *ïddr, (WÜd)v®)

	)

8 
	#TX_END
 
END_TRANSACTION


	)

9 
	#FREE
(
addr
, 
size
è
	`wÍd¡m_tx_ä“
×ddr, size)

	)

10 
	#MALLOC
(
size
è
	`wÍd¡m_tx_m®loc
(size)

	)

11 
	#TM_CALLABLE


	)

12 
	#TM_ARGDECL_ALONE


	)

13 
	#TM_ARGDECL


	)

14 
	#TM_ARG


	)

15 
	#TM_ARG_LAST


	)

16 
	#TM_ARG_ALONE


	)

17 
	#TM_STARTUP
(è
	`wÍd¡m_glob®_š™
()

	)

18 #ifdeà
COLLECT_STATS


19 
	#TM_SHUTDOWN
(è
	`wÍd¡m_´št_¡©s
()

	)

21 
	#TM_SHUTDOWN
(è

	)

23 
	#TM_THREAD_ENTER
(è
	`wÍd¡m_th»ad_š™
(); \

24 
tx_desc
 *
tx
 = 
	`wÍd¡m_g‘_tx_desc
()

	)

25 
	#TM_THREAD_EXIT
(è

	)

	@include/sequential.h

2 
	#NL
 1

	)

3 
	#EL
 0

	)

4 
	#TX_START
(
ty³
è

	)

5 
	#TX_LOAD
(
addr
è(*×ddr))

	)

6 
	#TX_STORE
(
addr
, 
v®
è(*×ddrèğ(v®))

	)

7 
	#TX_END


	)

8 
	#FREE
(
addr
, 
size
è
	`ä“
×ddr)

	)

9 
	#MALLOC
(
size
è
	`m®loc
(size)

	)

10 
	#TM_CALLABLE


	)

11 
	#TM_ARGDECL_ALONE


	)

12 
	#TM_ARGDECL


	)

13 
	#TM_ARG


	)

14 
	#TM_ARG_ALONE


	)

15 
	#TM_ARG_LAST


	)

16 
	#TM_STARTUP
(è

	)

17 
	#TM_SHUTDOWN
(è

	)

18 
	#TM_STARTUP
(è

	)

19 
	#TM_SHUTDOWN
(è

	)

20 
	#TM_THREAD_ENTER
(è

	)

21 
	#TM_THREAD_EXIT
(è

	)

	@include/tinystm.h

6 #ifdeà
TINY098


8 
	~"¡m.h
"

9 
	~"mod_mem.h
"

10 
	~"mod_¡©s.h
"

11 
	#NL
 1

	)

12 
	#EL
 0

	)

13 
	#TX_START
(
ty³
è{ 
sigjmp_buf
 *
_e
 = 
	`¡m_g‘_’v
(); 
	`sig£tjmp
(*_e, 0); 
	`¡m_¡¬t
(_e, 0)

	)

14 
	#TX_LOAD
(
addr
è
	`¡m_lßd
((
¡m_wÜd_t
 *ïddr)

	)

15 
	#TX_STORE
(
addr
, 
v®
è
	`¡m_¡Üe
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_t)v®)

	)

16 
	#TX_END
 
	`¡m_comm™
(); }

	)

17 
	#FREE
(
addr
, 
size
è
	`¡m_ä“
×ddr, size)

	)

18 
	#MALLOC
(
size
è
	`¡m_m®loc
(size)

	)

19 
	#TM_CALLABLE


	)

20 
	#TM_ARGDECL_ALONE


	)

21 
	#TM_ARGDECL


	)

22 
	#TM_ARG


	)

23 
	#TM_ARG_LAST


	)

24 
	#TM_ARG_ALONE


	)

25 
	#TM_STARTUP
(
numTh»ad
) \

27 
	`årštf
(
¡d”r
, "Error: unsupported†ong‡nd…ointer sizes\n"); \

28 
	`ex™
(1); \

30 
	`¡m_š™
(); \

31 
	`mod_mem_š™
(); \

32 
	`mod_¡©s_š™
()

	)

33 
	#TM_SHUTDOWN
() \

34 
u
; \

35 ià(
	`¡m_g‘_¡©s
("glob®_nb_comm™s", &
u
) != 0) \

36 
	`´štf
("#comm™  : %lu\n", 
u
); \

37 ià(
	`¡m_g‘_¡©s
("glob®_nb_abÜts", &
u
) != 0) \

38 
	`´štf
("#abÜt  : %lu\n", 
u
); \

39 ià(
	`¡m_g‘_¡©s
("glob®_max_»Œ›s", &
u
) != 0) \

40 
	`´štf
("Max„‘r› : %lu\n", 
u
); \

41 
	`¡m_ex™
()

	)

42 
	#TM_THREAD_ENTER
(è
	`¡m_š™_th»ad
()

	)

43 
	#TM_THREAD_EXIT
() \

44 
	`¡m_g‘_¡©s
("nb_abÜts", &
d
->
nb_abÜts
); \

45 
	`¡m_g‘_¡©s
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
); \

46 
	`¡m_g‘_¡©s
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
); \

47 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
); \

48 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
); \

49 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
); \

50 
	`¡m_g‘_¡©s
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
); \

51 
	`¡m_g‘_¡©s
("nb_abÜts_doubË_wr™e", &
d
->
nb_abÜts_šv®id_memÜy
); \

52 
	`¡m_g‘_¡©s
("max_»Œ›s", &
d
->
max_»Œ›s
); \

53 
	`¡m_ex™_th»ad
()

	)

55 #–ià
defšed
 
TINY099


57 
	~"¡m.h
"

58 
	~"mod_mem.h
"

59 
	~"mod_¡©s.h
"

60 
	#NL
 1

	)

61 
	#EL
 0

	)

62 
	#TX_START
(
ty³
è{ 
sigjmp_buf
 *
_e
 = 
	`¡m_g‘_’v
(); 
	`sig£tjmp
(*_e, 0); 
	`¡m_¡¬t
(_e, 0)

	)

63 
	#TX_LOAD
(
addr
è
	`¡m_lßd
((
¡m_wÜd_t
 *ïddr)

	)

64 
	#TX_STORE
(
addr
, 
v®
è
	`¡m_¡Üe
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_t)v®)

	)

65 
	#TX_END
 
	`¡m_comm™
(); }

	)

66 
	#FREE
(
addr
, 
size
è
	`¡m_ä“
×ddr, size)

	)

67 
	#MALLOC
(
size
è
	`¡m_m®loc
(size)

	)

68 
	#TM_CALLABLE


	)

69 
	#TM_ARGDECL_ALONE


	)

70 
	#TM_ARGDECL


	)

71 
	#TM_ARG


	)

72 
	#TM_ARG_LAST


	)

73 
	#TM_ARG_ALONE


	)

74 
	#TM_THREAD_ENTER
(è
	`¡m_š™_th»ad
()

	)

75 
	#TM_THREAD_EXIT
() \

76 
	`¡m_g‘_¡©s
("nb_abÜts", &
d
->
nb_abÜts
); \

77 
	`¡m_g‘_¡©s
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
); \

78 
	`¡m_g‘_¡©s
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
); \

79 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
); \

80 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
); \

81 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
); \

82 
	`¡m_g‘_¡©s
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
); \

83 
	`¡m_g‘_¡©s
("nb_abÜts_doubË_wr™e", &
d
->
nb_abÜts_šv®id_memÜy
); \

84 
	`¡m_g‘_¡©s
("max_»Œ›s", &
d
->
max_»Œ›s
); \

85 
	`¡m_ex™_th»ad
()

	)

86 
	#TM_STARTUP
() \

88 
	`årštf
(
¡d”r
, "Error: unsupported†ong‡nd…ointer sizes\n"); \

89 
	`ex™
(1); \

91 
	`¡m_š™
(); \

92 
	`mod_mem_š™
(); \

93 ià(
	`g‘’v
("STM_STATS"è!ğ
NULL
) { \

94 
	`mod_¡©s_š™
(); \

95 }

	)

96 
	#TM_SHUTDOWN
() \

97 ià(
	`g‘’v
("STM_STATS"è!ğ
NULL
) { \

98 
u
; \

99 ià(
	`¡m_g‘_¡©s
("glob®_nb_comm™s", &
u
) != 0) \

100 
	`´štf
("#comm™  : %lu\n", 
u
); \

101 ià(
	`¡m_g‘_¡©s
("glob®_nb_abÜts", &
u
) != 0) \

102 
	`´štf
("#abÜt  : %lu\n", 
u
); \

103 ià(
	`¡m_g‘_¡©s
("glob®_max_»Œ›s", &
u
) != 0) \

104 
	`´štf
("Max„‘r› : %lu\n", 
u
); \

106 
	`¡m_ex™
()

	)

108 #–ià
defšed
(
TINY100
è|| defšed(
TINY10B
)

110 
	~"¡m.h
"

111 
	~"mod_mem.h
"

112 
	~"mod_¡©s.h
"

113 
	#NL
 1

	)

114 
	#EL
 0

	)

115 
	#TX_START
(
ty³
è{ 
sigjmp_buf
 *
_e
 = 
	`¡m_¡¬t
(0); ià(_!ğ
NULL
è
	`sig£tjmp
(*_e, 0);

	)

116 
	#TX_LOAD
(
addr
è
	`¡m_lßd
((
¡m_wÜd_t
 *ïddr)

	)

118 
	#TX_UNIT_LOAD
(
addr
è
	`¡m_un™_lßd
((
¡m_wÜd_t
 *ïddr, 
NULL
)

	)

119 
	#TX_UNIT_LOAD_TS
(
addr
, 
time¡amp
è
	`¡m_un™_lßd
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_ˆ*éime¡amp)

	)

120 
	#TX_STORE
(
addr
, 
v®
è
	`¡m_¡Üe
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_t)v®)

	)

121 
	#TX_END
 
	`¡m_comm™
(); }

	)

122 
	#FREE
(
addr
, 
size
è
	`¡m_ä“
×ddr, size)

	)

123 
	#MALLOC
(
size
è
	`¡m_m®loc
(size)

	)

124 
	#TM_CALLABLE


	)

125 
	#TM_ARGDECL_ALONE


	)

126 
	#TM_ARGDECL


	)

127 
	#TM_ARG


	)

128 
	#TM_ARG_LAST


	)

129 
	#TM_ARG_ALONE


	)

130 
	#TM_THREAD_ENTER
(è
	`¡m_š™_th»ad
()

	)

131 
	#TM_THREAD_EXIT
() \

132 
	`¡m_g‘_¡©s
("nb_abÜts", &
d
->
nb_abÜts
); \

133 
	`¡m_g‘_¡©s
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
); \

134 
	`¡m_g‘_¡©s
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
); \

135 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
); \

136 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
); \

137 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
); \

138 
	`¡m_g‘_¡©s
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
); \

139 
	`¡m_g‘_¡©s
("nb_abÜts_doubË_wr™e", &
d
->
nb_abÜts_šv®id_memÜy
); \

140 
	`¡m_g‘_¡©s
("max_»Œ›s", &
d
->
max_»Œ›s
); \

141 
	`¡m_ex™_th»ad
()

	)

142 
	#TM_STARTUP
() \

144 
	`årštf
(
¡d”r
, "Error: unsupported†ong‡nd…ointer sizes\n"); \

145 
	`ex™
(1); \

147 
	`¡m_š™
(); \

148 
	`mod_mem_š™
(0); \

149 ià(
	`g‘’v
("STM_STATS"è!ğ
NULL
) { \

150 
	`mod_¡©s_š™
(); \

151 }

	)

152 
	#TM_SHUTDOWN
() \

153 ià(
	`g‘’v
("STM_STATS"è!ğ
NULL
) { \

154 
u
; \

155 ià(
	`¡m_g‘_¡©s
("glob®_nb_comm™s", &
u
) != 0) \

156 
	`´štf
("#comm™  : %lu\n", 
u
); \

157 ià(
	`¡m_g‘_¡©s
("glob®_nb_abÜts", &
u
) != 0) \

158 
	`´štf
("#abÜt  : %lu\n", 
u
); \

159 ià(
	`¡m_g‘_¡©s
("glob®_max_»Œ›s", &
u
) != 0) \

160 
	`´štf
("Max„‘r› : %lu\n", 
u
); \

162 
	`¡m_ex™
()

	)

	@include/tl2-mbench.h

1 
	~<¡ršg.h
>

2 
	~"¡m.h
"

5 
	#NL
 1

	)

6 
	#EL
 0

	)

7 
	#TX_START
(
ty³
è
	`STM_BEGIN_WR
()

	)

8 
	#TX_END
 
	`STM_END
()

	)

9 
	#MALLOC
(
size
è
	`m®loc
(size)

	)

10 
	#FREE
(
addr
, 
±r
è
	`ä“
ÕŒ)

	)

11 
	#TM_MALLOC
(
size
è
	`MALLOC
(size)

	)

12 
	#TM_FREE
(
±r
è
	`FREE
(0,…Œ)

	)

13 
	#TM_RESTART
(è
	`STM_RESTART
()

	)

14 
	#TM_CALLABLE


	)

15 
	#TM_ARG
 
STM_SELF
,

	)

16 
	#TM_ARG_ALONE
 
STM_SELF


	)

17 
	#TM_ARGDECL
 
STM_THREAD_T
* 
TM_ARG


	)

18 
	#TM_ARGDECL_ALONE
 
STM_THREAD_T
* 
TM_ARG_ALONE


	)

19 
	#TM_STARTUP
(
numTh»ad
è
	`STM_STARTUP
()

	)

21 
	#TM_SHUTDOWN
(è
	`STM_SHUTDOWN
()

	)

22 
	#TM_THREAD_ENTER
(è
TM_ARGDECL_ALONE
 = 
	`STM_NEW_THREAD
(); \

23 
	`STM_INIT_THREAD
(
TM_ARG_ALONE
, 0)

	)

24 
	#TM_THREAD_EXIT
(è
	`STM_FREE_THREAD
(
TM_ARG_ALONE
)

	)

26 
	#TM_SHARED_READ
(
v¬
è
	`STM_READ
(v¬)

	)

27 
	#TM_SHARED_READ_P
(
v¬
è
	`STM_READ_P
(v¬)

	)

28 
	#TM_SHARED_READ_F
(
v¬
è
	`STM_READ_F
(v¬)

	)

30 
	#TM_SHARED_WRITE
(
v¬
, 
v®
è
	`STM_WRITE
((v¬), v®)

	)

31 
	#TM_SHARED_WRITE_P
(
v¬
, 
v®
è
	`STM_WRITE_P
((v¬), v®)

	)

32 
	#TM_SHARED_WRITE_F
(
v¬
, 
v®
è
	`STM_WRITE_F
((v¬), v®)

	)

34 
	#TM_LOCAL_WRITE
(
v¬
, 
v®
è
	`STM_LOCAL_WRITE
(v¬, v®)

	)

35 
	#TM_LOCAL_WRITE_P
(
v¬
, 
v®
è
	`STM_LOCAL_WRITE_P
(v¬, v®)

	)

36 
	#TM_LOCAL_WRITE_F
(
v¬
, 
v®
è
	`STM_LOCAL_WRITE_F
(v¬, v®)

	)

	@include/tm.h

2 #ifdeà
ESTM


3 
	~"e¡m.h
"

4 #–ià
defšed
(
TINY100
è|| defšed(
TINY10B
è|| defšed(
TINY099
è|| defšed(
TINY098
)

5 
	~"tšy¡m.h
"

6 #–ià
defšed
 
WPLDSTM


7 
	~"wÍd¡m.h
"

8 #–ià
defšed
 
LOCKFREE


9 
	~"lockä“.h
"

10 #–ià
defšed
 
TL2


11 
	~"2-mb’ch.h
"

12 #–ià
defšed
 
ICC


13 
	~"icc.h
"

14 #–ià
defšed
 
SEQUENTIAL


15 
	~"£qu’tŸl.h
"

	@linkedlists/lazy-list/coupling.c

24 
	~"cou¶šg.h
"

31 
	$lockc_d–‘e
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

32 
node_l_t
 *
cu¼
, *
Ãxt
;

33 
found
;

35 
	`LOCK
(&
£t
->
h—d
->
lock
);

36 
cu¼
 = 
£t
->
h—d
;

37 
	`LOCK
(&
cu¼
->
Ãxt
->
lock
);

38 
Ãxt
 = 
cu¼
->next;

40 
Ãxt
->
v®
 < val) {

41 
	`UNLOCK
(&
cu¼
->
lock
);

42 
cu¼
 = 
Ãxt
;

43 
	`LOCK
(&
Ãxt
->Ãxt->
lock
);

44 
Ãxt
 =‚ext->next;

46 
found
 = (
v®
 =ğ
Ãxt
->val);

47 ià(
found
) {

48 
cu¼
->
Ãxt
 =‚ext->next;

49 
	`UNLOCK
(&
Ãxt
->
lock
);

50 
	`node_d–‘e_l
(
Ãxt
);

51 
	`UNLOCK
(&
cu¼
->
lock
);

53 
	`UNLOCK
(&
cu¼
->
lock
);

54 
	`UNLOCK
(&
Ãxt
->
lock
);

56  
found
;

57 
	}
}

59 
	$lockc_fšd
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

60 
node_l_t
 *
cu¼
, *
Ãxt
;

61 
found
;

63 
	`LOCK
(&
£t
->
h—d
->
lock
);

64 
cu¼
 = 
£t
->
h—d
;

65 
	`LOCK
(&
cu¼
->
Ãxt
->
lock
);

66 
Ãxt
 = 
cu¼
->next;

68 
Ãxt
->
v®
 < val) {

69 
	`UNLOCK
(&
cu¼
->
lock
);

70 
cu¼
 = 
Ãxt
;

71 
	`LOCK
(&
Ãxt
->Ãxt->
lock
);

72 
Ãxt
 = 
cu¼
->next;

74 
found
 = (
v®
 =ğ
Ãxt
->val);

75 
	`UNLOCK
(&
cu¼
->
lock
);

76 
	`UNLOCK
(&
Ãxt
->
lock
);

77  
found
;

78 
	}
}

80 
	$lockc_š£¹
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

81 
node_l_t
 *
cu¼
, *
Ãxt
, *
Ãwnode
;

82 
found
;

84 
	`LOCK
(&
£t
->
h—d
->
lock
);

85 
cu¼
 = 
£t
->
h—d
;

86 
	`LOCK
(&
cu¼
->
Ãxt
->
lock
);

87 
Ãxt
 = 
cu¼
->next;

89 
Ãxt
->
v®
 < val) {

91 
	`UNLOCK
(&
cu¼
->
lock
);

92 
cu¼
 = 
Ãxt
;

93 
	`LOCK
(&
Ãxt
->Ãxt->
lock
);

94 
Ãxt
 = 
cu¼
->next;

97 
found
 = (
v®
 =ğ
Ãxt
->val);

98 ià(!
found
) {

99 
Ãwnode
 = 
	`Ãw_node_l
(
v®
, 
Ãxt
, 0);

100 
cu¼
->
Ãxt
 = 
Ãwnode
;

102 
	`UNLOCK
(&
cu¼
->
lock
);

103 
	`UNLOCK
(&
Ãxt
->
lock
);

104  !
found
;

105 
	}
}

	@linkedlists/lazy-list/coupling.h

24 
	~"lškedli¡-lock.h
"

26 
lockc_d–‘e
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

27 
lockc_fšd
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

28 
lockc_š£¹
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

	@linkedlists/lazy-list/intset.c

24 
	~"Ïzy.h
"

26 
	$£t_cÚšs_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

30  
	`lockc_fšd
(
£t
, 
v®
);

31 
	}
}

33 
	$£t_add_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

37  
	`lockc_š£¹
(
£t
, 
v®
);

38 
	}
}

40 
	$£t_»move_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

44  
	`lockc_d–‘e
(
£t
, 
v®
);

45 
	}
}

	@linkedlists/lazy-list/intset.h

24 
	~"Ïzy.h
"

26 
£t_cÚšs_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

27 
£t_add_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

28 
£t_»move_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

	@linkedlists/lazy-list/lazy.c

27 
	~"Ïzy.h
"

29 
šlše
 
	$is_m¬ked_»f
(
i
) {

30  (è(
i
 &ğ
LONG_MIN
+1);

31 
	}
}

33 
šlše
 
	$un£t_m¬k
(
i
) {

34 
i
 &ğ
LONG_MAX
-1;

35  
i
;

36 
	}
}

38 
šlše
 
	$£t_m¬k
(
i
) {

39 
i
 = 
	`un£t_m¬k
(i);

40 
i
 += 1;

41  
i
;

42 
	}
}

44 
šlše
 
node_l_t
 *
	$g‘_unm¬ked_»f
(
node_l_t
 *
n
) {

45  (
node_l_t
 *è
	`un£t_m¬k
((è
n
);

46 
	}
}

48 
šlše
 
node_l_t
 *
	$g‘_m¬ked_»f
(
node_l_t
 *
n
) {

49  (
node_l_t
 *è
	`£t_m¬k
((è
n
);

50 
	}
}

56 
šlše
 
	$·r£_v®id©e
(
node_l_t
 *
´ed
,‚ode_l_ˆ*
cu¼
) {

57  (!
	`is_m¬ked_»f
((è
´ed
è&& !is_m¬ked_»f((è
cu¼
è&& (´ed->
Ãxt
 == curr));

58 
	}
}

60 
	$·r£_fšd
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

61 
node_l_t
 *
cu¼
;

62 
cu¼
 = 
£t
->
h—d
;

63 
cu¼
->
v®
 < val)

64 
cu¼
 = 
	`g‘_unm¬ked_»f
(cu¼->
Ãxt
);

65  ((
cu¼
->
v®
 =ğv®è&& !
	`is_m¬ked_»f
(() curr));

66 
	}
}

68 
	$·r£_š£¹
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

69 
node_l_t
 *
cu¼
, *
´ed
, *
Ãwnode
;

70 
»suÉ
;

72 
´ed
 = 
£t
->
h—d
;

73 
cu¼
 = 
	`g‘_unm¬ked_»f
(
´ed
->
Ãxt
);

74 
cu¼
->
v®
 < val) {

75 
´ed
 = 
cu¼
;

76 
cu¼
 = 
	`g‘_unm¬ked_»f
(cu¼->
Ãxt
);

78 
	`LOCK
(&
´ed
->
lock
);

79 
	`LOCK
(&
cu¼
->
lock
);

80 
»suÉ
 = (
	`·r£_v®id©e
(
´ed
, 
cu¼
è&& (cu¼->
v®
 != val));

81 ià(
»suÉ
) {

82 
Ãwnode
 = 
	`Ãw_node_l
(
v®
, 
cu¼
, 0);

83 
´ed
->
Ãxt
 = 
Ãwnode
;

85 
	`UNLOCK
(&
cu¼
->
lock
);

86 
	`UNLOCK
(&
´ed
->
lock
);

87  
»suÉ
;

88 
	}
}

99 
	$·r£_d–‘e
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

100 
node_l_t
 *
´ed
, *
cu¼
;

101 
»suÉ
;

103 
´ed
 = 
£t
->
h—d
;

104 
cu¼
 = 
	`g‘_unm¬ked_»f
(
´ed
->
Ãxt
);

105 
cu¼
->
v®
 < val) {

106 
´ed
 = 
cu¼
;

107 
cu¼
 = 
	`g‘_unm¬ked_»f
(cu¼->
Ãxt
);

109 
	`LOCK
(&
´ed
->
lock
);

110 
	`LOCK
(&
cu¼
->
lock
);

111 
»suÉ
 = (
	`·r£_v®id©e
(
´ed
, 
cu¼
è&& (
v®
 == curr->val));

112 ià(
»suÉ
) {

113 
cu¼
->
Ãxt
 = 
	`g‘_m¬ked_»f
(curr->next);

114 
´ed
->
Ãxt
 = 
	`g‘_unm¬ked_»f
(
cu¼
->next);

116 
	`UNLOCK
(&
cu¼
->
lock
);

117 
	`UNLOCK
(&
´ed
->
lock
);

118  
»suÉ
;

119 
	}
}

	@linkedlists/lazy-list/lazy.h

27 
	~"cou¶šg.h
"

30 
šlše
 
is_m¬ked_»f
(
i
);

31 
šlše
 
un£t_m¬k
(
i
);

32 
šlše
 
£t_m¬k
(
i
);

33 
šlše
 
node_l_t
 *
g‘_unm¬ked_»f
Òode_l_ˆ*
n
);

34 
šlše
 
node_l_t
 *
g‘_m¬ked_»f
Òode_l_ˆ*
n
);

37 
·r£_v®id©e
(
node_l_t
 *
´ed
,‚ode_l_ˆ*
cu¼
);

38 
·r£_fšd
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

39 
·r£_š£¹
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

40 
·r£_d–‘e
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

	@linkedlists/lazy-list/linkedlist-lock.c

24 
	~"št£t.h
"

26 
node_l_t
 *
	$Ãw_node_l
(
v®_t
 
v®
, 
node_l_t
 *
Ãxt
, 
Œª§ùiÚ®
)

28 
node_l_t
 *
node_l
;

30 
node_l
 = (
node_l_t
 *)
	`m®loc
((node_l_t));

31 ià(
node_l
 =ğ
NULL
) {

32 
	`³¼Ü
("malloc");

33 
	`ex™
(1);

35 
node_l
->
v®
 = val;

36 
node_l
->
Ãxt
 =‚ext;

37 
	`INIT_LOCK
(&
node_l
->
lock
);

38  
node_l
;

39 
	}
}

41 
št£t_l_t
 *
	$£t_Ãw_l
()

43 
št£t_l_t
 *
£t
;

44 
node_l_t
 *
mš
, *
max
;

46 ià((
£t
 = (
št£t_l_t
 *)
	`m®loc
((št£t_l_t))è=ğ
NULL
) {

47 
	`³¼Ü
("malloc");

48 
	`ex™
(1);

50 
max
 = 
	`Ãw_node_l
(
VAL_MAX
, 
NULL
, 0);

51 
mš
 = 
	`Ãw_node_l
(
VAL_MIN
, 
max
, 0);

52 
£t
->
h—d
 = 
mš
;

54  
£t
;

55 
	}
}

57 
	$node_d–‘e_l
(
node_l_t
 *
node
) {

58 
	`DESTROY_LOCK
(&
node
->
lock
);

59 
	`ä“
(
node
);

60 
	}
}

62 
	$£t_d–‘e_l
(
št£t_l_t
 *
£t
)

64 
node_l_t
 *
node
, *
Ãxt
;

66 
node
 = 
£t
->
h—d
;

67 
node
 !ğ
NULL
) {

68 
Ãxt
 = 
node
->next;

69 
	`DESTROY_LOCK
(&
node
->
lock
);

70 
	`ä“
(
node
);

71 
node
 = 
Ãxt
;

73 
	`ä“
(
£t
);

74 
	}
}

76 
	$£t_size_l
(
št£t_l_t
 *
£t
)

78 
size
 = 0;

79 
node_l_t
 *
node
;

82 
node
 = 
£t
->
h—d
->
Ãxt
;

83 
node
->
Ãxt
 !ğ
NULL
) {

84 
size
++;

85 
node
 =‚ode->
Ãxt
;

88  
size
;

89 
	}
}

	@linkedlists/lazy-list/linkedlist-lock.h

24 
	~<as£¹.h
>

25 
	~<g‘İt.h
>

26 
	~<lim™s.h
>

27 
	~<±h»ad.h
>

28 
	~<sigÇl.h
>

29 
	~<¡dlib.h
>

30 
	~<¡dio.h
>

31 
	~<sys/time.h
>

32 
	~<time.h
>

33 
	~<¡dšt.h
>

35 
	~<immšŒš.h
>

37 
	~<©omic_İs.h
>

39 
	#DEFAULT_DURATION
 10000

	)

40 
	#DEFAULT_INITIAL
 256

	)

41 
	#DEFAULT_NB_THREADS
 4

	)

42 
	#DEFAULT_RANGE
 0x7FFFFFFF

	)

43 
	#DEFAULT_SEED
 0

	)

44 
	#DEFAULT_UPDATE
 20

	)

45 
	#DEFAULT_LOCKTYPE
 2

	)

46 
	#DEFAULT_ALTERNATE
 0

	)

47 
	#DEFAULT_EFFECTIVE
 1

	)

49 
	#XSTR
(
s
è
	`STR
(s)

	)

50 
	#STR
(
s
è#s

	)

52 
	#ATOMIC_CAS_MB_FBAR
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

54 
	#ATOMIC_CAS_MB_NOBAR
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

56 vŞ©
AO_t
 
	g¡İ
;

58 
	#TRANSACTIONAL
 
d
->
un™_tx


	)

60 
	#TRUE
 1

	)

61 
	#FALSE
 0

	)

63 
šŒ_t
 
	tv®_t
;

64 
	#VAL_MIN
 
INT_MIN


	)

65 
	#VAL_MAX
 
INT_MAX


	)

67 #ifdeà
MUTEX


68 
	t±lock_t
;

69 
	#INIT_LOCK
(
lock
) { \

70 *(vŞ©*)
lock
 = 0; \

71 }

	)

73 
	#DESTROY_LOCK
(
lock
è

	)

75 
	#LOCK
(
lock
) { \

76 
	`__©omic_exchªge_n
((vŞ©*)
lock
, 1, 
__ATOMIC_ACQUIRE
 | 
__ATOMIC_HLE_ACQUIRE
)){ \

78 
	`_mm_·u£
(); \

79 }*(vŞ©*)
lock
 == 1); \

81 }

	)

83 
	#UNLOCK
(
lock
) { \

84 
	`__©omic_¡Üe_n
((vŞ©*)
lock
, 0, 
__ATOMIC_RELEASE
 | 
__ATOMIC_HLE_RELEASE
); \

85 }

	)

88 
±h»ad_¥šlock_t
 
	t±lock_t
;

89 
	#INIT_LOCK
(
lock
è
	`±h»ad_¥š_š™
((
±h»ad_¥šlock_t
 *èlock, 
PTHREAD_PROCESS_PRIVATE
);

	)

90 
	#DESTROY_LOCK
(
lock
è
	`±h»ad_¥š_de¡roy
((
±h»ad_¥šlock_t
 *èlock)

	)

91 
	#LOCK
(
lock
è
	`±h»ad_¥š_lock
((
±h»ad_¥šlock_t
 *èlock)

	)

92 
	#UNLOCK
(
lock
è
	`±h»ad_¥š_uÆock
((
±h»ad_¥šlock_t
 *èlock)

	)

95 
	snode_l
 {

96 
v®_t
 
	mv®
;

97 
node_l
 *
	mÃxt
;

98 vŞ©
±lock_t
 
	mlock
;

99 } 
	tnode_l_t
;

101 
	sšt£t_l
 {

102 
node_l_t
 *
	mh—d
;

103 } 
	tšt£t_l_t
;

105 
node_l_t
 *
Ãw_node_l
(
v®_t
 
v®
,‚ode_l_ˆ*
Ãxt
, 
Œª§ùiÚ®
);

106 
št£t_l_t
 *
£t_Ãw_l
();

107 
£t_d–‘e_l
(
št£t_l_t
 *
£t
);

108 
£t_size_l
(
št£t_l_t
 *
£t
);

109 
node_d–‘e_l
(
node_l_t
 *
node
);

	@linkedlists/lazy-list/test.c

24 
	~"št£t.h
"

26 
	sb¬r›r
 {

27 
±h»ad_cÚd_t
 
	mcom¶‘e
;

28 
±h»ad_mu‹x_t
 
	mmu‹x
;

29 
	mcouÁ
;

30 
	müossšg
;

31 } 
	tb¬r›r_t
;

33 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

35 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

36 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

37 
b
->
couÁ
 = 
n
;

38 
b
->
üossšg
 = 0;

39 
	}
}

41 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

43 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

45 
b
->
üossšg
++;

47 ià(
b
->
üossšg
 < b->
couÁ
) {

48 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

50 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

52 
b
->
üossšg
 = 0;

54 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

55 
	}
}

65 
šlše
 
	$¿nd_¿nge
(
r
) {

66 
m
 = 
RAND_MAX
;

67 
d
, 
v
 = 0;

70 
d
 = (
m
 > 
r
 ?„ : m);

71 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

72 
r
 -ğ
m
;

73 } 
r
 > 0);

74  
v
;

75 
	}
}

76 
¿nd_¿nge
(
r
);

79 
šlše
 
	$¿nd_¿nge_»
(*
£ed
, 
r
) {

80 
m
 = 
RAND_MAX
;

81 
d
, 
v
 = 0;

84 
d
 = (
m
 > 
r
 ?„ : m);

85 
v
 +ğ1 + ()(
d
 * (()
	`¿nd_r
(
£ed
)/(()(
m
)+1.0)));

86 
r
 -ğ
m
;

87 } 
r
 > 0);

88  
v
;

89 
	}
}

90 
¿nd_¿nge_»
(*
£ed
, 
r
);

92 
	sth»ad_d©a
 {

93 
v®_t
 
	mfœ¡
;

94 
	m¿nge
;

95 
	mupd©e
;

96 
	mun™_tx
;

97 
	m®‹º©e
;

98 
	mefãùive
;

99 
	mnb_add
;

100 
	mnb_added
;

101 
	mnb_»move
;

102 
	mnb_»moved
;

103 
	mnb_cÚšs
;

104 
	mnb_found
;

105 
	mnb_abÜts
;

106 
	mnb_abÜts_locked_»ad
;

107 
	mnb_abÜts_locked_wr™e
;

108 
	mnb_abÜts_v®id©e_»ad
;

109 
	mnb_abÜts_v®id©e_wr™e
;

110 
	mnb_abÜts_v®id©e_comm™
;

111 
	mnb_abÜts_šv®id_memÜy
;

112 
	mmax_»Œ›s
;

113 
	m£ed
;

114 
št£t_l_t
 *
	m£t
;

115 
b¬r›r_t
 *
	mb¬r›r
;

116 } 
	tth»ad_d©a_t
;

119 *
	$‹¡
(*
d©a
) {

120 
uÃxt
, 
Ï¡
 = -1;

121 
v®_t
 
v®
 = 0;

123 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

126 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

129 
uÃxt
 = (
	`¿nd_¿nge_»
(&
d
->
£ed
, 100è- 1 < d->
upd©e
);

131 
¡İ
 == 0) {

133 ià(
uÃxt
) {

135 ià(
Ï¡
 < 0) {

137 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

138 ià(
	`£t_add_l
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

139 
d
->
nb_added
++;

140 
Ï¡
 = 
v®
;

142 
d
->
nb_add
++;

146 ià(
d
->
®‹º©e
) {

148 ià(
	`£t_»move_l
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
)) {

149 
d
->
nb_»moved
++;

151 
Ï¡
 = -1;

155 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

156 ià(
	`£t_»move_l
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

157 
d
->
nb_»moved
++;

158 
Ï¡
 = -1;

162 
d
->
nb_»move
++;

167 ià(
d
->
®‹º©e
) {

168 ià(
d
->
upd©e
 == 0) {

169 ià(
Ï¡
 < 0) {

170 
v®
 = 
d
->
fœ¡
;

171 
Ï¡
 = 
v®
;

173 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

174 
Ï¡
 = -1;

177 ià(
Ï¡
 < 0) {

178 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

181 
v®
 = 
Ï¡
;

184 } 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

186 ià(
	`£t_cÚšs_l
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

187 
d
->
nb_found
++;

188 
d
->
nb_cÚšs
++;

192 ià(
d
->
efãùive
) {

193 
uÃxt
 = ((100 * (
d
->
nb_added
 + d->
nb_»moved
))

194 < (
d
->
upd©e
 * (d->
nb_add
 + d->
nb_»move
 + d->
nb_cÚšs
)));

196 
uÃxt
 = (
	`¿nd_¿nge_»
(&
d
->
£ed
, 100è- 1 < d->
upd©e
);

200  
NULL
;

201 
	}
}

203 
	$maš
(
¬gc
, **
¬gv
)

205 
İtiÚ
 
lÚg_İtiÚs
[] = {

207 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

208 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

209 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

210 {"th»ad-num", 
»quœed_¬gum’t
, 
NULL
, 't'},

211 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

212 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 'S'},

213 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

214 {"un™-tx", 
»quœed_¬gum’t
, 
NULL
, 'x'},

215 {
NULL
, 0, NULL, 0}

218 
št£t_l_t
 *
£t
;

219 
i
, 
c
, 
size
;

220 
v®_t
 
Ï¡
 = 0;

221 
v®_t
 
v®
 = 0;

222 
»ads
, 
efä—ds
, 
upd©es
, 
effupds
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

223 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

224 
abÜts_šv®id_memÜy
, 
max_»Œ›s
;

225 
th»ad_d©a_t
 *
d©a
;

226 
±h»ad_t
 *
th»ads
;

227 
±h»ad_©Œ_t
 
©Œ
;

228 
b¬r›r_t
 
b¬r›r
;

229 
timev®
 
¡¬t
, 
’d
;

230 
time¥ec
 
timeout
;

231 
du¿tiÚ
 = 
DEFAULT_DURATION
;

232 
š™Ÿl
 = 
DEFAULT_INITIAL
;

233 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

234 
¿nge
 = 
DEFAULT_RANGE
;

235 
£ed
 = 
DEFAULT_SEED
;

236 
upd©e
 = 
DEFAULT_UPDATE
;

237 
un™_tx
 = 
DEFAULT_LOCKTYPE
;

238 
®‹º©e
 = 
DEFAULT_ALTERNATE
;

239 
efãùive
 = 
DEFAULT_EFFECTIVE
;

240 
sig£t_t
 
block_£t
;

243 
i
 = 0;

244 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hAf:d:i:t:r:S:u:x:", 
lÚg_İtiÚs
, &
i
);

246 if(
c
 == -1)

249 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

250 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

252 
c
) {

257 
	`´štf
("intset -- STM stressest "

266 " -A, --®‹º©(deçuÉ="
	`XSTR
(
DEFAULT_ALTERNATE
)")\n"

269 " upd©tx mu¡ƒfãùiv–y wr™(0ñrŸl, 1ófãùive, deçuÉ=" 
	`XSTR
(
DEFAULT_EFFECTIVE
) ")\n"

271 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

273 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

275 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

277 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

279 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

281 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

287 
	`ex™
(0);

289 
®‹º©e
 = 1;

292 
efãùive
 = 
	`©oi
(
İrg
);

295 
du¿tiÚ
 = 
	`©oi
(
İrg
);

298 
š™Ÿl
 = 
	`©oi
(
İrg
);

301 
nb_th»ads
 = 
	`©oi
(
İrg
);

304 
¿nge
 = 
	`©Ş
(
İrg
);

307 
£ed
 = 
	`©oi
(
İrg
);

310 
upd©e
 = 
	`©oi
(
İrg
);

313 
	`´štf
("The…arameter x is‚ot valid forhis benchmark.\n");

314 
	`ex™
(0);

316 
	`´štf
("The…arameter‡ is‚ot valid forhis benchmark.\n");

317 
	`ex™
(0);

319 
	`´štf
("The…arameter s is‚ot valid forhis benchmark.\n");

320 
	`ex™
(0);

322 
	`´štf
("Use -h or --help for help.\n");

323 
	`ex™
(0);

325 
	`ex™
(1);

329 
	`as£¹
(
du¿tiÚ
 >= 0);

330 
	`as£¹
(
š™Ÿl
 >= 0);

331 
	`as£¹
(
nb_th»ads
 > 0);

332 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

333 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

335 
	`´štf
("Setype :†azy†inked†ist\n");

336 
	`´štf
("L’gth : %d\n", 
du¿tiÚ
);

337 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

338 
	`´štf
("Th»ad‚um : %d\n", 
nb_th»ads
);

339 
	`´štf
("V®u¿ng : %ld\n", 
¿nge
);

340 
	`´štf
("S“d : %d\n", 
£ed
);

341 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

342 
	`´štf
("Lock‡lg : %d\n", 
un™_tx
);

343 
	`´štf
("AÉ”Ç‹ : %d\n", 
®‹º©e
);

344 
	`´štf
("Efãùiv : %d\n", 
efãùive
);

345 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

349 ()(
ušŒ_t
));

351 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

352 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

354 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

355 
	`³¼Ü
("malloc");

356 
	`ex™
(1);

358 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

359 
	`³¼Ü
("malloc");

360 
	`ex™
(1);

363 ià(
£ed
 == 0)

364 
	`¤ªd
(()
	`time
(0));

366 
	`¤ªd
(
£ed
);

368 
£t
 = 
	`£t_Ãw_l
();

370 
¡İ
 = 0;

373 
	`´štf
("Initializing STM\n");

376 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

377 
i
 = 0;

378 
i
 < 
š™Ÿl
) {

379 
v®
 = (
	`¿nd
(è% 
¿nge
) + 1;

380 ià(
	`£t_add_l
(
£t
, 
v®
, 0)) {

381 
Ï¡
 = 
v®
;

382 
i
++;

385 
size
 = 
	`£t_size_l
(
£t
);

386 
	`´štf
("S‘ siz : %d\n", 
size
);

389 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

390 
	`±h»ad_©Œ_š™
(&
©Œ
);

391 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

392 
i
 = 0; i < 
nb_th»ads
; i++) {

393 
	`´štf
("C»©šgh»ad %d\n", 
i
);

394 
d©a
[
i
].
fœ¡
 = 
Ï¡
;

395 
d©a
[
i
].
¿nge
 =„ange;

396 
d©a
[
i
].
upd©e
 = update;

397 
d©a
[
i
].
®‹º©e
 =‡lternate;

398 
d©a
[
i
].
un™_tx
 = unit_tx;

399 
d©a
[
i
].
®‹º©e
 =‡lternate;

400 
d©a
[
i
].
efãùive
 =ƒffective;

401 
d©a
[
i
].
nb_add
 = 0;

402 
d©a
[
i
].
nb_added
 = 0;

403 
d©a
[
i
].
nb_»move
 = 0;

404 
d©a
[
i
].
nb_»moved
 = 0;

405 
d©a
[
i
].
nb_cÚšs
 = 0;

406 
d©a
[
i
].
nb_found
 = 0;

407 
d©a
[
i
].
nb_abÜts
 = 0;

408 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

409 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

410 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

411 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

412 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

413 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

414 
d©a
[
i
].
max_»Œ›s
 = 0;

415 
d©a
[
i
].
£ed
 = 
	`¿nd
();

416 
d©a
[
i
].
£t
 = set;

417 
d©a
[
i
].
b¬r›r
 = &barrier;

418 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

419 
	`årštf
(
¡d”r
, "Error creatinghread\n");

420 
	`ex™
(1);

423 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

426 
	`b¬r›r_üoss
(&
b¬r›r
);

428 
	`´štf
("STARTING...\n");

429 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

430 ià(
du¿tiÚ
 > 0) {

431 
	`Çno¦“p
(&
timeout
, 
NULL
);

433 
	`sigem±y£t
(&
block_£t
);

434 
	`sigsu¥’d
(&
block_£t
);

436 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

437 
	`g‘timeofday
(&
’d
, 
NULL
);

438 
	`´štf
("STOPPING...\n");

441 
i
 = 0; i < 
nb_th»ads
; i++) {

442 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

443 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

444 
	`ex™
(1);

448 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

449 
abÜts
 = 0;

450 
abÜts_locked_»ad
 = 0;

451 
abÜts_locked_wr™e
 = 0;

452 
abÜts_v®id©e_»ad
 = 0;

453 
abÜts_v®id©e_wr™e
 = 0;

454 
abÜts_v®id©e_comm™
 = 0;

455 
abÜts_šv®id_memÜy
 = 0;

456 
»ads
 = 0;

457 
efä—ds
 = 0;

458 
upd©es
 = 0;

459 
effupds
 = 0;

460 
max_»Œ›s
 = 0;

461 
i
 = 0; i < 
nb_th»ads
; i++) {

462 
	`´štf
("Th»ad %d\n", 
i
);

463 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

464 
	`´štf
(" #added : %lu\n", 
d©a
[
i
].
nb_added
);

465 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

466 
	`´štf
(" #»moved : %lu\n", 
d©a
[
i
].
nb_»moved
);

467 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

468 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

469 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

470 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

471 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

472 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

473 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

474 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

475 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

476 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

477 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

478 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

479 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

480 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

481 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

482 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

483 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

484 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

485 
efä—ds
 +ğ
d©a
[
i
].
nb_cÚšs
 +

486 (
d©a
[
i
].
nb_add
 - d©a[i].
nb_added
) +

487 (
d©a
[
i
].
nb_»move
 - d©a[i].
nb_»moved
);

488 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

489 
effupds
 +ğ
d©a
[
i
].
nb_»moved
 + d©a[i].
nb_added
;

492 
size
 +ğ
d©a
[
i
].
nb_added
 - d©a[i].
nb_»moved
;

493 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

494 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

496 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`£t_size_l
(
£t
), 
size
);

497 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

498 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
, (»ad + upd©esè* 1000.0 / 
du¿tiÚ
);

500 
	`´štf
("#readxs : ");

501 ià(
efãùive
) {

502 
	`´štf
("%lu (%à/ s)\n", 
efä—ds
,ƒfä—d * 1000.0 / 
du¿tiÚ
);

503 
	`´štf
(" #cÚš  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

504 } 
	`´štf
("%lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

506 
	`´štf
("#eff. upd„©e: %à\n", 100.0 * 
effupds
 / (effupd + 
efä—ds
));

508 
	`´štf
("#updatexs : ");

509 ià(
efãùive
) {

510 
	`´štf
("%lu (%à/ s)\n", 
effupds
,ƒffupd * 1000.0 / 
du¿tiÚ
);

511 
	`´štf
(" #updrŸl : %lu (%à/ s)\n", 
upd©es
, updates * 1000.0 /

512 
du¿tiÚ
);

513 } 
	`´štf
("%lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

515 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

516 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

517 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

518 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

519 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

520 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

521 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

522 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

525 
	`£t_d–‘e_l
(
£t
);

527 
	`ä“
(
th»ads
);

528 
	`ä“
(
d©a
);

531 
	}
}

	@linkedlists/lock-coupling-list/coupling.c

24 
	~"cou¶šg.h
"

31 
	$lockc_d–‘e
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

32 
node_l_t
 *
cu¼
, *
Ãxt
;

33 
found
;

35 
	`LOCK
(&
£t
->
h—d
->
lock
);

36 
cu¼
 = 
£t
->
h—d
;

37 
	`LOCK
(&
cu¼
->
Ãxt
->
lock
);

38 
Ãxt
 = 
cu¼
->next;

40 
Ãxt
->
v®
 < val) {

41 
	`UNLOCK
(&
cu¼
->
lock
);

42 
cu¼
 = 
Ãxt
;

43 
	`LOCK
(&
Ãxt
->Ãxt->
lock
);

44 
Ãxt
 =‚ext->next;

46 
found
 = (
v®
 =ğ
Ãxt
->val);

47 ià(
found
) {

48 
cu¼
->
Ãxt
 =‚ext->next;

49 
	`UNLOCK
(&
Ãxt
->
lock
);

50 
	`node_d–‘e_l
(
Ãxt
);

51 
	`UNLOCK
(&
cu¼
->
lock
);

53 
	`UNLOCK
(&
cu¼
->
lock
);

54 
	`UNLOCK
(&
Ãxt
->
lock
);

56  
found
;

57 
	}
}

59 
	$lockc_fšd
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

60 
node_l_t
 *
cu¼
, *
Ãxt
;

61 
found
;

63 
	`LOCK
(&
£t
->
h—d
->
lock
);

64 
cu¼
 = 
£t
->
h—d
;

65 
	`LOCK
(&
cu¼
->
Ãxt
->
lock
);

66 
Ãxt
 = 
cu¼
->next;

68 
Ãxt
->
v®
 < val) {

69 
	`UNLOCK
(&
cu¼
->
lock
);

70 
cu¼
 = 
Ãxt
;

71 
	`LOCK
(&
Ãxt
->Ãxt->
lock
);

72 
Ãxt
 = 
cu¼
->next;

74 
found
 = (
v®
 =ğ
Ãxt
->val);

75 
	`UNLOCK
(&
cu¼
->
lock
);

76 
	`UNLOCK
(&
Ãxt
->
lock
);

77  
found
;

78 
	}
}

80 
	$lockc_š£¹
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

81 
node_l_t
 *
cu¼
, *
Ãxt
, *
Ãwnode
;

82 
found
;

84 
	`LOCK
(&
£t
->
h—d
->
lock
);

85 
cu¼
 = 
£t
->
h—d
;

86 
	`LOCK
(&
cu¼
->
Ãxt
->
lock
);

87 
Ãxt
 = 
cu¼
->next;

89 
Ãxt
->
v®
 < val) {

91 
	`UNLOCK
(&
cu¼
->
lock
);

92 
cu¼
 = 
Ãxt
;

93 
	`LOCK
(&
Ãxt
->Ãxt->
lock
);

94 
Ãxt
 = 
cu¼
->next;

97 
found
 = (
v®
 =ğ
Ãxt
->val);

98 ià(!
found
) {

99 
Ãwnode
 = 
	`Ãw_node_l
(
v®
, 
Ãxt
, 0);

100 
cu¼
->
Ãxt
 = 
Ãwnode
;

102 
	`UNLOCK
(&
cu¼
->
lock
);

103 
	`UNLOCK
(&
Ãxt
->
lock
);

104  !
found
;

105 
	}
}

	@linkedlists/lock-coupling-list/coupling.h

24 
	~"lškedli¡-lock.h
"

26 
lockc_d–‘e
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

27 
lockc_fšd
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

28 
lockc_š£¹
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

	@linkedlists/lock-coupling-list/intset.c

24 
	~"Ïzy.h
"

26 
	$£t_cÚšs_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

28 ià(
Œª§ùiÚ®
 =ğ2è 
	`·r£_fšd
(
£t
, 
v®
);

29  
	`lockc_fšd
(
£t
, 
v®
);

30 
	}
}

32 
	$£t_add_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

34 ià(
Œª§ùiÚ®
 =ğ2è 
	`·r£_š£¹
(
£t
, 
v®
);

35  
	`lockc_š£¹
(
£t
, 
v®
);

36 
	}
}

38 
	$£t_»move_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

40 ià(
Œª§ùiÚ®
 =ğ2è 
	`·r£_d–‘e
(
£t
, 
v®
);

41  
	`lockc_d–‘e
(
£t
, 
v®
);

42 
	}
}

	@linkedlists/lock-coupling-list/intset.h

24 
	~"Ïzy.h
"

26 
£t_cÚšs_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

27 
£t_add_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

28 
£t_»move_l
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

	@linkedlists/lock-coupling-list/lazy.c

27 
	~"Ïzy.h
"

29 
šlše
 
	$is_m¬ked_»f
(
i
) {

30  (è(
i
 &ğ
LONG_MIN
+1);

31 
	}
}

33 
šlše
 
	$un£t_m¬k
(
i
) {

34 
i
 &ğ
LONG_MAX
-1;

35  
i
;

36 
	}
}

38 
šlše
 
	$£t_m¬k
(
i
) {

39 
i
 = 
	`un£t_m¬k
(i);

40 
i
 += 1;

41  
i
;

42 
	}
}

44 
šlše
 
	$g‘_unm¬ked_»f
(
w
) {

45  
	`un£t_m¬k
(
w
);

46 
	}
}

48 
šlše
 
	$g‘_m¬ked_»f
(
w
) {

49  
	`£t_m¬k
(
w
);

50 
	}
}

56 
šlše
 
	$·r£_v®id©e
(
node_l_t
 *
´ed
,‚ode_l_ˆ*
cu¼
) {

57  (!
	`is_m¬ked_»f
((è
´ed
è&& !is_m¬ked_»f((è´edè&& (´ed->
Ãxt
 =ğ
cu¼
));

58 
	}
}

60 
	$·r£_fšd
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

61 
node_l_t
 *
cu¼
;

62 
cu¼
 = 
£t
->
h—d
;

63 
cu¼
->
v®
 < val)

64 
cu¼
 = cu¼->
Ãxt
;

65  ((
cu¼
->
v®
 =ğv®è&& !
	`is_m¬ked_»f
(() curr));

66 
	}
}

68 
	$·r£_š£¹
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

69 
node_l_t
 *
cu¼
, *
´ed
, *
Ãwnode
;

70 
»suÉ
;

72 
´ed
 = 
£t
->
h—d
;

73 
cu¼
 = 
´ed
->
Ãxt
;

74 
cu¼
->
v®
 < val) {

75 
´ed
 = 
cu¼
;

76 
cu¼
 = cu¼->
Ãxt
;

78 
	`LOCK
(&
´ed
->
lock
);

79 
	`LOCK
(&
cu¼
->
lock
);

80 
»suÉ
 = (
	`·r£_v®id©e
(
´ed
, 
cu¼
è&& (cu¼->
v®
 != val));

81 ià(
»suÉ
) {

82 
Ãwnode
 = 
	`Ãw_node_l
(
v®
, 
cu¼
, 0);

83 
´ed
->
Ãxt
 = 
Ãwnode
;

85 
	`UNLOCK
(&
cu¼
->
lock
);

86 
	`UNLOCK
(&
´ed
->
lock
);

87  
»suÉ
;

88 
	}
}

99 
	$·r£_d–‘e
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
) {

100 
node_l_t
 *
´ed
, *
cu¼
;

101 
»suÉ
;

103 
´ed
 = 
£t
->
h—d
;

104 
cu¼
 = 
´ed
->
Ãxt
;

105 
cu¼
->
v®
 < val) {

106 
´ed
 = 
cu¼
;

107 
cu¼
 = cu¼->
Ãxt
;

109 
	`LOCK
(&
´ed
->
lock
);

110 
	`LOCK
(&
cu¼
->
lock
);

111 
»suÉ
 = (
	`·r£_v®id©e
(
´ed
, 
cu¼
è&& (
v®
 == curr->val));

112 ià(
»suÉ
) {

113 
	`£t_m¬k
((è
cu¼
);

114 
´ed
->
Ãxt
 = 
cu¼
->next;

116 
	`UNLOCK
(&
cu¼
->
lock
);

117 
	`UNLOCK
(&
´ed
->
lock
);

118  
»suÉ
;

119 
	}
}

	@linkedlists/lock-coupling-list/lazy.h

27 
	~"cou¶šg.h
"

30 
šlše
 
is_m¬ked_»f
(
i
);

31 
šlše
 
un£t_m¬k
(
i
);

32 
šlše
 
£t_m¬k
(
i
);

33 
šlše
 
g‘_unm¬ked_»f
(
w
);

34 
šlše
 
g‘_m¬ked_»f
(
w
);

37 
·r£_v®id©e
(
node_l_t
 *
´ed
,‚ode_l_ˆ*
cu¼
);

38 
·r£_fšd
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

39 
·r£_š£¹
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

40 
·r£_d–‘e
(
št£t_l_t
 *
£t
, 
v®_t
 
v®
);

	@linkedlists/lock-coupling-list/linkedlist-lock.c

24 
	~"št£t.h
"

26 
node_l_t
 *
	$Ãw_node_l
(
v®_t
 
v®
, 
node_l_t
 *
Ãxt
, 
Œª§ùiÚ®
)

28 
node_l_t
 *
node_l
;

30 
node_l
 = (
node_l_t
 *)
	`m®loc
((node_l_t));

31 ià(
node_l
 =ğ
NULL
) {

32 
	`³¼Ü
("malloc");

33 
	`ex™
(1);

35 
node_l
->
v®
 = val;

36 
node_l
->
Ãxt
 =‚ext;

37 
	`INIT_LOCK
(&
node_l
->
lock
);

38  
node_l
;

39 
	}
}

41 
št£t_l_t
 *
	$£t_Ãw_l
()

43 
št£t_l_t
 *
£t
;

44 
node_l_t
 *
mš
, *
max
;

46 ià((
£t
 = (
št£t_l_t
 *)
	`m®loc
((št£t_l_t))è=ğ
NULL
) {

47 
	`³¼Ü
("malloc");

48 
	`ex™
(1);

50 
max
 = 
	`Ãw_node_l
(
VAL_MAX
, 
NULL
, 0);

51 
mš
 = 
	`Ãw_node_l
(
VAL_MIN
, 
max
, 0);

52 
£t
->
h—d
 = 
mš
;

54  
£t
;

55 
	}
}

57 
	$node_d–‘e_l
(
node_l_t
 *
node
) {

58 
	`DESTROY_LOCK
(&
node
->
lock
);

59 
	`ä“
(
node
);

60 
	}
}

62 
	$£t_d–‘e_l
(
št£t_l_t
 *
£t
)

64 
node_l_t
 *
node
, *
Ãxt
;

66 
node
 = 
£t
->
h—d
;

67 
node
 !ğ
NULL
) {

68 
Ãxt
 = 
node
->next;

69 
	`DESTROY_LOCK
(&
node
->
lock
);

70 
	`ä“
(
node
);

71 
node
 = 
Ãxt
;

73 
	`ä“
(
£t
);

74 
	}
}

76 
	$£t_size_l
(
št£t_l_t
 *
£t
)

78 
size
 = 0;

79 
node_l_t
 *
node
;

82 
node
 = 
£t
->
h—d
->
Ãxt
;

83 
node
->
Ãxt
 !ğ
NULL
) {

84 
size
++;

85 
node
 =‚ode->
Ãxt
;

88  
size
;

89 
	}
}

	@linkedlists/lock-coupling-list/linkedlist-lock.h

24 
	~<as£¹.h
>

25 
	~<g‘İt.h
>

26 
	~<lim™s.h
>

27 
	~<±h»ad.h
>

28 
	~<sigÇl.h
>

29 
	~<¡dlib.h
>

30 
	~<¡dio.h
>

31 
	~<sys/time.h
>

32 
	~<time.h
>

33 
	~<¡dšt.h
>

35 
	~<©omic_İs.h
>

37 
	#DEFAULT_DURATION
 10000

	)

38 
	#DEFAULT_INITIAL
 256

	)

39 
	#DEFAULT_NB_THREADS
 1

	)

40 
	#DEFAULT_RANGE
 0x7FFFFFFF

	)

41 
	#DEFAULT_SEED
 0

	)

42 
	#DEFAULT_UPDATE
 20

	)

43 
	#DEFAULT_LOCKTYPE
 1

	)

44 
	#DEFAULT_ALTERNATE
 0

	)

45 
	#DEFAULT_EFFECTIVE
 1

	)

47 
	#XSTR
(
s
è
	`STR
(s)

	)

48 
	#STR
(
s
è#s

	)

50 
	#ATOMIC_CAS_MB_FBAR
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

52 
	#ATOMIC_CAS_MB_NOBAR
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

54 vŞ©
AO_t
 
	g¡İ
;

56 
	#TRANSACTIONAL
 
d
->
un™_tx


	)

58 
šŒ_t
 
	tv®_t
;

59 
	#VAL_MIN
 
INT_MIN


	)

60 
	#VAL_MAX
 
INT_MAX


	)

62 #ifdeà
MUTEX


63 
±h»ad_mu‹x_t
 
	t±lock_t
;

64 
	#INIT_LOCK
(
lock
è
	`±h»ad_mu‹x_š™
((
±h»ad_mu‹x_t
 *èlock, 
NULL
);

	)

65 
	#DESTROY_LOCK
(
lock
è
	`±h»ad_mu‹x_de¡roy
((
±h»ad_mu‹x_t
 *èlock)

	)

66 
	#LOCK
(
lock
è
	`±h»ad_mu‹x_lock
((
±h»ad_mu‹x_t
 *èlock)

	)

67 
	#UNLOCK
(
lock
è
	`±h»ad_mu‹x_uÆock
((
±h»ad_mu‹x_t
 *èlock)

	)

69 
±h»ad_¥šlock_t
 
	t±lock_t
;

70 
	#INIT_LOCK
(
lock
è
	`±h»ad_¥š_š™
((
±h»ad_¥šlock_t
 *èlock, 
PTHREAD_PROCESS_PRIVATE
);

	)

71 
	#DESTROY_LOCK
(
lock
è
	`±h»ad_¥š_de¡roy
((
±h»ad_¥šlock_t
 *èlock)

	)

72 
	#LOCK
(
lock
è
	`±h»ad_¥š_lock
((
±h»ad_¥šlock_t
 *èlock)

	)

73 
	#UNLOCK
(
lock
è
	`±h»ad_¥š_uÆock
((
±h»ad_¥šlock_t
 *èlock)

	)

76 
	snode_l
 {

77 
v®_t
 
	mv®
;

78 
node_l
 *
	mÃxt
;

79 vŞ©
±lock_t
 
	mlock
;

80 } 
	tnode_l_t
;

82 
	sšt£t_l
 {

83 
node_l_t
 *
	mh—d
;

84 } 
	tšt£t_l_t
;

86 
node_l_t
 *
Ãw_node_l
(
v®_t
 
v®
,‚ode_l_ˆ*
Ãxt
, 
Œª§ùiÚ®
);

87 
št£t_l_t
 *
£t_Ãw_l
();

88 
£t_d–‘e_l
(
št£t_l_t
 *
£t
);

89 
£t_size_l
(
št£t_l_t
 *
£t
);

90 
node_d–‘e_l
(
node_l_t
 *
node
);

	@linkedlists/lock-coupling-list/test.c

24 
	~"št£t.h
"

26 
	sb¬r›r
 {

27 
±h»ad_cÚd_t
 
	mcom¶‘e
;

28 
±h»ad_mu‹x_t
 
	mmu‹x
;

29 
	mcouÁ
;

30 
	müossšg
;

31 } 
	tb¬r›r_t
;

33 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

35 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

36 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

37 
b
->
couÁ
 = 
n
;

38 
b
->
üossšg
 = 0;

39 
	}
}

41 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

43 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

45 
b
->
üossšg
++;

47 ià(
b
->
üossšg
 < b->
couÁ
) {

48 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

50 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

52 
b
->
üossšg
 = 0;

54 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

55 
	}
}

65 
šlše
 
	$¿nd_¿nge
(
r
) {

66 
m
 = 
RAND_MAX
;

67 
d
, 
v
 = 0;

70 
d
 = (
m
 > 
r
 ?„ : m);

71 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

72 
r
 -ğ
m
;

73 } 
r
 > 0);

74  
v
;

75 
	}
}

76 
¿nd_¿nge
(
r
);

79 
šlše
 
	$¿nd_¿nge_»
(*
£ed
, 
r
) {

80 
m
 = 
RAND_MAX
;

81 
d
, 
v
 = 0;

84 
d
 = (
m
 > 
r
 ?„ : m);

85 
v
 +ğ1 + ()(
d
 * (()
	`¿nd_r
(
£ed
)/(()(
m
)+1.0)));

86 
r
 -ğ
m
;

87 } 
r
 > 0);

88  
v
;

89 
	}
}

90 
¿nd_¿nge_»
(*
£ed
, 
r
);

92 
	sth»ad_d©a
 {

93 
v®_t
 
	mfœ¡
;

94 
	m¿nge
;

95 
	mupd©e
;

96 
	mun™_tx
;

97 
	m®‹º©e
;

98 
	mefãùive
;

99 
	mnb_add
;

100 
	mnb_added
;

101 
	mnb_»move
;

102 
	mnb_»moved
;

103 
	mnb_cÚšs
;

104 
	mnb_found
;

105 
	mnb_abÜts
;

106 
	mnb_abÜts_locked_»ad
;

107 
	mnb_abÜts_locked_wr™e
;

108 
	mnb_abÜts_v®id©e_»ad
;

109 
	mnb_abÜts_v®id©e_wr™e
;

110 
	mnb_abÜts_v®id©e_comm™
;

111 
	mnb_abÜts_šv®id_memÜy
;

112 
	mmax_»Œ›s
;

113 
	m£ed
;

114 
št£t_l_t
 *
	m£t
;

115 
b¬r›r_t
 *
	mb¬r›r
;

116 } 
	tth»ad_d©a_t
;

119 *
	$‹¡
(*
d©a
) {

120 
uÃxt
, 
Ï¡
 = -1;

121 
v®_t
 
v®
 = 0;

123 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

126 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

129 
uÃxt
 = (
	`¿nd_¿nge_»
(&
d
->
£ed
, 100è- 1 < d->
upd©e
);

131 
¡İ
 == 0) {

133 ià(
uÃxt
) {

135 ià(
Ï¡
 < 0) {

137 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

138 ià(
	`£t_add_l
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

139 
d
->
nb_added
++;

140 
Ï¡
 = 
v®
;

142 
d
->
nb_add
++;

146 ià(
d
->
®‹º©e
) {

148 ià(
	`£t_»move_l
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
)) {

149 
d
->
nb_»moved
++;

151 
Ï¡
 = -1;

155 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

156 ià(
	`£t_»move_l
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

157 
d
->
nb_»moved
++;

158 
Ï¡
 = -1;

162 
d
->
nb_»move
++;

167 ià(
d
->
®‹º©e
) {

168 ià(
d
->
upd©e
 == 0) {

169 ià(
Ï¡
 < 0) {

170 
v®
 = 
d
->
fœ¡
;

171 
Ï¡
 = 
v®
;

173 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

174 
Ï¡
 = -1;

177 ià(
Ï¡
 < 0) {

178 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

181 
v®
 = 
Ï¡
;

184 } 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

186 ià(
	`£t_cÚšs_l
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

187 
d
->
nb_found
++;

188 
d
->
nb_cÚšs
++;

192 ià(
d
->
efãùive
) {

193 
uÃxt
 = ((100 * (
d
->
nb_added
 + d->
nb_»moved
))

194 < (
d
->
upd©e
 * (d->
nb_add
 + d->
nb_»move
 + d->
nb_cÚšs
)));

196 
uÃxt
 = (
	`¿nd_¿nge_»
(&
d
->
£ed
, 100è- 1 < d->
upd©e
);

200  
NULL
;

201 
	}
}

203 
	$maš
(
¬gc
, **
¬gv
)

205 
İtiÚ
 
lÚg_İtiÚs
[] = {

207 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

208 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

209 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

210 {"th»ad", 
»quœed_¬gum’t
, 
NULL
, 't'},

211 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

212 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 'S'},

213 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

214 {"un™-tx", 
»quœed_¬gum’t
, 
NULL
, 'x'},

215 {
NULL
, 0, NULL, 0}

218 
št£t_l_t
 *
£t
;

219 
i
, 
c
, 
size
;

220 
v®_t
 
Ï¡
 = 0;

221 
v®_t
 
v®
 = 0;

222 
»ads
, 
efä—ds
, 
upd©es
, 
effupds
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

223 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

224 
abÜts_šv®id_memÜy
, 
max_»Œ›s
;

225 
th»ad_d©a_t
 *
d©a
;

226 
±h»ad_t
 *
th»ads
;

227 
±h»ad_©Œ_t
 
©Œ
;

228 
b¬r›r_t
 
b¬r›r
;

229 
timev®
 
¡¬t
, 
’d
;

230 
time¥ec
 
timeout
;

231 
du¿tiÚ
 = 
DEFAULT_DURATION
;

232 
š™Ÿl
 = 
DEFAULT_INITIAL
;

233 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

234 
¿nge
 = 
DEFAULT_RANGE
;

235 
£ed
 = 
DEFAULT_SEED
;

236 
upd©e
 = 
DEFAULT_UPDATE
;

237 
un™_tx
 = 
DEFAULT_LOCKTYPE
;

238 
®‹º©e
 = 
DEFAULT_ALTERNATE
;

239 
efãùive
 = 
DEFAULT_EFFECTIVE
;

240 
sig£t_t
 
block_£t
;

243 
i
 = 0;

244 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hAf:d:i:t:r:S:u:x:"

245 , 
lÚg_İtiÚs
, &
i
);

247 if(
c
 == -1)

250 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

251 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

253 
c
) {

258 
	`´štf
("intset -- STM stressest "

267 " -A, --®‹º©(deçuÉ="
	`XSTR
(
DEFAULT_ALTERNATE
)")\n"

270 " upd©tx mu¡ƒfãùiv–y wr™(0ñrŸl, 1ófãùive, deçuÉ=" 
	`XSTR
(
DEFAULT_EFFECTIVE
) ")\n"

272 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

274 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

276 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

278 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

280 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

282 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

284 
	`ex™
(0);

286 
®‹º©e
 = 1;

289 
efãùive
 = 
	`©oi
(
İrg
);

292 
du¿tiÚ
 = 
	`©oi
(
İrg
);

295 
š™Ÿl
 = 
	`©oi
(
İrg
);

298 
nb_th»ads
 = 
	`©oi
(
İrg
);

301 
¿nge
 = 
	`©Ş
(
İrg
);

304 
£ed
 = 
	`©oi
(
İrg
);

307 
upd©e
 = 
	`©oi
(
İrg
);

310 
	`´štf
("The…arameter x is‚ot valid forhis benchmark.\n");

311 
	`ex™
(0);

313 
	`´štf
("The…arameter‡ is‚ot valid forhis benchmark.\n");

314 
	`ex™
(0);

316 
	`´štf
("The…arameter s is‚ot valid forhis benchmark.\n");

317 
	`ex™
(0);

319 
	`´štf
("Use -h or --help for help\n");

320 
	`ex™
(0);

322 
	`ex™
(1);

326 
	`as£¹
(
du¿tiÚ
 >= 0);

327 
	`as£¹
(
š™Ÿl
 >= 0);

328 
	`as£¹
(
nb_th»ads
 > 0);

329 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

330 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

332 
	`´štf
("Setype :†inked†ist\n");

333 
	`´štf
("L’gth : %d\n", 
du¿tiÚ
);

334 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

335 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

336 
	`´štf
("V®u¿ng : %ld\n", 
¿nge
);

337 
	`´štf
("S“d : %d\n", 
£ed
);

338 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

339 
	`´štf
("Lock‡lg : %d\n", 
un™_tx
);

340 
	`´štf
("AÉ”Ç‹ : %d\n", 
®‹º©e
);

341 
	`´štf
("Efãùiv : %d\n", 
efãùive
);

342 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

346 ()(
ušŒ_t
));

348 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

349 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

351 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

352 
	`³¼Ü
("malloc");

353 
	`ex™
(1);

355 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

356 
	`³¼Ü
("malloc");

357 
	`ex™
(1);

360 ià(
£ed
 == 0)

361 
	`¤ªd
(()
	`time
(0));

363 
	`¤ªd
(
£ed
);

365 
£t
 = 
	`£t_Ãw_l
();

367 
¡İ
 = 0;

370 
	`´štf
("Initializing STM\n");

373 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

374 
i
 = 0;

375 
i
 < 
š™Ÿl
) {

376 
v®
 = (
	`¿nd
(è% 
¿nge
) + 1;

377 ià(
	`£t_add_l
(
£t
, 
v®
, 0)) {

378 
Ï¡
 = 
v®
;

379 
i
++;

382 
size
 = 
	`£t_size_l
(
£t
);

383 
	`´štf
("S‘ siz : %d\n", 
size
);

386 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

387 
	`±h»ad_©Œ_š™
(&
©Œ
);

388 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

389 
i
 = 0; i < 
nb_th»ads
; i++) {

390 
	`´štf
("C»©šgh»ad %d\n", 
i
);

391 
d©a
[
i
].
fœ¡
 = 
Ï¡
;

392 
d©a
[
i
].
¿nge
 =„ange;

393 
d©a
[
i
].
upd©e
 = update;

394 
d©a
[
i
].
®‹º©e
 =‡lternate;

395 
d©a
[
i
].
un™_tx
 = unit_tx;

396 
d©a
[
i
].
®‹º©e
 =‡lternate;

397 
d©a
[
i
].
efãùive
 =ƒffective;

398 
d©a
[
i
].
nb_add
 = 0;

399 
d©a
[
i
].
nb_added
 = 0;

400 
d©a
[
i
].
nb_»move
 = 0;

401 
d©a
[
i
].
nb_»moved
 = 0;

402 
d©a
[
i
].
nb_cÚšs
 = 0;

403 
d©a
[
i
].
nb_found
 = 0;

404 
d©a
[
i
].
nb_abÜts
 = 0;

405 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

406 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

407 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

408 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

409 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

410 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

411 
d©a
[
i
].
max_»Œ›s
 = 0;

412 
d©a
[
i
].
£ed
 = 
	`¿nd
();

413 
d©a
[
i
].
£t
 = set;

414 
d©a
[
i
].
b¬r›r
 = &barrier;

415 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

416 
	`årštf
(
¡d”r
, "Error creatinghread\n");

417 
	`ex™
(1);

420 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

423 
	`b¬r›r_üoss
(&
b¬r›r
);

425 
	`´štf
("STARTING...\n");

426 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

427 ià(
du¿tiÚ
 > 0) {

428 
	`Çno¦“p
(&
timeout
, 
NULL
);

430 
	`sigem±y£t
(&
block_£t
);

431 
	`sigsu¥’d
(&
block_£t
);

433 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

434 
	`g‘timeofday
(&
’d
, 
NULL
);

435 
	`´štf
("STOPPING...\n");

438 
i
 = 0; i < 
nb_th»ads
; i++) {

439 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

440 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

441 
	`ex™
(1);

445 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

446 
abÜts
 = 0;

447 
abÜts_locked_»ad
 = 0;

448 
abÜts_locked_wr™e
 = 0;

449 
abÜts_v®id©e_»ad
 = 0;

450 
abÜts_v®id©e_wr™e
 = 0;

451 
abÜts_v®id©e_comm™
 = 0;

452 
abÜts_šv®id_memÜy
 = 0;

453 
»ads
 = 0;

454 
efä—ds
 = 0;

455 
upd©es
 = 0;

456 
effupds
 = 0;

457 
max_»Œ›s
 = 0;

458 
i
 = 0; i < 
nb_th»ads
; i++) {

459 
	`´štf
("Th»ad %d\n", 
i
);

460 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

461 
	`´štf
(" #added : %lu\n", 
d©a
[
i
].
nb_added
);

462 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

463 
	`´štf
(" #»moved : %lu\n", 
d©a
[
i
].
nb_»moved
);

464 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

465 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

466 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

467 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

468 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

469 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

470 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

471 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

472 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

473 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

474 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

475 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

476 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

477 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

478 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

479 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

480 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

481 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

482 
efä—ds
 +ğ
d©a
[
i
].
nb_cÚšs
 +

483 (
d©a
[
i
].
nb_add
 - d©a[i].
nb_added
) +

484 (
d©a
[
i
].
nb_»move
 - d©a[i].
nb_»moved
);

485 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

486 
effupds
 +ğ
d©a
[
i
].
nb_»moved
 + d©a[i].
nb_added
;

489 
size
 +ğ
d©a
[
i
].
nb_added
 - d©a[i].
nb_»moved
;

490 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

491 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

493 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`£t_size_l
(
£t
), 
size
);

494 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

495 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
, (»ad + upd©esè* 1000.0 / 
du¿tiÚ
);

497 
	`´štf
("#readxs : ");

498 ià(
efãùive
) {

499 
	`´štf
("%lu (%à/ s)\n", 
efä—ds
,ƒfä—d * 1000.0 / 
du¿tiÚ
);

500 
	`´štf
(" #cÚš  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

501 } 
	`´štf
("%lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

503 
	`´štf
("#eff. upd„©e: %à\n", 100.0 * 
effupds
 / (effupd + 
efä—ds
));

505 
	`´štf
("#updatexs : ");

506 ià(
efãùive
) {

507 
	`´štf
("%lu (%à/ s)\n", 
effupds
,ƒffupd * 1000.0 / 
du¿tiÚ
);

508 
	`´štf
(" #updrŸl : %lu (%à/ s)\n", 
upd©es
, updates * 1000.0 /

509 
du¿tiÚ
);

510 } 
	`´štf
("%lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

512 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

513 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

514 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

515 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

516 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

517 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

518 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

519 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

522 
	`£t_d–‘e_l
(
£t
);

524 
	`ä“
(
th»ads
);

525 
	`ä“
(
d©a
);

528 
	}
}

	@linkedlists/lockfree-list/harris.c

26 
	~"h¬ris.h
"

35 
šlše
 
	$is_m¬ked_»f
(
i
) {

36  (è(
i
 & (
LONG_MIN
+1));

37 
	}
}

39 
šlše
 
	$un£t_m¬k
(
i
) {

40 
i
 &ğ
LONG_MAX
-1;

41  
i
;

42 
	}
}

44 
šlše
 
	$£t_m¬k
(
i
) {

45 
i
 = 
	`un£t_m¬k
(i);

46 
i
 += 1;

47  
i
;

48 
	}
}

50 
šlše
 
	$g‘_unm¬ked_»f
(
w
) {

51  
	`un£t_m¬k
(
w
);

52 
	}
}

54 
šlše
 
	$g‘_m¬ked_»f
(
w
) {

55  
	`£t_m¬k
(
w
);

56 
	}
}

66 
node_t
 *
	$h¬ris_£¬ch
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
node_t
 **
Ëá_node
) {

67 
node_t
 *
Ëá_node_Ãxt
, *
right_node
;

68 
Ëá_node_Ãxt
 = 
£t
->
h—d
;

70 
£¬ch_agaš
:

72 
node_t
 *
t
 = 
£t
->
h—d
;

73 
node_t
 *
t_Ãxt
 = 
£t
->
h—d
->
Ãxt
;

77 ià(!
	`is_m¬ked_»f
((è
t_Ãxt
)) {

78 (*
Ëá_node
èğ
t
;

79 
Ëá_node_Ãxt
 = 
t_Ãxt
;

81 
t
 = (
node_t
 *è
	`g‘_unm¬ked_»f
((è
t_Ãxt
);

82 ià(!
t
->
Ãxt
) ;

83 
t_Ãxt
 = 
t
->
Ãxt
;

84 } 
	`is_m¬ked_»f
((è
t_Ãxt
è|| (
t
->
v®
 < val));

85 
right_node
 = 
t
;

88 ià(
Ëá_node_Ãxt
 =ğ
right_node
) {

89 ià(
right_node
->
Ãxt
 && 
	`is_m¬ked_»f
(()„ight_node->next))

90 
£¬ch_agaš
;

91  
right_node
;

95 ià(
	`ATOMIC_CAS_MB
(&(*
Ëá_node
)->
Ãxt
,

96 
Ëá_node_Ãxt
,

97 
right_node
)) {

98 ià(
right_node
->
Ãxt
 && 
	`is_m¬ked_»f
(()„ight_node->next))

99 
£¬ch_agaš
;

100  
right_node
;

104 
	}
}

109 
	$h¬ris_fšd
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

110 
node_t
 *
right_node
, *
Ëá_node
;

111 
Ëá_node
 = 
£t
->
h—d
;

113 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

114 ià((!
right_node
->
Ãxt
è||„ight_node->
v®
 != val)

118 
	}
}

124 
	$h¬ris_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

125 
node_t
 *
Ãwnode
, *
right_node
, *
Ëá_node
;

126 
Ëá_node
 = 
£t
->
h—d
;

129 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

130 ià(
right_node
->
v®
 == val)

132 
Ãwnode
 = 
	`Ãw_node
(
v®
, 
right_node
, 0);

134 
	`AO_nİ_fuÎ
();

135 ià(
	`ATOMIC_CAS_MB
(&
Ëá_node
->
Ãxt
, 
right_node
, 
Ãwnode
))

138 
	}
}

145 
	$h¬ris_d–‘e
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

146 
node_t
 *
right_node
, *
right_node_Ãxt
, *
Ëá_node
;

147 
Ëá_node
 = 
£t
->
h—d
;

150 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

151 ià(
right_node
->
v®
 != val)

153 
right_node_Ãxt
 = 
right_node
->
Ãxt
;

154 ià(!
	`is_m¬ked_»f
((è
right_node_Ãxt
))

155 ià(
	`ATOMIC_CAS_MB
(&
right_node
->
Ãxt
,

156 
right_node_Ãxt
,

157 
	`g‘_m¬ked_»f
((è
right_node_Ãxt
)))

160 ià(!
	`ATOMIC_CAS_MB
(&
Ëá_node
->
Ãxt
, 
right_node
, 
right_node_Ãxt
))

161 
right_node
 = 
	`h¬ris_£¬ch
(
£t
,„ight_node->
v®
, &
Ëá_node
);

163 
	}
}

	@linkedlists/lockfree-list/harris.h

27 
	~"lškedli¡.h
"

33 
šlše
 
is_m¬ked_»f
(
i
);

34 
šlše
 
un£t_m¬k
(
i
);

35 
šlše
 
£t_m¬k
(
i
);

36 
šlše
 
g‘_unm¬ked_»f
(
w
);

37 
šlše
 
g‘_m¬ked_»f
(
w
);

39 
node_t
 *
h¬ris_£¬ch
(
št£t_t
 *
£t
, 
v®_t
 
v®
,‚ode_ˆ**
Ëá_node
);

40 
h¬ris_fšd
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

41 
h¬ris_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

42 
h¬ris_d–‘e
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

	@linkedlists/lockfree-list/intset.c

12 
	~"št£t.h
"

14 
	$£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

16 
»suÉ
;

18 #ifdeà
DEBUG


23 #ifdeà
SEQUENTIAL


24 
node_t
 *
´ev
, *
Ãxt
;

26 
´ev
 = 
£t
->
h—d
;

27 
Ãxt
 = 
´ev
->next;

28 
Ãxt
->
v®
 < val) {

29 
´ev
 = 
Ãxt
;

30 
Ãxt
 = 
´ev
->next;

32 
»suÉ
 = (
Ãxt
->
v®
 == val);

34 #–ià
defšed
 
STM


35 
¡©us
;

36 
node_t
 *
´ev
, *
Ãxt
;

37 
v®_t
 
v
 = 0;

39 ià(
Œª§ùiÚ®
 > 1) {

41 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
){

42 
´ev
 = 
£t
->
h—d
;

43 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

45 
v
 = 
	`TX_LOAD
((
ušŒ_t
 *è&
Ãxt
->
v®
);

46 ià(
v
 >ğ
v®
)

48 
´ev
 = 
Ãxt
;

49 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

51 
»suÉ
 = (
v
 =ğ
v®
);

52 
	`_x’d
();

56 
»suÉ
 = 
	`h¬ris_fšd
(
£t
, 
v®
);

61 
	`TX_START
(
NL
);

62 
´ev
 = 
£t
->
h—d
;

63 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

65 
v
 = 
	`TX_LOAD
((
ušŒ_t
 *è&
Ãxt
->
v®
);

66 ià(
v
 >ğ
v®
)

68 
´ev
 = 
Ãxt
;

69 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

71 
TX_END
;

72 
»suÉ
 = (
v
 =ğ
v®
);

76 #–ià
defšed
 
LOCKFREE


80  
»suÉ
;

81 
	}
}

83 
šlše
 
	$£t_£q_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
)

85 
»suÉ
;

86 
node_t
 *
´ev
, *
Ãxt
;

88 
´ev
 = 
£t
->
h—d
;

89 
Ãxt
 = 
´ev
->next;

90 
Ãxt
->
v®
 < val) {

91 
´ev
 = 
Ãxt
;

92 
Ãxt
 = 
´ev
->next;

94 
»suÉ
 = (
Ãxt
->
v®
 != val);

95 ià(
»suÉ
) {

96 
´ev
->
Ãxt
 = 
	`Ãw_node
(
v®
,‚ext, 0);

98  
»suÉ
;

99 
	}
}

102 
	$£t_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

104 
»suÉ
;

106 #ifdeà
DEBUG


111 ià(!
Œª§ùiÚ®
) {

113 
»suÉ
 = 
	`£t_£q_add
(
£t
, 
v®
);

117 #ifdeà
SEQUENTIAL


119 
»suÉ
 = 
	`£t_£q_add
(
£t
, 
v®
);

122 #–ià
defšed
 
STM


124 
node_t
 *
´ev
, *
Ãxt
;

125 
v®_t
 
v
;

127 ià(
Œª§ùiÚ®
 > 2) {

129 
¡©us
;

130 
node_t
 *
n_node
 = 
	`Ãw_node
(
v®
, 
NULL
, 
Œª§ùiÚ®
);

131 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
) {

132 
´ev
 = 
£t
->
h—d
;

133 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

135 
v
 = 
	`TX_LOAD
((
ušŒ_t
 *è&
Ãxt
->
v®
);

136 ià(
v
 >ğ
v®
)

138 
´ev
 = 
Ãxt
;

139 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

141 
»suÉ
 = (
v
 !ğ
v®
);

142 ià(
»suÉ
) {

143 
n_node
->
Ãxt
 =‚ext;

144 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n_node
);

146 
	`_x’d
();

150 
»suÉ
 = -1;

154 
	`´štf
("set_add‚oransactional\n");

155 
	`TX_START
(
NL
);

156 
´ev
 = 
£t
->
h—d
;

157 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

159 
v
 = 
	`TX_LOAD
((
ušŒ_t
 *è&
Ãxt
->
v®
);

160 ià(
v
 >ğ
v®
)

162 
´ev
 = 
Ãxt
;

163 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

165 
»suÉ
 = (
v
 !ğ
v®
);

166 ià(
»suÉ
) {

167 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
));

169 
TX_END
;

177  
»suÉ
;

178 
	}
}

180 
	$£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

182 
»suÉ
 = 0;

184 #ifdeà
DEBUG


189 #ifdeà
SEQUENTIAL


191 
node_t
 *
´ev
, *
Ãxt
;

193 
´ev
 = 
£t
->
h—d
;

194 
Ãxt
 = 
´ev
->next;

195 
Ãxt
->
v®
 < val) {

196 
´ev
 = 
Ãxt
;

197 
Ãxt
 = 
´ev
->next;

199 
»suÉ
 = (
Ãxt
->
v®
 == val);

200 ià(
»suÉ
) {

201 
´ev
->
Ãxt
 =‚ext->next;

202 
	`ä“
(
Ãxt
);

205 #–ià
defšed
 
STM


207 
node_t
 *
´ev
, *
Ãxt
;

208 
v®_t
 
v
;

209 
node_t
 *
n
;

210 
¡©us
;

212 ià(
Œª§ùiÚ®
 > 3) {

214 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
) {

215 
´ev
 = 
£t
->
h—d
;

216 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

218 
v
 = 
	`TX_LOAD
((
ušŒ_t
 *è&
Ãxt
->
v®
);

219 ià(
v
 >ğ
v®
)

221 
´ev
 = 
Ãxt
;

222 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

224 
»suÉ
 = (
v
 =ğ
v®
);

225 ià(
»suÉ
) {

226 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

227 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

229 
	`_x’d
();

231 if(
»suÉ
)

232 
	`FREE
(
Ãxt
, (
node_t
));

236 
»suÉ
 = 
	`h¬ris_d–‘e
(
£t
, 
v®
);

240 
	`TX_START
(
NL
);

241 
´ev
 = 
£t
->
h—d
;

242 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

244 
v
 = 
	`TX_LOAD
((
ušŒ_t
 *è&
Ãxt
->
v®
);

245 ià(
v
 >ğ
v®
)

247 
´ev
 = 
Ãxt
;

248 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

250 
»suÉ
 = (
v
 =ğ
v®
);

251 ià(
»suÉ
) {

252 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

253 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

254 
	`FREE
(
Ãxt
, (
node_t
));

256 
TX_END
;

259 #–ià
defšed
 
LOCKFREE


263  
»suÉ
;

264 
	}
}

	@linkedlists/lockfree-list/intset.h

10 
	~"h¬ris.h
"

12 
£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

13 
£t_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

14 
£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

	@linkedlists/lockfree-list/linkedlist.c

11 
	~"lškedli¡.h
"

13 
node_t
 *
	$Ãw_node
(
v®_t
 
v®
, 
node_t
 *
Ãxt
, 
Œª§ùiÚ®
)

15 
node_t
 *
node
;

17 ià(
Œª§ùiÚ®
) {

18 
node
 = (
node_t
 *)
	`MALLOC
((node_t));

20 
node
 = (
node_t
 *)
	`m®loc
((node_t));

22 ià(
node
 =ğ
NULL
) {

23 
	`³¼Ü
("malloc");

24 
	`ex™
(1);

27 
node
->
v®
 = val;

28 
node
->
Ãxt
 =‚ext;

30  
node
;

31 
	}
}

33 
št£t_t
 *
	$£t_Ãw
()

35 
št£t_t
 *
£t
;

36 
node_t
 *
mš
, *
max
;

38 ià((
£t
 = (
št£t_t
 *)
	`m®loc
((št£t_t))è=ğ
NULL
) {

39 
	`³¼Ü
("malloc");

40 
	`ex™
(1);

42 
max
 = 
	`Ãw_node
(
VAL_MAX
, 
NULL
, 0);

43 
mš
 = 
	`Ãw_node
(
VAL_MIN
, 
max
, 0);

44 
£t
->
h—d
 = 
mš
;

46  
£t
;

47 
	}
}

49 
	$£t_d–‘e
(
št£t_t
 *
£t
)

51 
node_t
 *
node
, *
Ãxt
;

53 
node
 = 
£t
->
h—d
;

54 
node
 !ğ
NULL
) {

55 
Ãxt
 = 
node
->next;

56 
	`ä“
(
node
);

57 
node
 = 
Ãxt
;

59 
	`ä“
(
£t
);

60 
	}
}

62 
	$£t_size
(
št£t_t
 *
£t
)

64 
size
 = 0;

65 
node_t
 *
node
;

68 
node
 = 
£t
->
h—d
->
Ãxt
;

69 
node
->
Ãxt
 !ğ
NULL
) {

70 
size
++;

71 
node
 =‚ode->
Ãxt
;

74  
size
;

75 
	}
}

	@linkedlists/lockfree-list/linkedlist.h

10 
	~<as£¹.h
>

11 
	~<g‘İt.h
>

12 
	~<lim™s.h
>

13 
	~<±h»ad.h
>

14 
	~<sigÇl.h
>

15 
	~<¡dlib.h
>

16 
	~<¡dio.h
>

17 
	~<sys/time.h
>

18 
	~<time.h
>

19 
	~<¡dšt.h
>

21 
	~<©omic_İs.h
>

23 
	~"lockä“.h
"

25 #ifdeà
DEBUG


26 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

30 
	#DEFAULT_DURATION
 10000

	)

31 
	#DEFAULT_INITIAL
 256

	)

32 
	#DEFAULT_NB_THREADS
 4

	)

33 
	#DEFAULT_RANGE
 0x7FFFFFFF

	)

34 
	#DEFAULT_SEED
 0

	)

35 
	#DEFAULT_UPDATE
 20

	)

36 
	#DEFAULT_ELASTICITY
 4

	)

37 
	#DEFAULT_ALTERNATE
 0

	)

38 
	#DEFAULT_EFFECTIVE
 1

	)

40 
	#XSTR
(
s
è
	`STR
(s)

	)

41 
	#STR
(
s
è#s

	)

43 
	#ATOMIC_CAS_MB
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

45 vŞ©
AO_t
 
	g¡İ
;

47 
	#TRANSACTIONAL
 
d
->
un™_tx


	)

49 
šŒ_t
 
	tv®_t
;

50 
	#VAL_MIN
 
INT_MIN


	)

51 
	#VAL_MAX
 
INT_MAX


	)

53 
	snode
 {

54 
v®_t
 
	mv®
;

55 
node
 *
	mÃxt
;

56 } 
	tnode_t
;

58 
	sšt£t
 {

59 
node_t
 *
	mh—d
;

60 } 
	tšt£t_t
;

62 
node_t
 *
Ãw_node
(
v®_t
 
v®
,‚ode_ˆ*
Ãxt
, 
Œª§ùiÚ®
);

63 
št£t_t
 *
£t_Ãw
();

64 
£t_d–‘e
(
št£t_t
 *
£t
);

65 
£t_size
(
št£t_t
 *
£t
);

	@linkedlists/lockfree-list/test.c

24 
	~"št£t.h
"

26 
	sb¬r›r
 {

27 
±h»ad_cÚd_t
 
	mcom¶‘e
;

28 
±h»ad_mu‹x_t
 
	mmu‹x
;

29 
	mcouÁ
;

30 
	müossšg
;

31 } 
	tb¬r›r_t
;

33 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

35 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

36 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

37 
b
->
couÁ
 = 
n
;

38 
b
->
üossšg
 = 0;

39 
	}
}

41 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

43 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

45 
b
->
üossšg
++;

47 ià(
b
->
üossšg
 < b->
couÁ
) {

48 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

50 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

52 
b
->
üossšg
 = 0;

54 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

55 
	}
}

67 
šlše
 
	$¿nd_¿nge
(
r
) {

69 
m
 = 2147483647;

70 
d
, 
v
 = 0;

73 
d
 = (
m
 > 
r
 ?„ : m);

74 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

75 
r
 -ğ
m
;

76 } 
r
 > 0);

77  
v
;

78 
	}
}

79 
¿nd_¿nge
(
r
);

82 
šlše
 
	$¿nd_¿nge_»
(*
£ed
, 
r
) {

83 
m
 = 2147483647;

84 
d
, 
v
 = 0;

87 
d
 = (
m
 > 
r
 ?„ : m);

88 
v
 +ğ1 + ()(
d
 * (()
	`¿nd_r
(
£ed
)/(()(
m
)+1.0)));

89 
r
 -ğ
m
;

90 } 
r
 > 0);

91  
v
;

92 
	}
}

93 
¿nd_¿nge_»
(*
£ed
, 
r
);

96 
	sth»ad_d©a
 {

97 
v®_t
 
	mfœ¡
;

98 
	m¿nge
;

99 
	mupd©e
;

100 
	mun™_tx
;

101 
	m®‹º©e
;

102 
	mefãùive
;

103 
	mnb_add
;

104 
	mnb_added
;

105 
	mnb_»move
;

106 
	mnb_»moved
;

107 
	mnb_cÚšs
;

108 
	mnb_found
;

109 
	mnb_abÜts
;

110 
	mnb_abÜts_locked_»ad
;

111 
	mnb_abÜts_locked_wr™e
;

112 
	mnb_abÜts_v®id©e_»ad
;

113 
	mnb_abÜts_v®id©e_wr™e
;

114 
	mnb_abÜts_v®id©e_comm™
;

115 
	mnb_abÜts_šv®id_memÜy
;

116 
	mnb_abÜts_doubË_wr™e
;

117 
	mmax_»Œ›s
;

118 
	m£ed
;

119 
št£t_t
 *
	m£t
;

120 
b¬r›r_t
 *
	mb¬r›r
;

121 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

122 } 
	tth»ad_d©a_t
;

124 *
	$‹¡
(*
d©a
) {

125 
uÃxt
, 
Ï¡
 = -1;

126 
v®_t
 
v®
 = 0;

128 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

131 
	`TM_THREAD_ENTER
();

133 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

136 
uÃxt
 = (
	`¿nd_¿nge_»
(&
d
->
£ed
, 100è- 1 < d->
upd©e
);

138 #ifdeà
ICC


139 
¡İ
 == 0) {

141 
	`AO_lßd_fuÎ
(&
¡İ
) == 0) {

144 ià(
uÃxt
) {

146 ià(
Ï¡
 < 0) {

148 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

149 ià(
	`£t_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

150 
d
->
nb_added
++;

151 
Ï¡
 = 
v®
;

153 
d
->
nb_add
++;

157 ià(
d
->
®‹º©e
) {

158 ià(
	`£t_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
)) {

159 
d
->
nb_»moved
++;

161 
Ï¡
 = -1;

164 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

166 ià(
	`£t_»move
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

167 
d
->
nb_»moved
++;

169 
Ï¡
 = -1;

172 
d
->
nb_»move
++;

177 ià(
d
->
®‹º©e
) {

178 ià(
d
->
upd©e
 == 0) {

179 ià(
Ï¡
 < 0) {

180 
v®
 = 
d
->
fœ¡
;

181 
Ï¡
 = 
v®
;

183 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

184 
Ï¡
 = -1;

187 ià(
Ï¡
 < 0) {

188 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

191 
v®
 = 
Ï¡
;

194 } 
v®
 = 
	`¿nd_¿nge_»
(&
d
->
£ed
, d->
¿nge
);

196 ià(
	`£t_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

197 
d
->
nb_found
++;

198 
d
->
nb_cÚšs
++;

203 ià(
d
->
efãùive
) {

204 
uÃxt
 = ((100 * (
d
->
nb_added
 + d->
nb_»moved
))

205 < (
d
->
upd©e
 * (d->
nb_add
 + d->
nb_»move
 + d->
nb_cÚšs
)));

207 
uÃxt
 = (
	`¿nd_¿nge_»
(&
d
->
£ed
, 100è- 1 < d->
upd©e
);

210 #ifdeà
ICC


217 
	`TM_THREAD_EXIT
();

219  
NULL
;

220 
	}
}

226 
	$maš
(
¬gc
, **
¬gv
) {

227 
İtiÚ
 
lÚg_İtiÚs
[] = {

229 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

230 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

231 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

232 {"th»ad-num", 
»quœed_¬gum’t
, 
NULL
, 't'},

233 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

234 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 'S'},

235 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

236 {"–a¡ic™y", 
»quœed_¬gum’t
, 
NULL
, 'x'},

237 {
NULL
, 0, NULL, 0}

240 
št£t_t
 *
£t
;

241 
i
, 
c
, 
size
;

242 
v®_t
 
Ï¡
 = 0;

243 
v®_t
 
v®
 = 0;

244 
»ads
, 
efä—ds
, 
upd©es
, 
effupds
, 
abÜts
, 
abÜts_locked_»ad
,

245 
abÜts_locked_wr™e
, 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
,

246 
abÜts_v®id©e_comm™
, 
abÜts_šv®id_memÜy
, 
abÜts_doubË_wr™e
,

247 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

248 
th»ad_d©a_t
 *
d©a
;

249 
±h»ad_t
 *
th»ads
;

250 
±h»ad_©Œ_t
 
©Œ
;

251 
b¬r›r_t
 
b¬r›r
;

252 
timev®
 
¡¬t
, 
’d
;

253 
time¥ec
 
timeout
;

254 
du¿tiÚ
 = 
DEFAULT_DURATION
;

255 
š™Ÿl
 = 
DEFAULT_INITIAL
;

256 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

257 
¿nge
 = 
DEFAULT_RANGE
;

258 
£ed
 = 
DEFAULT_SEED
;

259 
upd©e
 = 
DEFAULT_UPDATE
;

260 
un™_tx
 = 
DEFAULT_ELASTICITY
;

261 
®‹º©e
 = 
DEFAULT_ALTERNATE
;

262 
efãùive
 = 
DEFAULT_EFFECTIVE
;

263 
sig£t_t
 
block_£t
;

266 
i
 = 0;

267 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hAf:d:i:t:r:S:u:x:", 
lÚg_İtiÚs
, &
i
);

269 if(
c
 == -1)

272 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

273 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

275 
c
) {

280 
	`´štf
("intset -- STM stressest "

289 " -A, --®‹º©(deçuÉ="
	`XSTR
(
DEFAULT_ALTERNATE
)")\n"

292 " upd©tx mu¡ƒfãùiv–y wr™(0ñrŸl, 1ófãùive, deçuÉ=" 
	`XSTR
(
DEFAULT_EFFECTIVE
) ")\n"

294 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

296 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

298 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

300 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

302 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

304 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

315 
	`ex™
(0);

317 
®‹º©e
 = 1;

320 
efãùive
 = 
	`©oi
(
İrg
);

323 
du¿tiÚ
 = 
	`©oi
(
İrg
);

326 
š™Ÿl
 = 
	`©oi
(
İrg
);

329 
nb_th»ads
 = 
	`©oi
(
İrg
);

332 
¿nge
 = 
	`©Ş
(
İrg
);

335 
£ed
 = 
	`©oi
(
İrg
);

338 
upd©e
 = 
	`©oi
(
İrg
);

341 
un™_tx
 = 
	`©oi
(
İrg
);

344 
	`´štf
("Use -h or --help for help\n");

345 
	`ex™
(0);

347 
	`ex™
(1);

351 
	`as£¹
(
du¿tiÚ
 >= 0);

352 
	`as£¹
(
š™Ÿl
 >= 0);

353 
	`as£¹
(
nb_th»ads
 > 0);

354 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

355 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

357 
	`´štf
("Benchype :†inked†ist\n");

358 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

359 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

360 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

361 
	`´štf
("V®u¿ng : %ld\n", 
¿nge
);

362 
	`´štf
("S“d : %d\n", 
£ed
);

363 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

364 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

365 
	`´štf
("AÉ”Ç‹ : %d\n", 
®‹º©e
);

366 
	`´štf
("Efãùiv : %d\n", 
efãùive
);

367 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

371 ()(
ušŒ_t
));

373 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

374 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

376 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

377 
	`³¼Ü
("malloc");

378 
	`ex™
(1);

380 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

381 
	`³¼Ü
("malloc");

382 
	`ex™
(1);

385 ià(
£ed
 == 0)

386 
	`¤ªd
(()
	`time
(0));

388 
	`¤ªd
(
£ed
);

390 
£t
 = 
	`£t_Ãw
();

391 
¡İ
 = 0;

394 
	`´štf
("Initializing STM\n");

396 
	`TM_STARTUP
();

399 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

400 
i
 = 0;

401 
i
 < 
š™Ÿl
) {

402 
v®
 = 
	`¿nd_¿nge
(
¿nge
);

403 ià(
	`£t_add
(
£t
, 
v®
, 0)) {

404 
Ï¡
 = 
v®
;

405 
i
++;

408 
size
 = 
	`£t_size
(
£t
);

409 
	`´štf
("S‘ siz : %d\n", 
size
);

412 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

413 
	`±h»ad_©Œ_š™
(&
©Œ
);

414 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

415 
i
 = 0; i < 
nb_th»ads
; i++) {

416 
	`´štf
("C»©šgh»ad %d\n", 
i
);

417 
d©a
[
i
].
fœ¡
 = 
Ï¡
;

418 
d©a
[
i
].
¿nge
 =„ange;

419 
d©a
[
i
].
upd©e
 = update;

420 
d©a
[
i
].
un™_tx
 = unit_tx;

421 
d©a
[
i
].
®‹º©e
 =‡lternate;

422 
d©a
[
i
].
efãùive
 =ƒffective;

423 
d©a
[
i
].
nb_add
 = 0;

424 
d©a
[
i
].
nb_added
 = 0;

425 
d©a
[
i
].
nb_»move
 = 0;

426 
d©a
[
i
].
nb_»moved
 = 0;

427 
d©a
[
i
].
nb_cÚšs
 = 0;

428 
d©a
[
i
].
nb_found
 = 0;

429 
d©a
[
i
].
nb_abÜts
 = 0;

430 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

431 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

432 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

433 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

434 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

435 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

436 
d©a
[
i
].
nb_abÜts_doubË_wr™e
 = 0;

437 
d©a
[
i
].
max_»Œ›s
 = 0;

438 
d©a
[
i
].
£ed
 = 
	`¿nd
();

439 
d©a
[
i
].
£t
 = set;

440 
d©a
[
i
].
b¬r›r
 = &barrier;

441 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

442 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

443 
	`årštf
(
¡d”r
, "Error creatinghread\n");

444 
	`ex™
(1);

447 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

450 
	`b¬r›r_üoss
(&
b¬r›r
);

452 
	`´štf
("STARTING...\n");

453 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

454 ià(
du¿tiÚ
 > 0) {

455 
	`Çno¦“p
(&
timeout
, 
NULL
);

457 
	`sigem±y£t
(&
block_£t
);

458 
	`sigsu¥’d
(&
block_£t
);

461 #ifdeà
ICC


462 
¡İ
 = 1;

464 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

467 
	`g‘timeofday
(&
’d
, 
NULL
);

468 
	`´štf
("STOPPING...\n");

471 
i
 = 0; i < 
nb_th»ads
; i++) {

472 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

473 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

474 
	`ex™
(1);

478 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

479 
abÜts
 = 0;

480 
abÜts_locked_»ad
 = 0;

481 
abÜts_locked_wr™e
 = 0;

482 
abÜts_v®id©e_»ad
 = 0;

483 
abÜts_v®id©e_wr™e
 = 0;

484 
abÜts_v®id©e_comm™
 = 0;

485 
abÜts_šv®id_memÜy
 = 0;

486 
abÜts_doubË_wr™e
 = 0;

487 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

488 
»ads
 = 0;

489 
efä—ds
 = 0;

490 
upd©es
 = 0;

491 
effupds
 = 0;

492 
max_»Œ›s
 = 0;

493 
i
 = 0; i < 
nb_th»ads
; i++) {

494 
	`´štf
("Th»ad %d\n", 
i
);

495 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

496 
	`´štf
(" #added : %lu\n", 
d©a
[
i
].
nb_added
);

497 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

498 
	`´štf
(" #»moved : %lu\n", 
d©a
[
i
].
nb_»moved
);

499 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

500 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

501 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

502 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

503 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

504 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

505 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

506 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

507 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

508 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_doubË_wr™e
);

509 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

510 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

511 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

512 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

513 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

514 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

515 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

516 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

517 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

518 
abÜts_doubË_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_doubË_wr™e
;

519 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

520 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

521 
efä—ds
 +ğ
d©a
[
i
].
nb_cÚšs
 +

522 (
d©a
[
i
].
nb_add
 - d©a[i].
nb_added
) +

523 (
d©a
[
i
].
nb_»move
 - d©a[i].
nb_»moved
);

524 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

525 
effupds
 +ğ
d©a
[
i
].
nb_»moved
 + d©a[i].
nb_added
;

526 
size
 +ğ
d©a
[
i
].
nb_added
 - d©a[i].
nb_»moved
;

527 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

528 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

530 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`£t_size
(
£t
), 
size
);

531 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

532 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
,

533 (
»ads
 + 
upd©es
è* 1000.0 / 
du¿tiÚ
);

535 
	`´štf
("#readxs : ");

536 ià(
efãùive
) {

537 
	`´štf
("%lu (%à/ s)\n", 
efä—ds
,ƒfä—d * 1000.0 / 
du¿tiÚ
);

538 
	`´štf
(" #cÚš  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

539 } 
	`´štf
("%lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

541 
	`´štf
("#eff. upd„©e: %à\n", 100.0 * 
effupds
 / (effupd + 
efä—ds
));

543 
	`´štf
("#updatexs : ");

544 ià(
efãùive
) {

545 
	`´štf
("%lu (%à/ s)\n", 
effupds
,ƒffupd * 1000.0 / 
du¿tiÚ
);

546 
	`´štf
(" #updrŸl : %lu (%à/ s)\n", 
upd©es
, updates * 1000.0 /

547 
du¿tiÚ
);

548 } 
	`´štf
("%lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

551 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,

552 
abÜts
 * 1000.0 / 
du¿tiÚ
);

553 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,

554 
abÜts_locked_»ad
 * 1000.0 / 
du¿tiÚ
);

555 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,

556 
abÜts_locked_wr™e
 * 1000.0 / 
du¿tiÚ
);

557 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,

558 
abÜts_v®id©e_»ad
 * 1000.0 / 
du¿tiÚ
);

559 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,

560 
abÜts_v®id©e_wr™e
 * 1000.0 / 
du¿tiÚ
);

561 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,

562 
abÜts_v®id©e_comm™
 * 1000.0 / 
du¿tiÚ
);

563 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,

564 
abÜts_šv®id_memÜy
 * 1000.0 / 
du¿tiÚ
);

565 
	`´štf
(" #dup-w : %lu (%à/ s)\n", 
abÜts_doubË_wr™e
,

566 
abÜts_doubË_wr™e
 * 1000.0 / 
du¿tiÚ
);

567 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

568 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

571 
	`£t_d–‘e
(
£t
);

574 
	`TM_SHUTDOWN
();

576 
	`ä“
(
th»ads
);

577 
	`ä“
(
d©a
);

580 
	}
}

	@linkedlists/selfish/fomitchev.c

8 
	~"št£t.h
"

9 
	~"fom™chev.h
"

12 
	~"mixš.c
"

21 
šlše
 
	$is_m¬ked
(
node_t
 *
n
) {

22  (è((
ušŒ_t
è
n
 & (uintptr_t) 2);

23 
	}
}

26 
šlše
 
	$is_æagged
(
node_t
 *
n
) {

27  (è((
ušŒ_t
è
n
 & (uintptr_t) 1);

28 
	}
}

31 
šlše
 
node_t
* 
	$g‘_right
(
node_t
 *
n
) {

32  (
node_t
 *è((
ušŒ_t
è
n
 & ~(uintptr_t) 3);

33 
	}
}

36 
šlše
 
node_t
 *
	$·ck_tu¶e
(
node_t
 *
right
, 
m¬k
, 
æag
) {

37 
ušŒ_t
 
tu¶e
 = (ušŒ_tè
	`g‘_right
(
right
);

38 ià(
æag
è
tu¶e
 |ğ(
ušŒ_t
) 1;

39 ià(
m¬k
è
tu¶e
 |ğ(
ušŒ_t
) 2;

40  (
node_t
 *è
tu¶e
;

41 
	}
}

45 
fom™chev_£¬chäom
(
v®_t
 
v®
, 
node_t
 *
cu¼_node
,‚ode_ˆ**
n1
,‚ode_ˆ**
n2
);

46 
fom™chev_£¬chäom2
(
v®_t
 
v®
, 
node_t
 *
cu¼_node
,‚ode_ˆ**
n1
,‚ode_ˆ**
n2
);

47 
fom™chev_h–pm¬ked
(
node_t
 *
´ev_node
,‚ode_ˆ*
d–_node
);

48 
fom™chev_h–pæagged
(
node_t
 *
´ev_node
,‚ode_ˆ*
d–_node
);

49 
fom™chev_Œym¬k
(
node_t
 *
d–_node
);

50 
fom™chev_Œyæag
(
node_t
 *
´ev_node
,‚ode_ˆ*
rg‘_node
,‚ode_t** 
»t_node
);

54 
	$fom™chev_£¬chäom
(
v®_t
 
v®
, 
node_t
 *
cu¼_node
,‚ode_ˆ**
n1
,‚ode_ˆ**
n2
) {

55 
node_t
 *
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

56 
Ãxt_node
->
v®
 <= val) {

60 
	`is_m¬ked
(
Ãxt_node
->
Ãxt
) &&

61 (!
	`is_m¬ked
(
cu¼_node
->
Ãxt
è|| 
	`g‘_right
(cu¼_node->Ãxtè!ğ
Ãxt_node
)) {

62 ià(
	`g‘_right
(
cu¼_node
->
Ãxt
è=ğ
Ãxt_node
) {

63 
	`fom™chev_h–pm¬ked
(
cu¼_node
, 
Ãxt_node
);

65 
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

67 ià(
Ãxt_node
->
v®
 <= val) {

68 
cu¼_node
 = 
Ãxt_node
;

69 
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

74 *
n1
 = 
cu¼_node
;

75 *
n2
 = 
Ãxt_node
;

76 
	}
}

80 
	$fom™chev_£¬chäom2
(
v®_t
 
v®
, 
node_t
 *
cu¼_node
,‚ode_ˆ**
n1
,‚ode_ˆ**
n2
) {

81 
node_t
 *
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

82 
Ãxt_node
->
v®
 < val) {

86 
	`is_m¬ked
(
Ãxt_node
->
Ãxt
) &&

87 (!
	`is_m¬ked
(
cu¼_node
->
Ãxt
è|| 
	`g‘_right
(cu¼_node->Ãxtè!ğ
Ãxt_node
)) {

88 ià(
	`g‘_right
(
cu¼_node
->
Ãxt
è=ğ
Ãxt_node
) {

89 
	`fom™chev_h–pm¬ked
(
cu¼_node
, 
Ãxt_node
);

91 
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

93 ià(
Ãxt_node
->
v®
 < val) {

94 
cu¼_node
 = 
Ãxt_node
;

95 
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

100 *
n1
 = 
cu¼_node
;

101 *
n2
 = 
Ãxt_node
;

102 
	}
}

107 
	$fom™chev_h–pm¬ked
(
node_t
 *
´ev_node
,‚ode_ˆ*
d–_node
) {

108 
node_t
 *
Ãxt_node
 = 
	`g‘_right
(
d–_node
->
Ãxt
);

109 
node_t
 *
ex³ùed
 = 
	`·ck_tu¶e
(
d–_node
, 0, 1);

110 
	`©omic_com·»_exchªge_¡rÚg
(

111 &
´ev_node
->
Ãxt
,

112 &
ex³ùed
,

113 
	`·ck_tu¶e
(
Ãxt_node
, 0, 0));

114 
	}
}

119 
	$fom™chev_h–pæagged
(
node_t
 *
´ev_node
,‚ode_ˆ*
d–_node
) {

120 
d–_node
->
backlšk
 = 
´ev_node
;

121 ià(!
	`is_m¬ked
(
d–_node
->
Ãxt
))

122 
	`fom™chev_Œym¬k
(
d–_node
);

123 
	`fom™chev_h–pm¬ked
(
´ev_node
, 
d–_node
);

124 
	}
}

128 
	$fom™chev_Œym¬k
(
node_t
 *
d–_node
) {

130 
node_t
 *
Ãxt_node
 = 
	`g‘_right
(
d–_node
->
Ãxt
);

131 
node_t
 *
ex³ùed
 = 
	`·ck_tu¶e
(
Ãxt_node
, 0, 0);

132 
	`©omic_com·»_exchªge_¡rÚg
(

133 &
d–_node
->
Ãxt
,

134 &
ex³ùed
,

135 
	`·ck_tu¶e
(
Ãxt_node
, 1, 0));

136 ià(
	`is_æagged
(
ex³ùed
)) {

138 
	`fom™chev_h–pæagged
(
d–_node
, 
	`g‘_right
(
ex³ùed
));

140 } !
	`is_m¬ked
(
d–_node
->
Ãxt
));

141 
	}
}

151 
	$fom™chev_Œyæag
(
node_t
 *
´ev_node
,‚ode_ˆ*
rg‘_node
,‚ode_t** 
»t_node
) {

153 ià(
´ev_node
->
Ãxt
 =ğ
	`·ck_tu¶e
(
rg‘_node
, 0, 1)) {

155 *
»t_node
 = 
´ev_node
;

160 
node_t
 *
ex³ùed
 = 
	`·ck_tu¶e
(
rg‘_node
, 0, 0);

161 
	`©omic_com·»_exchªge_¡rÚg
(

162 &
´ev_node
->
Ãxt
,

163 &
ex³ùed
,

164 
	`·ck_tu¶e
(
rg‘_node
, 0, 1));

166 ià(
ex³ùed
 =ğ
	`·ck_tu¶e
(
rg‘_node
, 0, 0)) {

168 *
»t_node
 = 
´ev_node
;

171 ià(
ex³ùed
 =ğ
	`·ck_tu¶e
(
rg‘_node
, 0, 1)) {

173 *
»t_node
 = 
´ev_node
;

178 
	`is_m¬ked
(
´ev_node
->
Ãxt
)) {

179 
´ev_node
 =…»v_node->
backlšk
;

182 
node_t
 *
d–_node
;

183 
	`fom™chev_£¬chäom2
(
rg‘_node
->
v®
, 
´ev_node
, &´ev_node, &
d–_node
);

184 ià(
d–_node
 !ğ
rg‘_node
) {

186 *
»t_node
 = 
NULL
;

190 
	}
}

196 
	$£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

197 
node_t
 *
cu¼_node
, *
Ãxt_node
;

198 
	`fom™chev_£¬chäom
(
v®
, 
£t
->
h—d
, &
cu¼_node
, &
Ãxt_node
);

199 ià(
cu¼_node
->
v®
 == val)

202 
	}
}

205 
	$£t_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

206 
node_t
 *
´ev_node
, *
Ãxt_node
;

207 
	`fom™chev_£¬chäom
(
v®
, 
£t
->
h—d
, &
´ev_node
, &
Ãxt_node
);

208 ià(
´ev_node
->
v®
 == val)

211 
node_t
 *
Ãwnode
 = 
	`Ãw_node
(
v®
, 
NULL
);

213 
node_t
 *
´ev_Ãxt
 = 
´ev_node
->
Ãxt
;

214 ià(
	`is_æagged
(
´ev_Ãxt
)) {

215 
	`fom™chev_h–pæagged
(
´ev_node
, 
	`g‘_right
(
´ev_Ãxt
));

217 
Ãwnode
->
Ãxt
 = 
	`·ck_tu¶e
(
Ãxt_node
, 0, 0);

218 
node_t
 *
ex³ùed
 = 
	`·ck_tu¶e
(
Ãxt_node
, 0, 0);

219 
	`©omic_com·»_exchªge_¡rÚg
(

220 &
´ev_node
->
Ãxt
,

221 &
ex³ùed
,

222 
	`·ck_tu¶e
(
Ãwnode
, 0, 0));

223 ià(
ex³ùed
 =ğ
	`·ck_tu¶e
(
Ãxt_node
, 0, 0)) {

228 ià(
	`is_æagged
(
ex³ùed
)) {

229 
	`fom™chev_h–pæagged
(
´ev_node
, 
	`g‘_right
(
ex³ùed
));

232 
	`is_m¬ked
(
´ev_node
->
Ãxt
)) {

233 
´ev_node
 =…»v_node->
backlšk
;

237 
	`fom™chev_£¬chäom
(
v®
, 
´ev_node
, &´ev_node, &
Ãxt_node
);

238 ià(
´ev_node
->
v®
 == val) {

243 
	}
}

247 
	$£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

248 
node_t
 *
´ev_node
, *
d–_node
;

249 
	`fom™chev_£¬chäom2
(
v®
, 
£t
->
h—d
, &
´ev_node
, &
d–_node
);

250 ià(
d–_node
->
v®
 != val) {

253 
»suÉ
 = 
	`fom™chev_Œyæag
(
´ev_node
, 
d–_node
, &prev_node);

254 ià(
´ev_node
 !ğ
NULL
) {

255 
	`fom™chev_h–pæagged
(
´ev_node
, 
d–_node
);

257 ià(!
»suÉ
) {

262 
	}
}

	@linkedlists/selfish/fomitchev.h

1 
	#ALGONAME
 "Fom™chev & Ruµ”ˆlšked†i¡"

	)

3 
	snode
 {

4 
v®_t
 
	mv®
;

5 
_Atomic
(
node
 *è
	mÃxt
;

6 
node
 * 
	mbacklšk
;

9 
	sšt£t
 {

10 
node_t
 *
	mh—d
;

	@linkedlists/selfish/intset.h

1 
	~<¡dlib.h
>

2 
	~<lim™s.h
>

3 
	~<¡dio.h
>

4 
	~<¡dšt.h
>

5 
	~<¡d©omic.h
>

6 
	~<±h»ad.h
>

8 
	tv®_t
;

9 
	#VAL_MIN
 
INT_MIN


	)

10 
	#VAL_MAX
 
INT_MAX


	)

13 
node
 
	tnode_t
;

14 
št£t
 
	tšt£t_t
;

18 
št£t_t
 *
£t_Ãw
();

19 
£t_d–‘e
(
št£t_t
 *
£t
);

20 
£t_size
(
št£t_t
 *
£t
);

21 
node_t
 *
Ãw_node
(
v®
,‚ode_ˆ*
Ãxt
);

22 
£t_´št
(
št£t_t
 *
£t
);

25 
£t_cÚšs
(
št£t_t
 *
£t
, 
v®
);

26 
£t_š£¹
(
št£t_t
 *
£t
, 
v®
);

27 
£t_»move
(
št£t_t
 *
£t
, 
v®
);

30 #ifdeà
MUTEX


31 
±h»ad_mu‹x_t
 
	t±lock_t
;

32 
	#INIT_LOCK
(
lock
è
	`±h»ad_mu‹x_š™
((
±h»ad_mu‹x_t
 *èlock, 
NULL
);

	)

33 
	#DESTROY_LOCK
(
lock
è
	`±h»ad_mu‹x_de¡roy
((
±h»ad_mu‹x_t
 *èlock)

	)

34 
	#LOCK
(
lock
è
	`±h»ad_mu‹x_lock
((
±h»ad_mu‹x_t
 *èlock)

	)

35 
	#UNLOCK
(
lock
è
	`±h»ad_mu‹x_uÆock
((
±h»ad_mu‹x_t
 *èlock)

	)

37 
±h»ad_¥šlock_t
 
	t±lock_t
;

38 
	#INIT_LOCK
(
lock
è
	`±h»ad_¥š_š™
((
±h»ad_¥šlock_t
 *èlock, 
PTHREAD_PROCESS_PRIVATE
);

	)

39 
	#DESTROY_LOCK
(
lock
è
	`±h»ad_¥š_de¡roy
((
±h»ad_¥šlock_t
 *èlock)

	)

40 
	#LOCK
(
lock
è
	`±h»ad_¥š_lock
((
±h»ad_¥šlock_t
 *èlock)

	)

41 
	#UNLOCK
(
lock
è
	`±h»ad_¥š_uÆock
((
±h»ad_¥šlock_t
 *èlock)

	)

	@linkedlists/selfish/mixin.c

7 
št£t_t
 *
	$£t_Ãw
() {

8 
št£t_t
 *
£t
 = 
	`m®loc
((intset_t));

9 ià(
NULL
 =ğ
£t
) {

10 
	`³¼Ü
("malloc");

11 
	`ex™
(1);

14 
node_t
 *
max
 = 
	`Ãw_node
(
VAL_MAX
, 
NULL
);

15 
node_t
 *
mš
 = 
	`Ãw_node
(
VAL_MIN
, 
max
);

16 
£t
->
h—d
 = 
mš
;

17  
£t
;

18 
	}
}

21 
	$£t_d–‘e
(
št£t_t
 *
£t
) {

22 
node_t
 *
´ev
, *
cu¼
;

24 
cu¼
 = 
£t
->
h—d
;

25 
NULL
 !ğ
cu¼
) {

26 
´ev
 = 
cu¼
;

27 
cu¼
 = cu¼->
Ãxt
;

28 
	`ä“
(
´ev
);

30 
	`ä“
(
£t
);

31 
	}
}

35 
	$£t_size
(
št£t_t
 *
£t
) {

36 
size
 = 0;

37 
node_t
 *
cu¼
 = 
£t
->
h—d
->
Ãxt
;

38 
cu¼
->
Ãxt
 !ğ
NULL
) {

39 
size
++;

40 
cu¼
 = cu¼->
Ãxt
;

42  
size
;

43 
	}
}

45 
node_t
 *
	$Ãw_node
(
v®_t
 
v®
, 
node_t
 *
Ãxt
) {

46 
node_t
 *
node
 = 
	`ÿÎoc
((node_t), 1);

47 ià(
NULL
 =ğ
node
) {

48 
	`³¼Ü
("malloc");

49 
	`ex™
(1);

51 
node
->
v®
 = val;

52 
node
->
Ãxt
 =‚ext;

53  
node
;

54 
	}
}

57 
	$£t_´št
(
št£t_t
 *
£t
) {

58 
node_t
 *
cu¼
 = 
£t
->
h—d
;

59 
cu¼
 !ğ
NULL
) {

60 
	`´štf
("%d", 
cu¼
->
v®
);

61 ià(
cu¼
->
Ãxt
 !ğ
NULL
)

62 
	`´štf
(" -> ");

63 
cu¼
 = cu¼->
Ãxt
;

65 
	`´štf
("\n");

66 
	}
}

	@linkedlists/selfish/selfish.c

12 
	~"št£t.h
"

13 
	~"fom™chev.h
"

16 
	~"mixš.c
"

25 
šlše
 
	$is_m¬ked
(
node_t
 *
n
) {

26  (è((
ušŒ_t
è
n
 & (uintptr_t) 2);

27 
	}
}

30 
šlše
 
	$is_æagged
(
node_t
 *
n
) {

31  (è((
ušŒ_t
è
n
 & (uintptr_t) 1);

32 
	}
}

35 
šlše
 
node_t
* 
	$g‘_right
(
node_t
 *
n
) {

36  (
node_t
 *è((
ušŒ_t
è
n
 & ~(uintptr_t) 3);

37 
	}
}

40 
šlše
 
node_t
 *
	$·ck_tu¶e
(
node_t
 *
right
, 
m¬k
, 
æag
) {

41 
ušŒ_t
 
tu¶e
 = (ušŒ_tè
	`g‘_right
(
right
);

42 ià(
æag
è
tu¶e
 |ğ(
ušŒ_t
) 1;

43 ià(
m¬k
è
tu¶e
 |ğ(
ušŒ_t
) 2;

44  (
node_t
 *è
tu¶e
;

45 
	}
}

49 
fom™chev_£¬chäom
(
v®_t
 
v®
, 
node_t
 *
cu¼_node
,‚ode_ˆ**
n1
,‚ode_ˆ**
n2
);

50 
fom™chev_£¬chäom2
(
v®_t
 
v®
, 
node_t
 *
cu¼_node
,‚ode_ˆ**
n1
,‚ode_ˆ**
n2
);

51 
fom™chev_h–pm¬ked
(
node_t
 *
´ev_node
,‚ode_ˆ*
d–_node
);

52 
fom™chev_h–pæagged
(
node_t
 *
´ev_node
,‚ode_ˆ*
d–_node
);

53 
fom™chev_Œym¬k
(
node_t
 *
d–_node
);

54 
fom™chev_Œyæag
(
node_t
 *
´ev_node
,‚ode_ˆ*
rg‘_node
,‚ode_t** 
»t_node
);

58 
	$fom™chev_£¬chäom
(
v®_t
 
v®
, 
node_t
 *
cu¼_node
,‚ode_ˆ**
n1
,‚ode_ˆ**
n2
) {

59 
node_t
 *
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

60 
Ãxt_node
->
v®
 <= val) {

64 
	`is_m¬ked
(
Ãxt_node
->
Ãxt
) &&

65 (!
	`is_m¬ked
(
cu¼_node
->
Ãxt
è|| 
	`g‘_right
(cu¼_node->Ãxtè!ğ
Ãxt_node
)) {

66 ià(
	`g‘_right
(
cu¼_node
->
Ãxt
è=ğ
Ãxt_node
) {

67 
	`fom™chev_h–pm¬ked
(
cu¼_node
, 
Ãxt_node
);

69 
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

71 ià(
Ãxt_node
->
v®
 <= val) {

72 
cu¼_node
 = 
Ãxt_node
;

73 
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

78 *
n1
 = 
cu¼_node
;

79 *
n2
 = 
Ãxt_node
;

80 
	}
}

84 
	$fom™chev_£¬chäom2
(
v®_t
 
v®
, 
node_t
 *
cu¼_node
,‚ode_ˆ**
n1
,‚ode_ˆ**
n2
) {

85 
node_t
 *
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

86 
Ãxt_node
->
v®
 < val) {

90 
	`is_m¬ked
(
Ãxt_node
->
Ãxt
) &&

91 (!
	`is_m¬ked
(
cu¼_node
->
Ãxt
è|| 
	`g‘_right
(cu¼_node->Ãxtè!ğ
Ãxt_node
)) {

92 ià(
	`g‘_right
(
cu¼_node
->
Ãxt
è=ğ
Ãxt_node
) {

93 
	`fom™chev_h–pm¬ked
(
cu¼_node
, 
Ãxt_node
);

95 
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

97 ià(
Ãxt_node
->
v®
 < val) {

98 
cu¼_node
 = 
Ãxt_node
;

99 
Ãxt_node
 = 
	`g‘_right
(
cu¼_node
->
Ãxt
);

104 *
n1
 = 
cu¼_node
;

105 *
n2
 = 
Ãxt_node
;

106 
	}
}

111 
	$fom™chev_h–pm¬ked
(
node_t
 *
´ev_node
,‚ode_ˆ*
d–_node
) {

112 
node_t
 *
Ãxt_node
 = 
	`g‘_right
(
d–_node
->
Ãxt
);

113 
node_t
 *
ex³ùed
 = 
	`·ck_tu¶e
(
d–_node
, 0, 1);

114 
	`©omic_com·»_exchªge_¡rÚg
(

115 &
´ev_node
->
Ãxt
,

116 &
ex³ùed
,

117 
	`·ck_tu¶e
(
Ãxt_node
, 0, 0));

118 
	}
}

123 
	$fom™chev_h–pæagged
(
node_t
 *
´ev_node
,‚ode_ˆ*
d–_node
) {

124 
d–_node
->
backlšk
 = 
´ev_node
;

125 ià(!
	`is_m¬ked
(
d–_node
->
Ãxt
))

126 
	`fom™chev_Œym¬k
(
d–_node
);

127 
	`fom™chev_h–pm¬ked
(
´ev_node
, 
d–_node
);

128 
	}
}

132 
	$fom™chev_Œym¬k
(
node_t
 *
d–_node
) {

134 
node_t
 *
Ãxt_node
 = 
	`g‘_right
(
d–_node
->
Ãxt
);

135 
node_t
 *
ex³ùed
 = 
	`·ck_tu¶e
(
Ãxt_node
, 0, 0);

136 
	`©omic_com·»_exchªge_¡rÚg
(

137 &
d–_node
->
Ãxt
,

138 &
ex³ùed
,

139 
	`·ck_tu¶e
(
Ãxt_node
, 1, 0));

140 ià(
	`is_æagged
(
ex³ùed
)) {

142 
	`fom™chev_h–pæagged
(
d–_node
, 
	`g‘_right
(
ex³ùed
));

144 } !
	`is_m¬ked
(
d–_node
->
Ãxt
));

145 
	}
}

155 
	$fom™chev_Œyæag
(
node_t
 *
´ev_node
,‚ode_ˆ*
rg‘_node
,‚ode_t** 
»t_node
) {

157 ià(
´ev_node
->
Ãxt
 =ğ
	`·ck_tu¶e
(
rg‘_node
, 0, 1)) {

159 *
»t_node
 = 
´ev_node
;

164 
node_t
 *
ex³ùed
 = 
	`·ck_tu¶e
(
rg‘_node
, 0, 0);

165 
	`©omic_com·»_exchªge_¡rÚg
(

166 &
´ev_node
->
Ãxt
,

167 &
ex³ùed
,

168 
	`·ck_tu¶e
(
rg‘_node
, 0, 1));

170 ià(
ex³ùed
 =ğ
	`·ck_tu¶e
(
rg‘_node
, 0, 0)) {

172 *
»t_node
 = 
´ev_node
;

175 ià(
ex³ùed
 =ğ
	`·ck_tu¶e
(
rg‘_node
, 0, 1)) {

177 *
»t_node
 = 
´ev_node
;

182 
	`is_m¬ked
(
´ev_node
->
Ãxt
)) {

183 
´ev_node
 =…»v_node->
backlšk
;

186 
node_t
 *
d–_node
;

187 
	`fom™chev_£¬chäom2
(
rg‘_node
->
v®
, 
´ev_node
, &´ev_node, &
d–_node
);

188 ià(
d–_node
 !ğ
rg‘_node
) {

190 *
»t_node
 = 
NULL
;

194 
	}
}

200 
	$£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

201 
node_t
 *
cu¼
 = 
£t
->
h—d
;

202 
m¬ked
 = 0;

203 
cu¼
->
v®
 < val) {

204 
node_t
 *
cu¼_Ãxt
 = 
cu¼
->
Ãxt
;

205 
m¬ked
 = 
	`is_m¬ked
(
cu¼_Ãxt
);

206 
cu¼
 = 
	`g‘_right
(
cu¼_Ãxt
);

208  (
cu¼
->
v®
 =ğv® && !
m¬ked
);

209 
	}
}

213 
	$£t_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

214 
node_t
 *
´ev_node
, *
Ãxt_node
;

215 
	`fom™chev_£¬chäom
(
v®
, 
£t
->
h—d
, &
´ev_node
, &
Ãxt_node
);

216 ià(
´ev_node
->
v®
 == val)

219 
node_t
 *
Ãwnode
 = 
	`Ãw_node
(
v®
, 
NULL
);

221 
node_t
 *
´ev_Ãxt
 = 
´ev_node
->
Ãxt
;

222 ià(
	`is_æagged
(
´ev_Ãxt
)) {

223 
	`fom™chev_h–pæagged
(
´ev_node
, 
	`g‘_right
(
´ev_Ãxt
));

225 
Ãwnode
->
Ãxt
 = 
	`·ck_tu¶e
(
Ãxt_node
, 0, 0);

226 
node_t
 *
ex³ùed
 = 
	`·ck_tu¶e
(
Ãxt_node
, 0, 0);

227 
	`©omic_com·»_exchªge_¡rÚg
(

228 &
´ev_node
->
Ãxt
,

229 &
ex³ùed
,

230 
	`·ck_tu¶e
(
Ãwnode
, 0, 0));

231 ià(
ex³ùed
 =ğ
	`·ck_tu¶e
(
Ãxt_node
, 0, 0)) {

236 ià(
	`is_æagged
(
ex³ùed
)) {

237 
	`fom™chev_h–pæagged
(
´ev_node
, 
	`g‘_right
(
ex³ùed
));

240 
	`is_m¬ked
(
´ev_node
->
Ãxt
)) {

241 
´ev_node
 =…»v_node->
backlšk
;

245 
	`fom™chev_£¬chäom
(
v®
, 
´ev_node
, &´ev_node, &
Ãxt_node
);

246 ià(
´ev_node
->
v®
 == val) {

251 
	}
}

255 
	$£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

256 
node_t
 *
´ev_node
, *
d–_node
;

257 
	`fom™chev_£¬chäom2
(
v®
, 
£t
->
h—d
, &
´ev_node
, &
d–_node
);

258 ià(
d–_node
->
v®
 != val) {

261 
»suÉ
 = 
	`fom™chev_Œyæag
(
´ev_node
, 
d–_node
, &prev_node);

262 ià(
´ev_node
 !ğ
NULL
) {

263 
	`fom™chev_h–pæagged
(
´ev_node
, 
d–_node
);

265 ià(!
»suÉ
) {

270 
	}
}

	@linkedlists/selfish/selfish.h

1 
	#ALGONAME
 "Fom™chev & Ruµ”ˆlšked†i¡ w™h wa™-ä“ cÚšs"

	)

3 
	snode
 {

4 
v®_t
 
	mv®
;

5 
_Atomic
(
node
 *è
	mÃxt
;

6 
node
 * 
	mbacklšk
;

9 
	sšt£t
 {

10 
node_t
 *
	mh—d
;

	@linkedlists/selfish/test.c

24 
	~<as£¹.h
>

25 
	~<g‘İt.h
>

26 
	~<lim™s.h
>

27 
	~<±h»ad.h
>

28 
	~<sigÇl.h
>

29 
	~<¡dlib.h
>

30 
	~<¡dio.h
>

31 
	~<sys/time.h
>

32 
	~<time.h
>

33 
	~<¡dšt.h
>

34 
	~<¡d©omic.h
>

36 
	~"št£t.h
"

38 #ià
defšed
 
SEQUENTIAL


39 
	~"£qu’tŸl.h
"

40 #–ià
defšed
 
HARRIS


41 
	~"h¬ris.h
"

42 #–ià
defšed
 
VERSIONED


43 
	~"v”siÚed.h
"

44 #–ià
defšed
 
FOMITCHEV


45 
	~"fom™chev.h
"

46 #–ià
defšed
 
LAZY


47 
	~"Ïzy.h
"

48 #–ià
defšed
 
COUPLING


49 
	~"cou¶šg.h
"

50 #–ià
defšed
 
UNIVERSAL


51 
	~"univ”§l.h
"

52 #–ià
defšed
 
SELFISH


53 
	~"£lfish.h
"

58 
	#DEFAULT_DURATION
 10000

	)

59 
	#DEFAULT_INITIAL
 256

	)

60 
	#DEFAULT_NB_THREADS
 1

	)

61 
	#DEFAULT_RANGE
 0x7FFFFFFF

	)

62 
	#DEFAULT_BIAS_RANGE
 (-1)

	)

63 
	#DEFAULT_BIAS_OFFSET
 (-1)

	)

64 
	#DEFAULT_SEED
 0

	)

65 
	#DEFAULT_UPDATE
 20

	)

66 
	#DEFAULT_ELASTICITY
 4

	)

67 
	#DEFAULT_LOCKTYPE
 2

	)

68 
	#DEFAULT_ALTERNATE
 0

	)

69 
	#DEFAULT_EFFECTIVE
 1

	)

70 
	#XSTR
(
s
è
	`STR
(s)

	)

71 
	#STR
(
s
è#s

	)

74 
	$_Atomic
(è
¡İ
;

76 
	sb¬r›r
 {

77 
±h»ad_cÚd_t
 
com¶‘e
;

78 
±h»ad_mu‹x_t
 
mu‹x
;

79 
couÁ
;

80 
üossšg
;

81 } 
	tb¬r›r_t
;

83 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

85 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

86 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

87 
b
->
couÁ
 = 
n
;

88 
b
->
üossšg
 = 0;

89 
	}
}

91 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

93 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

95 
b
->
üossšg
++;

97 ià(
b
->
üossšg
 < b->
couÁ
) {

98 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

100 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

102 
b
->
üossšg
 = 0;

104 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

105 
	}
}

115 
šlše
 
	$¿nd_¿nge
(
r
) {

116 
m
 = 2147483647;

117 
d
, 
v
 = 0;

120 
d
 = (
m
 > 
r
 ?„ : m);

121 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

122 
r
 -ğ
m
;

123 } 
r
 > 0);

124  
v
;

125 
	}
}

126 
¿nd_¿nge
(
r
);

129 
šlše
 
	$¿nd_¿nge_»
(*
£ed
, 
r
) {

130 
m
 = 2147483647;

131 
d
, 
v
 = 0;

134 
d
 = (
m
 > 
r
 ?„ : m);

135 
v
 +ğ1 + ()(
d
 * (()
	`¿nd_r
(
£ed
)/(()(
m
)+1.0)));

136 
r
 -ğ
m
;

137 } 
r
 > 0);

138  
v
;

139 
	}
}

140 
¿nd_¿nge_»
(*
£ed
, 
r
);

143 
	sth»ad_d©a
 {

144 
v®_t
 
	mfœ¡
;

145 
	m¿nge
;

146 
	mbŸs_’abËd
;

147 
	mbŸs_¿nge
;

148 
	mbŸs_off£t
;

149 
	mupd©e
;

150 
	mun™_tx
;

151 
	m®‹º©e
;

152 
	mefãùive
;

153 
	mnb_add
;

154 
	mnb_added
;

155 
	mnb_»move
;

156 
	mnb_»moved
;

157 
	mnb_cÚšs
;

158 
	mnb_found
;

159 
	mnb_abÜts
;

160 
	mnb_abÜts_locked_»ad
;

161 
	mnb_abÜts_locked_wr™e
;

162 
	mnb_abÜts_v®id©e_»ad
;

163 
	mnb_abÜts_v®id©e_wr™e
;

164 
	mnb_abÜts_v®id©e_comm™
;

165 
	mnb_abÜts_šv®id_memÜy
;

166 
	mnb_abÜts_doubË_wr™e
;

167 
	mmax_»Œ›s
;

168 
	m£ed
;

169 
št£t_t
 *
	m£t
;

170 
b¬r›r_t
 *
	mb¬r›r
;

171 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

172 } 
	tth»ad_d©a_t
;

174 *
	$‹¡
(*
d©a
) {

176 
th»ad_d©a_t
 
d
 = *Ñh»ad_d©a_ˆ*)
d©a
;

179 
	`b¬r›r_üoss
(
d
.
b¬r›r
);

183 
Ï¡
 = -1;

187 ià(
d
.
bŸs_’abËd
)

188 
Ï¡
 = 
d
.
bŸs_off£t
;

190 
	`©omic_lßd
(&
¡İ
) == 0) {

192 
do_upd©e
;

193 ià(
d
.
efãùive
)

194 
do_upd©e
 = (100 * (
d
.
nb_added
 + d.
nb_»moved
)è< (d.
upd©e
 * (d.
nb_add
 + d.
nb_»move
 + d.
nb_cÚšs
));

196 
do_upd©e
 = 
	`¿nd_¿nge_»
(&
d
.
£ed
, 100è- 1 < d.
upd©e
;

200 
v®ue
 = 
	`¿nd_¿nge_»
(&
d
.
£ed
, d.
¿nge
);

203 ià(
d
.
bŸs_’abËd
) {

204 
v®ue
 = 
d
.
bŸs_off£t
 + 
	`¿nd_¿nge_»
(&d.
£ed
, d.
bŸs_¿nge
) - 1;

205 
Ï¡
 = (
	`¿nd_¿nge_»
(&
d
.
£ed
, 2è=ğ1è? -1 : 
v®ue
;

208 ià(
do_upd©e
 && 
Ï¡
 < 0) {

210 ià(
	`£t_š£¹
(
d
.
£t
, 
v®ue
)) {

211 
d
.
nb_added
++;

212 
Ï¡
 = 
v®ue
;

214 
d
.
nb_add
++;

215 } ià(
do_upd©e
 && 
Ï¡
 >= 0) {

219 ià(
d
.
®‹º©e
) {

220 ià(
	`£t_»move
(
d
.
£t
, 
Ï¡
))

221 
d
.
nb_»moved
++;

222 
Ï¡
 = -1;

224 ià(
	`£t_»move
(
d
.
£t
, 
v®ue
)) {

225 
d
.
nb_»moved
++;

226 
Ï¡
 = -1;

229 
d
.
nb_»move
++;

232 ià(
d
.
®‹º©e
) {

233 ià(
d
.
upd©e
 == 0) {

234 ià(
Ï¡
 < 0)

235 
Ï¡
 = 
v®ue
 = 
d
.
fœ¡
;

237 
Ï¡
 = -1;

239 ià(
Ï¡
 >= 0)

240 
v®ue
 = 
Ï¡
;

244 ià(
	`£t_cÚšs
(
d
.
£t
, 
v®ue
))

245 
d
.
nb_found
++;

246 
d
.
nb_cÚšs
++;

250 *(
th»ad_d©a_t
 *)
d©a
 = 
d
;

252  
NULL
;

253 
	}
}

255 
	$maš
(
¬gc
, **
¬gv
) {

256 
İtiÚ
 
lÚg_İtiÚs
[] = {

258 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

259 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

260 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

261 {"th»ad-num", 
»quœed_¬gum’t
, 
NULL
, 't'},

262 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

263 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 'S'},

264 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

265 {"bŸs-¿nge", 
»quœed_¬gum’t
, 
NULL
, 'b'},

266 {"bŸs-off£t", 
»quœed_¬gum’t
, 
NULL
, 'u'},

267 {"–a¡ic™y", 
»quœed_¬gum’t
, 
NULL
, 'x'},

268 {
NULL
, 0, NULL, 0}

271 
št£t_t
 *
£t
;

272 
i
, 
c
, 
size
;

273 
v®_t
 
Ï¡
 = 0;

274 
v®_t
 
v®
 = 0;

275 
»ads
, 
efä—ds
, 
upd©es
, 
effupds
, 
abÜts
, 
abÜts_locked_»ad
,

276 
abÜts_locked_wr™e
, 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
,

277 
abÜts_v®id©e_comm™
, 
abÜts_šv®id_memÜy
, 
abÜts_doubË_wr™e
,

278 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

279 
th»ad_d©a_t
 *
d©a
;

280 
±h»ad_t
 *
th»ads
;

281 
±h»ad_©Œ_t
 
©Œ
;

282 
b¬r›r_t
 
b¬r›r
;

283 
timev®
 
¡¬t
, 
’d
;

284 
time¥ec
 
timeout
;

285 
du¿tiÚ
 = 
DEFAULT_DURATION
;

286 
š™Ÿl
 = 
DEFAULT_INITIAL
;

287 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

288 
¿nge
 = 
DEFAULT_RANGE
;

289 
bŸs_¿nge
 = 
DEFAULT_BIAS_RANGE
;

290 
bŸs_off£t
 = 
DEFAULT_BIAS_OFFSET
;

291 
bŸs_’abËd
 = 0;

292 
£ed
 = 
DEFAULT_SEED
;

293 
upd©e
 = 
DEFAULT_UPDATE
;

294 
un™_tx
 = 
DEFAULT_ELASTICITY
;

295 
®‹º©e
 = 
DEFAULT_ALTERNATE
;

296 
efãùive
 = 
DEFAULT_EFFECTIVE
;

297 
sig£t_t
 
block_£t
;

300 
i
 = 0;

301 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hAf:d:i:t:r:S:u:b:B:x:", 
lÚg_İtiÚs
, &
i
);

303 if(
c
 == -1)

306 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

307 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

309 
c
) {

314 
	`´štf
("intset -- STM stressest "

323 " -A, --®‹º©(deçuÉ="
	`XSTR
(
DEFAULT_ALTERNATE
)")\n"

326 " upd©tx mu¡ƒfãùiv–y wr™(0ñrŸl, 1ófãùive, deçuÉ=" 
	`XSTR
(
DEFAULT_EFFECTIVE
) ")\n"

328 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

330 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

332 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

334 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

336 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

338 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

353 
	`ex™
(0);

355 
®‹º©e
 = 1;

358 
efãùive
 = 
	`©oi
(
İrg
);

361 
du¿tiÚ
 = 
	`©oi
(
İrg
);

364 
š™Ÿl
 = 
	`©oi
(
İrg
);

367 
nb_th»ads
 = 
	`©oi
(
İrg
);

370 
¿nge
 = 
	`©Ş
(
İrg
);

373 
£ed
 = 
	`©oi
(
İrg
);

376 
upd©e
 = 
	`©oi
(
İrg
);

379 
bŸs_¿nge
 = 
	`©Ş
(
İrg
);

382 
bŸs_off£t
 = 
	`©Ş
(
İrg
);

385 
un™_tx
 = 
	`©oi
(
İrg
);

388 
	`´štf
("Use -h or --help for help\n");

389 
	`ex™
(0);

391 
	`ex™
(1);

395 
	`as£¹
(
du¿tiÚ
 >= 0);

396 
	`as£¹
(
š™Ÿl
 >= 0);

397 
	`as£¹
(
nb_th»ads
 > 0);

398 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

399 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

400 ià(
bŸs_¿nge
 !ğ
DEFAULT_BIAS_RANGE
 || 
bŸs_off£t
 !ğ
DEFAULT_BIAS_OFFSET
) {

401 
bŸs_’abËd
 = 1;

402 
	`as£¹
(
bŸs_¿nge
 >= 0);

403 
	`as£¹
(
bŸs_off£t
 > 0);

406 
	`´štf
("B’chy³ : " 
ALGONAME
 "\n");

407 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

408 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

409 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

410 
	`´štf
("V®u¿ng : %ld\n", 
¿nge
);

411 ià(
bŸs_’abËd
) {

412 
	`´štf
("BŸ£d„ªge: [%ld, %ld)\n", 
bŸs_off£t
, bŸs_off£t+
bŸs_¿nge
);

414 
	`´štf
("S“d : %d\n", 
£ed
);

415 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

416 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

417 
	`´štf
("AÉ”Ç‹ : %d\n", 
®‹º©e
);

418 
	`´štf
("Efãùiv : %d\n", 
efãùive
);

419 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

423 ()(
ušŒ_t
));

424 
	`´štf
("Nodsiz : %d\n", ()(
node_t
));

426 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

427 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

429 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

430 
	`³¼Ü
("malloc");

431 
	`ex™
(1);

433 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

434 
	`³¼Ü
("malloc");

435 
	`ex™
(1);

438 ià(
£ed
 == 0)

439 
	`¤ªd
(()
	`time
(0));

441 
	`¤ªd
(
£ed
);

443 
£t
 = 
	`£t_Ãw
();

444 
¡İ
 = 0;

447 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

448 
i
 = 0;

449 
i
 < 
š™Ÿl
) {

450 
v®
 = 
	`¿nd_¿nge
(
¿nge
);

451 ià(
	`£t_š£¹
(
£t
, 
v®
)) {

452 
Ï¡
 = 
v®
;

453 
i
++;

456 
size
 = 
	`£t_size
(
£t
);

457 
	`´štf
("S‘ siz : %d\n", 
size
);

460 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

461 
	`±h»ad_©Œ_š™
(&
©Œ
);

462 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

463 
i
 = 0; i < 
nb_th»ads
; i++) {

464 
	`´štf
("C»©šgh»ad %d\n", 
i
);

465 
d©a
[
i
].
fœ¡
 = 
Ï¡
;

466 
d©a
[
i
].
bŸs_’abËd
 = bias_enabled;

467 
d©a
[
i
].
bŸs_¿nge
 = bias_range;

468 
d©a
[
i
].
bŸs_off£t
 = bias_offset;

469 
d©a
[
i
].
¿nge
 =„ange;

470 
d©a
[
i
].
upd©e
 = update;

471 
d©a
[
i
].
un™_tx
 = unit_tx;

472 
d©a
[
i
].
®‹º©e
 =‡lternate;

473 
d©a
[
i
].
efãùive
 =ƒffective;

474 
d©a
[
i
].
nb_add
 = 0;

475 
d©a
[
i
].
nb_added
 = 0;

476 
d©a
[
i
].
nb_»move
 = 0;

477 
d©a
[
i
].
nb_»moved
 = 0;

478 
d©a
[
i
].
nb_cÚšs
 = 0;

479 
d©a
[
i
].
nb_found
 = 0;

480 
d©a
[
i
].
nb_abÜts
 = 0;

481 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

482 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

483 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

484 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

485 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

486 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

487 
d©a
[
i
].
nb_abÜts_doubË_wr™e
 = 0;

488 
d©a
[
i
].
max_»Œ›s
 = 0;

489 
d©a
[
i
].
£ed
 = 
	`¿nd
();

490 
d©a
[
i
].
£t
 = set;

491 
d©a
[
i
].
b¬r›r
 = &barrier;

492 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

493 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

494 
	`årštf
(
¡d”r
, "Error creatinghread\n");

495 
	`ex™
(1);

498 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

501 
	`b¬r›r_üoss
(&
b¬r›r
);

503 
	`´štf
("STARTING...\n");

504 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

505 ià(
du¿tiÚ
 > 0) {

506 
	`Çno¦“p
(&
timeout
, 
NULL
);

508 
	`sigem±y£t
(&
block_£t
);

509 
	`sigsu¥’d
(&
block_£t
);

519 
	`©omic_¡Üe
(&
¡İ
, 1);

521 
	`g‘timeofday
(&
’d
, 
NULL
);

522 
	`´štf
("STOPPING...\n");

525 
i
 = 0; i < 
nb_th»ads
; i++) {

526 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

527 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

528 
	`ex™
(1);

532 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

533 
abÜts
 = 0;

534 
abÜts_locked_»ad
 = 0;

535 
abÜts_locked_wr™e
 = 0;

536 
abÜts_v®id©e_»ad
 = 0;

537 
abÜts_v®id©e_wr™e
 = 0;

538 
abÜts_v®id©e_comm™
 = 0;

539 
abÜts_šv®id_memÜy
 = 0;

540 
abÜts_doubË_wr™e
 = 0;

541 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

542 
»ads
 = 0;

543 
efä—ds
 = 0;

544 
upd©es
 = 0;

545 
effupds
 = 0;

546 
max_»Œ›s
 = 0;

547 
i
 = 0; i < 
nb_th»ads
; i++) {

548 
	`´štf
("Th»ad %d\n", 
i
);

549 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

550 
	`´štf
(" #added : %lu\n", 
d©a
[
i
].
nb_added
);

551 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

552 
	`´štf
(" #»moved : %lu\n", 
d©a
[
i
].
nb_»moved
);

553 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

554 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

555 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

556 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

557 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

558 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

559 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

560 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

561 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

562 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_doubË_wr™e
);

563 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

564 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

565 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

566 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

567 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

568 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

569 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

570 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

571 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

572 
abÜts_doubË_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_doubË_wr™e
;

573 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

574 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

575 
efä—ds
 +ğ
d©a
[
i
].
nb_cÚšs
 +

576 (
d©a
[
i
].
nb_add
 - d©a[i].
nb_added
) +

577 (
d©a
[
i
].
nb_»move
 - d©a[i].
nb_»moved
);

578 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

579 
effupds
 +ğ
d©a
[
i
].
nb_»moved
 + d©a[i].
nb_added
;

580 
size
 +ğ
d©a
[
i
].
nb_added
 - d©a[i].
nb_»moved
;

581 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

582 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

584 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`£t_size
(
£t
), 
size
);

585 ià(
	`£t_size
(
£t
è!ğ
size
) {

586 
	`´štf
("ERROR: Set size did‚ot matchƒxpected.\n");

588 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

589 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
,

590 (
»ads
 + 
upd©es
è* 1000.0 / 
du¿tiÚ
);

592 
	`´štf
("#readxs : ");

593 ià(
efãùive
) {

594 
	`´štf
("%lu (%à/ s)\n", 
efä—ds
,ƒfä—d * 1000.0 / 
du¿tiÚ
);

595 
	`´štf
(" #cÚš  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

596 } 
	`´štf
("%lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

598 
	`´štf
("#eff. upd„©e: %à\n", 100.0 * 
effupds
 / (effupd + 
efä—ds
));

600 
	`´štf
("#updatexs : ");

601 ià(
efãùive
) {

602 
	`´štf
("%lu (%à/ s)\n", 
effupds
,ƒffupd * 1000.0 / 
du¿tiÚ
);

603 
	`´štf
(" #updrŸl : %lu (%à/ s)\n", 
upd©es
, updates * 1000.0 /

604 
du¿tiÚ
);

605 } 
	`´štf
("%lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

608 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,

609 
abÜts
 * 1000.0 / 
du¿tiÚ
);

610 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,

611 
abÜts_locked_»ad
 * 1000.0 / 
du¿tiÚ
);

612 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,

613 
abÜts_locked_wr™e
 * 1000.0 / 
du¿tiÚ
);

614 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,

615 
abÜts_v®id©e_»ad
 * 1000.0 / 
du¿tiÚ
);

616 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,

617 
abÜts_v®id©e_wr™e
 * 1000.0 / 
du¿tiÚ
);

618 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,

619 
abÜts_v®id©e_comm™
 * 1000.0 / 
du¿tiÚ
);

620 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,

621 
abÜts_šv®id_memÜy
 * 1000.0 / 
du¿tiÚ
);

622 
	`´štf
(" #dup-w : %lu (%à/ s)\n", 
abÜts_doubË_wr™e
,

623 
abÜts_doubË_wr™e
 * 1000.0 / 
du¿tiÚ
);

624 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

625 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

628 
	`£t_d–‘e
(
£t
);

630 
	`ä“
(
th»ads
);

631 
	`ä“
(
d©a
);

634 
	}
}

	@linkedlists/versioned/intset.h

1 
	~<¡dlib.h
>

2 
	~<lim™s.h
>

3 
	~<¡dio.h
>

4 
	~<¡dšt.h
>

5 
	~<¡d©omic.h
>

6 
	~<±h»ad.h
>

8 
	tv®_t
;

9 
	#VAL_MIN
 
INT_MIN


	)

10 
	#VAL_MAX
 
INT_MAX


	)

13 
node
 
	tnode_t
;

14 
št£t
 
	tšt£t_t
;

17 
št£t_t
 *
£t_Ãw
();

18 
£t_d–‘e
(
št£t_t
 *
£t
);

19 
£t_size
(
št£t_t
 *
£t
);

20 
node_t
 *
Ãw_node
(
v®_t
 
v®
,‚ode_ˆ*
Ãxt
);

21 
£t_´št
(
št£t_t
 *
£t
);

24 
£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

25 
£t_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

26 
£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

29 #ifdeà
MUTEX


30 
±h»ad_mu‹x_t
 
	t±lock_t
;

31 
	#INIT_LOCK
(
lock
è
	`±h»ad_mu‹x_š™
((
±h»ad_mu‹x_t
 *èlock, 
NULL
);

	)

32 
	#DESTROY_LOCK
(
lock
è
	`±h»ad_mu‹x_de¡roy
((
±h»ad_mu‹x_t
 *èlock)

	)

33 
	#LOCK
(
lock
è
	`±h»ad_mu‹x_lock
((
±h»ad_mu‹x_t
 *èlock)

	)

34 
	#UNLOCK
(
lock
è
	`±h»ad_mu‹x_uÆock
((
±h»ad_mu‹x_t
 *èlock)

	)

36 
±h»ad_¥šlock_t
 
	t±lock_t
;

37 
	#INIT_LOCK
(
lock
è
	`±h»ad_¥š_š™
((
±h»ad_¥šlock_t
 *èlock, 
PTHREAD_PROCESS_PRIVATE
);

	)

38 
	#DESTROY_LOCK
(
lock
è
	`±h»ad_¥š_de¡roy
((
±h»ad_¥šlock_t
 *èlock)

	)

39 
	#LOCK
(
lock
è
	`±h»ad_¥š_lock
((
±h»ad_¥šlock_t
 *èlock)

	)

40 
	#UNLOCK
(
lock
è
	`±h»ad_¥š_uÆock
((
±h»ad_¥šlock_t
 *èlock)

	)

	@linkedlists/versioned/mixin.c

7 
št£t_t
 *
	$£t_Ãw
() {

8 
št£t_t
 *
£t
 = 
	`m®loc
((intset_t));

9 ià(
NULL
 =ğ
£t
) {

10 
	`³¼Ü
("malloc");

11 
	`ex™
(1);

14 
node_t
 *
max
 = 
	`Ãw_node
(
VAL_MAX
, 
NULL
);

15 
node_t
 *
mš
 = 
	`Ãw_node
(
VAL_MIN
, 
max
);

16 
£t
->
h—d
 = 
mš
;

17  
£t
;

18 
	}
}

21 
	$£t_d–‘e
(
št£t_t
 *
£t
) {

22 
node_t
 *
´ev
, *
cu¼
;

23 
cu¼
 = 
£t
->
h—d
;

24 
NULL
 !ğ
cu¼
) {

25 
´ev
 = 
cu¼
;

26 
cu¼
 = cu¼->
Ãxt
;

27 
	`ä“
(
´ev
);

29 
	`ä“
(
£t
);

30 
	}
}

34 
	$£t_size
(
št£t_t
 *
£t
) {

35 
size
 = 0;

36 
node_t
 *
cu¼
 = 
£t
->
h—d
->
Ãxt
;

37 
cu¼
->
Ãxt
 !ğ
NULL
) {

38 
size
++;

39 
cu¼
 = cu¼->
Ãxt
;

41  
size
;

42 
	}
}

44 
node_t
 *
	$Ãw_node
(
v®_t
 
v®
, 
node_t
 *
Ãxt
) {

45 
node_t
 *
node
 = 
	`ÿÎoc
((node_t), 1);

46 ià(
NULL
 =ğ
node
) {

47 
	`³¼Ü
("malloc");

48 
	`ex™
(1);

50 
node
->
v®
 = val;

51 
node
->
Ãxt
 =‚ext;

52  
node
;

53 
	}
}

56 
	$£t_´št
(
št£t_t
 *
£t
) {

57 
node_t
 *
cu¼
 = 
£t
->
h—d
;

58 
cu¼
 !ğ
NULL
) {

59 
	`´štf
("%d", 
cu¼
->
v®
);

60 ià(
cu¼
->
Ãxt
 !ğ
NULL
)

61 
	`´štf
(" -> ");

62 
cu¼
 = cu¼->
Ãxt
;

64 
	`´štf
("\n");

65 
	}
}

	@linkedlists/versioned/test.c

24 
	~<as£¹.h
>

25 
	~<g‘İt.h
>

26 
	~<lim™s.h
>

27 
	~<±h»ad.h
>

28 
	~<sigÇl.h
>

29 
	~<¡dlib.h
>

30 
	~<¡dio.h
>

31 
	~<sys/time.h
>

32 
	~<time.h
>

33 
	~<¡dšt.h
>

34 
	~<¡d©omic.h
>

36 
	~"št£t.h
"

37 
	~"v”siÚed-lškedli¡.h
"

39 
	#DEFAULT_DURATION
 10000

	)

40 
	#DEFAULT_INITIAL
 256

	)

41 
	#DEFAULT_NB_THREADS
 1

	)

42 
	#DEFAULT_RANGE
 0x7FFFFFFF

	)

43 
	#DEFAULT_BIAS_RANGE
 (-1)

	)

44 
	#DEFAULT_BIAS_OFFSET
 (-1)

	)

45 
	#DEFAULT_SEED
 0

	)

46 
	#DEFAULT_UPDATE
 20

	)

47 
	#DEFAULT_ELASTICITY
 4

	)

48 
	#DEFAULT_LOCKTYPE
 2

	)

49 
	#DEFAULT_ALTERNATE
 0

	)

50 
	#DEFAULT_EFFECTIVE
 1

	)

51 
	#XSTR
(
s
è
	`STR
(s)

	)

52 
	#STR
(
s
è#s

	)

55 
	$_Atomic
(è
¡İ
;

57 
	sb¬r›r
 {

58 
±h»ad_cÚd_t
 
com¶‘e
;

59 
±h»ad_mu‹x_t
 
mu‹x
;

60 
couÁ
;

61 
üossšg
;

62 } 
	tb¬r›r_t
;

64 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

66 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

67 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

68 
b
->
couÁ
 = 
n
;

69 
b
->
üossšg
 = 0;

70 
	}
}

72 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

74 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

76 
b
->
üossšg
++;

78 ià(
b
->
üossšg
 < b->
couÁ
) {

79 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

81 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

83 
b
->
üossšg
 = 0;

85 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

86 
	}
}

98 
šlše
 
	$¿nd_¿nge
(
r
) {

100 
m
 = 2147483647;

101 
d
, 
v
 = 0;

104 
d
 = (
m
 > 
r
 ?„ : m);

105 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

106 
r
 -ğ
m
;

107 } 
r
 > 0);

108  
v
;

109 
	}
}

110 
¿nd_¿nge
(
r
);

113 
šlše
 
	$¿nd_¿nge_»
(*
£ed
, 
r
) {

114 
m
 = 2147483647;

115 
d
, 
v
 = 0;

118 
d
 = (
m
 > 
r
 ?„ : m);

119 
v
 +ğ1 + ()(
d
 * (()
	`¿nd_r
(
£ed
)/(()(
m
)+1.0)));

120 
r
 -ğ
m
;

121 } 
r
 > 0);

122  
v
;

123 
	}
}

124 
¿nd_¿nge_»
(*
£ed
, 
r
);

127 
	sth»ad_d©a
 {

128 
v®_t
 
	mfœ¡
;

129 
	m¿nge
;

130 
	mbŸs_’abËd
;

131 
	mbŸs_¿nge
;

132 
	mbŸs_off£t
;

133 
	mupd©e
;

134 
	mun™_tx
;

135 
	m®‹º©e
;

136 
	mefãùive
;

137 
	mnb_add
;

138 
	mnb_added
;

139 
	mnb_»move
;

140 
	mnb_»moved
;

141 
	mnb_cÚšs
;

142 
	mnb_found
;

143 
	mnb_abÜts
;

144 
	mnb_abÜts_locked_»ad
;

145 
	mnb_abÜts_locked_wr™e
;

146 
	mnb_abÜts_v®id©e_»ad
;

147 
	mnb_abÜts_v®id©e_wr™e
;

148 
	mnb_abÜts_v®id©e_comm™
;

149 
	mnb_abÜts_šv®id_memÜy
;

150 
	mnb_abÜts_doubË_wr™e
;

151 
	mmax_»Œ›s
;

152 
	m£ed
;

153 
št£t_t
 *
	m£t
;

154 
b¬r›r_t
 *
	mb¬r›r
;

155 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

156 } 
	tth»ad_d©a_t
;

158 *
	$‹¡
(*
d©a
) {

160 
th»ad_d©a_t
 
d
 = *Ñh»ad_d©a_ˆ*)
d©a
;

163 
	`b¬r›r_üoss
(
d
.
b¬r›r
);

167 
v®_t
 
Ï¡
 = -1;

171 ià(
d
.
bŸs_’abËd
)

172 
Ï¡
 = 
d
.
bŸs_off£t
;

174 
	`©omic_lßd
(&
¡İ
) == 0) {

176 
do_upd©e
;

177 ià(
d
.
efãùive
)

178 
do_upd©e
 = (100 * (
d
.
nb_added
 + d.
nb_»moved
)è< (d.
upd©e
 * (d.
nb_add
 + d.
nb_»move
 + d.
nb_cÚšs
));

180 
do_upd©e
 = 
	`¿nd_¿nge_»
(&
d
.
£ed
, 100è- 1 < d.
upd©e
;

184 
v®_t
 
v®ue
 = 
	`¿nd_¿nge_»
(&
d
.
£ed
, d.
¿nge
);

187 ià(
d
.
bŸs_’abËd
) {

188 
v®ue
 = 
d
.
bŸs_off£t
 + 
	`¿nd_¿nge_»
(&d.
£ed
, d.
bŸs_¿nge
) - 1;

189 
Ï¡
 = (
	`¿nd_¿nge_»
(&
d
.
£ed
, 2è=ğ1è? -1 : 
v®ue
;

192 ià(
do_upd©e
 && 
Ï¡
 < 0) {

194 ià(
	`£t_š£¹
(
d
.
£t
, 
v®ue
)) {

195 
d
.
nb_added
++;

196 
Ï¡
 = 
v®ue
;

198 
d
.
nb_add
++;

199 } ià(
do_upd©e
 && 
Ï¡
 >= 0) {

203 ià(
d
.
®‹º©e
) {

204 ià(
	`£t_»move
(
d
.
£t
, 
Ï¡
))

205 
d
.
nb_»moved
++;

206 
Ï¡
 = -1;

208 ià(
	`£t_»move
(
d
.
£t
, 
v®ue
)) {

209 
d
.
nb_»moved
++;

210 
Ï¡
 = -1;

213 
d
.
nb_»move
++;

216 ià(
d
.
®‹º©e
) {

217 ià(
d
.
upd©e
 == 0) {

218 ià(
Ï¡
 < 0)

219 
Ï¡
 = 
v®ue
 = 
d
.
fœ¡
;

221 
Ï¡
 = -1;

223 ià(
Ï¡
 >= 0)

224 
v®ue
 = 
Ï¡
;

228 ià(
	`£t_cÚšs
(
d
.
£t
, 
v®ue
))

229 
d
.
nb_found
++;

230 
d
.
nb_cÚšs
++;

234 *(
th»ad_d©a_t
 *)
d©a
 = 
d
;

236  
NULL
;

237 
	}
}

243 
	$maš
(
¬gc
, **
¬gv
) {

244 
İtiÚ
 
lÚg_İtiÚs
[] = {

246 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

247 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

248 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

249 {"th»ad-num", 
»quœed_¬gum’t
, 
NULL
, 't'},

250 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

251 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 'S'},

252 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

253 {"bŸs-¿nge", 
»quœed_¬gum’t
, 
NULL
, 'b'},

254 {"bŸs-off£t", 
»quœed_¬gum’t
, 
NULL
, 'u'},

255 {"–a¡ic™y", 
»quœed_¬gum’t
, 
NULL
, 'x'},

256 {
NULL
, 0, NULL, 0}

259 
št£t_t
 *
£t
;

260 
i
, 
c
, 
size
;

261 
v®_t
 
Ï¡
 = 0;

262 
v®_t
 
v®
 = 0;

263 
»ads
, 
efä—ds
, 
upd©es
, 
effupds
, 
abÜts
, 
abÜts_locked_»ad
,

264 
abÜts_locked_wr™e
, 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
,

265 
abÜts_v®id©e_comm™
, 
abÜts_šv®id_memÜy
, 
abÜts_doubË_wr™e
,

266 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

267 
th»ad_d©a_t
 *
d©a
;

268 
±h»ad_t
 *
th»ads
;

269 
±h»ad_©Œ_t
 
©Œ
;

270 
b¬r›r_t
 
b¬r›r
;

271 
timev®
 
¡¬t
, 
’d
;

272 
time¥ec
 
timeout
;

273 
du¿tiÚ
 = 
DEFAULT_DURATION
;

274 
š™Ÿl
 = 
DEFAULT_INITIAL
;

275 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

276 
¿nge
 = 
DEFAULT_RANGE
;

277 
bŸs_¿nge
 = 
DEFAULT_BIAS_RANGE
;

278 
bŸs_off£t
 = 
DEFAULT_BIAS_OFFSET
;

279 
bŸs_’abËd
 = 0;

280 
£ed
 = 
DEFAULT_SEED
;

281 
upd©e
 = 
DEFAULT_UPDATE
;

282 
un™_tx
 = 
DEFAULT_ELASTICITY
;

283 
®‹º©e
 = 
DEFAULT_ALTERNATE
;

284 
efãùive
 = 
DEFAULT_EFFECTIVE
;

285 
sig£t_t
 
block_£t
;

288 
i
 = 0;

289 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hAf:d:i:t:r:S:u:b:B:x:", 
lÚg_İtiÚs
, &
i
);

291 if(
c
 == -1)

294 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

295 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

297 
c
) {

302 
	`´štf
("intset -- STM stressest "

311 " -A, --®‹º©(deçuÉ="
	`XSTR
(
DEFAULT_ALTERNATE
)")\n"

314 " upd©tx mu¡ƒfãùiv–y wr™(0ñrŸl, 1ófãùive, deçuÉ=" 
	`XSTR
(
DEFAULT_EFFECTIVE
) ")\n"

316 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

318 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

320 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

322 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

324 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

326 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

341 
	`ex™
(0);

343 
®‹º©e
 = 1;

346 
efãùive
 = 
	`©oi
(
İrg
);

349 
du¿tiÚ
 = 
	`©oi
(
İrg
);

352 
š™Ÿl
 = 
	`©oi
(
İrg
);

355 
nb_th»ads
 = 
	`©oi
(
İrg
);

358 
¿nge
 = 
	`©Ş
(
İrg
);

361 
£ed
 = 
	`©oi
(
İrg
);

364 
upd©e
 = 
	`©oi
(
İrg
);

367 
bŸs_¿nge
 = 
	`©Ş
(
İrg
);

370 
bŸs_off£t
 = 
	`©Ş
(
İrg
);

373 
un™_tx
 = 
	`©oi
(
İrg
);

376 
	`´štf
("Use -h or --help for help\n");

377 
	`ex™
(0);

379 
	`ex™
(1);

383 
	`as£¹
(
du¿tiÚ
 >= 0);

384 
	`as£¹
(
š™Ÿl
 >= 0);

385 
	`as£¹
(
nb_th»ads
 > 0);

386 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

387 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

388 ià(
bŸs_¿nge
 !ğ
DEFAULT_BIAS_RANGE
 || 
bŸs_off£t
 !ğ
DEFAULT_BIAS_OFFSET
) {

389 
bŸs_’abËd
 = 1;

390 
	`as£¹
(
bŸs_¿nge
 >= 0);

391 
	`as£¹
(
bŸs_off£t
 > 0);

394 
	`´štf
("B’chy³ : " 
ALGONAME
 "\n");

395 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

396 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

397 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

398 
	`´štf
("V®u¿ng : %ld\n", 
¿nge
);

399 ià(
bŸs_’abËd
) {

400 
	`´štf
("BŸ£d„ªge: [%ld, %ld)\n", 
bŸs_off£t
, bŸs_off£t+
bŸs_¿nge
);

402 
	`´štf
("S“d : %d\n", 
£ed
);

403 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

404 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

405 
	`´štf
("AÉ”Ç‹ : %d\n", 
®‹º©e
);

406 
	`´štf
("Efãùiv : %d\n", 
efãùive
);

407 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d/val_t=%d\n",

411 ()(
ušŒ_t
),

412 ()(
v®_t
));

413 
	`´štf
("Nodsiz : %d\n", ()(
node_t
));

415 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

416 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

418 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

419 
	`³¼Ü
("malloc");

420 
	`ex™
(1);

422 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

423 
	`³¼Ü
("malloc");

424 
	`ex™
(1);

427 ià(
£ed
 == 0)

428 
	`¤ªd
(()
	`time
(0));

430 
	`¤ªd
(
£ed
);

432 
£t
 = 
	`£t_Ãw
();

433 
	`©omic_¡Üe
(&
¡İ
, 0);

441 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

442 
i
 = 0;

443 
i
 < 
š™Ÿl
) {

444 
v®
 = 
	`¿nd_¿nge
(
¿nge
);

445 ià(
	`£t_š£¹
(
£t
, 
v®
)) {

446 
Ï¡
 = 
v®
;

447 
i
++;

450 
size
 = 
	`£t_size
(
£t
);

451 
	`´štf
("S‘ siz : %d\n", 
size
);

454 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

455 
	`±h»ad_©Œ_š™
(&
©Œ
);

456 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

457 
i
 = 0; i < 
nb_th»ads
; i++) {

458 
	`´štf
("C»©šgh»ad %d\n", 
i
);

459 
d©a
[
i
].
fœ¡
 = 
Ï¡
;

460 
d©a
[
i
].
bŸs_’abËd
 = bias_enabled;

461 
d©a
[
i
].
bŸs_¿nge
 = bias_range;

462 
d©a
[
i
].
bŸs_off£t
 = bias_offset;

463 
d©a
[
i
].
¿nge
 =„ange;

464 
d©a
[
i
].
upd©e
 = update;

465 
d©a
[
i
].
un™_tx
 = unit_tx;

466 
d©a
[
i
].
®‹º©e
 =‡lternate;

467 
d©a
[
i
].
efãùive
 =ƒffective;

468 
d©a
[
i
].
nb_add
 = 0;

469 
d©a
[
i
].
nb_added
 = 0;

470 
d©a
[
i
].
nb_»move
 = 0;

471 
d©a
[
i
].
nb_»moved
 = 0;

472 
d©a
[
i
].
nb_cÚšs
 = 0;

473 
d©a
[
i
].
nb_found
 = 0;

474 
d©a
[
i
].
nb_abÜts
 = 0;

475 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

476 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

477 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

478 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

479 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

480 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

481 
d©a
[
i
].
nb_abÜts_doubË_wr™e
 = 0;

482 
d©a
[
i
].
max_»Œ›s
 = 0;

483 
d©a
[
i
].
£ed
 = 
	`¿nd
();

484 
d©a
[
i
].
£t
 = set;

485 
d©a
[
i
].
b¬r›r
 = &barrier;

486 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

487 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

488 
	`årštf
(
¡d”r
, "Error creatinghread\n");

489 
	`ex™
(1);

492 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

495 
	`b¬r›r_üoss
(&
b¬r›r
);

497 
	`´štf
("STARTING...\n");

498 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

499 ià(
du¿tiÚ
 > 0) {

500 
	`Çno¦“p
(&
timeout
, 
NULL
);

502 
	`sigem±y£t
(&
block_£t
);

503 
	`sigsu¥’d
(&
block_£t
);

506 
	`©omic_¡Üe
(&
¡İ
, 1);

508 
	`g‘timeofday
(&
’d
, 
NULL
);

509 
	`´štf
("STOPPING...\n");

512 
i
 = 0; i < 
nb_th»ads
; i++) {

513 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

514 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

515 
	`ex™
(1);

519 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

520 
abÜts
 = 0;

521 
abÜts_locked_»ad
 = 0;

522 
abÜts_locked_wr™e
 = 0;

523 
abÜts_v®id©e_»ad
 = 0;

524 
abÜts_v®id©e_wr™e
 = 0;

525 
abÜts_v®id©e_comm™
 = 0;

526 
abÜts_šv®id_memÜy
 = 0;

527 
abÜts_doubË_wr™e
 = 0;

528 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

529 
»ads
 = 0;

530 
efä—ds
 = 0;

531 
upd©es
 = 0;

532 
effupds
 = 0;

533 
max_»Œ›s
 = 0;

534 
i
 = 0; i < 
nb_th»ads
; i++) {

535 
	`´štf
("Th»ad %d\n", 
i
);

536 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

537 
	`´štf
(" #added : %lu\n", 
d©a
[
i
].
nb_added
);

538 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

539 
	`´štf
(" #»moved : %lu\n", 
d©a
[
i
].
nb_»moved
);

540 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

541 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

542 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

543 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

544 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

545 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

546 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

547 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

548 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

549 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_doubË_wr™e
);

550 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

551 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

552 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

553 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

554 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

555 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

556 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

557 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

558 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

559 
abÜts_doubË_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_doubË_wr™e
;

560 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

561 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

562 
efä—ds
 +ğ
d©a
[
i
].
nb_cÚšs


563 + (
d©a
[
i
].
nb_add
 - d©a[i].
nb_added
)

564 + (
d©a
[
i
].
nb_»move
 - d©a[i].
nb_»moved
);

565 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

566 
effupds
 +ğ
d©a
[
i
].
nb_»moved
 + d©a[i].
nb_added
;

567 
size
 +ğ
d©a
[
i
].
nb_added
 - d©a[i].
nb_»moved
;

568 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

569 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

571 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`£t_size
(
£t
), 
size
);

572 ià(
	`£t_size
(
£t
è!ğ
size
) {

573 
	`´štf
("ERROR: Set size did‚ot matchƒxpected.\n");

575 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

576 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
, (»ad + upd©esè* 1000.0 / 
du¿tiÚ
);

578 
	`´štf
("#readxs : ");

579 ià(
efãùive
) {

580 
	`´štf
("%lu (%à/ s)\n", 
efä—ds
,ƒfä—d * 1000.0 / 
du¿tiÚ
);

581 
	`´štf
(" #cÚš  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

582 } 
	`´štf
("%lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

584 
	`´štf
("#eff. upd„©e: %à\n", 100.0 * 
effupds
 / (effupd + 
efä—ds
));

586 
	`´štf
("#updatexs : ");

587 ià(
efãùive
) {

588 
	`´štf
("%lu (%à/ s)\n", 
effupds
,ƒffupd * 1000.0 / 
du¿tiÚ
);

589 
	`´štf
(" #updrŸl : %lu (%à/ s)\n", 
upd©es
, updates * 1000.0 /

590 
du¿tiÚ
);

591 } 
	`´štf
("%lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

594 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

595 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

596 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

597 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

598 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

599 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

600 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

601 
	`´štf
(" #dup-w : %lu (%à/ s)\n", 
abÜts_doubË_wr™e
,‡bÜts_doubË_wr™* 1000.0 / 
du¿tiÚ
);

602 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

603 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

606 
	`£t_d–‘e
(
£t
);

611 
	`ä“
(
th»ads
);

612 
	`ä“
(
d©a
);

615 
	}
}

	@linkedlists/versioned/versioned-linkedlist.c

23 
	~"št£t.h
"

24 
	~"v”siÚed-lškedli¡.h
"

27 
	~"mixš.c
"

30 
	$£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

31 
node_t
* 
cu¼
 = 
£t
->
h—d
;

33 
cu¼
->
v®
 < val) {

34 
cu¼
 = cu¼->
Ãxt
;

38  (
cu¼
->
v®
 =ğv® && !cu¼->
d–‘ed
);

39 
	}
}

42 
	$v®id©e
(
v®_t
 
v®
, 
node_t
** 
´ev
,‚ode_t** 
cu¼
, 
v”lock_t
* 
´ev_v”siÚ
) {

43 
·¹Ÿl_abÜt
:

44 *
´ev_v”siÚ
 = 
	`g‘_v”siÚ
(&(*
´ev
)->
lock
);

46 ià((*
´ev
)->
d–‘ed
){

48  
çl£
;

51 *
cu¼
 = (*
´ev
)->
Ãxt
;

52 (*
cu¼
)->
v®
 < val) {

53 *
´ev_v”siÚ
 = 
	`g‘_v”siÚ
(&(*
cu¼
)->
lock
);

55 ià((*
cu¼
)->
d–‘ed
){

56 
·¹Ÿl_abÜt
;

59 *
´ev
 = *
cu¼
;

60 *
cu¼
 = (*cu¼)->
Ãxt
;

63  
Œue
;

64 
	}
}

67 
	$Œav”£
(
v®_t
 
v®
, 
node_t
** 
´ev
,‚ode_t** 
cu¼
,‚ode_t* 
¡¬t
) {

68 *
´ev
 = 
¡¬t
;

69 *
cu¼
 = 
¡¬t
;

72 (*
cu¼
)->
v®
 < val) {

73 *
´ev
 = *
cu¼
;

74 *
cu¼
 = (*cu¼)->
Ãxt
;

77 
	}
}

79 
	$£t_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
){

80 
node_t
* 
´ev
 = 
NULL
;

81 
node_t
* 
cu¼
 = 
NULL
;

82 
node_t
* 
Ãw
 = 
NULL
;

83 
v”lock_t
 
´ev_v”siÚ
;

86 
»¡¬t_äom_Œav”£
:

87 
	`Œav”£
(
v®
, &
´ev
, &
cu¼
, 
£t
->
h—d
);

90 
»¡¬t_äom_v®id©e
:

93 ià(!
	`v®id©e
(
v®
, &
´ev
, &
cu¼
, &
´ev_v”siÚ
)) {

95 
»¡¬t_äom_Œav”£
;

99 ià(
cu¼
->
d–‘ed
) {

100 
»¡¬t_äom_Œav”£
;

104 ià(
cu¼
->
v®
 == val) {

105  
çl£
;

109 ià(
Ãw
 =ğ
NULL
) {

110 
Ãw
 = 
	`Ãw_node
(
v®
, 
NULL
);

114 
Ãw
->
Ãxt
 = 
cu¼
;

117 ià(!
	`Œy_lock_©_v”siÚ
(&
´ev
->
lock
, 
´ev_v”siÚ
)) {

119 
»¡¬t_äom_v®id©e
;

123 
´ev
->
Ãxt
 = 
Ãw
;

125 
	`uÆock_ªd_šüem’t_v”siÚ
(&
´ev
->
lock
);

127  
Œue
;

128 
	}
}

130 
	$£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

131 
node_t
* 
´ev
 = 
NULL
;

132 
node_t
* 
cu¼
 = 
NULL
;

133 
v”lock_t
 
´ev_v”siÚ
;

136 
»¡¬t_äom_Œav”£
:

137 
	`Œav”£
(
v®
, &
´ev
, &
cu¼
, 
£t
->
h—d
);

140 
»¡¬t_äom_v®id©e
:

143 ià(!
	`v®id©e
(
v®
, &
´ev
, &
cu¼
, &
´ev_v”siÚ
)) {

145 
»¡¬t_äom_Œav”£
;

149 ià(
cu¼
->
v®
 !ğv® || cu¼->
d–‘ed
) {

150  
çl£
;

154 ià(!
	`Œy_lock_©_v”siÚ
(&
´ev
->
lock
, 
´ev_v”siÚ
)) {

156 
»¡¬t_äom_v®id©e
;

160 
	`¥šlock
(&
cu¼
->
lock
);

163 
cu¼
->
d–‘ed
 = 
Œue
;

166 
´ev
->
Ãxt
 = 
cu¼
->next;

168 
	`uÆock_ªd_šüem’t_v”siÚ
(&
cu¼
->
lock
);

169 
	`uÆock_ªd_šüem’t_v”siÚ
(&
´ev
->
lock
);

171  
Œue
;

172 
	}
}

	@linkedlists/versioned/versioned-linkedlist.h

23 #iâdeà
_VERSIONED_LINKEDLIST_H


24 
	#_VERSIONED_LINKEDLIST_H


	)

26 
	~<¡dboŞ.h
>

27 
	~"../../uts/v”siÚed-lock/v”siÚed-lock.h
"

29 
	#ALGONAME
 "V”siÚed Lšked Li¡"

	)

31 
	snode
 {

32 
v®_t
 
	mv®
;

33 
node
* 
	mÃxt
;

34 
	md–‘ed
;

35 
_Atomic
(
v”lock_t
è
	mlock
;

38 
	sšt£t
 {

39 
node_t
* 
	mh—d
;

	@rtm-charlie/hash_hle/hashtable.cpp

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<immšŒš.h
>

5 
	~"hashbË.h
"

7 
»size_hash_bË_if_Ãeded
(
HashTabË
 *
ht
);

8 
hash_¡r
(*
key
);

10 vŞ©
	gmu‹x_v®
;

12 
	$hË_š™
(vŞ©*
v®
)

14 *
v®
 = 0;

15 
	}
}

17 
	$hË_lock
(vŞ©*
mu‹x_v®
)

19 
	`__©omic_exchªge_n
(
mu‹x_v®
, 1, 
__ATOMIC_ACQUIRE
 | 
__ATOMIC_HLE_ACQUIRE
))

20 
	`_mm_·u£
();

21  
Œue
;

22 
	}
}

24 
	$hË_»Ëa£
(vŞ©*
mu‹x_v®
)

26 
	`__©omic_¡Üe_n
(
mu‹x_v®
, 0, 
__ATOMIC_RELEASE
 | 
__ATOMIC_HLE_RELEASE
);

27  
Œue
;

28 
	}
}

30 
	$hash_š™
(
HashTabË
 *
ht
)

32 
ht
->
size
 = 
HASH_TABLE_INIT_SIZE
;

33 
ht
->
–em_num
 = 0;

34 
ht
->
h—d”s
 = (
H—d”
 *)
	`ÿÎoc
(ht->
size
, (Header));

36 if(
ht
->
h—d”s
 =ğ
NULL
è 
FAILED
;

37 
i
;

38 
i
 = 0; i < 
ht
->
size
; i++) {

39 
	`hË_š™
(&
ht
->
h—d”s
[
i
].
mu‹x_v®
);

41 
	`LOG_MSG
("[š™]\tsize: %i\n", 
ht
->
size
);

43  
SUCCESS
;

44 
	}
}

46 
	$hash_lookup
(
HashTabË
 *
ht
, *
key
, **
»suÉ
)

48 
¡©us
;

49 
šdex
 = 
	`HASH_INDEX
(
ht
, 
key
);

50 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

51 
	`hË_lock
(&
h—d”
->
mu‹x_v®
);

52 
Buck‘
 *
buck‘
 = 
h—d”
->
Ãxt
;

53 if(
buck‘
 =ğ
NULL
) {

54 
	`hË_»Ëa£
(&
h—d”
->
mu‹x_v®
);

55 
çed
;

57 
buck‘
)

59 if(
	`¡rcmp
(
buck‘
->
key
, key) == 0)

63 *
»suÉ
 = 
buck‘
->
v®ue
;

64  
SUCCESS
;

67 
buck‘
 = buck‘->
Ãxt
;

69 
	`hË_»Ëa£
(&
h—d”
->
mu‹x_v®
);

71 
çed
:

72 
	`LOG_MSG
("[lookup]\ˆkey:%s\tçed\t\n", 
key
);

73  
FAILED
;

74 
	}
}

76 
	$hash_š£¹
(
HashTabË
 *
ht
,*
key
, *
v®ue
)

79 
¡©us
;

80 
Buck‘
 *
buck‘
 = (Buck‘ *)
	`m®loc
((Bucket));

82 
	`»size_hash_bË_if_Ãeded
(
ht
);

84 
šdex
 = 
	`HASH_INDEX
(
ht
, 
key
);

85 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

86 
	`hË_lock
(&
h—d”
->
mu‹x_v®
);

87 
Buck‘
 *
Üg_buck‘
 = 
h—d”
->
Ãxt
;

88 
Buck‘
 *
tmp_buck‘
 = 
Üg_buck‘
;

90 
tmp_buck‘
)

92 if(
	`¡rcmp
(
key
, 
tmp_buck‘
->key) == 0)

94 
tmp_buck‘
->
v®ue
 = value;

95 
	`ä“
(
buck‘
);

96 
	`hË_»Ëa£
(&
h—d”
->
mu‹x_v®
);

97  
SUCCESS
;

100 
tmp_buck‘
 =mp_buck‘->
Ãxt
;

102 
buck‘
->
key
 = key;

103 
buck‘
->
v®ue
 = value;

104 
buck‘
->
Ãxt
 = 
NULL
;

106 
ht
->
–em_num
 += 1;

108 if(
Üg_buck‘
 !ğ
NULL
)

110 
buck‘
->
Ãxt
 = 
Üg_buck‘
;

113 
ht
->
h—d”s
[
šdex
].
Ãxt
ğ
buck‘
;

114 
	`hË_»Ëa£
(&
h—d”
->
mu‹x_v®
);

115  
SUCCESS
;

116 
	}
}

118 
	$hash_»move
(
HashTabË
 *
ht
, *
key
)

120 
šdex
 = 
	`HASH_INDEX
(
ht
, 
key
);

121 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

122 
Buck‘
 *
buck‘
 = 
h—d”
->
Ãxt
;

123 
Buck‘
 *
´ev
 = 
NULL
;

125 if(
buck‘
 =ğ
NULL
è 
FAILED
;

128 
buck‘
)

130 if(
	`¡rcmp
(
buck‘
->
key
, key) == 0)

132 
	`LOG_MSG
("[»move]\tkey:(%sèšdex: %d\n", 
key
, 
šdex
);

134 if(
´ev
 =ğ
NULL
)

136 
ht
->
h—d”s
[
šdex
].
Ãxt
 = 
buck‘
->next;

140 
´ev
->
Ãxt
 = 
buck‘
->next;

142 
	`ä“
(
buck‘
);

144  
SUCCESS
;

147 
´ev
 = 
buck‘
;

148 
buck‘
 = buck‘->
Ãxt
;

151 
	`LOG_MSG
("[»move]\ˆkey:% nÙ found„emov\tçed\t\n", 
key
);

152  
FAILED
;

153 
	}
}

155 
	$hash_de¡roy
(
HashTabË
 *
ht
)

157 
i
;

158 
Buck‘
 *
cur
 = 
NULL
;

159 
Buck‘
 *
tmp
 = 
NULL
;

161 
i
=0; i < 
ht
->
size
; ++i)

163 
cur
 = 
ht
->
h—d”s
[
i
].
Ãxt
;

164 
cur
)

166 
tmp
 = 
cur
;

167 
cur
 = cur->
Ãxt
;

168 
	`ä“
(
tmp
);

171 
	`ä“
(
ht
->
h—d”s
);

173  
SUCCESS
;

174 
	}
}

176 
	$hash_¡r
(*
key
)

178 
hash
 = 0;

180 *
cur
 = 
key
;

182 *
cur
 != '\0')

184 
hash
 +ğ*
cur
;

185 ++
cur
;

188  
hash
;

189 
	}
}

191 
	$hash_»size
(
HashTabË
 *
ht
)

194 
Üg_size
 = 
ht
->
size
;

195 
ht
->
size
 = ht->size * 2;

196 
ht
->
–em_num
 = 0;

198 
	`LOG_MSG
("[»size]\tÜg size: %i\Šew size: %i\n", 
Üg_size
, 
ht
->
size
);

201 
H—d”
 *
h—d”s
 = (H—d” *)
	`ÿÎoc
(
ht
->
size
, (Header));

203 
H—d”
 *
Üg_h—d”s
 = 
ht
->
h—d”s
;

204 
ht
->
h—d”s
 = headers;

206 
i
 = 0;

207 
i
=0; i < 
Üg_size
; ++i)

209 
Buck‘
 *
cur
 = 
Üg_h—d”s
[
i
].
Ãxt
;

210 
Buck‘
 *
tmp
;

211 
cur
)

214 
	`hash_š£¹
(
ht
, 
cur
->
key
, cur->
v®ue
);

217 
tmp
 = 
cur
;

218 
cur
 = cur->
Ãxt
;

219 
	`ä“
(
tmp
);

222 
	`ä“
(
Üg_h—d”s
);

224 
	`LOG_MSG
("[resize] done\n");

226  
SUCCESS
;

227 
	}
}

231 
	$»size_hash_bË_if_Ãeded
(
HashTabË
 *
ht
)

233 if(
ht
->
size
 - ht->
–em_num
 < 1)

235 
	`hash_»size
(
ht
);

237 
	}
}

	@rtm-charlie/hash_hle/hashtable.h

1 #iâdeà
_HASH_TABLE_H_


2 
	#_HASH_TABLE_H_
 1

	)

4 
	#HASH_TABLE_INIT_SIZE
 65536

	)

5 
	#HASH_INDEX
(
ht
, 
key
è(
	`hash_¡r
((key)è% (ht)->
size
)

	)

7 #ià
defšed
(
DEBUG
)

8 
	#LOG_MSG
 
´štf


	)

10 
	#LOG_MSG
(...)

	)

13 
	~<±h»ad.h
>

16 
	#SUCCESS
 0

	)

17 
	#FAILED
 -1

	)

22 
hË_š™
();

23 
hË_lock
();

24 
hË_»Ëa£
();

28 
	s_Buck‘


30 *
	mkey
;

31 *
	mv®ue
;

32 
_Buck‘
 *
	mÃxt
;

33 } 
	tBuck‘
;

35 
	s_H—d”


37 
_Buck‘
 *
	mÃxt
;

38 vŞ©
	mmu‹x_v®
;

39 } 
	tH—d”
;

41 
	s_HashTabË


43 
	msize
;

44 
	m–em_num
;

45 
H—d”
 *
	mh—d”s
;

46 } 
	tHashTabË
;

48 
hash_š™
(
HashTabË
 *
ht
);

49 
hash_lookup
(
HashTabË
 *
ht
, *
key
, **
»suÉ
);

50 
hash_š£¹
(
HashTabË
 *
ht
, *
key
, *
v®ue
);

51 
hash_»move
(
HashTabË
 *
ht
, *
key
);

52 
hash_de¡roy
(
HashTabË
 *
ht
);

	@rtm-charlie/hash_hle/main.cpp

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<as£¹.h
>

4 
	~<¡ršg.h
>

5 
	~"hashbË.h
"

6 
	~<¡ršg
>

7 
	~<io¡»am
>

8 
	~<time.h
>

10 
	#TEST
(
tÿ£
è
	`´štf
(">>> [START CASE] "ÿ£ "<<<\n")

	)

11 
	#PASS
(
tÿ£
è
	`´štf
(">>> [PASSED] "ÿ£ " <<<\n")

	)

13 
	gnum_th»ads
 = 4;

14 *
	$wÜk”
(*
·¿
)

16 
HashTabË
 *
ht
 = (HashTabË *)
·¿
;

18 
št1
 = 10;

19 
št2
 = 20;

20 
¡r1
[] = "Hello TIPI";

21 
¡r2
[] = "Value";

23 *
j
 = 
NULL
;

24 *
fšd_¡r
 = 
NULL
;

25 
»suÉ
 = 0;

26 
i
;

27 
	`¤ªd
(()
	`time
(
NULL
));

30 
	`TEST
("Key insert");

31 
i
 = 0; i < 10000; i++){

32 
¡d
::
¡ršg
 
¡r
 = std::
	`to_¡ršg
(
	`¿nd
());

33 *
c
 = 
	`¡rdup
(
¡r
.
	`c_¡r
());

34 
	`hash_š£¹
(
ht
, 
c
, &
¡r1
);

37 
	`PASS
("Key insert");

43 
	`TEST
("Key†ookup");

44 
	`hash_lookup
(
ht
, "KeyIÁ", (**)&
j
);

45 
	`hash_lookup
(
ht
, "KeySŒ", (**)&
fšd_¡r
);

47 
	`as£¹
(
	`¡rcmp
(
fšd_¡r
, 
¡r1
) == 0);

48 
	`as£¹
(*
j
 = 
št1
);

49 
	`PASS
("Key†ookup");

54 
	`TEST
("Test key update");

55 
	`hash_š£¹
(
ht
, "KeyIÁ", &
št2
);

56 
	`hash_lookup
(
ht
, "KeyIÁ", (**)&
j
);

57 
	`as£¹
(*
j
 = 
št2
);

58 
	`PASS
("Test key update");

60 
	`TEST
(">>> Test key‚ot found <<< ");

61 
»suÉ
 = 
	`hash_lookup
(
ht
, "nÚ-ex™s-key", (**)&
j
);

62 
	`as£¹
(
»suÉ
 =ğ
FAILED
);

63 
	`PASS
("non-exist-key†ookup");

65 
	`TEST
("Test key‚ot found‡fter„emove");

66 
¡rMyKey
[] = "My-Key-Value";

67 
fšd_¡r
 = 
NULL
;

68 
	`hash_š£¹
(
ht
, "My-Key", &
¡rMyKey
);

69 
»suÉ
 = 
	`hash_»move
(
ht
, "My-Key");

70 
	`as£¹
(
»suÉ
 =ğ
SUCCESS
);

72 
»suÉ
 = 
	`hash_lookup
(
ht
, "My-Key", (**)&
fšd_¡r
);

73 
	`as£¹
(
fšd_¡r
 =ğ
NULL
);

74 
	`as£¹
(
»suÉ
 =ğ
FAILED
);

75 
	`PASS
("Test key‚ot found‡fter„emove");

77 
	`PASS
(">>> Test key‚ot found <<< ");

79 
	`TEST
("Add manyƒlements‡nd make hashtable„ehash");

80 
	`hash_š£¹
(
ht
, "a1", &
št2
);

81 
	`hash_š£¹
(
ht
, "a2", &
št1
);

82 
	`hash_š£¹
(
ht
, "a3", &
št1
);

83 
	`hash_š£¹
(
ht
, "a4", &
št1
);

84 
	`hash_š£¹
(
ht
, "a5", &
št1
);

85 
	`hash_š£¹
(
ht
, "a6", &
št1
);

86 
	`hash_š£¹
(
ht
, "a7", &
št1
);

87 
	`hash_š£¹
(
ht
, "a8", 
¡r2
);

88 
	`hash_š£¹
(
ht
, "a9", &
št1
);

89 
	`hash_š£¹
(
ht
, "a10", &
št1
);

90 
	`hash_š£¹
(
ht
, "a11", &
št1
);

91 
	`hash_š£¹
(
ht
, "a12", &
št1
);

92 
	`hash_š£¹
(
ht
, "a13", &
št1
);

93 
	`hash_š£¹
(
ht
, "a14", &
št1
);

94 
	`hash_š£¹
(
ht
, "a15", &
št1
);

95 
	`hash_š£¹
(
ht
, "a16", &
št1
);

96 
	`hash_š£¹
(
ht
, "a17", &
št1
);

97 
	`hash_š£¹
(
ht
, "a18", &
št1
);

98 
	`hash_š£¹
(
ht
, "a19", &
št1
);

99 
	`hash_š£¹
(
ht
, "a20", &
št1
);

100 
	`hash_š£¹
(
ht
, "a21", &
št1
);

101 
	`hash_š£¹
(
ht
, "a22", &
št1
);

102 
	`hash_š£¹
(
ht
, "a23", &
št1
);

103 
	`hash_š£¹
(
ht
, "a24", &
št1
);

104 
	`hash_š£¹
(
ht
, "a24", &
št1
);

105 
	`hash_š£¹
(
ht
, "a24", &
št1
);

106 
	`hash_š£¹
(
ht
, "a25", &
št1
);

107 
	`hash_š£¹
(
ht
, "a26", &
št1
);

108 
	`hash_š£¹
(
ht
, "a27", &
št1
);

109 
	`hash_š£¹
(
ht
, "a28", &
št1
);

110 
	`hash_š£¹
(
ht
, "a29", &
št1
);

111 
	`hash_š£¹
(
ht
, "a30", &
št1
);

112 
	`hash_š£¹
(
ht
, "a31", &
št1
);

113 
	`hash_š£¹
(
ht
, "a32", &
št1
);

114 
	`hash_š£¹
(
ht
, "a33", &
št1
);

116 
	`hash_lookup
(
ht
, "a23", (**)&
j
);

117 
	`as£¹
(*
j
 = 
št1
);

118 
	`hash_lookup
(
ht
, "a30", (**)&
j
);

119 
	`as£¹
(*
j
 = 
št1
);

121 
	}
}

123 
	$maš
(
¬gc
, **
¬gv
) {

124 
±h»ad_t
 
th»ad
[
num_th»ads
];

125 
i
;

127 
HashTabË
 *
ht
 = (HashTabË *)
	`m®loc
((HashTable));

128 
»suÉ
 = 
	`hash_š™
(
ht
);

130 
	`as£¹
(
»suÉ
 =ğ
SUCCESS
);

131 
i
 = 0; i < 
num_th»ads
; i++) {

132 
»t
 = 
	`±h»ad_ü—‹
(&
th»ad
[
i
], 
NULL
, &
wÜk”
, (*)
ht
);

133 ià(
»t
) {

134 
	`´štf
("createhreadƒrror \n");

138 
i
 = 0; i < 
num_th»ads
; i++) {

139 
»t
 = 
	`±h»ad_još
(
th»ad
[
i
], 
NULL
);

144 
	`PASS
("Add manyƒlements‡nd make hashtable„ehash");

146 
	`hash_de¡roy
(
ht
);

147 
	`ä“
(
ht
);

149 
	`´štf
("Woohoo, It†ooks†ike HashTable works…roperly\n");

152 
	}
}

	@rtm-charlie/hash_rtm/hashtable.cpp

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<¡ršg.h
>

4 
	~<immšŒš.h
>

5 
	~"hashbË.h
"

7 
»size_hash_bË_if_Ãeded
(
HashTabË
 *
ht
);

8 
hash_¡r
(*
key
);

10 
	$hash_š™
(
HashTabË
 *
ht
)

12 
ht
->
size
 = 
HASH_TABLE_INIT_SIZE
;

13 
ht
->
–em_num
 = 0;

14 
ht
->
h—d”s
 = (
H—d”
 *)
	`ÿÎoc
(ht->
size
, (Header));

16 if(
ht
->
h—d”s
 =ğ
NULL
è 
FAILED
;

17 
i
;

18 
i
 = 0; i < 
ht
->
size
; i++) {

19 
	`±h»ad_mu‹x_š™
(&(
ht
->
h—d”s
[
i
].
mu‹x
), 
NULL
);

22 
	`LOG_MSG
("[š™]\tsize: %i\n", 
ht
->
size
);

24  
SUCCESS
;

25 
	}
}

27 
	$hash_lookup
(
HashTabË
 *
ht
, *
key
, **
»suÉ
)

29 
¡©us
;

30 
šdex
 = 
	`HASH_INDEX
(
ht
, 
key
);

31 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
) {

32 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

33 
Buck‘
 *
buck‘
 = 
h—d”
->
Ãxt
;

34 if(
buck‘
 =ğ
NULL
) {

35 
	`_x’d
();

36 
çed
;

38 
buck‘
)

40 if(
	`¡rcmp
(
buck‘
->
key
, key) == 0)

44 *
»suÉ
 = 
buck‘
->
v®ue
;

45 
	`_x’d
();

46  
SUCCESS
;

49 
buck‘
 = buck‘->
Ãxt
;

51 
	`_x’d
();

53 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

54 
	`±h»ad_mu‹x_lock
(&
h—d”
->
mu‹x
);

55 
Buck‘
 *
buck‘
 = 
h—d”
->
Ãxt
;

56 if(
buck‘
 =ğ
NULL
) {

57 
	`±h»ad_mu‹x_uÆock
(&
h—d”
->
mu‹x
);

58 
çed
;

60 
buck‘
)

62 if(
	`¡rcmp
(
buck‘
->
key
, key) == 0)

66 *
»suÉ
 = 
buck‘
->
v®ue
;

67  
SUCCESS
;

70 
buck‘
 = buck‘->
Ãxt
;

72 
	`±h»ad_mu‹x_uÆock
(&
h—d”
->
mu‹x
);

74 
çed
:

75 
	`LOG_MSG
("[lookup]\ˆkey:%s\tçed\t\n", 
key
);

76  
FAILED
;

77 
	}
}

79 
	$hash_š£¹
(
HashTabË
 *
ht
,*
key
, *
v®ue
)

82 
¡©us
;

83 
Buck‘
 *
buck‘
 = (Buck‘ *)
	`m®loc
((Bucket));

85 
	`»size_hash_bË_if_Ãeded
(
ht
);

87 
šdex
 = 
	`HASH_INDEX
(
ht
, 
key
);

89 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
) {

90 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

91 
Buck‘
 *
Üg_buck‘
 = 
h—d”
->
Ãxt
;

92 
Buck‘
 *
tmp_buck‘
 = 
Üg_buck‘
;

94 
tmp_buck‘
)

96 if(
	`¡rcmp
(
key
, 
tmp_buck‘
->key) == 0)

98 
tmp_buck‘
->
v®ue
 = value;

99 
	`_x’d
();

100 
	`ä“
(
buck‘
);

101  
SUCCESS
;

104 
tmp_buck‘
 =mp_buck‘->
Ãxt
;

106 
buck‘
->
key
 = key;

107 
buck‘
->
v®ue
 = value;

108 
buck‘
->
Ãxt
 = 
NULL
;

110 
ht
->
–em_num
 += 1;

112 if(
Üg_buck‘
 !ğ
NULL
)

114 
buck‘
->
Ãxt
 = 
Üg_buck‘
;

117 (
ht
->
h—d”s
[
šdex
]).
Ãxt
ğ
buck‘
;

118 
	`_x’d
();

119 
	`´štf
("committed\n");

122 
	`´štf
("abÜˆ¡©u i %u\n", 
¡©us
);

123 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

124 
	`±h»ad_mu‹x_lock
(&
h—d”
->
mu‹x
);

125 
Buck‘
 *
Üg_buck‘
 = 
h—d”
->
Ãxt
;

126 
Buck‘
 *
tmp_buck‘
 = 
Üg_buck‘
;

128 
tmp_buck‘
)

130 if(
	`¡rcmp
(
key
, 
tmp_buck‘
->key) == 0)

132 
tmp_buck‘
->
v®ue
 = value;

133 
	`ä“
(
buck‘
);

134 
	`±h»ad_mu‹x_uÆock
(&
h—d”
->
mu‹x
);

135  
SUCCESS
;

138 
tmp_buck‘
 =mp_buck‘->
Ãxt
;

140 
buck‘
->
key
 = key;

141 
buck‘
->
v®ue
 = value;

142 
buck‘
->
Ãxt
 = 
NULL
;

144 
ht
->
–em_num
 += 1;

146 if(
Üg_buck‘
 !ğ
NULL
)

148 
buck‘
->
Ãxt
 = 
Üg_buck‘
;

151 
ht
->
h—d”s
[
šdex
].
Ãxt
ğ
buck‘
;

152 
	`±h»ad_mu‹x_uÆock
(&
h—d”
->
mu‹x
);

156  
SUCCESS
;

157 
	}
}

159 
	$hash_»move
(
HashTabË
 *
ht
, *
key
)

161 
¡©us
;

162 
šdex
 = 
	`HASH_INDEX
(
ht
, 
key
);

163 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
) {

164 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

165 
Buck‘
 *
buck‘
 = 
h—d”
->
Ãxt
;

166 
Buck‘
 *
´ev
 = 
NULL
;

167 if(
buck‘
 =ğ
NULL
) {

168 
	`_x’d
();

169  
FAILED
;

173 
buck‘
)

175 if(
	`¡rcmp
(
buck‘
->
key
, key) == 0)

177 
	`LOG_MSG
("[»move]\tkey:(%sèšdex: %d\n", 
key
, 
šdex
);

179 if(
´ev
 =ğ
NULL
)

181 
ht
->
h—d”s
[
šdex
].
Ãxt
 = 
buck‘
->next;

185 
´ev
->
Ãxt
 = 
buck‘
->next;

187 
	`_x’d
();

188 
	`ä“
(
buck‘
);

189  
SUCCESS
;

191 
´ev
 = 
buck‘
;

192 
buck‘
 = buck‘->
Ãxt
;

194 
	`_x’d
();

196 
H—d”
 *
h—d”
 = &(
ht
->
h—d”s
[
šdex
]);

197 
	`±h»ad_mu‹x_lock
(&
h—d”
->
mu‹x
);

198 
Buck‘
 *
buck‘
 = 
h—d”
->
Ãxt
;

199 
Buck‘
 *
´ev
 = 
NULL
;

200 if(
buck‘
 =ğ
NULL
) {

201 
	`±h»ad_mu‹x_uÆock
(&
h—d”
->
mu‹x
);

202  
FAILED
;

206 
buck‘
)

208 if(
	`¡rcmp
(
buck‘
->
key
, key) == 0)

210 
	`LOG_MSG
("[»move]\tkey:(%sèšdex: %d\n", 
key
, 
šdex
);

212 if(
´ev
 =ğ
NULL
)

214 
ht
->
h—d”s
[
šdex
].
Ãxt
 = 
buck‘
->next;

218 
´ev
->
Ãxt
 = 
buck‘
->next;

220 
	`±h»ad_mu‹x_uÆock
(&
h—d”
->
mu‹x
);

221 
	`ä“
(
buck‘
);

222  
SUCCESS
;

224 
´ev
 = 
buck‘
;

225 
buck‘
 = buck‘->
Ãxt
;

227 
	`±h»ad_mu‹x_uÆock
(&
h—d”
->
mu‹x
);

229 
	`LOG_MSG
("[»move]\ˆkey:% nÙ found„emov\tçed\t\n", 
key
);

230  
FAILED
;

231 
	}
}

233 
	$hash_de¡roy
(
HashTabË
 *
ht
)

235 
i
;

236 
Buck‘
 *
cur
 = 
NULL
;

237 
Buck‘
 *
tmp
 = 
NULL
;

239 
i
=0; i < 
ht
->
size
; ++i)

241 
cur
 = 
ht
->
h—d”s
[
i
].
Ãxt
;

242 
cur
)

244 
tmp
 = 
cur
;

245 
cur
 = cur->
Ãxt
;

246 
	`ä“
(
tmp
);

249 
	`ä“
(
ht
->
h—d”s
);

251  
SUCCESS
;

252 
	}
}

254 
	$hash_¡r
(*
key
)

256 
hash
 = 0;

258 *
cur
 = 
key
;

260 *
cur
 != '\0')

262 
hash
 +ğ*
cur
;

263 ++
cur
;

266  
hash
;

267 
	}
}

269 
	$hash_»size
(
HashTabË
 *
ht
)

272 
Üg_size
 = 
ht
->
size
;

273 
ht
->
size
 = ht->size * 2;

274 
ht
->
–em_num
 = 0;

276 
	`LOG_MSG
("[»size]\tÜg size: %i\Šew size: %i\n", 
Üg_size
, 
ht
->
size
);

279 
H—d”
 *
h—d”s
 = (H—d” *)
	`ÿÎoc
(
ht
->
size
, (Header));

281 
H—d”
 *
Üg_h—d”s
 = 
ht
->
h—d”s
;

282 
ht
->
h—d”s
 = headers;

284 
i
 = 0;

285 
i
=0; i < 
Üg_size
; ++i)

287 
Buck‘
 *
cur
 = 
Üg_h—d”s
[
i
].
Ãxt
;

288 
Buck‘
 *
tmp
;

289 
cur
)

292 
	`hash_š£¹
(
ht
, 
cur
->
key
, cur->
v®ue
);

295 
tmp
 = 
cur
;

296 
cur
 = cur->
Ãxt
;

297 
	`ä“
(
tmp
);

300 
	`ä“
(
Üg_h—d”s
);

302 
	`LOG_MSG
("[resize] done\n");

304  
SUCCESS
;

305 
	}
}

309 
	$»size_hash_bË_if_Ãeded
(
HashTabË
 *
ht
)

311 if(
ht
->
size
 - ht->
–em_num
 < 1)

313 
	`hash_»size
(
ht
);

315 
	}
}

	@rtm-charlie/hash_rtm/hashtable.h

1 #iâdeà
_HASH_TABLE_H_


2 
	#_HASH_TABLE_H_
 1

	)

4 
	#HASH_TABLE_INIT_SIZE
 65536

	)

5 
	#HASH_INDEX
(
ht
, 
key
è(
	`hash_¡r
((key)è% (ht)->
size
)

	)

7 #ià
defšed
(
DEBUG
)

8 
	#LOG_MSG
 
´štf


	)

10 
	#LOG_MSG
(...)

	)

13 
	~<±h»ad.h
>

15 
	#SUCCESS
 0

	)

16 
	#FAILED
 -1

	)

20 
	s_Buck‘


22 *
	mkey
;

23 *
	mv®ue
;

24 
_Buck‘
 *
	mÃxt
;

25 } 
	tBuck‘
;

27 
	s_H—d”


29 
_Buck‘
 *
	mÃxt
;

30 
±h»ad_mu‹x_t
 
	mmu‹x
;

31 } 
	tH—d”
;

33 
	s_HashTabË


35 
	msize
;

36 
	m–em_num
;

37 
H—d”
 *
	mh—d”s
;

38 } 
	tHashTabË
;

40 
hash_š™
(
HashTabË
 *
ht
);

41 
hash_lookup
(
HashTabË
 *
ht
, *
key
, **
»suÉ
);

42 
hash_š£¹
(
HashTabË
 *
ht
, *
key
, *
v®ue
);

43 
hash_»move
(
HashTabË
 *
ht
, *
key
);

44 
hash_de¡roy
(
HashTabË
 *
ht
);

	@rtm-charlie/hash_rtm/main.cpp

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<as£¹.h
>

4 
	~<¡ršg.h
>

5 
	~"hashbË.h
"

6 
	~<¡ršg
>

7 
	~<io¡»am
>

8 
	~<time.h
>

10 
	#TEST
(
tÿ£
è
	`´štf
(">>> [START CASE] "ÿ£ "<<<\n")

	)

11 
	#PASS
(
tÿ£
è
	`´štf
(">>> [PASSED] "ÿ£ " <<<\n")

	)

13 
	gnum_th»ads
 = 4;

14 *
	$wÜk”
(*
·¿
)

16 
HashTabË
 *
ht
 = (HashTabË *)
·¿
;

18 
št1
 = 10;

19 
št2
 = 20;

20 
¡r1
[] = "Hello TIPI";

21 
¡r2
[] = "Value";

23 *
j
 = 
NULL
;

24 *
fšd_¡r
 = 
NULL
;

25 
»suÉ
 = 0;

26 
i
;

27 
	`¤ªd
(()
	`time
(
NULL
));

30 
	`TEST
("Key insert");

31 
i
 = 0; i < 10000; i++){

32 
¡d
::
¡ršg
 
¡r
 = std::
	`to_¡ršg
(
	`¿nd
());

33 *
c
 = 
	`¡rdup
(
¡r
.
	`c_¡r
());

34 
	`hash_š£¹
(
ht
, 
c
, &
¡r1
);

37 
	`PASS
("Key insert");

43 
	`TEST
("Key†ookup");

44 
	`hash_lookup
(
ht
, "KeyIÁ", (**)&
j
);

45 
	`hash_lookup
(
ht
, "KeySŒ", (**)&
fšd_¡r
);

47 
	`as£¹
(
	`¡rcmp
(
fšd_¡r
, 
¡r1
) == 0);

48 
	`as£¹
(*
j
 = 
št1
);

49 
	`PASS
("Key†ookup");

54 
	`TEST
("Test key update");

55 
	`hash_š£¹
(
ht
, "KeyIÁ", &
št2
);

56 
	`hash_lookup
(
ht
, "KeyIÁ", (**)&
j
);

57 
	`as£¹
(*
j
 = 
št2
);

58 
	`PASS
("Test key update");

60 
	`TEST
(">>> Test key‚ot found <<< ");

61 
»suÉ
 = 
	`hash_lookup
(
ht
, "nÚ-ex™s-key", (**)&
j
);

62 
	`as£¹
(
»suÉ
 =ğ
FAILED
);

63 
	`PASS
("non-exist-key†ookup");

65 
	`TEST
("Test key‚ot found‡fter„emove");

66 
¡rMyKey
[] = "My-Key-Value";

67 
fšd_¡r
 = 
NULL
;

68 
	`hash_š£¹
(
ht
, "My-Key", &
¡rMyKey
);

69 
»suÉ
 = 
	`hash_»move
(
ht
, "My-Key");

70 
	`as£¹
(
»suÉ
 =ğ
SUCCESS
);

72 
»suÉ
 = 
	`hash_lookup
(
ht
, "My-Key", (**)&
fšd_¡r
);

73 
	`as£¹
(
fšd_¡r
 =ğ
NULL
);

74 
	`as£¹
(
»suÉ
 =ğ
FAILED
);

75 
	`PASS
("Test key‚ot found‡fter„emove");

77 
	`PASS
(">>> Test key‚ot found <<< ");

79 
	`TEST
("Add manyƒlements‡nd make hashtable„ehash");

80 
	`hash_š£¹
(
ht
, "a1", &
št2
);

81 
	`hash_š£¹
(
ht
, "a2", &
št1
);

82 
	`hash_š£¹
(
ht
, "a3", &
št1
);

83 
	`hash_š£¹
(
ht
, "a4", &
št1
);

84 
	`hash_š£¹
(
ht
, "a5", &
št1
);

85 
	`hash_š£¹
(
ht
, "a6", &
št1
);

86 
	`hash_š£¹
(
ht
, "a7", &
št1
);

87 
	`hash_š£¹
(
ht
, "a8", 
¡r2
);

88 
	`hash_š£¹
(
ht
, "a9", &
št1
);

89 
	`hash_š£¹
(
ht
, "a10", &
št1
);

90 
	`hash_š£¹
(
ht
, "a11", &
št1
);

91 
	`hash_š£¹
(
ht
, "a12", &
št1
);

92 
	`hash_š£¹
(
ht
, "a13", &
št1
);

93 
	`hash_š£¹
(
ht
, "a14", &
št1
);

94 
	`hash_š£¹
(
ht
, "a15", &
št1
);

95 
	`hash_š£¹
(
ht
, "a16", &
št1
);

96 
	`hash_š£¹
(
ht
, "a17", &
št1
);

97 
	`hash_š£¹
(
ht
, "a18", &
št1
);

98 
	`hash_š£¹
(
ht
, "a19", &
št1
);

99 
	`hash_š£¹
(
ht
, "a20", &
št1
);

100 
	`hash_š£¹
(
ht
, "a21", &
št1
);

101 
	`hash_š£¹
(
ht
, "a22", &
št1
);

102 
	`hash_š£¹
(
ht
, "a23", &
št1
);

103 
	`hash_š£¹
(
ht
, "a24", &
št1
);

104 
	`hash_š£¹
(
ht
, "a24", &
št1
);

105 
	`hash_š£¹
(
ht
, "a24", &
št1
);

106 
	`hash_š£¹
(
ht
, "a25", &
št1
);

107 
	`hash_š£¹
(
ht
, "a26", &
št1
);

108 
	`hash_š£¹
(
ht
, "a27", &
št1
);

109 
	`hash_š£¹
(
ht
, "a28", &
št1
);

110 
	`hash_š£¹
(
ht
, "a29", &
št1
);

111 
	`hash_š£¹
(
ht
, "a30", &
št1
);

112 
	`hash_š£¹
(
ht
, "a31", &
št1
);

113 
	`hash_š£¹
(
ht
, "a32", &
št1
);

114 
	`hash_š£¹
(
ht
, "a33", &
št1
);

116 
	`hash_lookup
(
ht
, "a23", (**)&
j
);

117 
	`as£¹
(*
j
 = 
št1
);

118 
	`hash_lookup
(
ht
, "a30", (**)&
j
);

119 
	`as£¹
(*
j
 = 
št1
);

121 
	}
}

123 
	$maš
(
¬gc
, **
¬gv
) {

124 
±h»ad_t
 
th»ad
[
num_th»ads
];

125 
i
;

127 
HashTabË
 *
ht
 = (HashTabË *)
	`m®loc
((HashTable));

128 
»suÉ
 = 
	`hash_š™
(
ht
);

130 
	`as£¹
(
»suÉ
 =ğ
SUCCESS
);

131 
i
 = 0; i < 
num_th»ads
; i++) {

132 
»t
 = 
	`±h»ad_ü—‹
(&
th»ad
[
i
], 
NULL
, &
wÜk”
, (*)
ht
);

133 ià(
»t
) {

134 
	`´štf
("createhreadƒrror \n");

138 
i
 = 0; i < 
num_th»ads
; i++) {

139 
»t
 = 
	`±h»ad_još
(
th»ad
[
i
], 
NULL
);

144 
	`PASS
("Add manyƒlements‡nd make hashtable„ehash");

146 
	`hash_de¡roy
(
ht
);

147 
	`ä“
(
ht
);

149 
	`´štf
("Woohoo, It†ooks†ike HashTable works…roperly\n");

152 
	}
}

	@rtm-charlie/list_hle/listNode.cpp

1 
	~"li¡Node.h
"

2 
	~<¡dlib.h
>

4 
pNode
 
	$®locNode
(
v®
)

6 
pNode
 
»t
 = 
NULL
;

7 
»t
 = (
pNode
)
	`m®loc
((
Node
));

8 if(
»t
)

10 
»t
->
v®
 = val;

11 
»t
->
Ãxt
 = 
NULL
;

14  
»t
;

15 
	}
}

17 
	$ä“Node
(
pNode
 
node
)

19 if(
node
)

21 
	`ä“
(
node
);

23 
	}
}

	@rtm-charlie/list_hle/listNode.h

1 
	~<mu‹x
>

2 
	~<immšŒš.h
>

4 
	s_Node


6 
	mv®
;

7 
_Node
* 
	mÃxt
;

8 }
	tNode
,*
	tpNode
;

	@rtm-charlie/list_hle/list_cgl.cpp

1 
	~"li¡Node.ıp
"

2 
	~<io¡»am
>

3 
	~<immšŒš.h
>

4 
	~<¡dlib.h
>

6 
FILE
* 
	gdbgLogs
;

8 
	#MIN
 -999999

	)

9 
	#MAX
 999999

	)

11 şas 
	cli¡_cgl


13 
	mpublic
:

14 
li¡_cgl
();

15 ~
li¡_cgl
();

17 
boŞ
 
add
(
v®
);

18 
boŞ
 
»move
(
v®
);

19 
boŞ
 
cÚšs
(
v®
);

20 
hË_lock
();

21 
hË_»Ëa£
();

23 
´štAÎ
();

24 
	m´iv©e
:

26 
boŞ
 
v®id©e
(
pNode
 
´ed
,…Nod
cu¼
);

27 
pNode
 
	mh—d
;

29 vŞ©
	mmtx_v®
;

32 
	gli¡_cgl
::
	$li¡_cgl
()

34 
h—d
 = 
	`®locNode
(
MIN
);

35 
h—d
->
Ãxt
 = 
	`®locNode
(
MAX
);

36 
mtx_v®
 = 0;

38 
	}
}

40 
	gli¡_cgl
::~
	$li¡_cgl
()

42 
	`ä“Node
(
h—d
->
Ãxt
);

43 
	`ä“Node
(
h—d
);

45 
	}
}

47 
	gli¡_cgl
::
	$hË_lock
()

49 
	`__©omic_exchªge_n
(&
mtx_v®
, 1, 
__ATOMIC_ACQUIRE
 | 
__ATOMIC_HLE_ACQUIRE
))

50 
	`_mm_·u£
();

51  
Œue
;

52 
	}
}

54 
	gli¡_cgl
::
	$hË_»Ëa£
()

56 
	`__©omic_¡Üe_n
(&
mtx_v®
, 0, 
__ATOMIC_RELEASE
 | 
__ATOMIC_HLE_RELEASE
);

57  
Œue
;

58 
	}
}

60 
boŞ
 
	gli¡_cgl
::
	$add
(
v®
)

62 
boŞ
 
»tV®
 = 
çl£
;

64 
	`hË_lock
();

65 
pNode
 
´ed
 = 
h—d
;

66 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

67 
cu¼
->
v®
 < val)

69 
´ed
 = 
cu¼
;

70 
cu¼
 = cu¼->
Ãxt
;

72 if(
cu¼
->
v®
 == val)

74 
»tV®
 = 
çl£
;

78 
pNode
 
node
 = 
	`®locNode
(
v®
);

79 
node
->
Ãxt
 = 
cu¼
;

80 
´ed
->
Ãxt
 = 
node
;

81 
»tV®
 = 
Œue
;

83 
	`hË_»Ëa£
();

84  
»tV®
;

85 
	}
}

87 
boŞ
 
	gli¡_cgl
::
	$»move
(
v®
)

89 
boŞ
 
»tV®
 = 
çl£
;

91 
	`hË_lock
();

92 
pNode
 
´ed
 = 
h—d
;

93 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

95 
cu¼
->
v®
 < val)

97 
´ed
 = 
cu¼
;

98 
cu¼
 = cu¼->
Ãxt
;

101 if(
cu¼
->
v®
 == val)

103 
´ed
->
Ãxt
 = 
cu¼
->next;

104 
	`ä“Node
(
cu¼
);

105 
cu¼
 = 
NULL
;

106 
»tV®
 = 
Œue
;

110 
»tV®
 = 
çl£
;

113 
	`hË_»Ëa£
();

114  
»tV®
;

115 
	}
}

117 
boŞ
 
	gli¡_cgl
::
	$cÚšs
(
v®
)

119 
boŞ
 
»tV®
 = 
çl£
;

122 
	`hË_lock
();

123 
pNode
 
´ed
 = 
h—d
;

124 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

126 
cu¼
->
v®
 < val)

128 
´ed
 = 
cu¼
;

129 
cu¼
 = cu¼->
Ãxt
;

131 
»tV®
 = (
cu¼
->
v®
 == val);

134 
	`hË_»Ëa£
();

135  
»tV®
;

136 
	}
}

139 
	gli¡_cgl
::
	$´štAÎ
()

141 
FILE
* 
vFe
 = 
	`fİ’
("validate.txt","w");

146 
pNode
 
cu¼
 = 
h—d
;

147 
cu¼
)

149 
	`årštf
(
vFe
,"\n%d",
cu¼
->
v®
);

150 
	`fæush
(
vFe
);

151 
cu¼
 = cu¼->
Ãxt
;

153 
	`fşo£
(
vFe
);

156 
	}
}

	@rtm-charlie/list_hle/test_list.cpp

1 
	~<io¡»am
>

2 
	~<th»ad
>

3 
	~"li¡_cgl.ıp
"

4 
	~<time.h
>

5 
	~<th»ad
>

6 
	~<uni¡d.h
>

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	#T_MAX
 8

	)

11 
	#SLEEP_DUR
 10000

	)

12 
	#NUM_INSERT
 1000

	)

14 
li¡_cgl
 
	gcgl
;

16 
	gşockcyşes_a
[
T_MAX
];

17 
	gşockcyşes_r
[
T_MAX
];

18 
	gşockcyşes_c
[
T_MAX
];

19 
	gşockcyşes_¬c
[
T_MAX
];

21 
	$‹¡Li¡
(
i
)

23 
şock_t
 
s_a
,
e_a
;

24 
şock_t
 
s_r
,
e_r
;

25 
şock_t
 
s_c
,
e_c
;

26 
şock_t
 
s_¬c
,
e_¬c
;

28 
s_¬c
 = 
	`şock
();

30 
s_a
 = 
s_¬c
;

31 
j
 = 1; j <ğ
NUM_INSERT
; j++)

33 
cgl
.
	`add
(
i
 * 
NUM_INSERT
 + 
j
);

37 
e_a
 = 
	`şock
();

39 
s_c
 = 
	`şock
();

40 
j
 = 1; j <ğ
NUM_INSERT
; j++)

42 
cgl
.
	`cÚšs
(
i
 * 
NUM_INSERT
 + 
j
);

44 
e_c
 = 
	`şock
();

46 
s_r
 = 
	`şock
();

47 
j
 = 
NUM_INSERT
; j >= 1; j--)

49 
cgl
.
	`»move
(
i
 * 
NUM_INSERT
 + 
j
);

53 
e_r
 = 
	`şock
();

55 
e_¬c
 = 
e_r
;

57 
şockcyşes_a
[
i
] = (
e_a
 - 
s_a
);

58 
şockcyşes_r
[
i
] = (
e_r
 - 
s_r
);

59 
şockcyşes_c
[
i
] = (
e_c
 - 
s_c
);

60 
şockcyşes_¬c
[
i
] = (
e_¬c
 - 
s_¬c
);

61 
	}
}

63 
	$maš
()

65 
tÙ®Time_a
 = 0;

66 
tÙ®Time_r
 = 0;

67 
tÙ®Time_c
 = 0;

68 
tÙ®Time_¬c
 = 0;

70 
th»ad
* 
pTh»ads
[
T_MAX
];

72 
i
 = 0; i < 
T_MAX
; i++)

74 
pTh»ads
[
i
] = 
Ãw
 
	`th»ad
(
‹¡Li¡
,i);

77 
i
 = 0; i < 
T_MAX
; i++)

79 
pTh»ads
[
i
]->
	`još
();

80 
	`d–‘e
(
pTh»ads
[
i
]);

83 
cgl
.
	`´štAÎ
();

88 
i
 = 0; i < 
T_MAX
; i++)

90 
tÙ®Time_a
 +ğ
şockcyşes_a
[
i
];

91 
tÙ®Time_r
 +ğ
şockcyşes_r
[
i
];

92 
tÙ®Time_c
 +ğ
şockcyşes_c
[
i
];

93 
tÙ®Time_¬c
 +ğ
şockcyşes_¬c
[
i
];

96 
	`´štf
("\nTÙ®imfÜ‡dd = %f",(()
tÙ®Time_a
)/
CLOCKS_PER_SEC
);

97 
	`´štf
("\nTÙ®imfÜ„emovğ%f",(()
tÙ®Time_r
)/
CLOCKS_PER_SEC
);

98 
	`´štf
("\nTÙ®imfÜ cÚš ğ%f",(()
tÙ®Time_c
)/
CLOCKS_PER_SEC
);

99 
	`´štf
("\nTÙ®imfÜ cÚcu¼’ˆadd/»move/cÚš ğ%f",(()
tÙ®Time_¬c
)/
CLOCKS_PER_SEC
);

103 
	}
}

	@rtm-charlie/list_rtm/listNode.cpp

1 
	~"li¡Node.h
"

2 
	~<¡dlib.h
>

4 
pNode
 
	$®locNode
(
v®
)

6 
pNode
 
»t
 = 
NULL
;

7 
»t
 = (
pNode
)
	`m®loc
((
Node
));

8 if(
»t
)

10 
»t
->
v®
 = val;

11 
»t
->
Ãxt
 = 
NULL
;

14  
»t
;

15 
	}
}

17 
	$ä“Node
(
pNode
 
node
)

19 if(
node
)

21 
	`ä“
(
node
);

23 
	}
}

	@rtm-charlie/list_rtm/listNode.h

1 
	~<mu‹x
>

2 
	~<immšŒš.h
>

4 
	s_Node


6 
	mv®
;

7 
_Node
* 
	mÃxt
;

8 }
	tNode
,*
	tpNode
;

	@rtm-charlie/list_rtm/list_cgl.cpp

1 
	~"li¡Node.ıp
"

2 
	~<io¡»am
>

3 
	~<immšŒš.h
>

5 
FILE
* 
	gdbgLogs
;

7 
	#MIN
 -999999

	)

8 
	#MAX
 999999

	)

10 şas 
	cli¡_cgl


12 
	mpublic
:

13 
li¡_cgl
();

14 ~
li¡_cgl
();

16 
boŞ
 
add
(
v®
);

17 
boŞ
 
»move
(
v®
);

18 
boŞ
 
cÚšs
(
v®
);

20 
´štAÎ
();

21 
	m´iv©e
:

23 
boŞ
 
v®id©e
(
pNode
 
´ed
,…Nod
cu¼
);

24 
pNode
 
	mh—d
;

25 
	m¡d
::
mu‹x
 
mtx
;

28 
	gli¡_cgl
::
	$li¡_cgl
()

30 
h—d
 = 
	`®locNode
(
MIN
);

31 
h—d
->
Ãxt
 = 
	`®locNode
(
MAX
);

33 
	}
}

35 
	gli¡_cgl
::~
	$li¡_cgl
()

37 
	`ä“Node
(
h—d
->
Ãxt
);

38 
	`ä“Node
(
h—d
);

40 
	}
}

42 
boŞ
 
	gli¡_cgl
::
	$add
(
v®
)

44 
¡©us
;

45 
boŞ
 
»tV®
 = 
çl£
;

46 
pNode
 
node
 = 
	`®locNode
(
v®
);

47 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
) {

48 
pNode
 
´ed
 = 
h—d
;

49 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

50 
cu¼
->
v®
 < val)

52 
´ed
 = 
cu¼
;

53 
cu¼
 = cu¼->
Ãxt
;

55 if(
cu¼
->
v®
 == val)

57 
»tV®
 = 
çl£
;

62 
node
->
Ãxt
 = 
cu¼
;

63 
´ed
->
Ãxt
 = 
node
;

64 
»tV®
 = 
Œue
;

66 
	`_x’d
();

68 
mtx
.
	`lock
();

70 
pNode
 
´ed
 = 
h—d
;

71 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

72 
cu¼
->
v®
 < val)

74 
´ed
 = 
cu¼
;

75 
cu¼
 = cu¼->
Ãxt
;

77 if(
cu¼
->
v®
 == val)

79 
»tV®
 = 
çl£
;

83 
pNode
 
node
 = 
	`®locNode
(
v®
);

84 
node
->
Ãxt
 = 
cu¼
;

85 
´ed
->
Ãxt
 = 
node
;

86 
»tV®
 = 
Œue
;

89 
mtx
.
	`uÆock
();

91 if(
»tV®
 =ğ
çl£
)

92 
	`ä“
(
node
);

93  
»tV®
;

94 
	}
}

96 
boŞ
 
	gli¡_cgl
::
	$»move
(
v®
)

98 
boŞ
 
»tV®
 = 
çl£
;

99 
¡©us
;

100 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
) {

101 
pNode
 
´ed
 = 
h—d
;

102 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

104 
cu¼
->
v®
 < val)

106 
´ed
 = 
cu¼
;

107 
cu¼
 = cu¼->
Ãxt
;

110 if(
cu¼
->
v®
 == val)

112 
´ed
->
Ãxt
 = 
cu¼
->next;

113 
	`ä“Node
(
cu¼
);

114 
cu¼
 = 
NULL
;

115 
»tV®
 = 
Œue
;

119 
»tV®
 = 
çl£
;

121 
	`_x’d
();

125 
mtx
.
	`lock
();

127 
pNode
 
´ed
 = 
h—d
;

128 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

130 
cu¼
->
v®
 < val)

132 
´ed
 = 
cu¼
;

133 
cu¼
 = cu¼->
Ãxt
;

136 if(
cu¼
->
v®
 == val)

138 
´ed
->
Ãxt
 = 
cu¼
->next;

139 
	`ä“Node
(
cu¼
);

140 
cu¼
 = 
NULL
;

141 
»tV®
 = 
Œue
;

145 
»tV®
 = 
çl£
;

147 
mtx
.
	`uÆock
();

149  
»tV®
;

150 
	}
}

152 
boŞ
 
	gli¡_cgl
::
	$cÚšs
(
v®
)

154 
¡©us
;

155 
boŞ
 
»tV®
 = 
çl£
;

156 if((
¡©us
 = 
	`_xbegš
()è=ğ
_XBEGIN_STARTED
) {

157 
pNode
 
´ed
 = 
h—d
;

158 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

160 
cu¼
->
v®
 < val)

162 
´ed
 = 
cu¼
;

163 
cu¼
 = cu¼->
Ãxt
;

165 
»tV®
 = (
cu¼
->
v®
 == val);

166 
	`_x’d
();

169 
mtx
.
	`lock
();

171 
pNode
 
´ed
 = 
h—d
;

172 
pNode
 
cu¼
 = 
´ed
->
Ãxt
;

174 
cu¼
->
v®
 < val)

176 
´ed
 = 
cu¼
;

177 
cu¼
 = cu¼->
Ãxt
;

179 
»tV®
 = (
cu¼
->
v®
 == val);

181 
mtx
.
	`uÆock
();

183  
»tV®
;

184 
	}
}

187 
	gli¡_cgl
::
	$´štAÎ
()

189 
FILE
* 
vFe
 = 
	`fİ’
("validate.txt","w");

194 
pNode
 
cu¼
 = 
h—d
;

195 
cu¼
)

197 
	`årštf
(
vFe
,"\n%d",
cu¼
->
v®
);

198 
	`fæush
(
vFe
);

199 
cu¼
 = cu¼->
Ãxt
;

201 
	`fşo£
(
vFe
);

204 
	}
}

	@rtm-charlie/list_rtm/test_list.cpp

1 
	~<io¡»am
>

2 
	~<th»ad
>

3 
	~"li¡_cgl.ıp
"

4 
	~<time.h
>

5 
	~<th»ad
>

6 
	~<uni¡d.h
>

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	#T_MAX
 8

	)

11 
	#SLEEP_DUR
 10000

	)

12 
	#NUM_INSERT
 1000

	)

14 
li¡_cgl
 
	gcgl
;

16 
	gşockcyşes_a
[
T_MAX
];

17 
	gşockcyşes_r
[
T_MAX
];

18 
	gşockcyşes_c
[
T_MAX
];

19 
	gşockcyşes_¬c
[
T_MAX
];

21 
	$‹¡Li¡
(
i
)

23 
şock_t
 
s_a
,
e_a
;

24 
şock_t
 
s_r
,
e_r
;

25 
şock_t
 
s_c
,
e_c
;

26 
şock_t
 
s_¬c
,
e_¬c
;

28 
s_¬c
 = 
	`şock
();

30 
s_a
 = 
s_¬c
;

31 
j
 = 1; j <ğ
NUM_INSERT
; j++)

33 
cgl
.
	`add
(
i
 * 
NUM_INSERT
 + 
j
);

37 
e_a
 = 
	`şock
();

39 
s_c
 = 
	`şock
();

40 
j
 = 1; j <ğ
NUM_INSERT
; j++)

42 
cgl
.
	`cÚšs
(
i
 * 
NUM_INSERT
 + 
j
);

44 
e_c
 = 
	`şock
();

46 
s_r
 = 
	`şock
();

47 
j
 = 
NUM_INSERT
; j >= 1; j--)

49 
cgl
.
	`»move
(
i
 * 
NUM_INSERT
 + 
j
);

53 
e_r
 = 
	`şock
();

55 
e_¬c
 = 
e_r
;

57 
şockcyşes_a
[
i
] = (
e_a
 - 
s_a
);

58 
şockcyşes_r
[
i
] = (
e_r
 - 
s_r
);

59 
şockcyşes_c
[
i
] = (
e_c
 - 
s_c
);

60 
şockcyşes_¬c
[
i
] = (
e_¬c
 - 
s_¬c
);

61 
	}
}

63 
	$maš
()

65 
tÙ®Time_a
 = 0;

66 
tÙ®Time_r
 = 0;

67 
tÙ®Time_c
 = 0;

68 
tÙ®Time_¬c
 = 0;

70 
th»ad
* 
pTh»ads
[
T_MAX
];

72 
i
 = 0; i < 
T_MAX
; i++)

74 
pTh»ads
[
i
] = 
Ãw
 
	`th»ad
(
‹¡Li¡
,i);

77 
i
 = 0; i < 
T_MAX
; i++)

79 
pTh»ads
[
i
]->
	`još
();

80 
	`d–‘e
(
pTh»ads
[
i
]);

83 
cgl
.
	`´štAÎ
();

88 
i
 = 0; i < 
T_MAX
; i++)

90 
tÙ®Time_a
 +ğ
şockcyşes_a
[
i
];

91 
tÙ®Time_r
 +ğ
şockcyşes_r
[
i
];

92 
tÙ®Time_c
 +ğ
şockcyşes_c
[
i
];

93 
tÙ®Time_¬c
 +ğ
şockcyşes_¬c
[
i
];

96 
	`´štf
("\nTÙ®imfÜ‡dd = %f",(()
tÙ®Time_a
)/
CLOCKS_PER_SEC
);

97 
	`´štf
("\nTÙ®imfÜ„emovğ%f",(()
tÙ®Time_r
)/
CLOCKS_PER_SEC
);

98 
	`´štf
("\nTÙ®imfÜ cÚš ğ%f",(()
tÙ®Time_c
)/
CLOCKS_PER_SEC
);

99 
	`´štf
("\nTÙ®imfÜ cÚcu¼’ˆadd/»move/cÚš ğ%f",(()
tÙ®Time_¬c
)/
CLOCKS_PER_SEC
);

103 
	}
}

	@utils/estm-0.2.4.3/bench/lf-deque/herlihy.c

24 
	~"h¬ris.h
"

30 
	$is_m¬ked_»f
(
i
) {

32  (è(
i
 & (
LONG_MIN
+1));

33 
	}
}

35 
	$un£t_m¬k
(
i
) {

36 
i
 &ğ
LONG_MAX
-1;

37  
i
;

38 
	}
}

40 
	$£t_m¬k
(
i
) {

41 
i
 = 
	`un£t_m¬k
(i);

42 
i
 += 1;

43  
i
;

44 
	}
}

46 
	$g‘_unm¬ked_»f
(
w
) {

47  
	`un£t_m¬k
(
w
);

48 
	}
}

50 
	$g‘_m¬ked_»f
(
w
) {

51  
	`£t_m¬k
(
w
);

52 
	}
}

54 
node_t
 *
	$h¬ris_£¬ch
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
node_t
 **
Ëá_node
) {

55 
node_t
 *
Ëá_node_Ãxt
, *
right_node
;

56 
Ëá_node_Ãxt
 = 
£t
->
h—d
;

58 
£¬ch_agaš
:

60 
node_t
 *
t
 = 
£t
->
h—d
;

61 
node_t
 *
t_Ãxt
 = 
£t
->
h—d
->
Ãxt
;

65 ià(!
	`is_m¬ked_»f
((è
t_Ãxt
)) {

66 (*
Ëá_node
èğ
t
;

67 
Ëá_node_Ãxt
 = 
t_Ãxt
;

69 
t
 = (
node_t
 *è
	`g‘_unm¬ked_»f
((è
t_Ãxt
);

70 ià(!
t
->
Ãxt
) ;

71 
t_Ãxt
 = 
t
->
Ãxt
;

72 } 
	`is_m¬ked_»f
((è
t_Ãxt
è|| (
t
->
v®
 < val));

73 
right_node
 = 
t
;

76 ià(
Ëá_node_Ãxt
 =ğ
right_node
) {

77 ià(
right_node
->
Ãxt
 && 
	`is_m¬ked_»f
(()„ight_node->next))

78 
£¬ch_agaš
;

79  
right_node
;

83 ià(
	`ATOMIC_CAS_MB
(&(*
Ëá_node
)->
Ãxt
,

84 
Ëá_node_Ãxt
,

85 
right_node
)) {

86 ià(
right_node
->
Ãxt
 && 
	`is_m¬ked_»f
(()„ight_node->next))

87 
£¬ch_agaš
;

88  
right_node
;

92 
	}
}

94 
	$h¬ris_fšd
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

95 
node_t
 *
right_node
, *
Ëá_node
;

96 
Ëá_node
 = 
£t
->
h—d
;

98 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

99 ià((!
right_node
->
Ãxt
è||„ight_node->
v®
 != val)

103 
	}
}

105 
	$h¬ris_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

106 
node_t
 *
Ãwnode
, *
right_node
, *
Ëá_node
;

107 
Ëá_node
 = 
£t
->
h—d
;

110 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

111 ià(
right_node
->
v®
 == val)

113 
Ãwnode
 = 
	`Ãw_node
(
v®
, 
right_node
, 0);

115 
	`AO_nİ_fuÎ
();

116 ià(
	`ATOMIC_CAS_MB
(&
Ëá_node
->
Ãxt
, 
right_node
, 
Ãwnode
))

119 
	}
}

121 
	$h¬ris_d–‘e
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

122 
node_t
 *
right_node
, *
right_node_Ãxt
, *
Ëá_node
;

123 
Ëá_node
 = 
£t
->
h—d
;

126 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

127 ià(
right_node
->
v®
 != val)

129 
right_node_Ãxt
 = 
right_node
->
Ãxt
;

130 ià(!
	`is_m¬ked_»f
((è
right_node_Ãxt
))

131 ià(
	`ATOMIC_CAS_MB
(&
right_node
->
Ãxt
,

132 
right_node_Ãxt
,

133 
	`g‘_m¬ked_»f
((è
right_node_Ãxt
)))

136 ià(!
	`ATOMIC_CAS_MB
(&
Ëá_node
->
Ãxt
, 
right_node
, 
right_node_Ãxt
))

137 
right_node
 = 
	`h¬ris_£¬ch
(
£t
,„ight_node->
v®
, &
Ëá_node
);

139 
	}
}

142 
	#RIGHT
 1

	)

143 
	#LEFT
 0

	)

145 
ty³
 
	g–em’t
 = 
»cÜd
 
v®
: 
v®ty³
; 
	gùr
: 
’d


154 
	$Üaşe
(
dœeùiÚ
) {

157 
	}
}

159 
	$righush
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

161 
k
 :ğ
	`Üaşe
(
RIGHT
);

162 
´ev
 :ğ
A
[
k
-1];

163 
cur
 :ğ
A
[
k
];

164 ià(
´ev
.
v®
 !ğ
RN
 
ªd
 
cur
.val = RN) {

165 ià(
k
 = 
MAX
+1)  0;

166 
	`ATOMIC_CAS_MB
(&
A
[
k
-1], 
´ev
, <´ev.
v®
,´ev.
ùr
+1>)

167 
	`ATOMIC_CAS_MB
(&
A
[
k
], 
cur
, <
v
,cur.
ùr
+1>)

171 
	}
}

173 
	$righİ
() {

175 
k
 :ğ
	`Üaşe
(
RIGHT
);

176 
cur
 :ğ
A
[
k
-1];

177 
Ãxt
 :ğ
A
[
k
];

178 ià(
cur
.
v®
 !ğ
RN
 
ªd
 
Ãxt
.val = RN) {

179 ià(
cur
.
v®
 = 
LN
 
ªd
 
A
[
k
-1] = cur)

181 
	`ATOMIC_CAS_MB
(&
A
[
k
], 
Ãxt
, <
RN
,Ãxt.
ùr
+1>)

182 
	`ATOMIC_CAS_MB
(&
A
[
k
-1], 
cur
, <
RN
,cur.
ùr
+1>)

183  
cur
.
v®
;

186 
	}
}

	@utils/estm-0.2.4.3/bench/lf-deque/herlihy.h

10 
	~"št£t.h
"

16 
is_m¬ked_»f
(
i
);

18 
un£t_m¬k
(
i
);

20 
£t_m¬k
(
i
);

22 
g‘_unm¬ked_»f
(
w
);

24 
g‘_m¬ked_»f
(
w
);

26 
node_t
 *
h¬ris_£¬ch
(
št£t_t
 *
£t
, 
v®_t
 
v®
,‚ode_ˆ**
Ëá_node
);

28 
h¬ris_fšd
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

30 
h¬ris_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

32 
h¬ris_d–‘e
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

	@utils/estm-0.2.4.3/bench/lf-deque/intset.c

22 
	~<as£¹.h
>

23 
	~<g‘İt.h
>

24 
	~<lim™s.h
>

25 
	~<±h»ad.h
>

26 
	~<sigÇl.h
>

27 
	~<¡dlib.h
>

28 
	~<¡dio.h
>

29 
	~<sys/time.h
>

30 
	~<time.h
>

31 
	~<¡dšt.h
>

33 
	~<©omic_İs.h
>

35 
	~"¡m.h
"

36 
	~"mod_mem.h
"

38 #ifdeà
DEBUG


39 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

49 
	#MALLOC
(
size
è
	`¡m_m®loc
(size)

	)

55 
šŒ_t
 
	tv®_t
;

56 
	#VAL_MIN
 
INT_MIN


	)

57 
	#VAL_MAX
 
INT_MAX


	)

59 *
	gA
[
MAXLENGTH
];

61 
	snode
 {

62 
v®_t
 
	mv®
;

63 
node
 *
	mÃxt
;

64 
node
 *
	m´ev
;

65 } 
	tnode_t
;

67 
	sdeque
 {

68 
node_t
 *
	mh—d
;

69 
node_t
 *
	m
;

70 } 
	tdeque_t
;

72 
node_t
 *
	$Ãw_node
(
v®_t
 
v®
, 
node_t
 *
Ãxt
, 
Œª§ùiÚ®
)

74 
node_t
 *
node
;

76 ià(!
Œª§ùiÚ®
) {

77 
node
 = (
node_t
 *)
	`m®loc
((node_t));

79 
node
 = (
node_t
 *)
	`MALLOC
((node_t));

81 ià(
node
 =ğ
NULL
) {

82 
	`³¼Ü
("malloc");

83 
	`ex™
(1);

86 
node
->
v®
 = val;

87 
node
->
Ãxt
 =‚ext;

89  
node
;

90 
	}
}

92 
št£t_t
 *
	$£t_Ãw
()

94 
št£t_t
 *
£t
;

95 
node_t
 *
mš
, *
max
;

97 ià((
£t
 = (
št£t_t
 *)
	`m®loc
((št£t_t))è=ğ
NULL
) {

98 
	`³¼Ü
("malloc");

99 
	`ex™
(1);

101 
max
 = 
	`Ãw_node
(
VAL_MAX
, 
NULL
, 0);

102 
mš
 = 
	`Ãw_node
(
VAL_MIN
, 
max
, 0);

103 
£t
->
h—d
 = 
mš
;

105  
£t
;

106 
	}
}

108 
	$£t_d–‘e
(
št£t_t
 *
£t
)

110 
node_t
 *
node
, *
Ãxt
;

112 
node
 = 
£t
->
h—d
;

113 
node
 !ğ
NULL
) {

114 
Ãxt
 = 
node
->next;

115 
	`ä“
(
node
);

116 
node
 = 
Ãxt
;

118 
	`ä“
(
£t
);

119 
	}
}

121 
	$£t_size
(
št£t_t
 *
£t
)

123 
size
 = 0;

124 
node_t
 *
node
;

127 
node
 = 
£t
->
h—d
->
Ãxt
;

128 
node
->
Ãxt
 !ğ
NULL
) {

129 
size
++;

130 
node
 =‚ode->
Ãxt
;

133  
size
;

134 
	}
}

	@utils/estm-0.2.4.3/bench/lf-deque/intset.h

23 
	~<as£¹.h
>

24 
	~<g‘İt.h
>

25 
	~<lim™s.h
>

26 
	~<±h»ad.h
>

27 
	~<sigÇl.h
>

28 
	~<¡dlib.h
>

29 
	~<¡dio.h
>

30 
	~<sys/time.h
>

31 
	~<time.h
>

32 
	~<¡dšt.h
>

34 
	~<©omic_İs.h
>

36 
	~"¡m.h
"

37 
	~"mod_mem.h
"

39 #ifdeà
DEBUG


40 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

49 
	#RO
 0

	)

50 
	#RW
 0

	)

52 
	#TX_START
(
id
, 
ro
, 
ty³
è{ 
sigjmp_buf
 *
_e
 = 
	`¡m_g‘_’v
(); 
¡m_tx_©Œ_t
 
_a
 = {id,„o}; 
	`sig£tjmp
(*_e, 0); 
	`¡m_¡¬t
(_e, &_a,y³)

	)

53 
	#TX_LOAD
(
addr
è
	`¡m_lßd
((
¡m_wÜd_t
 *ïddr)

	)

54 
	#TX_STORE
(
addr
, 
v®
è
	`¡m_¡Üe
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_t)v®)

	)

55 
	#TX_END
 
	`¡m_comm™
(); }

	)

57 
	#FREE
(
addr
, 
size
è
	`¡m_ä“
×ddr, size)

	)

59 
	#DEFAULT_DURATION
 10000

	)

60 
	#DEFAULT_INITIAL
 256

	)

61 
	#DEFAULT_NB_THREADS
 1

	)

62 
	#DEFAULT_RANGE
 0xFFFF

	)

63 
	#DEFAULT_SEED
 0

	)

64 
	#DEFAULT_UPDATE
 20

	)

66 
	#XSTR
(
s
è
	`STR
(s)

	)

67 
	#STR
(
s
è#s

	)

69 
	#ATOMIC_CAS_MB
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

75 vŞ©
AO_t
 
	g¡İ
;

81 
	#TRANSACTIONAL
 
d
->
un™_tx


	)

83 
šŒ_t
 
	tv®_t
;

84 
	#VAL_MIN
 
INT_MIN


	)

85 
	#VAL_MAX
 
INT_MAX


	)

87 
	snode
 {

88 
v®_t
 
	mv®
;

89 
node
 *
	mÃxt
;

90 } 
	tnode_t
;

92 
	sšt£t
 {

93 
node_t
 *
	mh—d
;

94 } 
	tšt£t_t
;

96 
node_t
 *
Ãw_node
(
v®_t
 
v®
,‚ode_ˆ*
Ãxt
, 
Œª§ùiÚ®
);

97 
št£t_t
 *
£t_Ãw
();

98 
£t_d–‘e
(
št£t_t
 *
£t
);

99 
£t_size
(
št£t_t
 *
£t
);

	@utils/estm-0.2.4.3/bench/lf-deque/lf-ll.c

10 
	~"lškedli¡.h
"

17 
	sb¬r›r
 {

18 
±h»ad_cÚd_t
 
	mcom¶‘e
;

19 
±h»ad_mu‹x_t
 
	mmu‹x
;

20 
	mcouÁ
;

21 
	müossšg
;

22 } 
	tb¬r›r_t
;

24 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

26 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

27 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

28 
b
->
couÁ
 = 
n
;

29 
b
->
üossšg
 = 0;

30 
	}
}

32 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

34 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

36 
b
->
üossšg
++;

38 ià(
b
->
üossšg
 < b->
couÁ
) {

39 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

41 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

43 
b
->
üossšg
 = 0;

45 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

46 
	}
}

53 
	sth»ad_d©a
 {

54 
	m¿nge
;

55 
	mupd©e
;

56 #iâdeà
USE_RBTREE


57 
	mun™_tx
;

59 
	mnb_add
;

60 
	mnb_»move
;

61 
	mnb_cÚšs
;

62 
	mnb_found
;

63 
	mnb_abÜts
;

64 
	mnb_abÜts_locked_»ad
;

65 
	mnb_abÜts_locked_wr™e
;

66 
	mnb_abÜts_v®id©e_»ad
;

67 
	mnb_abÜts_v®id©e_wr™e
;

68 
	mnb_abÜts_v®id©e_comm™
;

69 
	mnb_abÜts_šv®id_memÜy
;

70 
	mmax_»Œ›s
;

71 
	mdiff
;

72 
	m£ed
;

73 
št£t_t
 *
	m£t
;

74 
b¬r›r_t
 *
	mb¬r›r
;

75 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

76 } 
	tth»ad_d©a_t
;

80 *
	$‹¡
(*
d©a
)

82 
v®
, 
Ï¡
 = 0;

83 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

86 
	`¡m_š™_th»ad
();

88 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

90 
Ï¡
 = -1;

91 
¡İ
 == 0) {

92 
v®
 = 
	`¿nd_r
(&
d
->
£ed
) % 100;

93 ià(
v®
 < 
d
->
upd©e
) {

94 ià(
Ï¡
 < 0) {

96 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

97 ià(
	`£t_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

98 
d
->
diff
++;

99 
Ï¡
 = 
v®
;

101 
d
->
nb_add
++;

104 ià(
	`£t_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
))

105 
d
->
diff
--;

106 
d
->
nb_»move
++;

107 
Ï¡
 = -1;

111 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

112 ià(
	`£t_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

113 
d
->
nb_found
++;

114 
d
->
nb_cÚšs
++;

117 
	`¡m_g‘_·¿m‘”
("nb_abÜts", &
d
->
nb_abÜts
);

118 
	`¡m_g‘_·¿m‘”
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
);

119 
	`¡m_g‘_·¿m‘”
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
);

120 
	`¡m_g‘_·¿m‘”
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
);

121 
	`¡m_g‘_·¿m‘”
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
);

122 
	`¡m_g‘_·¿m‘”
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
);

123 
	`¡m_g‘_·¿m‘”
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
);

124 
	`¡m_g‘_·¿m‘”
("max_»Œ›s", &
d
->
max_»Œ›s
);

125 
	`¡m_g‘_·¿m‘”
("çu»s_beÿu£_cÚ‹ÁiÚ", &
d
->
çu»s_beÿu£_cÚ‹ÁiÚ
);

127 
	`¡m_ex™_th»ad
();

129  
NULL
;

130 
	}
}

132 
	$ÿtch”
(
sig
)

134 
	`´štf
("CAUGHT SIGNAL %d\n", 
sig
);

135 
	}
}

137 
	$maš
(
¬gc
, **
¬gv
)

139 
İtiÚ
 
lÚg_İtiÚs
[] = {

141 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

142 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

143 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

144 {"num-th»ads", 
»quœed_¬gum’t
, 
NULL
, 'n'},

145 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

146 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 's'},

147 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

148 {"–a¡ic™y", 
»quœed_¬gum’t
, 
NULL
, 'x'},

149 {
NULL
, 0, NULL, 0}

152 
št£t_t
 *
£t
;

153 
i
, 
c
, 
v®
, 
size
;

154 *
s
;

155 
»ads
, 
upd©es
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

156 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

157 
abÜts_šv®id_memÜy
, 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

158 
th»ad_d©a_t
 *
d©a
;

159 
±h»ad_t
 *
th»ads
;

160 
±h»ad_©Œ_t
 
©Œ
;

161 
b¬r›r_t
 
b¬r›r
;

162 
timev®
 
¡¬t
, 
’d
;

163 
time¥ec
 
timeout
;

164 
du¿tiÚ
 = 
DEFAULT_DURATION
;

165 
š™Ÿl
 = 
DEFAULT_INITIAL
;

166 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

167 
¿nge
 = 
DEFAULT_RANGE
;

168 
£ed
 = 
DEFAULT_SEED
;

169 
upd©e
 = 
DEFAULT_UPDATE
;

170 #iâdeà
USE_RBTREE


171 
un™_tx
 = 4;

173 
sig£t_t
 
block_£t
;

176 
i
 = 0;

177 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hd:i:n:r:s:u:"

178 #iâdeà
USE_RBTREE


181 , 
lÚg_İtiÚs
, &
i
);

183 if(
c
 == -1)

186 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

187 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

189 
c
) {

194 
	`´štf
("intset -- STM stressest "

195 #ifdeà
USE_RBTREE


208 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

210 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

212 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

214 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

216 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

218 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

219 #iâdeà
USE_RBTREE


231 
	`ex™
(0);

233 
du¿tiÚ
 = 
	`©oi
(
İrg
);

236 
š™Ÿl
 = 
	`©oi
(
İrg
);

239 
nb_th»ads
 = 
	`©oi
(
İrg
);

242 
¿nge
 = 
	`©oi
(
İrg
);

245 
£ed
 = 
	`©oi
(
İrg
);

248 
upd©e
 = 
	`©oi
(
İrg
);

250 #iâdeà
USE_RBTREE


252 
un™_tx
 = 
	`©oi
(
İrg
);

256 
	`´štf
("Use -h or --help for help\n");

257 
	`ex™
(0);

259 
	`ex™
(1);

263 
	`as£¹
(
du¿tiÚ
 >= 0);

264 
	`as£¹
(
š™Ÿl
 >= 0);

265 
	`as£¹
(
nb_th»ads
 > 0);

266 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

267 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

269 #ifdeà
USE_RBTREE


270 
	`´štf
("Setype :„ed-blackree\n");

272 
	`´štf
("Setype :†inked†ist\n");

274 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

275 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

276 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

277 
	`´štf
("V®u¿ng : %d\n", 
¿nge
);

278 
	`´štf
("S“d : %d\n", 
£ed
);

279 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

280 #iâdeà
USE_RBTREE


281 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

283 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

287 ()(
¡m_wÜd_t
));

289 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

290 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

292 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

293 
	`³¼Ü
("malloc");

294 
	`ex™
(1);

296 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

297 
	`³¼Ü
("malloc");

298 
	`ex™
(1);

301 ià(
£ed
 == 0)

302 
	`¤ªd
(()
	`time
(0));

304 
	`¤ªd
(
£ed
);

306 
£t
 = 
	`£t_Ãw
();

308 
¡İ
 = 0;

311 
	`´štf
("Initializing STM\n");

312 
	`¡m_š™
();

313 
	`mod_mem_š™
();

315 ià(
	`¡m_g‘_·¿m‘”
("compe_æags", &
s
))

316 
	`´štf
("STM fÏg  : %s\n", 
s
);

319 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

320 
i
 = 0;

321 
i
 < 
š™Ÿl
) {

322 
v®
 = (
	`¿nd
(è% 
¿nge
) + 1;

323 ià(
	`£t_add
(
£t
, 
v®
, 0))

324 
i
++;

326 
size
 = 
	`£t_size
(
£t
);

327 
	`´štf
("S‘ siz : %d\n", 
size
);

330 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

331 
	`±h»ad_©Œ_š™
(&
©Œ
);

332 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

333 
i
 = 0; i < 
nb_th»ads
; i++) {

334 
	`´štf
("C»©šgh»ad %d\n", 
i
);

335 
d©a
[
i
].
¿nge
 =„ange;

336 
d©a
[
i
].
upd©e
 = update;

337 #iâdeà
USE_RBTREE


338 
d©a
[
i
].
un™_tx
 = unit_tx;

340 
d©a
[
i
].
nb_add
 = 0;

341 
d©a
[
i
].
nb_»move
 = 0;

342 
d©a
[
i
].
nb_cÚšs
 = 0;

343 
d©a
[
i
].
nb_found
 = 0;

344 
d©a
[
i
].
nb_abÜts
 = 0;

345 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

346 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

347 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

348 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

349 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

350 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

351 
d©a
[
i
].
max_»Œ›s
 = 0;

352 
d©a
[
i
].
diff
 = 0;

353 
d©a
[
i
].
£ed
 = 
	`¿nd
();

354 
d©a
[
i
].
£t
 = set;

355 
d©a
[
i
].
b¬r›r
 = &barrier;

356 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

357 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

358 
	`årštf
(
¡d”r
, "Error creatinghread\n");

359 
	`ex™
(1);

362 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

365 ià(
	`sigÇl
(
SIGHUP
, 
ÿtch”
è=ğ
SIG_ERR
 ||

366 
	`sigÇl
(
SIGINT
, 
ÿtch”
è=ğ
SIG_ERR
 ||

367 
	`sigÇl
(
SIGTERM
, 
ÿtch”
è=ğ
SIG_ERR
) {

368 
	`³¼Ü
("signal");

369 
	`ex™
(1);

373 
	`b¬r›r_üoss
(&
b¬r›r
);

375 
	`´štf
("STARTING...\n");

376 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

377 ià(
du¿tiÚ
 > 0) {

378 
	`Çno¦“p
(&
timeout
, 
NULL
);

380 
	`sigem±y£t
(&
block_£t
);

381 
	`sigsu¥’d
(&
block_£t
);

383 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

384 
	`g‘timeofday
(&
’d
, 
NULL
);

385 
	`´štf
("STOPPING...\n");

388 
i
 = 0; i < 
nb_th»ads
; i++) {

389 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

390 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

391 
	`ex™
(1);

395 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

396 
abÜts
 = 0;

397 
abÜts_locked_»ad
 = 0;

398 
abÜts_locked_wr™e
 = 0;

399 
abÜts_v®id©e_»ad
 = 0;

400 
abÜts_v®id©e_wr™e
 = 0;

401 
abÜts_v®id©e_comm™
 = 0;

402 
abÜts_šv®id_memÜy
 = 0;

403 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

404 
»ads
 = 0;

405 
upd©es
 = 0;

406 
max_»Œ›s
 = 0;

407 
i
 = 0; i < 
nb_th»ads
; i++) {

408 
	`´štf
("Th»ad %d\n", 
i
);

409 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

410 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

411 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

412 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

413 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

414 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

415 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

416 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

417 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

418 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

419 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

420 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

421 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

422 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

423 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

424 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

425 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

426 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

427 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

428 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

429 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

430 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

431 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

432 
size
 +ğ
d©a
[
i
].
diff
;

433 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

434 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

436 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`£t_size
(
£t
), 
size
);

437 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

438 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
, (»ad + upd©esè* 1000.0 / 
du¿tiÚ
);

439 
	`´štf
("#»adx  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

440 
	`´štf
("#upd©tx  : %lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

441 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

442 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

443 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

444 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

445 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

446 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

447 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

448 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

449 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

452 
	`£t_d–‘e
(
£t
);

455 
	`¡m_ex™
();

457 
	`ä“
(
th»ads
);

458 
	`ä“
(
d©a
);

461 
	}
}

	@utils/estm-0.2.4.3/bench/lf-deque/linkedlist.c

24 
	~"lškedli¡.h
"

26 
	$£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

28 
»suÉ
;

29 
node_t
 *
´ev
, *
Ãxt
;

30 
v®_t
 
v
;

32 #ifdeà
DEBUG


33 
	`´štf
("++> s‘_cÚšs(%d)\n", 
v®
);

34 
IO_FLUSH
;

37 
Œª§ùiÚ®
) {

39 
´ev
 = 
£t
->
h—d
;

40 
Ãxt
 = 
´ev
->next;

41 
Ãxt
->
v®
 < val) {

42 
´ev
 = 
Ãxt
;

43 
Ãxt
 = 
´ev
->next;

45 
»suÉ
 = (
Ãxt
->
v®
 == val);

49 
	`TX_START
(0, 
RO
, 
NL
);

50 
´ev
 = 
£t
->
h—d
;

51 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

53 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

54 ià(
v
 >ğ
v®
)

56 
´ev
 = 
Ãxt
;

57 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

59 
»suÉ
 = (
v
 =ğ
v®
);

60 
TX_END
;

66 
	`TX_START
(0, 
RO
, 
EL
);

67 
´ev
 = 
£t
->
h—d
;

68 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

70 
v
 = 
	`TX_LOAD
((
¡m_wÜd_t
 *è&
Ãxt
->
v®
);

71 ià(
v
 >ğ
v®
)

73 
´ev
 = 
Ãxt
;

74 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

76 
TX_END
;

77 
»suÉ
 = (
v
 =ğ
v®
);

81 
»suÉ
 = 
	`h¬ris_fšd
(
£t
, 
v®
);

84 
»suÉ
=0;

85 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

86 
	`ex™
(1);

89  
»suÉ
;

90 
	}
}

92 
	$£t_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

94 
»suÉ
;

95 
node_t
 *
´ev
, *
Ãxt
;

96 
v®_t
 
v
;

98 #ifdeà
DEBUG


99 
	`´štf
("++> s‘_add(%d)\n", 
v®
);

100 
IO_FLUSH
;

103 
Œª§ùiÚ®
) {

105 
´ev
 = 
£t
->
h—d
;

106 
Ãxt
 = 
´ev
->next;

107 
Ãxt
->
v®
 < val) {

108 
´ev
 = 
Ãxt
;

109 
Ãxt
 = 
´ev
->next;

111 
»suÉ
 = (
Ãxt
->
v®
 != val);

112 ià(
»suÉ
) {

113 
´ev
->
Ãxt
 = 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
);

119 
	`TX_START
(1, 
RW
, 
NL
);

120 
´ev
 = 
£t
->
h—d
;

121 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

123 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

124 ià(
v
 >ğ
v®
)

126 
´ev
 = 
Ãxt
;

127 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

129 
»suÉ
 = (
v
 !ğ
v®
);

130 ià(
»suÉ
) {

131 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
));

133 
TX_END
;

138 
	`TX_START
(1, 
RW
, 
EL
);

139 
´ev
 = 
£t
->
h—d
;

140 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

142 
v
 = 
	`TX_LOAD
((
¡m_wÜd_t
 *è&
Ãxt
->
v®
);

143 ià(
v
 >ğ
v®
)

145 
´ev
 = 
Ãxt
;

146 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

148 
»suÉ
 = (
v
 !ğ
v®
);

149 ià(
»suÉ
) {

150 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
));

152 
TX_END
;

156 
»suÉ
 = 
	`h¬ris_š£¹
(
£t
, 
v®
);

159 
»suÉ
=0;

160 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

161 
	`ex™
(1);

164  
»suÉ
;

165 
	}
}

167 
	$£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

169 
»suÉ
;

170 
node_t
 *
´ev
, *
Ãxt
;

171 
v®_t
 
v
;

172 
node_t
 *
n
;

174 #ifdeà
DEBUG


175 
	`´štf
("++> s‘_»move(%d)\n", 
v®
);

176 
IO_FLUSH
;

179 
Œª§ùiÚ®
) {

181 
´ev
 = 
£t
->
h—d
;

182 
Ãxt
 = 
´ev
->next;

183 
Ãxt
->
v®
 < val) {

184 
´ev
 = 
Ãxt
;

185 
Ãxt
 = 
´ev
->next;

187 
»suÉ
 = (
Ãxt
->
v®
 == val);

188 ià(
»suÉ
) {

189 
´ev
->
Ãxt
 =‚ext->next;

190 
	`ä“
(
Ãxt
);

197 
	`TX_START
(2, 
RW
, 
NL
);

198 
´ev
 = 
£t
->
h—d
;

199 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

201 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

202 ià(
v
 >ğ
v®
)

204 
´ev
 = 
Ãxt
;

205 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

207 
»suÉ
 = (
v
 =ğ
v®
);

208 ià(
»suÉ
) {

209 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

210 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

212 
	`FREE
(
Ãxt
, (
node_t
));

214 
TX_END
;

218 
	`TX_START
(2, 
RW
, 
EL
);

219 
´ev
 = 
£t
->
h—d
;

220 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

222 
v
 = 
	`TX_LOAD
((
¡m_wÜd_t
 *è&
Ãxt
->
v®
);

223 ià(
v
 >ğ
v®
)

225 
´ev
 = 
Ãxt
;

226 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

228 
»suÉ
 = (
v
 =ğ
v®
);

229 ià(
»suÉ
) {

230 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

231 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

233 
	`FREE
(
Ãxt
, (
node_t
));

235 
TX_END
;

239 
»suÉ
 = 
	`h¬ris_d–‘e
(
£t
, 
v®
);

242 
»suÉ
=0;

243 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

244 
	`ex™
(1);

247  
»suÉ
;

248 
	}
}

	@utils/estm-0.2.4.3/bench/lf-deque/linkedlist.h

10 
	~"h¬ris.h
"

12 
£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

13 
£t_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

14 
£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

	@utils/estm-0.2.4.3/bench/lf-hashtable/lf-ht.c

14 
	~"../lf-lškedli¡/lškedli¡.h
"

16 
	#DEFAULT_MOVE
 0

	)

17 
	#DEFAULT_SNAPSHOT
 0

	)

18 
	#DEFAULT_LOAD
 1

	)

19 
	#MAXHTLENGTH
 65535

	)

22 
	gmaxh’gth
;

25 #ifdeà
TLS


26 
__th»ad
 *
	gºg_£ed
;

28 
±h»ad_key_t
 
	gºg_£ed_key
;

31 
	sht_št£t
 {

32 
št£t_t
 *
	mbuck‘s
[
MAXHTLENGTH
];

33 } 
	tht_št£t_t
;

35 
	$ht_d–‘e
(
ht_št£t_t
 *
£t
) {

36 
node_t
 *
node
, *
Ãxt
;

37 
i
;

39 
i
=0; i < 
maxh’gth
; i++) {

40 
node
 = 
£t
->
buck‘s
[
i
]->
h—d
;

41 
node
 !ğ
NULL
) {

42 
Ãxt
 = 
node
->next;

43 
	`ä“
(
node
);

44 
node
 = 
Ãxt
;

47 
	`ä“
(
£t
);

48 
	}
}

50 
	$ht_size
(
ht_št£t_t
 *
£t
) {

51 
size
 = 0;

52 
node_t
 *
node
;

53 
i
;

55 
i
=0; i < 
maxh’gth
; i++) {

58 
node
 = 
£t
->
buck‘s
[
i
]->
h—d
->
Ãxt
;

59 
node
->
Ãxt
) {

60 
size
++;

61 
node
 =‚ode->
Ãxt
;

65  
size
;

66 
	}
}

68 
	$æoÜ_log_2
(
n
) {

69 
pos
 = 0;

70 
	`´štf
("À»suÉ = %d\n", 
n
);

71 ià(
n
 >ğ1<<16è{‚ >>ğ16; 
pos
 += 16; }

72 ià(
n
 >ğ1<< 8è{‚ >>ğ8; 
pos
 += 8; }

73 ià(
n
 >ğ1<< 4è{‚ >>ğ4; 
pos
 += 4; }

74 ià(
n
 >ğ1<< 2è{‚ >>ğ2; 
pos
 += 2; }

75 ià(
n
 >ğ1<< 1è{ 
pos
 += 1; }

76 
	`´štf
("æoÜ„esuÉ = %d\n", 
pos
);

77  ((
n
 =ğ0è? (-1è: 
pos
);

78 
	}
}

80 
ht_št£t_t
 *
	$ht_Ãw
() {

81 
ht_št£t_t
 *
£t
;

82 
i
;

84 ià((
£t
 = (
ht_št£t_t
 *)
	`m®loc
((ht_št£t_t))è=ğ
NULL
) {

85 
	`³¼Ü
("malloc");

86 
	`ex™
(1);

88 
i
=0; i < 
maxh’gth
; i++) {

89 
£t
->
buck‘s
[
i
] = 
	`£t_Ãw
();

91  
£t
;

92 
	}
}

94 
	$ht_cÚšs
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

95 
addr
;

97 #ifdeà
DEBUG


98 
	`´štf
("++> ht_cÚšs(%d)\n", (è
v®
);

99 
IO_FLUSH
;

101 
addr
 = 
v®
 % 
maxh’gth
;

102 ià(
Œª§ùiÚ®
 == 5)

103  
	`£t_cÚšs
(
£t
->
buck‘s
[
addr
], 
v®
, 4);

105  
	`£t_cÚšs
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

106 
	}
}

108 
	$ht_add
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

109 
addr
;

111 #ifdeà
DEBUG


112 
	`´štf
("++> ht_add(%d)\n", (è
v®
);

113 
IO_FLUSH
;

115 
addr
 = 
v®
 % 
maxh’gth
;

116 ià(
Œª§ùiÚ®
 == 5)

117  
	`£t_add
(
£t
->
buck‘s
[
addr
], 
v®
, 4);

119  
	`£t_add
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

120 
	}
}

122 
	$ht_»move
(
ht_št£t_t
 *
£t
, 
v®
, 
Œª§ùiÚ®
) {

123 
addr
;

125 #ifdeà
DEBUG


126 
	`´štf
("++> ht_cÚšs(%d)\n", (è
v®
);

127 
IO_FLUSH
;

129 
addr
 = 
v®
 % 
maxh’gth
;

130 ià(
Œª§ùiÚ®
 == 5)

131  
	`£t_»move
(
£t
->
buck‘s
[
addr
], 
v®
, 4);

133  
	`£t_»move
(
£t
->
buck‘s
[
addr
], 
v®
, 
Œª§ùiÚ®
);

134 
	}
}

140 
	$ht_move
(
ht_št£t_t
 *
£t
, 
v®1
, 
v®2
, 
Œª§ùiÚ®
) {

141 
v
, 
addr1
, 
addr2
, 
»suÉ
 = 0;

142 
node_t
 *
n
, *
´ev
, *
Ãxt
, *
´ev2
, *
Ãxt2
;

144 
Œª§ùiÚ®
) {

146 
addr1
 = 
v®1
 % 
maxh’gth
;

147 
addr2
 = 
v®2
 % 
maxh’gth
;

148 
»suÉ
 = (
	`£t_»move
(
£t
->
buck‘s
[
addr1
], 
v®1
, 
Œª§ùiÚ®
) &&

149 
	`£t_add
(
£t
->
buck‘s
[
addr2
], 
v®2
, 
Œª§ùiÚ®
));

153 
	`TX_START
(
NL
);

154 
addr1
 = 
v®1
 % 
maxh’gth
;

155 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

156 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

158 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

159 ià(
v
 >ğ
v®1
) ;

160 
´ev
 = 
Ãxt
;

161 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

163 ià(
v
 =ğ
v®1
) {

165 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

166 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

167 
	`FREE
(
Ãxt
, (
node_t
));

169 
addr2
 = 
v®2
 % 
maxh’gth
;

170 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

171 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

173 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

174 ià(
v
 >ğ
v®2
) ;

175 
´ev
 = 
Ãxt
;

176 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

178 ià(
v
 !ğ
v®2
) {

179 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®2
,‚ext, 
Œª§ùiÚ®
));

182 
»suÉ
 = 1;

183 } 
»suÉ
 = 0;

184 
TX_END
;

190 
	`TX_START
(
EL
);

191 
addr1
 = 
v®1
 % 
maxh’gth
;

192 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

193 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

195 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

196 ià(
v
 >ğ
v®1
) ;

197 
´ev
 = 
Ãxt
;

198 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

200 ià(
v
 =ğ
v®1
) {

201 
addr2
 = 
v®2
 % 
maxh’gth
;

202 
´ev2
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

203 
Ãxt2
 = (
node_t
 *)
	`TX_LOAD
(&
´ev2
->
Ãxt
);

205 
v
 = 
	`TX_LOAD
(&
Ãxt2
->
v®
);

206 ià(
v
 >ğ
v®2
) ;

207 
´ev2
 = 
Ãxt2
;

208 
Ãxt2
 = (
node_t
 *)
	`TX_LOAD
(&
´ev2
->
Ãxt
);

211 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

212 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

214 
	`FREE
(
Ãxt
, (
node_t
));

216 ià(
v
 !ğ
v®2
) {

217 
	`TX_STORE
(&
´ev2
->
Ãxt
, 
	`Ãw_node
(
v®2
, 
Ãxt2
, 
Œª§ùiÚ®
));

220 
»suÉ
 = 1;

221 } 
»suÉ
 = 0;

222 
TX_END
;

226 
	`TX_START
(
EL
);

227 
addr1
 = 
v®1
 % 
maxh’gth
;

228 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr1
]->
h—d
);

229 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

231 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

232 ià(
v
 >ğ
v®1
) ;

233 
´ev
 = 
Ãxt
;

234 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

236 ià(
v
 =ğ
v®1
) {

238 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

239 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

240 
	`FREE
(
Ãxt
, (
node_t
));

242 
addr2
 = 
v®2
 % 
maxh’gth
;

243 
´ev
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
addr2
]->
h—d
);

244 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

246 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

247 ià(
v
 >ğ
v®2
) ;

248 
´ev
 = 
Ãxt
;

249 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

251 ià(
v
 !ğ
v®2
) {

252 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®2
,‚ext, 
Œª§ùiÚ®
));

255 
»suÉ
 = 1;

256 } 
»suÉ
 = 0;

257 
TX_END
;

261 
	`´štf
("ht_snapshot: No other implementation of‡tomic snapshot is‡vailable\n");

262 
	`ex™
(1);

265 
»suÉ
=0;

266 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

267 
	`ex™
(1);

269  
»suÉ
;

270 
	}
}

280 
	$ht_¢­shÙ
(
ht_št£t_t
 *
£t
, 
Œª§ùiÚ®
) {

281 
i
, 
»suÉ
, 
sum
 = 0;

282 
node_t
 *
Ãxt
;

284 
Œª§ùiÚ®
) {

286 
i
=0; i < 
maxh’gth
; i++) {

287 
Ãxt
 = 
£t
->
buck‘s
[
i
]->
h—d
->next;

288 
Ãxt
->next) {

289 
sum
 +ğ
Ãxt
->
v®
;

290 
Ãxt
 =‚ext->next;

293 
»suÉ
 = 1;

301 
	`TX_START
(
NL
);

302 
i
=0; i < 
maxh’gth
; i++) {

303 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
£t
->
buck‘s
[
i
]->
h—d
->next);

304 
Ãxt
->next) {

305 
sum
 +ğ
	`TX_LOAD
(&
Ãxt
->
v®
);

306 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&next->next);

309 
TX_END
;

310 
»suÉ
 = 1;

314 
»suÉ
 = 0;

315 
	`´štf
("ht_snapshot: No other implementation of‡tomic snapshot is‡vailable\n");

316 
	`ex™
(1);

319 
»suÉ
=0;

320 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

321 
	`ex™
(1);

323  
»suÉ
;

324 
	}
}

330 
	sb¬r›r
 {

331 
±h»ad_cÚd_t
 
	mcom¶‘e
;

332 
±h»ad_mu‹x_t
 
	mmu‹x
;

333 
	mcouÁ
;

334 
	müossšg
;

335 } 
	tb¬r›r_t
;

338 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

340 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

341 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

342 
b
->
couÁ
 = 
n
;

343 
b
->
üossšg
 = 0;

344 
	}
}

346 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

348 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

350 
b
->
üossšg
++;

352 ià(
b
->
üossšg
 < b->
couÁ
) {

353 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

355 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

357 
b
->
üossšg
 = 0;

359 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

360 
	}
}

372 
šlše
 
	$¿nd_¿nge
(
r
) {

373 
m
 = 
RAND_MAX
;

374 
v
 = 0;

375 
d
;

378 
d
 = (
m
 > 
r
 ?„ : m);

379 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

380 
r
 -ğ
m
;

381 } 
r
 > 0);

382  
v
;

383 
	}
}

385 
	sth»ad_d©a
 {

386 
	m¿nge
;

387 
	mupd©e
;

388 
	mmove
;

389 
	m¢­shÙ
;

390 #iâdeà
USE_RBTREE


391 
	mun™_tx
;

393 
	mnb_add
;

394 
	mnb_»move
;

395 
	mnb_cÚšs
;

397 
	mlßd_çùÜ
;

398 
	mnb_move
;

399 
	mnb_moved
;

400 
	mnb_¢­shÙ
;

401 
	mnb_¢­shÙed
;

403 
	mnb_found
;

404 
	mnb_abÜts
;

405 
	mnb_abÜts_locked_»ad
;

406 
	mnb_abÜts_locked_wr™e
;

407 
	mnb_abÜts_v®id©e_»ad
;

408 
	mnb_abÜts_v®id©e_wr™e
;

409 
	mnb_abÜts_v®id©e_comm™
;

410 
	mnb_abÜts_šv®id_memÜy
;

411 
	mnb_abÜts_doubË_wr™e
;

412 
	mmax_»Œ›s
;

413 
	mdiff
;

414 
	m£ed
;

415 
ht_št£t_t
 *
	m£t
;

416 
b¬r›r_t
 *
	mb¬r›r
;

417 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

418 } 
	tth»ad_d©a_t
;

421 *
	$‹¡
(*
d©a
)

423 
v®
, 
Ï¡
, 
æag
 = 1;

424 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

427 
	`¡m_š™_th»ad
();

429 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

431 
Ï¡
 = 0;

432 
¡İ
 == 0) {

433 
v®
 = 
	`¿nd_r
(&
d
->
£ed
) % 100;

435 ià(
v®
 < 
d
->
upd©e
) {

436 ià(
v®
 >ğ
d
->
move
) {

437 ià(
æag
) {

439 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

440 ià(
	`ht_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

441 
d
->
diff
++;

442 
Ï¡
 = 
v®
;

443 
æag
 = 0;

445 
d
->
nb_add
++;

448 ià(
	`ht_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
))

449 
d
->
diff
--;

450 
d
->
nb_»move
++;

451 
æag
 = 1;

454 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

455 ià(
	`ht_move
(
d
->
£t
, 
Ï¡
, 
v®
, 
TRANSACTIONAL
)) {

456 
d
->
nb_moved
++;

457 
Ï¡
 = 
v®
;

459 
d
->
nb_move
++;

462 ià(
v®
 >ğ
d
->
upd©e
 + d->
¢­shÙ
) {

464 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

465 ià(
	`ht_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

466 
d
->
nb_found
++;

467 
d
->
nb_cÚšs
++;

469 ià(
	`ht_¢­shÙ
(
d
->
£t
, 
TRANSACTIONAL
))

470 
d
->
nb_¢­shÙed
++;

471 
d
->
nb_¢­shÙ
++;

475 
	`¡m_g‘_¡©s
("nb_abÜts", &
d
->
nb_abÜts
);

476 
	`¡m_g‘_¡©s
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
);

477 
	`¡m_g‘_¡©s
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
);

478 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
);

479 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
);

480 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
);

481 
	`¡m_g‘_¡©s
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
);

482 
	`¡m_g‘_¡©s
("nb_abÜts_doubË_wr™e", &
d
->
nb_abÜts_doubË_wr™e
);

483 
	`¡m_g‘_¡©s
("max_»Œ›s", &
d
->
max_»Œ›s
);

485 
	`¡m_ex™_th»ad
();

487  
NULL
;

488 
	}
}

490 
	$ÿtch”
(
sig
)

492 
	`´štf
("CAUGHT SIGNAL %d\n", 
sig
);

493 
	}
}

495 
	$´št_£t
(
št£t_t
 *
£t
) {

496 
node_t
 *
cu¼
, *
tmp
;

498 
cu¼
 = 
£t
->
h—d
;

499 
tmp
 = 
cu¼
;

501 
	`´štf
(" - v%d", (è
cu¼
->
v®
);

502 
tmp
 = 
cu¼
;

503 
cu¼
 = 
tmp
->
Ãxt
;

504 } 
cu¼
->
v®
 !ğ
VAL_MAX
);

505 
	`´štf
(" - v%d", (è
cu¼
->
v®
);

506 
	`´štf
("\n");

507 
	}
}

509 
	$´št_ht
(
ht_št£t_t
 *
£t
) {

510 
i
;

511 
i
=0; i < 
maxh’gth
; i++) {

512 
	`´št_£t
(
£t
->
buck‘s
[
i
]);

514 
	}
}

516 
šlše
 
	$¿nd_65535
()

518 #ifdeà
TLS


519  
	`¿nd_r
(
ºg_£ed
) % 65535;

521  
	`¿nd_r
((*)
	`±h»ad_g‘¥ecific
(
ºg_£ed_key
)) % 65535;

523 
	}
}

525 
	$maš
(
¬gc
, **
¬gv
)

527 
İtiÚ
 
lÚg_İtiÚs
[] = {

529 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

530 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

531 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

532 {"num-th»ads", 
»quœed_¬gum’t
, 
NULL
, 'n'},

533 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

534 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 's'},

535 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

536 {"move-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'm'},

537 {"¢­shÙ-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'a'},

538 {"–a¡ic™y", 
»quœed_¬gum’t
, 
NULL
, 'x'},

539 {
NULL
, 0, NULL, 0}

542 
ht_št£t_t
 *
£t
;

543 
i
, 
c
, 
v®
, 
size
;

544 *
s
;

545 
»ads
, 
upd©es
, 
moves
, 
¢­shÙs
, 
abÜts
,

546 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
, 
abÜts_v®id©e_»ad
,

547 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
, 
abÜts_šv®id_memÜy
,

548 
abÜts_doubË_wr™e
,

549 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

550 
th»ad_d©a_t
 *
d©a
;

551 
±h»ad_t
 *
th»ads
;

552 
±h»ad_©Œ_t
 
©Œ
;

553 
b¬r›r_t
 
b¬r›r
;

554 
timev®
 
¡¬t
, 
’d
;

555 
time¥ec
 
timeout
;

556 
du¿tiÚ
 = 
DEFAULT_DURATION
;

557 
š™Ÿl
 = 
DEFAULT_INITIAL
;

558 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

559 
¿nge
 = 
DEFAULT_RANGE
;

560 
£ed
 = 
DEFAULT_SEED
;

561 
upd©e
 = 
DEFAULT_UPDATE
;

562 
lßd_çùÜ
 = 
DEFAULT_LOAD
;

563 
move
 = 
DEFAULT_MOVE
;

564 
¢­shÙ
 = 
DEFAULT_SNAPSHOT
;

565 
un™_tx
 = 4;

566 
sig£t_t
 
block_£t
;

569 
i
 = 0;

570 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hd:i:n:r:s:u:m:a:l:x:", 
lÚg_İtiÚs
, &
i
);

572 if(
c
 == -1)

575 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

576 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

578 
c
) {

583 
	`´štf
("intset -- STM stressest "

593 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

595 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

597 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

599 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

601 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

603 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

605 " P”ûÁagoàmovŒª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_MOVE
) ")\n"

607 " P”ûÁagoà¢­shÙ¿n§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_SNAPSHOT
) ")\n"

609 " R©iØoàkey ov” buck‘ (deçuÉ=" 
	`XSTR
(
DEFAULT_LOAD
) ")\n"

619 
	`ex™
(0);

621 
du¿tiÚ
 = 
	`©oi
(
İrg
);

624 
š™Ÿl
 = 
	`©oi
(
İrg
);

627 
nb_th»ads
 = 
	`©oi
(
İrg
);

630 
¿nge
 = 
	`©oi
(
İrg
);

633 
£ed
 = 
	`©oi
(
İrg
);

636 
upd©e
 = 
	`©oi
(
İrg
);

639 
move
 = 
	`©oi
(
İrg
);

642 
¢­shÙ
 = 
	`©oi
(
İrg
);

645 
lßd_çùÜ
 = 
	`©oi
(
İrg
);

648 
un™_tx
 = 
	`©oi
(
İrg
);

651 
	`´štf
("Use -h or --help for help\n");

652 
	`ex™
(0);

654 
	`ex™
(1);

658 
	`as£¹
(
du¿tiÚ
 >= 0);

659 
	`as£¹
(
š™Ÿl
 >= 0);

660 
	`as£¹
(
nb_th»ads
 > 0);

661 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

662 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

663 
	`as£¹
(
move
 >ğ0 && mov<ğ
upd©e
);

664 
	`as£¹
(
¢­shÙ
 >ğ0 && sÇpshÙ <ğ(100-
upd©e
));

665 
	`as£¹
(
š™Ÿl
 < 
MAXHTLENGTH
);

666 
	`as£¹
(
š™Ÿl
 >ğ
lßd_çùÜ
);

668 
	`´štf
("Setype : hashable\n");

669 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

670 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

671 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

672 
	`´štf
("V®u¿ng : %d\n", 
¿nge
);

673 
	`´štf
("S“d : %d\n", 
£ed
);

674 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

675 
	`´štf
("Lßd faùÜ : %d\n", 
lßd_çùÜ
);

676 
	`´štf
("Mov¿‹ : %d\n", 
move
);

677 
	`´štf
("SÇpshÙ„©e: %d\n", 
¢­shÙ
);

678 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

679 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

683 ()(
¡m_wÜd_t
));

685 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

686 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

688 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

689 
	`³¼Ü
("malloc");

690 
	`ex™
(1);

692 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

693 
	`³¼Ü
("malloc");

694 
	`ex™
(1);

697 ià(
£ed
 == 0)

698 
	`¤ªd
(()
	`time
(0));

700 
	`¤ªd
(
£ed
);

702 
maxh’gth
 = (è
š™Ÿl
 / 
lßd_çùÜ
;

703 
£t
 = 
	`ht_Ãw
();

705 
¡İ
 = 0;

708 
	`´štf
("Initializing STM\n");

709 
	`¡m_š™
();

710 
	`mod_mem_š™
();

712 ià(
	`¡m_g‘_·¿m‘”
("compe_æags", &
s
))

713 
	`´štf
("STM fÏg  : %s\n", 
s
);

716 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

717 
i
 = 0;

718 
maxh’gth
 = (è(
š™Ÿl
 / 
lßd_çùÜ
);

719 
i
 < 
š™Ÿl
) {

720 
v®
 = 
	`¿nd_¿nge
(
¿nge
);

721 ià(
	`ht_add
(
£t
, 
v®
, 0))

722 
i
++;

724 
size
 = 
	`ht_size
(
£t
);

725 
	`´štf
("S‘ siz : %d\n", 
size
);

726 
	`´štf
("Buck‘‡mouÁ: %d\n", 
maxh’gth
);

727 
	`´štf
("Lßd : %d\n", 
lßd_çùÜ
);

730 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

731 
	`±h»ad_©Œ_š™
(&
©Œ
);

732 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

733 
i
 = 0; i < 
nb_th»ads
; i++) {

734 
	`´štf
("C»©šgh»ad %d\n", 
i
);

735 
d©a
[
i
].
¿nge
 =„ange;

736 
d©a
[
i
].
upd©e
 = update;

737 
d©a
[
i
].
lßd_çùÜ
 =†oad_factor;

738 
d©a
[
i
].
move
 = move;

739 
d©a
[
i
].
¢­shÙ
 = snapshot;

740 
d©a
[
i
].
un™_tx
 = unit_tx;

741 
d©a
[
i
].
nb_add
 = 0;

742 
d©a
[
i
].
nb_»move
 = 0;

743 
d©a
[
i
].
nb_cÚšs
 = 0;

744 
d©a
[
i
].
nb_found
 = 0;

745 
d©a
[
i
].
nb_abÜts
 = 0;

746 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

747 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

748 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

749 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

750 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

751 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

752 
d©a
[
i
].
nb_abÜts_doubË_wr™e
 = 0;

753 
d©a
[
i
].
max_»Œ›s
 = 0;

754 
d©a
[
i
].
diff
 = 0;

755 
d©a
[
i
].
£ed
 = 
	`¿nd
();

756 
d©a
[
i
].
£t
 = set;

757 
d©a
[
i
].
b¬r›r
 = &barrier;

758 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

759 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

760 
	`årštf
(
¡d”r
, "Error creatinghread\n");

761 
	`ex™
(1);

764 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

767 ià(
	`sigÇl
(
SIGHUP
, 
ÿtch”
è=ğ
SIG_ERR
 ||

768 
	`sigÇl
(
SIGINT
, 
ÿtch”
è=ğ
SIG_ERR
 ||

769 
	`sigÇl
(
SIGTERM
, 
ÿtch”
è=ğ
SIG_ERR
) {

770 
	`³¼Ü
("signal");

771 
	`ex™
(1);

775 
	`b¬r›r_üoss
(&
b¬r›r
);

777 
	`´štf
("STARTING...\n");

778 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

779 ià(
du¿tiÚ
 > 0) {

780 
	`Çno¦“p
(&
timeout
, 
NULL
);

782 
	`sigem±y£t
(&
block_£t
);

783 
	`sigsu¥’d
(&
block_£t
);

785 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

786 
	`g‘timeofday
(&
’d
, 
NULL
);

787 
	`´štf
("STOPPING...\n");

790 
i
 = 0; i < 
nb_th»ads
; i++) {

791 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

792 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

793 
	`ex™
(1);

797 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

798 
abÜts
 = 0;

799 
abÜts_locked_»ad
 = 0;

800 
abÜts_locked_wr™e
 = 0;

801 
abÜts_v®id©e_»ad
 = 0;

802 
abÜts_v®id©e_wr™e
 = 0;

803 
abÜts_v®id©e_comm™
 = 0;

804 
abÜts_šv®id_memÜy
 = 0;

805 
abÜts_doubË_wr™e
 = 0;

806 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

807 
»ads
 = 0;

808 
upd©es
 = 0;

809 
moves
 = 0;

810 
¢­shÙs
 = 0;

811 
max_»Œ›s
 = 0;

812 
i
 = 0; i < 
nb_th»ads
; i++) {

813 
	`´štf
("Th»ad %d\n", 
i
);

814 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

815 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

816 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

817 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

818 
	`´štf
(" #mov : %lu\n", 
d©a
[
i
].
nb_move
);

819 
	`´štf
(" #moved : %lu\n", 
d©a
[
i
].
nb_moved
);

820 
	`´štf
(" #¢­shÙ : %lu\n", 
d©a
[
i
].
nb_¢­shÙ
);

821 
	`´štf
(" #¢­shÙed : %lu\n", 
d©a
[
i
].
nb_¢­shÙed
);

822 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

823 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

824 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

825 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

826 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

827 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

828 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

829 
	`´štf
(" #dup-w : %lu\n", 
d©a
[
i
].
nb_abÜts_doubË_wr™e
);

830 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

831 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

832 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

833 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

834 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

835 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

836 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

837 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

838 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

839 
abÜts_doubË_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_doubË_wr™e
;

840 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

841 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

842 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

843 
moves
 +ğ
d©a
[
i
].
nb_move
;

844 
¢­shÙs
 +ğ
d©a
[
i
].
nb_¢­shÙ
;

845 
size
 +ğ
d©a
[
i
].
diff
;

846 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

847 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

849 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`ht_size
(
£t
), 
size
);

850 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

851 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
 + 
moves
 + 
¢­shÙs
, (»ad + upd©e + move + sÇpshÙsè* 1000.0 / 
du¿tiÚ
);

852 
	`´štf
("#»adx  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

853 
	`´štf
("#upd©tx  : %lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

854 
	`´štf
("#movtx  : %lu (%à/ s)\n", 
moves
, move * 1000.0 / 
du¿tiÚ
);

855 
	`´štf
("#¢­shÙx : %lu (%à/ s)\n", 
¢­shÙs
, sÇpshÙ * 1000.0 / 
du¿tiÚ
);

856 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

857 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

858 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

859 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

860 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

861 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

862 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

863 
	`´štf
(" #dup-w : %lu (%à/ s)\n", 
abÜts_doubË_wr™e
,‡bÜts_doubË_wr™* 1000.0 / 
du¿tiÚ
);

864 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

865 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

868 
	`ht_d–‘e
(
£t
);

871 
	`¡m_ex™
();

873 
	`ä“
(
th»ads
);

874 
	`ä“
(
d©a
);

877 
	}
}

	@utils/estm-0.2.4.3/bench/lf-linkedlist/harris.c

24 
	~"h¬ris.h
"

33 
	$is_m¬ked_»f
(
i
) {

34  (è(
i
 & (
LONG_MIN
+1));

35 
	}
}

37 
	$un£t_m¬k
(
i
) {

38 
i
 &ğ
LONG_MAX
-1;

39  
i
;

40 
	}
}

42 
	$£t_m¬k
(
i
) {

43 
i
 = 
	`un£t_m¬k
(i);

44 
i
 += 1;

45  
i
;

46 
	}
}

48 
	$g‘_unm¬ked_»f
(
w
) {

49  
	`un£t_m¬k
(
w
);

50 
	}
}

52 
	$g‘_m¬ked_»f
(
w
) {

53  
	`£t_m¬k
(
w
);

54 
	}
}

64 
node_t
 *
	$h¬ris_£¬ch
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
node_t
 **
Ëá_node
) {

65 
node_t
 *
Ëá_node_Ãxt
, *
right_node
;

66 
Ëá_node_Ãxt
 = 
£t
->
h—d
;

68 
£¬ch_agaš
:

70 
node_t
 *
t
 = 
£t
->
h—d
;

71 
node_t
 *
t_Ãxt
 = 
£t
->
h—d
->
Ãxt
;

75 ià(!
	`is_m¬ked_»f
((è
t_Ãxt
)) {

76 (*
Ëá_node
èğ
t
;

77 
Ëá_node_Ãxt
 = 
t_Ãxt
;

79 
t
 = (
node_t
 *è
	`g‘_unm¬ked_»f
((è
t_Ãxt
);

80 ià(!
t
->
Ãxt
) ;

81 
t_Ãxt
 = 
t
->
Ãxt
;

82 } 
	`is_m¬ked_»f
((è
t_Ãxt
è|| (
t
->
v®
 < val));

83 
right_node
 = 
t
;

86 ià(
Ëá_node_Ãxt
 =ğ
right_node
) {

87 ià(
right_node
->
Ãxt
 && 
	`is_m¬ked_»f
(()„ight_node->next))

88 
£¬ch_agaš
;

89  
right_node
;

93 ià(
	`ATOMIC_CAS_MB
(&(*
Ëá_node
)->
Ãxt
,

94 
Ëá_node_Ãxt
,

95 
right_node
)) {

96 ià(
right_node
->
Ãxt
 && 
	`is_m¬ked_»f
(()„ight_node->next))

97 
£¬ch_agaš
;

98  
right_node
;

102 
	}
}

107 
	$h¬ris_fšd
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

108 
node_t
 *
right_node
, *
Ëá_node
;

109 
Ëá_node
 = 
£t
->
h—d
;

111 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

112 ià((!
right_node
->
Ãxt
è||„ight_node->
v®
 != val)

116 
	}
}

122 
	$h¬ris_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

123 
node_t
 *
Ãwnode
, *
right_node
, *
Ëá_node
;

124 
Ëá_node
 = 
£t
->
h—d
;

127 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

128 ià(
right_node
->
v®
 == val)

130 
Ãwnode
 = 
	`Ãw_node
(
v®
, 
right_node
, 0);

132 
	`AO_nİ_fuÎ
();

133 ià(
	`ATOMIC_CAS_MB
(&
Ëá_node
->
Ãxt
, 
right_node
, 
Ãwnode
))

136 
	}
}

143 
	$h¬ris_d–‘e
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

144 
node_t
 *
right_node
, *
right_node_Ãxt
, *
Ëá_node
;

145 
Ëá_node
 = 
£t
->
h—d
;

148 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

149 ià(
right_node
->
v®
 != val)

151 
right_node_Ãxt
 = 
right_node
->
Ãxt
;

152 ià(!
	`is_m¬ked_»f
((è
right_node_Ãxt
))

153 ià(
	`ATOMIC_CAS_MB
(&
right_node
->
Ãxt
,

154 
right_node_Ãxt
,

155 
	`g‘_m¬ked_»f
((è
right_node_Ãxt
)))

158 ià(!
	`ATOMIC_CAS_MB
(&
Ëá_node
->
Ãxt
, 
right_node
, 
right_node_Ãxt
))

159 
right_node
 = 
	`h¬ris_£¬ch
(
£t
,„ight_node->
v®
, &
Ëá_node
);

161 
	}
}

	@utils/estm-0.2.4.3/bench/lf-linkedlist/harris.h

10 
	~"št£t.h
"

16 
is_m¬ked_»f
(
i
);

17 
un£t_m¬k
(
i
);

18 
£t_m¬k
(
i
);

19 
g‘_unm¬ked_»f
(
w
);

20 
g‘_m¬ked_»f
(
w
);

22 
node_t
 *
h¬ris_£¬ch
(
št£t_t
 *
£t
, 
v®_t
 
v®
,‚ode_ˆ**
Ëá_node
);

23 
h¬ris_fšd
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

24 
h¬ris_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

25 
h¬ris_d–‘e
(
št£t_t
 *
£t
, 
v®_t
 
v®
);

	@utils/estm-0.2.4.3/bench/lf-linkedlist/intset.c

22 
	~<as£¹.h
>

23 
	~<g‘İt.h
>

24 
	~<lim™s.h
>

25 
	~<±h»ad.h
>

26 
	~<sigÇl.h
>

27 
	~<¡dlib.h
>

28 
	~<¡dio.h
>

29 
	~<sys/time.h
>

30 
	~<time.h
>

31 
	~<¡dšt.h
>

33 
	~<©omic_İs.h
>

35 
	~"¡m.h
"

36 
	~"mod_mem.h
"

38 #ifdeà
DEBUG


39 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

49 
	#MALLOC
(
size
è
	`¡m_m®loc
(size)

	)

55 
šŒ_t
 
	tv®_t
;

56 
	#VAL_MIN
 
INT_MIN


	)

57 
	#VAL_MAX
 
INT_MAX


	)

59 
	snode
 {

60 
v®_t
 
	mv®
;

61 
node
 *
	mÃxt
;

62 } 
	tnode_t
;

64 
	sšt£t
 {

65 
node_t
 *
	mh—d
;

66 } 
	tšt£t_t
;

68 
node_t
 *
	$Ãw_node
(
v®_t
 
v®
, 
node_t
 *
Ãxt
, 
Œª§ùiÚ®
)

70 
node_t
 *
node
;

72 ià(!
Œª§ùiÚ®
) {

73 
node
 = (
node_t
 *)
	`m®loc
((node_t));

75 
node
 = (
node_t
 *)
	`MALLOC
((node_t));

77 ià(
node
 =ğ
NULL
) {

78 
	`³¼Ü
("malloc");

79 
	`ex™
(1);

82 
node
->
v®
 = val;

83 
node
->
Ãxt
 =‚ext;

85  
node
;

86 
	}
}

88 
št£t_t
 *
	$£t_Ãw
()

90 
št£t_t
 *
£t
;

91 
node_t
 *
mš
, *
max
;

93 ià((
£t
 = (
št£t_t
 *)
	`m®loc
((št£t_t))è=ğ
NULL
) {

94 
	`³¼Ü
("malloc");

95 
	`ex™
(1);

97 
max
 = 
	`Ãw_node
(
VAL_MAX
, 
NULL
, 0);

98 
mš
 = 
	`Ãw_node
(
VAL_MIN
, 
max
, 0);

99 
£t
->
h—d
 = 
mš
;

101  
£t
;

102 
	}
}

104 
	$£t_d–‘e
(
št£t_t
 *
£t
)

106 
node_t
 *
node
, *
Ãxt
;

108 
node
 = 
£t
->
h—d
;

109 
node
 !ğ
NULL
) {

110 
Ãxt
 = 
node
->next;

111 
	`ä“
(
node
);

112 
node
 = 
Ãxt
;

114 
	`ä“
(
£t
);

115 
	}
}

117 
	$£t_size
(
št£t_t
 *
£t
)

119 
size
 = 0;

120 
node_t
 *
node
;

123 
node
 = 
£t
->
h—d
->
Ãxt
;

124 
node
->
Ãxt
 !ğ
NULL
) {

125 
size
++;

126 
node
 =‚ode->
Ãxt
;

129  
size
;

130 
	}
}

	@utils/estm-0.2.4.3/bench/lf-linkedlist/intset.h

23 
	~<as£¹.h
>

24 
	~<g‘İt.h
>

25 
	~<lim™s.h
>

26 
	~<±h»ad.h
>

27 
	~<sigÇl.h
>

28 
	~<¡dlib.h
>

29 
	~<¡dio.h
>

30 
	~<sys/time.h
>

31 
	~<time.h
>

32 
	~<¡dšt.h
>

34 
	~<©omic_İs.h
>

36 
	~"¡m.h
"

37 
	~"mod_mem.h
"

39 #ifdeà
DEBUG


40 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

49 
	#TX_START
(
ty³
è{ 
sigjmp_buf
 *
_e
 = 
	`¡m_g‘_’v
(); 
	`sig£tjmp
(*_e, 0); 
	`¡m_¡¬t
(_e, 0,y³)

	)

50 
	#TX_LOAD
(
addr
è
	`¡m_lßd
((
¡m_wÜd_t
 *ïddr)

	)

51 
	#TX_STORE
(
addr
, 
v®
è
	`¡m_¡Üe
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_t)v®)

	)

52 
	#TX_END
 
	`¡m_comm™
(); }

	)

54 
	#FREE
(
addr
, 
size
è
	`¡m_ä“
×ddr, size)

	)

56 
	#DEFAULT_DURATION
 10000

	)

57 
	#DEFAULT_INITIAL
 256

	)

58 
	#DEFAULT_NB_THREADS
 1

	)

59 
	#DEFAULT_RANGE
 0xFFFF

	)

60 
	#DEFAULT_SEED
 0

	)

61 
	#DEFAULT_UPDATE
 20

	)

63 
	#XSTR
(
s
è
	`STR
(s)

	)

64 
	#STR
(
s
è#s

	)

66 
	#ATOMIC_CAS_MB
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

72 vŞ©
AO_t
 
	g¡İ
;

78 
	#TRANSACTIONAL
 
d
->
un™_tx


	)

80 
šŒ_t
 
	tv®_t
;

81 
	#VAL_MIN
 
INT_MIN


	)

82 
	#VAL_MAX
 
INT_MAX


	)

84 
	snode
 {

85 
v®_t
 
	mv®
;

86 
node
 *
	mÃxt
;

87 } 
	tnode_t
;

89 
	sšt£t
 {

90 
node_t
 *
	mh—d
;

91 } 
	tšt£t_t
;

93 
node_t
 *
Ãw_node
(
v®_t
 
v®
,‚ode_ˆ*
Ãxt
, 
Œª§ùiÚ®
);

94 
št£t_t
 *
£t_Ãw
();

95 
£t_d–‘e
(
št£t_t
 *
£t
);

96 
£t_size
(
št£t_t
 *
£t
);

	@utils/estm-0.2.4.3/bench/lf-linkedlist/lf-ll.c

10 
	~"lškedli¡.h
"

17 
	sb¬r›r
 {

18 
±h»ad_cÚd_t
 
	mcom¶‘e
;

19 
±h»ad_mu‹x_t
 
	mmu‹x
;

20 
	mcouÁ
;

21 
	müossšg
;

22 } 
	tb¬r›r_t
;

24 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

26 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

27 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

28 
b
->
couÁ
 = 
n
;

29 
b
->
üossšg
 = 0;

30 
	}
}

32 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

34 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

36 
b
->
üossšg
++;

38 ià(
b
->
üossšg
 < b->
couÁ
) {

39 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

41 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

43 
b
->
üossšg
 = 0;

45 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

46 
	}
}

58 
šlše
 
	$¿nd_¿nge
(
r
) {

59 
m
 = 
RAND_MAX
;

60 
v
 = 0;

61 
d
;

64 
d
 = (
m
 > 
r
 ?„ : m);

65 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

66 
r
 -ğ
m
;

67 } 
r
 > 0);

68  
v
;

69 
	}
}

71 
	sth»ad_d©a
 {

72 
	m¿nge
;

73 
	mupd©e
;

74 #iâdeà
USE_RBTREE


75 
	mun™_tx
;

77 
	mnb_add
;

78 
	mnb_»move
;

79 
	mnb_cÚšs
;

80 
	mnb_found
;

81 
	mnb_abÜts
;

82 
	mnb_abÜts_locked_»ad
;

83 
	mnb_abÜts_locked_wr™e
;

84 
	mnb_abÜts_v®id©e_»ad
;

85 
	mnb_abÜts_v®id©e_wr™e
;

86 
	mnb_abÜts_v®id©e_comm™
;

87 
	mnb_abÜts_šv®id_memÜy
;

88 
	mnb_abÜts_doubË_wr™e
;

89 
	mmax_»Œ›s
;

90 
	mdiff
;

91 
	m£ed
;

92 
št£t_t
 *
	m£t
;

93 
b¬r›r_t
 *
	mb¬r›r
;

94 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

95 } 
	tth»ad_d©a_t
;

97 *
	$‹¡
(*
d©a
)

99 
v®
, 
Ï¡
 = 0;

100 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

103 
	`¡m_š™_th»ad
();

105 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

107 
Ï¡
 = -1;

108 
¡İ
 == 0) {

109 
v®
 = 
	`¿nd_r
(&
d
->
£ed
) % 100;

110 ià(
v®
 < 
d
->
upd©e
) {

111 ià(
Ï¡
 < 0) {

113 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

114 ià(
	`£t_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

115 
d
->
diff
++;

116 
Ï¡
 = 
v®
;

118 
d
->
nb_add
++;

121 ià(
	`£t_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
))

122 
d
->
diff
--;

123 
d
->
nb_»move
++;

124 
Ï¡
 = -1;

128 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

129 ià(
	`£t_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

130 
d
->
nb_found
++;

131 
d
->
nb_cÚšs
++;

135 
	`¡m_g‘_¡©s
("nb_abÜts", &
d
->
nb_abÜts
);

136 
	`¡m_g‘_¡©s
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
);

137 
	`¡m_g‘_¡©s
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
);

138 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
);

139 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
);

140 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
);

141 
	`¡m_g‘_¡©s
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
);

142 
	`¡m_g‘_¡©s
("nb_abÜts_doubË_wr™e", &
d
->
nb_abÜts_šv®id_memÜy
);

143 
	`¡m_g‘_¡©s
("max_»Œ›s", &
d
->
max_»Œ›s
);

145 
	`¡m_ex™_th»ad
();

147  
NULL
;

148 
	}
}

150 
	$ÿtch”
(
sig
)

152 
	`´štf
("CAUGHT SIGNAL %d\n", 
sig
);

153 
	}
}

155 
	$maš
(
¬gc
, **
¬gv
)

157 
İtiÚ
 
lÚg_İtiÚs
[] = {

159 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

160 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

161 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

162 {"num-th»ads", 
»quœed_¬gum’t
, 
NULL
, 'n'},

163 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

164 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 's'},

165 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

166 {"–a¡ic™y", 
»quœed_¬gum’t
, 
NULL
, 'x'},

167 {
NULL
, 0, NULL, 0}

170 
št£t_t
 *
£t
;

171 
i
, 
c
, 
v®
, 
size
;

172 *
s
;

173 
»ads
, 
upd©es
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

174 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

175 
abÜts_šv®id_memÜy
, 
abÜts_doubË_wr™e
, 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

176 
th»ad_d©a_t
 *
d©a
;

177 
±h»ad_t
 *
th»ads
;

178 
±h»ad_©Œ_t
 
©Œ
;

179 
b¬r›r_t
 
b¬r›r
;

180 
timev®
 
¡¬t
, 
’d
;

181 
time¥ec
 
timeout
;

182 
du¿tiÚ
 = 
DEFAULT_DURATION
;

183 
š™Ÿl
 = 
DEFAULT_INITIAL
;

184 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

185 
¿nge
 = 
DEFAULT_RANGE
;

186 
£ed
 = 
DEFAULT_SEED
;

187 
upd©e
 = 
DEFAULT_UPDATE
;

188 
un™_tx
 = 4;

189 
sig£t_t
 
block_£t
;

192 
i
 = 0;

193 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hd:i:n:r:s:u:x:", 
lÚg_İtiÚs
, &
i
);

195 if(
c
 == -1)

198 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

199 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

201 
c
) {

206 
	`´štf
("intset -- STM stressest "

216 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

218 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

220 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

222 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

224 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

226 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

237 
	`ex™
(0);

239 
du¿tiÚ
 = 
	`©oi
(
İrg
);

242 
š™Ÿl
 = 
	`©oi
(
İrg
);

245 
nb_th»ads
 = 
	`©oi
(
İrg
);

248 
¿nge
 = 
	`©oi
(
İrg
);

251 
£ed
 = 
	`©oi
(
İrg
);

254 
upd©e
 = 
	`©oi
(
İrg
);

256 #iâdeà
USE_RBTREE


258 
un™_tx
 = 
	`©oi
(
İrg
);

262 
	`´štf
("Use -h or --help for help\n");

263 
	`ex™
(0);

265 
	`ex™
(1);

269 
	`as£¹
(
du¿tiÚ
 >= 0);

270 
	`as£¹
(
š™Ÿl
 >= 0);

271 
	`as£¹
(
nb_th»ads
 > 0);

272 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

273 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

275 
	`´štf
("Setype :†inked†ist\n");

276 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

277 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

278 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

279 
	`´štf
("V®u¿ng : %d\n", 
¿nge
);

280 
	`´štf
("S“d : %d\n", 
£ed
);

281 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

282 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

283 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

287 ()(
¡m_wÜd_t
));

289 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

290 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

292 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

293 
	`³¼Ü
("malloc");

294 
	`ex™
(1);

296 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

297 
	`³¼Ü
("malloc");

298 
	`ex™
(1);

301 ià(
£ed
 == 0)

302 
	`¤ªd
(()
	`time
(0));

304 
	`¤ªd
(
£ed
);

306 
£t
 = 
	`£t_Ãw
();

307 
¡İ
 = 0;

310 
	`´štf
("Initializing STM\n");

311 
	`¡m_š™
();

312 
	`mod_mem_š™
();

314 ià(
	`¡m_g‘_·¿m‘”
("compe_æags", &
s
))

315 
	`´štf
("STM fÏg  : %s\n", 
s
);

318 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

319 
i
 = 0;

320 
i
 < 
š™Ÿl
) {

321 
v®
 = 
	`¿nd_¿nge
(
¿nge
);

322 ià(
	`£t_add
(
£t
, 
v®
, 0)) {

323 
i
++;

326 
size
 = 
	`£t_size
(
£t
);

327 
	`´štf
("S‘ siz : %d\n", 
size
);

330 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

331 
	`±h»ad_©Œ_š™
(&
©Œ
);

332 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

333 
i
 = 0; i < 
nb_th»ads
; i++) {

334 
	`´štf
("C»©šgh»ad %d\n", 
i
);

335 
d©a
[
i
].
¿nge
 =„ange;

336 
d©a
[
i
].
upd©e
 = update;

337 #iâdeà
USE_RBTREE


338 
d©a
[
i
].
un™_tx
 = unit_tx;

340 
d©a
[
i
].
nb_add
 = 0;

341 
d©a
[
i
].
nb_»move
 = 0;

342 
d©a
[
i
].
nb_cÚšs
 = 0;

343 
d©a
[
i
].
nb_found
 = 0;

344 
d©a
[
i
].
nb_abÜts
 = 0;

345 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

346 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

347 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

348 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

349 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

350 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

351 
d©a
[
i
].
nb_abÜts_doubË_wr™e
 = 0;

352 
d©a
[
i
].
max_»Œ›s
 = 0;

353 
d©a
[
i
].
diff
 = 0;

354 
d©a
[
i
].
£ed
 = 
	`¿nd
();

355 
d©a
[
i
].
£t
 = set;

356 
d©a
[
i
].
b¬r›r
 = &barrier;

357 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

358 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

359 
	`årštf
(
¡d”r
, "Error creatinghread\n");

360 
	`ex™
(1);

363 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

366 ià(
	`sigÇl
(
SIGHUP
, 
ÿtch”
è=ğ
SIG_ERR
 ||

367 
	`sigÇl
(
SIGINT
, 
ÿtch”
è=ğ
SIG_ERR
 ||

368 
	`sigÇl
(
SIGTERM
, 
ÿtch”
è=ğ
SIG_ERR
) {

369 
	`³¼Ü
("signal");

370 
	`ex™
(1);

374 
	`b¬r›r_üoss
(&
b¬r›r
);

376 
	`´štf
("STARTING...\n");

377 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

378 ià(
du¿tiÚ
 > 0) {

379 
	`Çno¦“p
(&
timeout
, 
NULL
);

381 
	`sigem±y£t
(&
block_£t
);

382 
	`sigsu¥’d
(&
block_£t
);

384 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

385 
	`g‘timeofday
(&
’d
, 
NULL
);

386 
	`´štf
("STOPPING...\n");

389 
i
 = 0; i < 
nb_th»ads
; i++) {

390 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

391 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

392 
	`ex™
(1);

396 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

397 
abÜts
 = 0;

398 
abÜts_locked_»ad
 = 0;

399 
abÜts_locked_wr™e
 = 0;

400 
abÜts_v®id©e_»ad
 = 0;

401 
abÜts_v®id©e_wr™e
 = 0;

402 
abÜts_v®id©e_comm™
 = 0;

403 
abÜts_šv®id_memÜy
 = 0;

404 
abÜts_doubË_wr™e
 = 0;

405 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

406 
»ads
 = 0;

407 
upd©es
 = 0;

408 
max_»Œ›s
 = 0;

409 
i
 = 0; i < 
nb_th»ads
; i++) {

410 
	`´štf
("Th»ad %d\n", 
i
);

411 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

412 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

413 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

414 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

415 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

416 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

417 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

418 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

419 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

420 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

421 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

422 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_doubË_wr™e
);

423 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

424 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

425 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

426 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

427 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

428 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

429 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

430 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

431 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

432 
abÜts_doubË_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_doubË_wr™e
;

433 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

434 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

435 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

436 
size
 +ğ
d©a
[
i
].
diff
;

437 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

438 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

440 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`£t_size
(
£t
), 
size
);

441 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

442 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
, (»ad + upd©esè* 1000.0 / 
du¿tiÚ
);

443 
	`´štf
("#»adx  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

444 
	`´štf
("#upd©tx  : %lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

445 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

446 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

447 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

448 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

449 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

450 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

451 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

452 
	`´štf
(" #dup-w : %lu (%à/ s)\n", 
abÜts_doubË_wr™e
,‡bÜts_doubË_wr™* 1000.0 / 
du¿tiÚ
);

453 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

454 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

457 
	`£t_d–‘e
(
£t
);

460 
	`¡m_ex™
();

462 
	`ä“
(
th»ads
);

463 
	`ä“
(
d©a
);

466 
	}
}

	@utils/estm-0.2.4.3/bench/lf-linkedlist/linkedlist.c

24 
	~"lškedli¡.h
"

26 
	$£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

28 
»suÉ
;

29 
node_t
 *
´ev
, *
Ãxt
;

30 
v®_t
 
v
;

32 #ifdeà
DEBUG


33 
	`´štf
("++> s‘_cÚšs(%d)\n", ()
v®
);

34 
IO_FLUSH
;

37 
Œª§ùiÚ®
) {

39 
´ev
 = 
£t
->
h—d
;

40 
Ãxt
 = 
´ev
->next;

41 
Ãxt
->
v®
 < val) {

42 
´ev
 = 
Ãxt
;

43 
Ãxt
 = 
´ev
->next;

45 
»suÉ
 = (
Ãxt
->
v®
 == val);

49 
	`TX_START
(
NL
);

50 
´ev
 = 
£t
->
h—d
;

51 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

53 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

54 ià(
v
 >ğ
v®
)

56 
´ev
 = 
Ãxt
;

57 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

59 
»suÉ
 = (
v
 =ğ
v®
);

60 
TX_END
;

66 
	`TX_START
(
EL
);

67 
´ev
 = 
£t
->
h—d
;

68 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

70 
v
 = 
	`TX_LOAD
((
¡m_wÜd_t
 *è&
Ãxt
->
v®
);

71 ià(
v
 >ğ
v®
)

73 
´ev
 = 
Ãxt
;

74 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

76 
TX_END
;

77 
»suÉ
 = (
v
 =ğ
v®
);

81 
»suÉ
 = 
	`h¬ris_fšd
(
£t
, 
v®
);

85 
»suÉ
=0;

86 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

87 
	`ex™
(1);

90  
»suÉ
;

91 
	}
}

93 
	$£t_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

95 
»suÉ
;

96 
node_t
 *
´ev
, *
Ãxt
;

97 
v®_t
 
v
;

99 #ifdeà
DEBUG


100 
	`´štf
("++> s‘_add(%d)\n", ()
v®
);

101 
IO_FLUSH
;

104 
Œª§ùiÚ®
) {

106 
´ev
 = 
£t
->
h—d
;

107 
Ãxt
 = 
´ev
->next;

108 
Ãxt
->
v®
 < val) {

109 
´ev
 = 
Ãxt
;

110 
Ãxt
 = 
´ev
->next;

112 
»suÉ
 = (
Ãxt
->
v®
 != val);

113 ià(
»suÉ
) {

114 
´ev
->
Ãxt
 = 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
);

120 
	`TX_START
(
NL
);

121 
´ev
 = 
£t
->
h—d
;

122 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

124 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

125 ià(
v
 >ğ
v®
)

127 
´ev
 = 
Ãxt
;

128 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

130 
»suÉ
 = (
v
 !ğ
v®
);

131 ià(
»suÉ
) {

132 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
));

134 
TX_END
;

139 
	`TX_START
(
EL
);

140 
´ev
 = 
£t
->
h—d
;

141 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

143 
v
 = 
	`TX_LOAD
((
¡m_wÜd_t
 *è&
Ãxt
->
v®
);

144 ià(
v
 >ğ
v®
)

146 
´ev
 = 
Ãxt
;

147 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

149 
»suÉ
 = (
v
 !ğ
v®
);

150 ià(
»suÉ
) {

151 
	`TX_STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
));

153 
TX_END
;

157 
»suÉ
 = 
	`h¬ris_š£¹
(
£t
, 
v®
);

161 
»suÉ
=0;

162 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

163 
	`ex™
(1);

166  
»suÉ
;

167 
	}
}

169 
	$£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

171 
»suÉ
;

172 
node_t
 *
´ev
, *
Ãxt
;

173 
v®_t
 
v
;

174 
node_t
 *
n
;

176 #ifdeà
DEBUG


177 
	`´štf
("++> s‘_»move(%d)\n", ()
v®
);

178 
IO_FLUSH
;

181 
Œª§ùiÚ®
) {

183 
´ev
 = 
£t
->
h—d
;

184 
Ãxt
 = 
´ev
->next;

185 
Ãxt
->
v®
 < val) {

186 
´ev
 = 
Ãxt
;

187 
Ãxt
 = 
´ev
->next;

189 
»suÉ
 = (
Ãxt
->
v®
 == val);

190 ià(
»suÉ
) {

191 
´ev
->
Ãxt
 =‚ext->next;

192 
	`ä“
(
Ãxt
);

199 
	`TX_START
(
NL
);

200 
´ev
 = 
£t
->
h—d
;

201 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

203 
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
);

204 ià(
v
 >ğ
v®
)

206 
´ev
 = 
Ãxt
;

207 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

209 
»suÉ
 = (
v
 =ğ
v®
);

210 ià(
»suÉ
) {

211 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

212 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

213 
	`FREE
(
Ãxt
, (
node_t
));

215 
TX_END
;

219 
	`TX_START
(
EL
);

220 
´ev
 = 
£t
->
h—d
;

221 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

223 
v
 = 
	`TX_LOAD
((
¡m_wÜd_t
 *è&
Ãxt
->
v®
);

224 ià(
v
 >ğ
v®
)

226 
´ev
 = 
Ãxt
;

227 
Ãxt
 = (
node_t
 *)
	`TX_LOAD
(&
´ev
->next);

229 
»suÉ
 = (
v
 =ğ
v®
);

230 ià(
»suÉ
) {

231 
n
 = (
node_t
 *)
	`TX_LOAD
(&
Ãxt
->next);

232 
	`TX_STORE
(&
´ev
->
Ãxt
, 
n
);

233 
	`FREE
(
Ãxt
, (
node_t
));

235 
TX_END
;

239 
»suÉ
 = 
	`h¬ris_d–‘e
(
£t
, 
v®
);

243 
»suÉ
=0;

244 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

245 
	`ex™
(1);

248  
»suÉ
;

249 
	}
}

	@utils/estm-0.2.4.3/bench/lf-linkedlist/linkedlist.h

10 
	~"h¬ris.h
"

12 
£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

13 
£t_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

14 
£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
);

	@utils/estm-0.2.4.3/bench/lf-linkedlist/recursive.c

11 
	~"»cursive.h
"

13 
	$»c_£¬ch
(
¡m_wÜd_t
 *
¡¬t_ts
, 
node_t
 *
´ev
,‚ode_ˆ*
Ãxt
,

14 
v®_t
 
v®
, v®_ˆ*
v
) {

15 
¡m_wÜd_t
 
ts
, 
cu¼_ts
;

16 
node_t
 *
cu¼
;

17 
»suÉ
=0;

19 *
v
 = 
	`UNIT_LOAD
(&
Ãxt
->
v®
, &
ts
);

21 ià(
ts
 > *
¡¬t_ts
 || !
Ãxt
->next) {

22  (è
ts
;

26 ià(*
v
 >ğ
v®
)

30 
cu¼
 = 
Ãxt
;

31 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&Ãxt->Ãxt, &
ts
);

32 ià(
ts
 > *
¡¬t_ts
) {

34 
	`UNIT_LOAD
(&
cu¼
->
v®
, &
cu¼_ts
);

35 ià(
cu¼_ts
 > *
¡¬t_ts
) {

36  (è
cu¼_ts
;

38 *
¡¬t_ts
 = 
ts
;

42 
»¡¬t5
:

43 ià(!(
»suÉ
 = 
	`»c_£¬ch
(
¡¬t_ts
, 
cu¼
, 
Ãxt
, 
v®
, 
v
)))  0;

45 
	`UNIT_LOAD
(&
Ãxt
, &
ts
);

47 ià(
ts
 > *
¡¬t_ts
)  1;

49 *
¡¬t_ts
 = 
»suÉ
;

50 
»¡¬t5
;

53 
	}
}

56 
	$»c_£¬ch2
(
¡m_wÜd_t
 *
¡¬t_ts
, 
node_t
 **
´ev
,‚ode_ˆ**
Ãxt
,

57 
v®_t
 
v®
, v®_ˆ*
v
) {

58 
¡m_wÜd_t
 
ts
, 
cu¼_ts
;

59 
»suÉ
=0;

61 *
v
 = 
	`UNIT_LOAD
(&(*
Ãxt
)->
v®
, &
ts
);

63 ià(
ts
 > *
¡¬t_ts
 || !(*
Ãxt
)->next)

64  (è
ts
;

67 ià(*
v
 >ğ
v®
)

71 *
´ev
 = *
Ãxt
;

72 *
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&(*Ãxt)->Ãxt, &
ts
);

73 ià(
ts
 > *
¡¬t_ts
) {

75 
	`UNIT_LOAD
(&(*
´ev
)->
v®
, &
cu¼_ts
);

76 ià(
cu¼_ts
 > *
¡¬t_ts
) {

77  (è
cu¼_ts
;

79 *
¡¬t_ts
 = 
ts
;

83 
»¡¬t4
:

84 ià(!(
»suÉ
 = 
	`»c_£¬ch2
(
¡¬t_ts
, 
´ev
, 
Ãxt
, 
v®
, 
v
)))  0;

88 ià(
»suÉ
 > *
¡¬t_ts
)  1;

90 *
¡¬t_ts
 = 
»suÉ
;

91 
»¡¬t4
;

94 
	}
}

	@utils/estm-0.2.4.3/bench/lf-linkedlist/recursive.h

10 
	~"h¬ris.h
"

14 
»c_£¬ch
(
¡m_wÜd_t
 *
¡¬t_ts
, 
node_t
 *
´ev
,‚ode_ˆ*
Ãxt
,

15 
v®_t
 
v®
, v®_ˆ*
v
);

16 
»c_£¬ch2
(
¡m_wÜd_t
 *
¡¬t_ts
, 
node_t
 **
´ev
,‚ode_ˆ**
Ãxt
,

17 
v®_t
 
v®
, v®_ˆ*
v
);

	@utils/estm-0.2.4.3/bench/lf-rbtree/intset.c

23 
	~<as£¹.h
>

24 
	~<g‘İt.h
>

25 
	~<lim™s.h
>

26 
	~<±h»ad.h
>

27 
	~<sigÇl.h
>

28 
	~<¡dlib.h
>

29 
	~<¡dio.h
>

30 
	~<sys/time.h
>

31 
	~<time.h
>

33 
	~<©omic_İs.h
>

35 
	~"¡m.h
"

36 
	~"mod_mem.h
"

38 #ifdeà
DEBUG


39 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

49 
	#TX_START
(
ty³
è{ 
sigjmp_buf
 *
_e
 = 
	`¡m_g‘_’v
(); 
	`sig£tjmp
(*_e, 0); 
	`¡m_¡¬t
(_e, 0,y³)

	)

50 
	#TX_LOAD
(
addr
è
	`¡m_lßd
((
¡m_wÜd_t
 *ïddr)

	)

51 
	#TX_STORE
(
addr
, 
v®
è
	`¡m_¡Üe
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_t)v®)

	)

52 
	#TX_END
 
	`¡m_comm™
(); }

	)

54 
	#MALLOC
(
size
è
	`¡m_m®loc
(size)

	)

55 
	#FREE
(
addr
, 
size
è
	`¡m_ä“
×ddr, size)

	)

57 
	#DEFAULT_DURATION
 10000

	)

58 
	#DEFAULT_INITIAL
 256

	)

59 
	#DEFAULT_NB_THREADS
 1

	)

60 
	#DEFAULT_RANGE
 0xFFFF

	)

61 
	#DEFAULT_SEED
 0

	)

62 
	#DEFAULT_UPDATE
 20

	)

64 
	#XSTR
(
s
è
	`STR
(s)

	)

65 
	#STR
(
s
è#s

	)

71 vŞ©
AO_t
 
	g¡İ
;

77 #ifdeà
TLS


78 
__th»ad
 *
	gºg_£ed
;

80 
±h»ad_key_t
 
	gºg_£ed_key
;

87 
	#TRANSACTIONAL
 
d
->
un™_tx


	)

89 
	#INIT_SET_PARAMETERS


	)

91 
	#TM_ARGDECL_ALONE


	)

92 
	#TM_ARGDECL


	)

93 
	#TM_ARG


	)

94 
	#TM_ARG_ALONE


	)

95 
	#TM_CALLABLE


	)

97 
	#TM_SHARED_READ
(
v¬
è
	`TX_LOAD
(&(v¬))

	)

98 
	#TM_SHARED_READ_P
(
v¬
è
	`TX_LOAD
(&(v¬))

	)

100 
	#TM_SHARED_WRITE
(
v¬
, 
v®
è
	`TX_STORE
(&(v¬), v®)

	)

101 
	#TM_SHARED_WRITE_P
(
v¬
, 
v®
è
	`TX_STORE
(&(v¬), v®)

	)

103 
	#TM_MALLOC
(
size
è
	`MALLOC
(size)

	)

104 
	#TM_FREE
(
±r
è
	`FREE
ÕŒ, (*±r))

	)

106 
	~"rbŒ“.h
"

108 
	~"rbŒ“.c
"

110 
rbŒ“_t
 
	tšt£t_t
;

111 
šŒ_t
 
	tv®_t
;

113 
	$com·»
(cÚ¡ *
a
, cÚ¡ *
b
)

115  ((
v®_t
)
a
 - (v®_t)
b
);

116 
	}
}

118 
št£t_t
 *
	$£t_Ãw
()

120  
	`rbŒ“_®loc
(&
com·»
);

121 
	}
}

123 
	$£t_d–‘e
(
št£t_t
 *
£t
)

125 
	`rbŒ“_ä“
(
£t
);

126 
	}
}

128 
	$£t_size
(
št£t_t
 *
£t
)

130 
size
;

131 
node_t
 *
n
;

133 ià(!
	`rbŒ“_v”ify
(
£t
, 0)) {

134 
	`´štf
("Validation failed!\n");

135 
	`ex™
(1);

138 
size
 = 0;

139 
n
 = 
	`fœ¡EÁry
(
£t
);‚ !ğ
NULL
;‚ = 
	`sucûssÜ
(n))

140 
size
++;

142  
size
;

143 
	}
}

145 
	$£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

147 
»suÉ
 = 0;

148 *
v
;

150 
v
 = (*)
v®
;

152 
Œª§ùiÚ®
) {

154 
»suÉ
 = 
	`rbŒ“_cÚšs
(
£t
, 
v
);

158 
	`TX_START
(
NL
);

159 
»suÉ
 = 
	`TMrbŒ“_cÚšs
(
£t
, (*)
v®
);

160 
TX_END
;

166 
	`TX_START
(
EL
);

167 
»suÉ
 = 
	`TMrbŒ“_cÚšs
(
£t
, (*)
v®
);

168 
TX_END
;

172 
»suÉ
=0;

173 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

174 
	`ex™
(1);

176  
»suÉ
;

177 
	}
}

184 
	$£t_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

186 
»suÉ
 = 0;

188 
Œª§ùiÚ®
) {

190 
»suÉ
 = 
	`rbŒ“_š£¹
(
£t
, (*)
v®
, (*)val);

197 
	`TX_START
(
NL
);

198 
»suÉ
 = 
	`TMrbŒ“_š£¹
(
£t
, (*)
v®
, (*)val);

199 
TX_END
;

203 
»suÉ
=0;

204 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

205 
	`ex™
(1);

208  
»suÉ
;

209 
	}
}

211 
	$£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

213 
»suÉ
 = 0;

214 
node_t
 *
Ãxt
;

215 *
v
;

217 
Ãxt
 = 
NULL
;

218 
v
 = (*è
v®
;

220 
Œª§ùiÚ®
) {

222 
»suÉ
 = 
	`rbŒ“_d–‘e
(
£t
, (*)
v®
);

228 
	`TX_START
(
NL
);

229 
»suÉ
 = 
	`TMrbŒ“_d–‘e
(
£t
, (*)
v®
);

230 
TX_END
;

234 
	`TX_START
(
EL
);

235 
»suÉ
 = 
	`TMrbŒ“_d–‘e
(
£t
, (*)
v®
);

236 
TX_END
;

240 
»suÉ
=0;

241 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

242 
	`ex™
(1);

244  
»suÉ
;

245 
	}
}

251 
	sb¬r›r
 {

252 
±h»ad_cÚd_t
 
	mcom¶‘e
;

253 
±h»ad_mu‹x_t
 
	mmu‹x
;

254 
	mcouÁ
;

255 
	müossšg
;

256 } 
	tb¬r›r_t
;

258 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

260 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

261 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

262 
b
->
couÁ
 = 
n
;

263 
b
->
üossšg
 = 0;

264 
	}
}

266 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

268 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

270 
b
->
üossšg
++;

272 ià(
b
->
üossšg
 < b->
couÁ
) {

273 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

275 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

277 
b
->
üossšg
 = 0;

279 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

280 
	}
}

292 
šlše
 
	$¿nd_¿nge
(
r
) {

293 
m
 = 
RAND_MAX
;

294 
v
 = 0;

295 
d
;

298 
d
 = (
m
 > 
r
 ?„ : m);

299 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

300 
r
 -ğ
m
;

301 } 
r
 > 0);

302  
v
;

303 
	}
}

305 
	sth»ad_d©a
 {

306 
	m¿nge
;

307 
	mupd©e
;

308 
	mun™_tx
;

309 
	mnb_add
;

310 
	mnb_»move
;

311 
	mnb_cÚšs
;

312 
	mnb_found
;

313 
	mnb_abÜts
;

314 
	mnb_abÜts_locked_»ad
;

315 
	mnb_abÜts_locked_wr™e
;

316 
	mnb_abÜts_v®id©e_»ad
;

317 
	mnb_abÜts_v®id©e_wr™e
;

318 
	mnb_abÜts_v®id©e_comm™
;

319 
	mnb_abÜts_šv®id_memÜy
;

320 
	mnb_abÜts_»®loÿ‹
;

321 
	mnb_abÜts_rŞlov”
;

322 
	mlocked_»ads_ok
;

323 
	mlocked_»ads_çed
;

324 
	mmax_»Œ›s
;

325 
	mdiff
;

326 
	m£ed
;

327 
št£t_t
 *
	m£t
;

328 
b¬r›r_t
 *
	mb¬r›r
;

329 } 
	tth»ad_d©a_t
;

331 *
	$‹¡
(*
d©a
)

333 
v®
, 
Ï¡
 = 0;

334 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

336 #ifdeà
TLS


337 
ºg_£ed
 = &
d
->
£ed
;

339 
	`±h»ad_£t¥ecific
(
ºg_£ed_key
, &
d
->
£ed
);

343 
	`¡m_š™_th»ad
();

345 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

347 
Ï¡
 = -1;

348 
¡İ
 == 0) {

349 
v®
 = 
	`¿nd_r
(&
d
->
£ed
) % 100;

350 ià(
v®
 < 
d
->
upd©e
) {

351 ià(
Ï¡
 < 0) {

353 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

354 ià(
	`£t_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

355 
d
->
diff
++;

356 
Ï¡
 = 
v®
;

358 
d
->
nb_add
++;

361 ià(
	`£t_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
))

362 
d
->
diff
--;

363 
d
->
nb_»move
++;

364 
Ï¡
 = -1;

368 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

369 ià(
	`£t_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

370 
d
->
nb_found
++;

371 
d
->
nb_cÚšs
++;

374 
	`¡m_g‘_¡©s
("nb_abÜts", &
d
->
nb_abÜts
);

375 
	`¡m_g‘_¡©s
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
);

376 
	`¡m_g‘_¡©s
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
);

377 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
);

378 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
);

379 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
);

380 
	`¡m_g‘_¡©s
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
);

381 
	`¡m_g‘_¡©s
("nb_abÜts_»®loÿ‹", &
d
->
nb_abÜts_»®loÿ‹
);

382 
	`¡m_g‘_¡©s
("nb_abÜts_rŞlov”", &
d
->
nb_abÜts_rŞlov”
);

383 
	`¡m_g‘_¡©s
("locked_»ads_ok", &
d
->
locked_»ads_ok
);

384 
	`¡m_g‘_¡©s
("locked_»ads_çed", &
d
->
locked_»ads_çed
);

385 
	`¡m_g‘_¡©s
("max_»Œ›s", &
d
->
max_»Œ›s
);

387 
	`¡m_ex™_th»ad
();

389  
NULL
;

390 
	}
}

392 
	$ÿtch”
(
sig
)

394 
	`´štf
("CAUGHT SIGNAL %d\n", 
sig
);

395 
	}
}

397 
	$maš
(
¬gc
, **
¬gv
)

399 
İtiÚ
 
lÚg_İtiÚs
[] = {

401 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

402 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

403 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

404 {"num-th»ads", 
»quœed_¬gum’t
, 
NULL
, 'n'},

405 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

406 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 's'},

407 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

408 {"un™-tx", 
no_¬gum’t
, 
NULL
, 'x'},

409 {
NULL
, 0, NULL, 0}

412 
št£t_t
 *
£t
;

413 
i
, 
c
, 
v®
, 
size
;

414 *
s
;

415 
»ads
, 
upd©es
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

416 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

417 
abÜts_šv®id_memÜy
, 
abÜts_»®loÿ‹
, 
abÜts_rŞlov”
,

418 
locked_»ads_ok
, 
locked_»ads_çed
, 
max_»Œ›s
;

419 
th»ad_d©a_t
 *
d©a
;

420 
±h»ad_t
 *
th»ads
;

421 
±h»ad_©Œ_t
 
©Œ
;

422 
b¬r›r_t
 
b¬r›r
;

423 
timev®
 
¡¬t
, 
’d
;

424 
time¥ec
 
timeout
;

425 
du¿tiÚ
 = 
DEFAULT_DURATION
;

426 
š™Ÿl
 = 
DEFAULT_INITIAL
;

427 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

428 
¿nge
 = 
DEFAULT_RANGE
;

429 
£ed
 = 
DEFAULT_SEED
;

430 
upd©e
 = 
DEFAULT_UPDATE
;

431 
un™_tx
 = 4;

432 
sig£t_t
 
block_£t
;

435 
i
 = 0;

436 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hd:i:n:r:s:u:x:", 
lÚg_İtiÚs
, &
i
);

438 if(
c
 == -1)

441 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

442 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

444 
c
) {

449 
	`´štf
("intset -- STM stressest "

459 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

461 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

463 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

465 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

467 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

469 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

478 
	`ex™
(0);

480 
du¿tiÚ
 = 
	`©oi
(
İrg
);

483 
š™Ÿl
 = 
	`©oi
(
İrg
);

486 
nb_th»ads
 = 
	`©oi
(
İrg
);

489 
¿nge
 = 
	`©oi
(
İrg
);

492 
£ed
 = 
	`©oi
(
İrg
);

495 
upd©e
 = 
	`©oi
(
İrg
);

498 
un™_tx
 = 
	`©oi
(
İrg
);

501 
	`´štf
("Use -h or --help for help\n");

502 
	`ex™
(0);

504 
	`ex™
(1);

508 
	`as£¹
(
du¿tiÚ
 >= 0);

509 
	`as£¹
(
š™Ÿl
 >= 0);

510 
	`as£¹
(
nb_th»ads
 > 0);

511 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

512 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

514 
	`´štf
("Setype :„ed-blackree\n");

515 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

516 
	`´štf
("In™ŸÈsiz: %d\n", 
š™Ÿl
);

517 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

518 
	`´štf
("V®u¿ng : %d\n", 
¿nge
);

519 
	`´štf
("S“d : %d\n", 
£ed
);

520 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

521 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

522 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

526 ()(
¡m_wÜd_t
));

528 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

529 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

531 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

532 
	`³¼Ü
("malloc");

533 
	`ex™
(1);

535 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

536 
	`³¼Ü
("malloc");

537 
	`ex™
(1);

540 ià(
£ed
 == 0)

541 
	`¤ªd
(()
	`time
(0));

543 
	`¤ªd
(
£ed
);

545 
£t
 = 
	`£t_Ãw
(
INIT_SET_PARAMETERS
);

547 
¡İ
 = 0;

550 
	`´štf
("Initializing STM\n");

551 
	`¡m_š™
();

552 
	`mod_mem_š™
();

554 ià(
	`¡m_g‘_·¿m‘”
("compe_æags", &
s
))

555 
	`´štf
("STM fÏg  : %s\n", 
s
);

558 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

559 
i
 = 0;

560 
i
 < 
š™Ÿl
) {

561 
v®
 = 
	`¿nd_¿nge
(
¿nge
);

563 ià(
	`£t_add
(
£t
, 
v®
, 0))

564 
i
++;

566 
size
 = 
	`£t_size
(
£t
);

567 
	`´štf
("S‘ siz : %d\n", 
size
);

570 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

571 
	`±h»ad_©Œ_š™
(&
©Œ
);

572 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

573 
i
 = 0; i < 
nb_th»ads
; i++) {

574 
	`´štf
("C»©šgh»ad %d\n", 
i
);

575 
d©a
[
i
].
¿nge
 =„ange;

576 
d©a
[
i
].
upd©e
 = update;

577 
d©a
[
i
].
un™_tx
 = unit_tx;

578 
d©a
[
i
].
nb_add
 = 0;

579 
d©a
[
i
].
nb_»move
 = 0;

580 
d©a
[
i
].
nb_cÚšs
 = 0;

581 
d©a
[
i
].
nb_found
 = 0;

582 
d©a
[
i
].
nb_abÜts
 = 0;

583 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

584 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

585 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

586 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

587 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

588 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

589 
d©a
[
i
].
nb_abÜts_»®loÿ‹
 = 0;

590 
d©a
[
i
].
nb_abÜts_rŞlov”
 = 0;

591 
d©a
[
i
].
locked_»ads_ok
 = 0;

592 
d©a
[
i
].
locked_»ads_çed
 = 0;

593 
d©a
[
i
].
max_»Œ›s
 = 0;

594 
d©a
[
i
].
diff
 = 0;

595 
d©a
[
i
].
£ed
 = 
	`¿nd
();

596 
d©a
[
i
].
£t
 = set;

597 
d©a
[
i
].
b¬r›r
 = &barrier;

598 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

599 
	`årštf
(
¡d”r
, "Error creatinghread\n");

600 
	`ex™
(1);

603 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

606 ià(
	`sigÇl
(
SIGHUP
, 
ÿtch”
è=ğ
SIG_ERR
 ||

607 
	`sigÇl
(
SIGINT
, 
ÿtch”
è=ğ
SIG_ERR
 ||

608 
	`sigÇl
(
SIGTERM
, 
ÿtch”
è=ğ
SIG_ERR
) {

609 
	`³¼Ü
("signal");

610 
	`ex™
(1);

614 
	`b¬r›r_üoss
(&
b¬r›r
);

616 
	`´štf
("STARTING...\n");

617 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

618 ià(
du¿tiÚ
 > 0) {

619 
	`Çno¦“p
(&
timeout
, 
NULL
);

621 
	`sigem±y£t
(&
block_£t
);

622 
	`sigsu¥’d
(&
block_£t
);

624 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

625 
	`g‘timeofday
(&
’d
, 
NULL
);

626 
	`´štf
("STOPPING...\n");

629 
i
 = 0; i < 
nb_th»ads
; i++) {

630 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

631 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

632 
	`ex™
(1);

636 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

637 
abÜts
 = 0;

638 
abÜts_locked_»ad
 = 0;

639 
abÜts_locked_wr™e
 = 0;

640 
abÜts_v®id©e_»ad
 = 0;

641 
abÜts_v®id©e_wr™e
 = 0;

642 
abÜts_v®id©e_comm™
 = 0;

643 
abÜts_šv®id_memÜy
 = 0;

644 
abÜts_»®loÿ‹
 = 0;

645 
abÜts_rŞlov”
 = 0;

646 
locked_»ads_ok
 = 0;

647 
locked_»ads_çed
 = 0;

648 
»ads
 = 0;

649 
upd©es
 = 0;

650 
max_»Œ›s
 = 0;

651 
i
 = 0; i < 
nb_th»ads
; i++) {

652 
	`´štf
("Th»ad %d\n", 
i
);

653 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

654 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

655 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

656 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

657 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

658 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

659 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

660 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

661 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

662 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

663 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

664 
	`´štf
(" #»®loø : %lu\n", 
d©a
[
i
].
nb_abÜts_»®loÿ‹
);

665 
	`´štf
(" #r-ov” : %lu\n", 
d©a
[
i
].
nb_abÜts_rŞlov”
);

666 
	`´štf
(" #Ì-ok : %lu\n", 
d©a
[
i
].
locked_»ads_ok
);

667 
	`´štf
(" #Ì-çed : %lu\n", 
d©a
[
i
].
locked_»ads_çed
);

668 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

669 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

670 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

671 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

672 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

673 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

674 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

675 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

676 
abÜts_»®loÿ‹
 +ğ
d©a
[
i
].
nb_abÜts_»®loÿ‹
;

677 
abÜts_rŞlov”
 +ğ
d©a
[
i
].
nb_abÜts_rŞlov”
;

678 
locked_»ads_ok
 +ğ
d©a
[
i
].locked_reads_ok;

679 
locked_»ads_çed
 +ğ
d©a
[
i
].locked_reads_failed;

680 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

681 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

682 
size
 +ğ
d©a
[
i
].
diff
;

683 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

684 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

686 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`£t_size
(
£t
), 
size
);

687 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

688 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
, (»ad + upd©esè* 1000.0 / 
du¿tiÚ
);

689 
	`´štf
("#»adx  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

690 
	`´štf
("#upd©tx  : %lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

691 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

692 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

693 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

694 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

695 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

696 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

697 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

698 
	`´štf
(" #»®loø : %lu (%à/ s)\n", 
abÜts_»®loÿ‹
,‡bÜts_»®loÿ‹ * 1000.0 / 
du¿tiÚ
);

699 
	`´štf
(" #r-ov” : %lu (%à/ s)\n", 
abÜts_rŞlov”
,‡bÜts_rŞlov” * 1000.0 / 
du¿tiÚ
);

700 
	`´štf
("#Ì-ok : %lu (%à/ s)\n", 
locked_»ads_ok
,†ocked_»ads_ok * 1000.0 / 
du¿tiÚ
);

701 
	`´štf
("#Ì-çed : %lu (%à/ s)\n", 
locked_»ads_çed
,†ocked_»ads_çed * 1000.0 / 
du¿tiÚ
);

702 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

705 
	`£t_d–‘e
(
£t
);

708 
	`¡m_ex™
();

710 #iâdeà
TLS


711 
	`±h»ad_key_d–‘e
(
ºg_£ed_key
);

714 
	`ä“
(
th»ads
);

715 
	`ä“
(
d©a
);

718 
	}
}

	@utils/estm-0.2.4.3/bench/lf-rbtree/rbtree.c

83 
	~<¡ršg.h
>

84 
	~<¡dio.h
>

85 
	~<¡dlib.h
>

86 
	~<š‰y³s.h
>

87 
	~"memÜy.h
"

88 
	~"rbŒ“.h
"

92 
	snode
 {

93 * 
	mk
;

94 * 
	mv
;

95 
node
* 
	mp
;

96 
node
* 
	ml
;

97 
node
* 
	mr
;

98 
	mc
;

99 } 
	tnode_t
;

102 
	srbŒ“
 {

103 
node_t
* 
	mroÙ
;

104 (*
	mcom·»
)(const *, const *);

107 
	#LDA
(
a
è*×)

	)

108 
	#STA
(
a
,
v
è*×èğ(v)

	)

109 
	#LDV
(
a
è×)

	)

110 
	#STV
(
a
,
v
è×èğ(v)

	)

111 
	#LDF
(
o
,
f
è((o)->f)

	)

112 
	#STF
(
o
,
f
,
v
è((o)->fèğ(v)

	)

113 
	#LDNODE
(
o
,
f
è((
node_t
*)(
	`LDF
((o),f)))

	)

115 
	#TX_LDA
(
a
è
	`TM_SHARED_READ
(*×))

	)

116 
	#TX_STA
(
a
,
v
è
	`TM_SHARED_WRITE
(*×), v)

	)

117 
	#TX_LDV
(
a
è
	`TM_SHARED_READ
×)

	)

118 
	#TX_STV
(
a
,
v
è
	`TM_SHARED_WRITE_P
×, v)

	)

119 
	#TX_LDF
(
o
,
f
è(()
	`TM_SHARED_READ
((o)->f))

	)

120 
	#TX_LDF_P
(
o
,
f
è((*)
	`TM_SHARED_READ_P
((o)->f))

	)

121 
	#TX_STF
(
o
,
f
,
v
è
	`TM_SHARED_WRITE
((o)->f, v)

	)

122 
	#TX_STF_P
(
o
,
f
,
v
è
	`TM_SHARED_WRITE_P
((o)->f, v)

	)

123 
	#TX_LDNODE
(
o
,
f
è((
node_t
*)(
	`TX_LDF_P
((o),f)))

	)

133 
TM_CALLABLE


134 
node_t
*

135 
TMlookup
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, * 
k
);

137 
TM_CALLABLE


139 
TMrÙ©eLeá
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
x
);

141 
TM_CALLABLE


143 
TMrÙ©eRight
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
x
);

145 
TM_CALLABLE


146 
šlše
 
node_t
*

147 
TM·»ÁOf
 (
TM_ARGDECL
 
node_t
* 
n
);

149 
TM_CALLABLE


150 
šlše
 
node_t
*

151 
TMËáOf
 (
TM_ARGDECL
 
node_t
* 
n
);

153 
TM_CALLABLE


154 
šlše
 
node_t
*

155 
TMrightOf
 (
TM_ARGDECL
 
node_t
* 
n
);

157 
TM_CALLABLE


158 
šlše
 

159 
TMcŞÜOf
 (
TM_ARGDECL
 
node_t
* 
n
);

161 
TM_CALLABLE


162 
šlše
 

163 
TM£tCŞÜ
 (
TM_ARGDECL
 
node_t
* 
n
, 
c
);

165 
TM_CALLABLE


167 
TMfixAá”In£¹iÚ
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
x
);

169 
TM_CALLABLE


170 
node_t
*

171 
TMsucûssÜ
 (
TM_ARGDECL
 
node_t
* 
t
);

173 
TM_CALLABLE


175 
TMfixAá”D–‘iÚ
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
x
);

177 
TM_CALLABLE


178 
node_t
*

179 
TMš£¹
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, * 
k
, * 
v
, 
node_t
* 
n
);

181 
TM_CALLABLE


182 
node_t
*

183 
TMg‘Node
 (
TM_ARGDECL_ALONE
);

185 
TM_CALLABLE


186 
node_t
*

187 
TMd–‘e
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
p
);

190 
	mRED
 = 0,

191 
	mBLACK
 = 1

213 
node_t
*

214 
	$lookup
 (
rbŒ“_t
* 
s
, * 
k
)

216 
node_t
* 
p
 = 
	`LDNODE
(
s
, 
roÙ
);

218 
p
 !ğ
NULL
) {

219 
cmp
 = 
s
->
	`com·»
(
k
, 
	`LDF
(
p
, k));

220 ià(
cmp
 == 0) {

221  
p
;

223 
p
 = ((
cmp
 < 0è? 
	`LDNODE
Õ, 
l
è: LDNODEÕ, 
r
));

226  
NULL
;

227 
	}
}

228 
	#LOOKUP
(
£t
, 
key
è
	`lookup
(£t, key)

	)

235 
node_t
*

236 
	$TMlookup
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, * 
k
)

238 
node_t
* 
p
 = 
	`TX_LDNODE
(
s
, 
roÙ
);

240 
p
 !ğ
NULL
) {

241 
cmp
 = 
s
->
	`com·»
(
k
, 
	`TX_LDF_P
(
p
, k));

242 ià(
cmp
 == 0) {

243  
p
;

245 
p
 = ((
cmp
 < 0è? 
	`TX_LDNODE
Õ, 
l
è: TX_LDNODEÕ, 
r
));

248  
NULL
;

249 
	}
}

250 
	#TX_LOOKUP
(
£t
, 
key
è
	`TMlookup
(
TM_ARG
 s‘, key)

	)

288 
	$rÙ©eLeá
 (
rbŒ“_t
* 
s
, 
node_t
* 
x
)

290 
node_t
* 
r
 = 
	`LDNODE
(
x
,„);

291 
node_t
* 
¾
 = 
	`LDNODE
(
r
, 
l
);

292 
	`STF
(
x
, 
r
, 
¾
);

293 ià(
¾
 !ğ
NULL
) {

294 
	`STF
(
¾
, 
p
, 
x
);

297 
node_t
* 
xp
 = 
	`LDNODE
(
x
, 
p
);

298 
	`STF
(
r
, 
p
, 
xp
);

299 ià(
xp
 =ğ
NULL
) {

300 
	`STF
(
s
, 
roÙ
, 
r
);

301 } ià(
	`LDNODE
(
xp
, 
l
è=ğ
x
) {

302 
	`STF
(
xp
, 
l
, 
r
);

304 
	`STF
(
xp
, 
r
,„);

306 
	`STF
(
r
, 
l
, 
x
);

307 
	`STF
(
x
, 
p
, 
r
);

308 
	}
}

309 
	#ROTATE_LEFT
(
£t
, 
node
è
	`rÙ©eLeá
(£t,‚ode)

	)

317 
	$TMrÙ©eLeá
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
x
)

319 
node_t
* 
r
 = 
	`TX_LDNODE
(
x
,„);

320 
node_t
* 
¾
 = 
	`TX_LDNODE
(
r
, 
l
);

321 
	`TX_STF_P
(
x
, 
r
, 
¾
);

322 ià(
¾
 !ğ
NULL
) {

323 
	`TX_STF_P
(
¾
, 
p
, 
x
);

326 
node_t
* 
xp
 = 
	`TX_LDNODE
(
x
, 
p
);

327 
	`TX_STF_P
(
r
, 
p
, 
xp
);

328 ià(
xp
 =ğ
NULL
) {

329 
	`TX_STF_P
(
s
, 
roÙ
, 
r
);

330 } ià(
	`TX_LDNODE
(
xp
, 
l
è=ğ
x
) {

331 
	`TX_STF_P
(
xp
, 
l
, 
r
);

333 
	`TX_STF_P
(
xp
, 
r
,„);

335 
	`TX_STF_P
(
r
, 
l
, 
x
);

336 
	`TX_STF_P
(
x
, 
p
, 
r
);

337 
	}
}

338 
	#TX_ROTATE_LEFT
(
£t
, 
node
è
	`TMrÙ©eLeá
(
TM_ARG
 s‘,‚ode)

	)

346 
	$rÙ©eRight
 (
rbŒ“_t
* 
s
, 
node_t
* 
x
)

348 
node_t
* 
l
 = 
	`LDNODE
(
x
,†);

349 
node_t
* 
Ì
 = 
	`LDNODE
(
l
, 
r
);

350 
	`STF
(
x
, 
l
, 
Ì
);

351 ià(
Ì
 !ğ
NULL
) {

352 
	`STF
(
Ì
, 
p
, 
x
);

354 
node_t
* 
xp
 = 
	`LDNODE
(
x
, 
p
);

355 
	`STF
(
l
, 
p
, 
xp
);

356 ià(
xp
 =ğ
NULL
) {

357 
	`STF
(
s
, 
roÙ
, 
l
);

358 } ià(
	`LDNODE
(
xp
, 
r
è=ğ
x
) {

359 
	`STF
(
xp
, 
r
, 
l
);

361 
	`STF
(
xp
, 
l
,†);

363 
	`STF
(
l
, 
r
, 
x
);

364 
	`STF
(
x
, 
p
, 
l
);

365 
	}
}

366 
	#ROTATE_RIGHT
(
£t
, 
node
è
	`rÙ©eRight
(£t,‚ode)

	)

374 
	$TMrÙ©eRight
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
x
)

376 
node_t
* 
l
 = 
	`TX_LDNODE
(
x
,†);

377 
node_t
* 
Ì
 = 
	`TX_LDNODE
(
l
, 
r
);

378 
	`TX_STF_P
(
x
, 
l
, 
Ì
);

379 ià(
Ì
 !ğ
NULL
) {

380 
	`TX_STF_P
(
Ì
, 
p
, 
x
);

382 
node_t
* 
xp
 = 
	`TX_LDNODE
(
x
, 
p
);

383 
	`TX_STF_P
(
l
, 
p
, 
xp
);

384 ià(
xp
 =ğ
NULL
) {

385 
	`TX_STF_P
(
s
, 
roÙ
, 
l
);

386 } ià(
	`TX_LDNODE
(
xp
, 
r
è=ğ
x
) {

387 
	`TX_STF_P
(
xp
, 
r
, 
l
);

389 
	`TX_STF_P
(
xp
, 
l
,†);

391 
	`TX_STF_P
(
l
, 
r
, 
x
);

392 
	`TX_STF_P
(
x
, 
p
, 
l
);

393 
	}
}

394 
	#TX_ROTATE_RIGHT
(
£t
, 
node
è
	`TMrÙ©eRight
(
TM_ARG
 s‘,‚ode)

	)

401 
šlše
 
node_t
*

402 
	$·»ÁOf
 (
node_t
* 
n
)

404  (
n
 ? 
	`LDNODE
Ò,
p
è: 
NULL
);

405 
	}
}

406 
	#PARENT_OF
(
n
è
	`·»ÁOf
Ò)

	)

413 
šlše
 
node_t
*

414 
	$TM·»ÁOf
 (
TM_ARGDECL
 
node_t
* 
n
)

416  (
n
 ? 
	`TX_LDNODE
Ò,
p
è: 
NULL
);

417 
	}
}

418 
	#TX_PARENT_OF
(
n
è
	`TM·»ÁOf
(
TM_ARG
‚)

	)

425 
šlše
 
node_t
*

426 
	$ËáOf
 (
node_t
* 
n
)

428  (
n
 ? 
	`LDNODE
Ò, 
l
è: 
NULL
);

429 
	}
}

430 
	#LEFT_OF
(
n
è
	`ËáOf
Ò)

	)

437 
šlše
 
node_t
*

438 
	$TMËáOf
 (
TM_ARGDECL
 
node_t
* 
n
)

440  (
n
 ? 
	`TX_LDNODE
Ò, 
l
è: 
NULL
);

441 
	}
}

442 
	#TX_LEFT_OF
(
n
è
	`TMËáOf
(
TM_ARG
‚)

	)

449 
šlše
 
node_t
*

450 
	$rightOf
 (
node_t
* 
n
)

452  (
n
 ? 
	`LDNODE
Ò, 
r
è: 
NULL
);

453 
	}
}

454 
	#RIGHT_OF
(
n
è
	`rightOf
Ò)

	)

461 
šlše
 
node_t
*

462 
	$TMrightOf
 (
TM_ARGDECL
 
node_t
* 
n
)

464  (
n
 ? 
	`TX_LDNODE
Ò, 
r
è: 
NULL
);

465 
	}
}

466 
	#TX_RIGHT_OF
(
n
è
	`TMrightOf
(
TM_ARG
‚)

	)

473 
šlše
 

474 
	$cŞÜOf
 (
node_t
* 
n
)

476  (
n
 ? ()
	`LDNODE
Ò, 
c
è: 
BLACK
);

477 
	}
}

478 
	#COLOR_OF
(
n
è
	`cŞÜOf
Ò)

	)

485 
šlše
 

486 
	$TMcŞÜOf
 (
TM_ARGDECL
 
node_t
* 
n
)

488  (
n
 ? ()
	`TX_LDF
Ò, 
c
è: 
BLACK
);

489 
	}
}

490 
	#TX_COLOR_OF
(
n
è
	`TMcŞÜOf
(
TM_ARG
‚)

	)

497 
šlše
 

498 
	$£tCŞÜ
 (
node_t
* 
n
, 
c
)

500 ià(
n
 !ğ
NULL
) {

501 
	`STF
(
n
, 
c
, c);

503 
	}
}

504 
	#SET_COLOR
(
n
, 
c
è
	`£tCŞÜ
Ò, c)

	)

511 
šlše
 

512 
	$TM£tCŞÜ
 (
TM_ARGDECL
 
node_t
* 
n
, 
c
)

514 ià(
n
 !ğ
NULL
) {

515 
	`TX_STF
(
n
, 
c
, c);

517 
	}
}

518 
	#TX_SET_COLOR
(
n
, 
c
è
	`TM£tCŞÜ
(
TM_ARG
‚, c)

	)

526 
	$fixAá”In£¹iÚ
 (
rbŒ“_t
* 
s
, 
node_t
* 
x
)

528 
	`STF
(
x
, 
c
, 
RED
);

529 
x
 !ğ
NULL
 && x !ğ
	`LDNODE
(
s
, 
roÙ
)) {

530 
node_t
* 
xp
 = 
	`LDNODE
(
x
, 
p
);

531 ià(
	`LDF
(
xp
, 
c
è!ğ
RED
) {

535 ià(
	`PARENT_OF
(
x
è=ğ
	`LEFT_OF
(PARENT_OF(PARENT_OF(x)))) {

536 
node_t
* 
y
 = 
	`RIGHT_OF
(
	`PARENT_OF
(PARENT_OF(
x
)));

537 ià(
	`COLOR_OF
(
y
è=ğ
RED
) {

538 
	`SET_COLOR
(
	`PARENT_OF
(
x
), 
BLACK
);

539 
	`SET_COLOR
(
y
, 
BLACK
);

540 
	`SET_COLOR
(
	`PARENT_OF
(PARENT_OF(
x
)), 
RED
);

541 
x
 = 
	`PARENT_OF
(PARENT_OF(x));

543 ià(
x
 =ğ
	`RIGHT_OF
(
	`PARENT_OF
(x))) {

544 
x
 = 
	`PARENT_OF
(x);

545 
	`ROTATE_LEFT
(
s
, 
x
);

547 
	`SET_COLOR
(
	`PARENT_OF
(
x
), 
BLACK
);

548 
	`SET_COLOR
(
	`PARENT_OF
(PARENT_OF(
x
)), 
RED
);

549 ià(
	`PARENT_OF
(PARENT_OF(
x
)è!ğ
NULL
) {

550 
	`ROTATE_RIGHT
(
s
, 
	`PARENT_OF
(PARENT_OF(
x
)));

554 
node_t
* 
y
 = 
	`LEFT_OF
(
	`PARENT_OF
(PARENT_OF(
x
)));

555 ià(
	`COLOR_OF
(
y
è=ğ
RED
) {

556 
	`SET_COLOR
(
	`PARENT_OF
(
x
), 
BLACK
);

557 
	`SET_COLOR
(
y
, 
BLACK
);

558 
	`SET_COLOR
(
	`PARENT_OF
(PARENT_OF(
x
)), 
RED
);

559 
x
 = 
	`PARENT_OF
(PARENT_OF(x));

561 ià(
x
 =ğ
	`LEFT_OF
(
	`PARENT_OF
(x))) {

562 
x
 = 
	`PARENT_OF
(x);

563 
	`ROTATE_RIGHT
(
s
, 
x
);

565 
	`SET_COLOR
(
	`PARENT_OF
(
x
), 
BLACK
);

566 
	`SET_COLOR
(
	`PARENT_OF
(PARENT_OF(
x
)), 
RED
);

567 ià(
	`PARENT_OF
(PARENT_OF(
x
)è!ğ
NULL
) {

568 
	`ROTATE_LEFT
(
s
, 
	`PARENT_OF
(PARENT_OF(
x
)));

573 
node_t
* 
ro
 = 
	`LDNODE
(
s
, 
roÙ
);

574 ià(
	`LDF
(
ro
, 
c
è!ğ
BLACK
) {

575 
	`STF
(
ro
, 
c
, 
BLACK
);

577 
	}
}

578 
	#FIX_AFTER_INSERTION
(
s
, 
x
è
	`fixAá”In£¹iÚ
(s, x)

	)

586 
	$TMfixAá”In£¹iÚ
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
x
)

588 
	`TX_STF
(
x
, 
c
, 
RED
);

589 
x
 !ğ
NULL
 && x !ğ
	`TX_LDNODE
(
s
, 
roÙ
)) {

590 
node_t
* 
xp
 = 
	`TX_LDNODE
(
x
, 
p
);

591 ià(
	`TX_LDF
(
xp
, 
c
è!ğ
RED
) {

595 ià(
	`TX_PARENT_OF
(
x
è=ğ
	`TX_LEFT_OF
(TX_PARENT_OF(TX_PARENT_OF(x)))) {

596 
node_t
* 
y
 = 
	`TX_RIGHT_OF
(
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)));

597 ià(
	`TX_COLOR_OF
(
y
è=ğ
RED
) {

598 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(
x
), 
BLACK
);

599 
	`TX_SET_COLOR
(
y
, 
BLACK
);

600 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)), 
RED
);

601 
x
 = 
	`TX_PARENT_OF
(TX_PARENT_OF(x));

603 ià(
x
 =ğ
	`TX_RIGHT_OF
(
	`TX_PARENT_OF
(x))) {

604 
x
 = 
	`TX_PARENT_OF
(x);

605 
	`TX_ROTATE_LEFT
(
s
, 
x
);

607 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(
x
), 
BLACK
);

608 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)), 
RED
);

609 ià(
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)è!ğ
NULL
) {

610 
	`TX_ROTATE_RIGHT
(
s
, 
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)));

614 
node_t
* 
y
 = 
	`TX_LEFT_OF
(
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)));

615 ià(
	`TX_COLOR_OF
(
y
è=ğ
RED
) {

616 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(
x
), 
BLACK
);

617 
	`TX_SET_COLOR
(
y
, 
BLACK
);

618 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)), 
RED
);

619 
x
 = 
	`TX_PARENT_OF
(TX_PARENT_OF(x));

621 ià(
x
 =ğ
	`TX_LEFT_OF
(
	`TX_PARENT_OF
(x))) {

622 
x
 = 
	`TX_PARENT_OF
(x);

623 
	`TX_ROTATE_RIGHT
(
s
, 
x
);

625 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(
x
), 
BLACK
);

626 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)), 
RED
);

627 ià(
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)è!ğ
NULL
) {

628 
	`TX_ROTATE_LEFT
(
s
, 
	`TX_PARENT_OF
(TX_PARENT_OF(
x
)));

633 
node_t
* 
ro
 = 
	`TX_LDNODE
(
s
, 
roÙ
);

634 ià(
	`TX_LDF
(
ro
, 
c
è!ğ
BLACK
) {

635 
	`TX_STF
(
ro
, 
c
, 
BLACK
);

637 
	}
}

638 
	#TX_FIX_AFTER_INSERTION
(
s
, 
x
è
	`TMfixAá”In£¹iÚ
(
TM_ARG
 s, x)

	)

645 
node_t
*

646 
	$š£¹
 (
rbŒ“_t
* 
s
, * 
k
, * 
v
, 
node_t
* 
n
)

648 
node_t
* 
t
 = 
	`LDNODE
(
s
, 
roÙ
);

649 ià(
t
 =ğ
NULL
) {

650 ià(
n
 =ğ
NULL
) {

651  
NULL
;

654 
	`STF
(
n
, 
l
, 
NULL
);

655 
	`STF
(
n
, 
r
, 
NULL
);

656 
	`STF
(
n
, 
p
, 
NULL
);

657 
	`STF
(
n
, 
k
, k);

658 
	`STF
(
n
, 
v
, v);

659 
	`STF
(
n
, 
c
, 
BLACK
);

660 
	`STF
(
s
, 
roÙ
, 
n
);

661  
NULL
;

665 
cmp
 = 
s
->
	`com·»
(
k
, 
	`LDF
(
t
, k));

666 ià(
cmp
 == 0) {

667  
t
;

668 } ià(
cmp
 < 0) {

669 
node_t
* 

 = 
	`LDNODE
(
t
, 
l
);

670 ià(

 !ğ
NULL
) {

671 
t
 = 

;

673 
	`STF
(
n
, 
l
, 
NULL
);

674 
	`STF
(
n
, 
r
, 
NULL
);

675 
	`STF
(
n
, 
k
, k);

676 
	`STF
(
n
, 
v
, v);

677 
	`STF
(
n
, 
p
, 
t
);

678 
	`STF
(
t
, 
l
, 
n
);

679 
	`FIX_AFTER_INSERTION
(
s
, 
n
);

680  
NULL
;

683 
node_t
* 
Œ
 = 
	`LDNODE
(
t
, 
r
);

684 ià(
Œ
 !ğ
NULL
) {

685 
t
 = 
Œ
;

687 
	`STF
(
n
, 
l
, 
NULL
);

688 
	`STF
(
n
, 
r
, 
NULL
);

689 
	`STF
(
n
, 
k
, k);

690 
	`STF
(
n
, 
v
, v);

691 
	`STF
(
n
, 
p
, 
t
);

692 
	`STF
(
t
, 
r
, 
n
);

693 
	`FIX_AFTER_INSERTION
(
s
, 
n
);

694  
NULL
;

698 
	}
}

699 
	#INSERT
(
s
, 
k
, 
v
, 
n
è
	`š£¹
(s, k, v,‚)

	)

706 
node_t
*

707 
	$TMš£¹
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, * 
k
, * 
v
, 
node_t
* 
n
)

709 
node_t
* 
t
 = 
	`TX_LDNODE
(
s
, 
roÙ
);

710 ià(
t
 =ğ
NULL
) {

711 ià(
n
 =ğ
NULL
) {

712  
NULL
;

715 
	`TX_STF_P
(
n
, 
l
, (
node_t
*)
NULL
);

716 
	`TX_STF_P
(
n
, 
r
, (
node_t
*)
NULL
);

717 
	`TX_STF_P
(
n
, 
p
, (
node_t
*)
NULL
);

718 
	`TX_STF
(
n
, 
k
, k);

719 
	`TX_STF
(
n
, 
v
, v);

720 
	`TX_STF
(
n
, 
c
, 
BLACK
);

721 
	`TX_STF_P
(
s
, 
roÙ
, 
n
);

722  
NULL
;

726 
cmp
 = 
s
->
	`com·»
(
k
, 
	`TX_LDF_P
(
t
, k));

727 ià(
cmp
 == 0) {

728  
t
;

729 } ià(
cmp
 < 0) {

730 
node_t
* 

 = 
	`TX_LDNODE
(
t
, 
l
);

731 ià(

 !ğ
NULL
) {

732 
t
 = 

;

734 
	`TX_STF_P
(
n
, 
l
, (
node_t
*)
NULL
);

735 
	`TX_STF_P
(
n
, 
r
, (
node_t
*)
NULL
);

736 
	`TX_STF
(
n
, 
k
, k);

737 
	`TX_STF
(
n
, 
v
, v);

738 
	`TX_STF_P
(
n
, 
p
, 
t
);

739 
	`TX_STF_P
(
t
, 
l
, 
n
);

740 
	`TX_FIX_AFTER_INSERTION
(
s
, 
n
);

741  
NULL
;

744 
node_t
* 
Œ
 = 
	`TX_LDNODE
(
t
, 
r
);

745 ià(
Œ
 !ğ
NULL
) {

746 
t
 = 
Œ
;

748 
	`TX_STF_P
(
n
, 
l
, (
node_t
*)
NULL
);

749 
	`TX_STF_P
(
n
, 
r
, (
node_t
*)
NULL
);

750 
	`TX_STF
(
n
, 
k
, k);

751 
	`TX_STF
(
n
, 
v
, v);

752 
	`TX_STF_P
(
n
, 
p
, 
t
);

753 
	`TX_STF_P
(
t
, 
r
, 
n
);

754 
	`TX_FIX_AFTER_INSERTION
(
s
, 
n
);

755  
NULL
;

759 
	}
}

760 
	#TX_INSERT
(
s
, 
k
, 
v
, 
n
è
	`TMš£¹
(
TM_ARG
 s, k, v,‚)

	)

775 
node_t
*

776 
	$sucûssÜ
 (
node_t
* 
t
)

778 ià(
t
 =ğ
NULL
) {

779  
NULL
;

780 } ià(
	`LDNODE
(
t
, 
r
è!ğ
NULL
) {

781 
node_t
* 
p
 = 
	`LDNODE
(
t
, 
r
);

782 
	`LDNODE
(
p
, 
l
è!ğ
NULL
) {

783 
p
 = 
	`LDNODE
Õ, 
l
);

785  
p
;

787 
node_t
* 
p
 = 
	`LDNODE
(
t
,…);

788 
node_t
* 
ch
 = 
t
;

789 
p
 !ğ
NULL
 && 
ch
 =ğ
	`LDNODE
Õ, 
r
)) {

790 
ch
 = 
p
;

791 
p
 = 
	`LDNODE
(p,…);

793  
p
;

795 
	}
}

796 
	#SUCCESSOR
(
n
è
	`sucûssÜ
Ò)

	)

803 
node_t
*

804 
	$TMsucûssÜ
 (
TM_ARGDECL
 
node_t
* 
t
)

806 ià(
t
 =ğ
NULL
) {

807  
NULL
;

808 } ià(
	`TX_LDNODE
(
t
, 
r
è!ğ
NULL
) {

809 
node_t
* 
p
 = 
	`TX_LDNODE
(
t
,
r
);

810 
	`TX_LDNODE
(
p
, 
l
è!ğ
NULL
) {

811 
p
 = 
	`TX_LDNODE
Õ, 
l
);

813  
p
;

815 
node_t
* 
p
 = 
	`TX_LDNODE
(
t
,…);

816 
node_t
* 
ch
 = 
t
;

817 
p
 !ğ
NULL
 && 
ch
 =ğ
	`TX_LDNODE
Õ, 
r
)) {

818 
ch
 = 
p
;

819 
p
 = 
	`TX_LDNODE
(p,…);

821  
p
;

823 
	}
}

824 
	#TX_SUCCESSOR
(
n
è
	`TMsucûssÜ
(
TM_ARG
‚)

	)

832 
	$fixAá”D–‘iÚ
 (
rbŒ“_t
* 
s
, 
node_t
* 
x
)

834 
x
 !ğ
	`LDNODE
(
s
,
roÙ
è&& 
	`COLOR_OF
(xè=ğ
BLACK
) {

835 ià(
x
 =ğ
	`LEFT_OF
(
	`PARENT_OF
(x))) {

836 
node_t
* 
sib
 = 
	`RIGHT_OF
(
	`PARENT_OF
(
x
));

837 ià(
	`COLOR_OF
(
sib
è=ğ
RED
) {

838 
	`SET_COLOR
(
sib
, 
BLACK
);

839 
	`SET_COLOR
(
	`PARENT_OF
(
x
), 
RED
);

840 
	`ROTATE_LEFT
(
s
, 
	`PARENT_OF
(
x
));

841 
sib
 = 
	`RIGHT_OF
(
	`PARENT_OF
(
x
));

843 ià(
	`COLOR_OF
(
	`LEFT_OF
(
sib
)è=ğ
BLACK
 &&

844 
	`COLOR_OF
(
	`RIGHT_OF
(
sib
)è=ğ
BLACK
) {

845 
	`SET_COLOR
(
sib
, 
RED
);

846 
x
 = 
	`PARENT_OF
(x);

848 ià(
	`COLOR_OF
(
	`RIGHT_OF
(
sib
)è=ğ
BLACK
) {

849 
	`SET_COLOR
(
	`LEFT_OF
(
sib
), 
BLACK
);

850 
	`SET_COLOR
(
sib
, 
RED
);

851 
	`ROTATE_RIGHT
(
s
, 
sib
);

852 
sib
 = 
	`RIGHT_OF
(
	`PARENT_OF
(
x
));

854 
	`SET_COLOR
(
sib
, 
	`COLOR_OF
(
	`PARENT_OF
(
x
)));

855 
	`SET_COLOR
(
	`PARENT_OF
(
x
), 
BLACK
);

856 
	`SET_COLOR
(
	`RIGHT_OF
(
sib
), 
BLACK
);

857 
	`ROTATE_LEFT
(
s
, 
	`PARENT_OF
(
x
));

859 
x
 = 
	`LDNODE
(
s
,
roÙ
);

862 
node_t
* 
sib
 = 
	`LEFT_OF
(
	`PARENT_OF
(
x
));

863 ià(
	`COLOR_OF
(
sib
è=ğ
RED
) {

864 
	`SET_COLOR
(
sib
, 
BLACK
);

865 
	`SET_COLOR
(
	`PARENT_OF
(
x
), 
RED
);

866 
	`ROTATE_RIGHT
(
s
, 
	`PARENT_OF
(
x
));

867 
sib
 = 
	`LEFT_OF
(
	`PARENT_OF
(
x
));

869 ià(
	`COLOR_OF
(
	`RIGHT_OF
(
sib
)è=ğ
BLACK
 &&

870 
	`COLOR_OF
(
	`LEFT_OF
(
sib
)è=ğ
BLACK
) {

871 
	`SET_COLOR
(
sib
, 
RED
);

872 
x
 = 
	`PARENT_OF
(x);

874 ià(
	`COLOR_OF
(
	`LEFT_OF
(
sib
)è=ğ
BLACK
) {

875 
	`SET_COLOR
(
	`RIGHT_OF
(
sib
), 
BLACK
);

876 
	`SET_COLOR
(
sib
, 
RED
);

877 
	`ROTATE_LEFT
(
s
, 
sib
);

878 
sib
 = 
	`LEFT_OF
(
	`PARENT_OF
(
x
));

880 
	`SET_COLOR
(
sib
, 
	`COLOR_OF
(
	`PARENT_OF
(
x
)));

881 
	`SET_COLOR
(
	`PARENT_OF
(
x
), 
BLACK
);

882 
	`SET_COLOR
(
	`LEFT_OF
(
sib
), 
BLACK
);

883 
	`ROTATE_RIGHT
(
s
, 
	`PARENT_OF
(
x
));

885 
x
 = 
	`LDNODE
(
s
, 
roÙ
);

890 ià(
x
 !ğ
NULL
 && 
	`LDF
(x,
c
è!ğ
BLACK
) {

891 
	`STF
(
x
, 
c
, 
BLACK
);

893 
	}
}

894 
	#FIX_AFTER_DELETION
(
s
, 
n
è
	`fixAá”D–‘iÚ
(s,‚)

	)

902 
	$TMfixAá”D–‘iÚ
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
x
)

904 
x
 !ğ
	`TX_LDNODE
(
s
,
roÙ
è&& 
	`TX_COLOR_OF
(xè=ğ
BLACK
) {

905 ià(
x
 =ğ
	`TX_LEFT_OF
(
	`TX_PARENT_OF
(x))) {

906 
node_t
* 
sib
 = 
	`TX_RIGHT_OF
(
	`TX_PARENT_OF
(
x
));

907 ià(
	`TX_COLOR_OF
(
sib
è=ğ
RED
) {

908 
	`TX_SET_COLOR
(
sib
, 
BLACK
);

909 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(
x
), 
RED
);

910 
	`TX_ROTATE_LEFT
(
s
, 
	`TX_PARENT_OF
(
x
));

911 
sib
 = 
	`TX_RIGHT_OF
(
	`TX_PARENT_OF
(
x
));

913 ià(
	`TX_COLOR_OF
(
	`TX_LEFT_OF
(
sib
)è=ğ
BLACK
 &&

914 
	`TX_COLOR_OF
(
	`TX_RIGHT_OF
(
sib
)è=ğ
BLACK
) {

915 
	`TX_SET_COLOR
(
sib
, 
RED
);

916 
x
 = 
	`TX_PARENT_OF
(x);

918 ià(
	`TX_COLOR_OF
(
	`TX_RIGHT_OF
(
sib
)è=ğ
BLACK
) {

919 
	`TX_SET_COLOR
(
	`TX_LEFT_OF
(
sib
), 
BLACK
);

920 
	`TX_SET_COLOR
(
sib
, 
RED
);

921 
	`TX_ROTATE_RIGHT
(
s
, 
sib
);

922 
sib
 = 
	`TX_RIGHT_OF
(
	`TX_PARENT_OF
(
x
));

924 
	`TX_SET_COLOR
(
sib
, 
	`TX_COLOR_OF
(
	`TX_PARENT_OF
(
x
)));

925 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(
x
), 
BLACK
);

926 
	`TX_SET_COLOR
(
	`TX_RIGHT_OF
(
sib
), 
BLACK
);

927 
	`TX_ROTATE_LEFT
(
s
, 
	`TX_PARENT_OF
(
x
));

929 
x
 = 
	`TX_LDNODE
(
s
,
roÙ
);

932 
node_t
* 
sib
 = 
	`TX_LEFT_OF
(
	`TX_PARENT_OF
(
x
));

934 ià(
	`TX_COLOR_OF
(
sib
è=ğ
RED
) {

935 
	`TX_SET_COLOR
(
sib
, 
BLACK
);

936 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(
x
), 
RED
);

937 
	`TX_ROTATE_RIGHT
(
s
, 
	`TX_PARENT_OF
(
x
));

938 
sib
 = 
	`TX_LEFT_OF
(
	`TX_PARENT_OF
(
x
));

940 ià(
	`TX_COLOR_OF
(
	`TX_RIGHT_OF
(
sib
)è=ğ
BLACK
 &&

941 
	`TX_COLOR_OF
(
	`TX_LEFT_OF
(
sib
)è=ğ
BLACK
) {

942 
	`TX_SET_COLOR
(
sib
, 
RED
);

943 
x
 = 
	`TX_PARENT_OF
(x);

945 ià(
	`TX_COLOR_OF
(
	`TX_LEFT_OF
(
sib
)è=ğ
BLACK
) {

946 
	`TX_SET_COLOR
(
	`TX_RIGHT_OF
(
sib
), 
BLACK
);

947 
	`TX_SET_COLOR
(
sib
, 
RED
);

948 
	`TX_ROTATE_LEFT
(
s
, 
sib
);

949 
sib
 = 
	`TX_LEFT_OF
(
	`TX_PARENT_OF
(
x
));

951 
	`TX_SET_COLOR
(
sib
, 
	`TX_COLOR_OF
(
	`TX_PARENT_OF
(
x
)));

952 
	`TX_SET_COLOR
(
	`TX_PARENT_OF
(
x
), 
BLACK
);

953 
	`TX_SET_COLOR
(
	`TX_LEFT_OF
(
sib
), 
BLACK
);

954 
	`TX_ROTATE_RIGHT
(
s
, 
	`TX_PARENT_OF
(
x
));

956 
x
 = 
	`TX_LDNODE
(
s
, 
roÙ
);

961 ià(
x
 !ğ
NULL
 && 
	`TX_LDF
(x,
c
è!ğ
BLACK
) {

962 
	`TX_STF
(
x
, 
c
, 
BLACK
);

964 
	}
}

965 
	#TX_FIX_AFTER_DELETION
(
s
, 
n
è
	`TMfixAá”D–‘iÚ
(
TM_ARG
 s,‚ )

	)

972 
node_t
*

973 
	$d–‘e_node
 (
rbŒ“_t
* 
s
, 
node_t
* 
p
)

979 ià(
	`LDNODE
(
p
, 
l
è!ğ
NULL
 && LDNODEÕ, 
r
) != NULL) {

980 
node_t
* 
s
 = 
	`SUCCESSOR
(
p
);

981 
	`STF
(
p
, 
k
, 
	`LDNODE
(
s
, k));

982 
	`STF
(
p
, 
v
, 
	`LDNODE
(
s
, v));

983 
p
 = 
s
;

987 
node_t
* 
»¶aûm’t
 =

988 ((
	`LDNODE
(
p
, 
l
è!ğ
NULL
è? LDNODEÕ,†è: LDNODEÕ, 
r
));

990 ià(
»¶aûm’t
 !ğ
NULL
) {

993 
	`STF
 (
»¶aûm’t
, 
p
, 
	`LDNODE
(p,…));

994 
node_t
* 
µ
 = 
	`LDNODE
(
p
,…);

995 ià(
µ
 =ğ
NULL
) {

996 
	`STF
(
s
, 
roÙ
, 
»¶aûm’t
);

997 } ià(
p
 =ğ
	`LDNODE
(
µ
, 
l
)) {

998 
	`STF
(
µ
, 
l
, 
»¶aûm’t
);

1000 
	`STF
(
µ
, 
r
, 
»¶aûm’t
);

1004 
	`STF
(
p
, 
l
, 
NULL
);

1005 
	`STF
(
p
, 
r
, 
NULL
);

1006 
	`STF
(
p
,…, 
NULL
);

1009 ià(
	`LDF
(
p
,
c
è=ğ
BLACK
) {

1010 
	`FIX_AFTER_DELETION
(
s
, 
»¶aûm’t
);

1012 } ià(
	`LDNODE
(
p
,…è=ğ
NULL
) {

1013 
	`STF
(
s
, 
roÙ
, 
NULL
);

1015 ià(
	`LDF
(
p
, 
c
è=ğ
BLACK
) {

1016 
	`FIX_AFTER_DELETION
(
s
, 
p
);

1018 
node_t
* 
µ
 = 
	`LDNODE
(
p
,…);

1019 ià(
µ
 !ğ
NULL
) {

1020 ià(
p
 =ğ
	`LDNODE
(
µ
, 
l
)) {

1021 
	`STF
(
µ
,
l
, 
NULL
);

1022 } ià(
p
 =ğ
	`LDNODE
(
µ
, 
r
)) {

1023 
	`STF
(
µ
, 
r
, 
NULL
);

1025 
	`STF
(
p
,…, 
NULL
);

1028  
p
;

1029 
	}
}

1030 
	#DELETE
(
s
, 
n
è
	`d–‘e_node
(s,‚)

	)

1037 
node_t
*

1038 
	$TMd–‘e
 (
TM_ARGDECL
 
rbŒ“_t
* 
s
, 
node_t
* 
p
)

1044 ià(
	`TX_LDNODE
(
p
, 
l
è!ğ
NULL
 && TX_LDNODEÕ, 
r
) != NULL) {

1045 
node_t
* 
s
 = 
	`TX_SUCCESSOR
(
p
);

1046 
	`TX_STF
(
p
,
k
, 
	`TX_LDF_P
(
s
, k));

1047 
	`TX_STF
(
p
,
v
, 
	`TX_LDF_P
(
s
, v));

1048 
p
 = 
s
;

1052 
node_t
* 
»¶aûm’t
 =

1053 ((
	`TX_LDNODE
(
p
, 
l
è!ğ
NULL
è? TX_LDNODEÕ,†è: TX_LDNODEÕ, 
r
));

1055 ià(
»¶aûm’t
 !ğ
NULL
) {

1058 
	`TX_STF_P
(
»¶aûm’t
, 
p
, 
	`TX_LDNODE
(p,…));

1059 
node_t
* 
µ
 = 
	`TX_LDNODE
(
p
,…);

1060 ià(
µ
 =ğ
NULL
) {

1061 
	`TX_STF_P
(
s
, 
roÙ
, 
»¶aûm’t
);

1062 } ià(
p
 =ğ
	`TX_LDNODE
(
µ
, 
l
)) {

1063 
	`TX_STF_P
(
µ
, 
l
, 
»¶aûm’t
);

1065 
	`TX_STF_P
(
µ
, 
r
, 
»¶aûm’t
);

1069 
	`TX_STF_P
(
p
, 
l
, (
node_t
*)
NULL
);

1070 
	`TX_STF_P
(
p
, 
r
, (
node_t
*)
NULL
);

1071 
	`TX_STF_P
(
p
,…, (
node_t
*)
NULL
);

1074 ià(
	`TX_LDF
(
p
,
c
è=ğ
BLACK
) {

1075 
	`TX_FIX_AFTER_DELETION
(
s
, 
»¶aûm’t
);

1077 } ià(
	`TX_LDNODE
(
p
,pè=ğ
NULL
) {

1078 
	`TX_STF_P
(
s
, 
roÙ
, (
node_t
*)
NULL
);

1080 ià(
	`TX_LDF
(
p
,
c
è=ğ
BLACK
) {

1081 
	`TX_FIX_AFTER_DELETION
(
s
, 
p
);

1083 
node_t
* 
µ
 = 
	`TX_LDNODE
(
p
,…);

1084 ià(
µ
 !ğ
NULL
) {

1085 ià(
p
 =ğ
	`TX_LDNODE
(
µ
, 
l
)) {

1086 
	`TX_STF_P
(
µ
,
l
, (
node_t
*)
NULL
);

1087 } ià(
p
 =ğ
	`TX_LDNODE
(
µ
, 
r
)) {

1088 
	`TX_STF_P
(
µ
, 
r
, (
node_t
*)
NULL
);

1090 
	`TX_STF_P
(
p
,…, (
node_t
*)
NULL
);

1093  
p
;

1094 
	}
}

1095 
	#TX_DELETE
(
s
, 
n
è
	`TMd–‘e
(
TM_ARG
 s,‚)

	)

1107 
node_t
*

1108 
	$fœ¡EÁry
 (
rbŒ“_t
* 
s
)

1110 
node_t
* 
p
 = 
s
->
roÙ
;

1111 ià(
p
 !ğ
NULL
) {

1112 
p
->
l
 !ğ
NULL
) {

1113 
p
 =…->
l
;

1116  
p
;

1117 
	}
}

1125 
node_t
*

1126 
	$´edeûssÜ
 (
node_t
* 
t
)

1128 ià(
t
 =ğ
NULL
)

1129  
NULL
;

1130 ià(
t
->
l
 !ğ
NULL
) {

1131 
node_t
* 
p
 = 
t
->
l
;

1132 
p
->
r
 !ğ
NULL
) {

1133 
p
 =…->
r
;

1135  
p
;

1137 
node_t
* 
p
 = 
t
->p;

1138 
node_t
* 
ch
 = 
t
;

1139 
p
 !ğ
NULL
 && 
ch
 =ğp->
l
) {

1140 
ch
 = 
p
;

1141 
p
 =…->p;

1143  
p
;

1145 
	}
}

1171 
	$v”ifyRedBÏck
 (
node_t
* 
roÙ
, 
d•th
)

1173 
height_Ëá
;

1174 
height_right
;

1176 ià(
roÙ
 =ğ
NULL
) {

1180 
height_Ëá
 = 
	`v”ifyRedBÏck
(
roÙ
->
l
, 
d•th
+1);

1181 
height_right
 = 
	`v”ifyRedBÏck
(
roÙ
->
r
, 
d•th
+1);

1182 ià(
height_Ëá
 =ğ0 || 
height_right
 == 0) {

1185 ià(
height_Ëá
 !ğ
height_right
) {

1186 
	`´štf
(" Imb®ªû @d•th=%ld : %ld %ld\n", 
d•th
, 
height_Ëá
, 
height_right
);

1189 ià(
roÙ
->
l
 !ğ
NULL
 &&„oÙ->l->
p
 !=„oot) {

1190 
	`´štf
("†ineage\n");

1192 ià(
roÙ
->
r
 !ğ
NULL
 &&„oÙ->r->
p
 !=„oot) {

1193 
	`´štf
("†ineage\n");

1197 ià(
roÙ
->
c
 =ğ
RED
) {

1198 ià(
roÙ
->
l
 !ğ
NULL
 &&„oÙ->l->
c
 !ğ
BLACK
) {

1199 
	`´štf
("VERIFY %d\n", 
__LINE__
);

1202 ià(
roÙ
->
r
 !ğ
NULL
 &&„oÙ->r->
c
 !ğ
BLACK
) {

1203 
	`´štf
("VERIFY %d\n", 
__LINE__
);

1206  
height_Ëá
;

1208 ià(
roÙ
->
c
 !ğ
BLACK
) {

1209 
	`´štf
("VERIFY %d\n", 
__LINE__
);

1213  (
height_Ëá
 + 1);

1214 
	}
}

1222 
	$rbŒ“_v”ify
 (
rbŒ“_t
* 
s
, 
v”bo£
)

1224 
node_t
* 
roÙ
 = 
s
->root;

1225 ià(
roÙ
 =ğ
NULL
) {

1228 ià(
v”bo£
) {

1229 
	`´štf
("Integrity check: ");

1232 ià(
roÙ
->
p
 !ğ
NULL
) {

1233 
	`´štf
(" (WARNING)„oot %lX…arent=%lX\n",

1234 ()
roÙ
, (ìoÙ->
p
);

1237 ià(
roÙ
->
c
 !ğ
BLACK
) {

1238 
	`´štf
(" (WARNING)„oot %lX color=%lX\n",

1239 ()
roÙ
, (ìoÙ->
c
);

1243 
ùr
 = 0;

1244 
node_t
* 
™s
 = 
	`fœ¡EÁry
(
s
);

1245 
™s
 !ğ
NULL
) {

1246 
ùr
++;

1247 
node_t
* 
chd
 = 
™s
->
l
;

1248 ià(
chd
 !ğ
NULL
 && chd->
p
 !ğ
™s
) {

1249 
	`´štf
("Bad…arent\n");

1251 
chd
 = 
™s
->
r
;

1252 ià(
chd
 !ğ
NULL
 && chd->
p
 !ğ
™s
) {

1253 
	`´štf
("Bad…arent\n");

1255 
node_t
* 
nxt
 = 
	`sucûssÜ
(
™s
);

1256 ià(
nxt
 =ğ
NULL
) {

1259 ià(
s
->
	`com·»
(
™s
->
k
, 
nxt
->k) >= 0) {

1260 
	`´štf
("Key order %lX (%ld %ld) %lX (%ld %ld)\n",

1261 ()
™s
, ()™s->
k
, ()™s->
v
,

1262 ()
nxt
, (êxt->
k
, (êxt->
v
);

1265 
™s
 = 
nxt
;

1268 
vfy
 = 
	`v”ifyRedBÏck
(
roÙ
, 0);

1269 ià(
v”bo£
) {

1270 
	`´štf
(" Nodes=%ld D•th=%ld\n", 
ùr
, 
vfy
);

1273  
vfy
;

1274 
	}
}

1282 
	$com·»KeysDeçuÉ
 (cÚ¡ * 
a
, cÚ¡ * 
b
)

1284  (()
a
 - ()
b
);

1285 
	}
}

1292 
rbŒ“_t
*

1293 
rbŒ“_®loc
 ((*
com·»
)(const *, const *))

1295 
rbŒ“_t
* 
n
 = (rbŒ“_t* )
	`m®loc
((*n));

1296 ià(
n
) {

1297 
n
->
com·»
 = (com·» ? com·» : &
com·»KeysDeçuÉ
);

1298 
n
->
roÙ
 = 
NULL
;

1300  
n
;

1301 
	}
}

1308 
rbŒ“_t
*

1309 
TMrbŒ“_®loc
 (
TM_ARGDECL
 (*
com·»
)(const *, const *))

1311 
rbŒ“_t
* 
n
 = (rbŒ“_t* )
	`TM_MALLOC
((*n));

1312 ià(
n
){

1313 
n
->
com·»
 = (com·» ? com·» : &
com·»KeysDeçuÉ
);

1314 
n
->
roÙ
 = 
NULL
;

1316  
n
;

1317 
	}
}

1325 
	$»Ëa£Node
 (
node_t
* 
n
)

1327 #iâdeà
SIMULATOR


1328 
	`ä“
(
n
);

1330 
	}
}

1338 
	$TM»Ëa£Node
 (
TM_ARGDECL
 
node_t
* 
n
)

1340 
	`TM_FREE
(
n
);

1341 
	}
}

1349 
	$ä“Node
 (
node_t
* 
n
)

1351 ià(
n
) {

1352 
	`ä“Node
(
n
->
l
);

1353 
	`ä“Node
(
n
->
r
);

1354 
	`»Ëa£Node
(
n
);

1356 
	}
}

1364 
	$TMä“Node
 (
TM_ARGDECL
 
node_t
* 
n
)

1366 ià(
n
) {

1367 
	`TMä“Node
(
TM_ARG
 
n
->
l
);

1368 
	`TMä“Node
(
TM_ARG
 
n
->
r
);

1369 
	`TM»Ëa£Node
(
TM_ARG
 
n
);

1371 
	}
}

1379 
	$rbŒ“_ä“
 (
rbŒ“_t
* 
r
)

1381 
	`ä“Node
(
r
->
roÙ
);

1382 
	`ä“
(
r
);

1383 
	}
}

1391 
	$TMrbŒ“_ä“
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
)

1393 
	`TMä“Node
(
TM_ARG
 
r
->
roÙ
);

1394 
	`TM_FREE
(
r
);

1395 
	}
}

1402 
node_t
*

1403 
	$g‘Node
 ()

1405 
node_t
* 
n
 = (node_t*)
	`m®loc
((*n));

1406  
n
;

1407 
	}
}

1414 
node_t
*

1415 
	$TMg‘Node
 (
TM_ARGDECL_ALONE
)

1417 
node_t
* 
n
 = (node_t*)
	`TM_MALLOC
((*n));

1418  
n
;

1419 
	}
}

1427 
boŞ_t


1428 
	$rbŒ“_š£¹
 (
rbŒ“_t
* 
r
, * 
key
, * 
v®
)

1430 
node_t
* 
node
 = 
	`g‘Node
();

1431 
node_t
* 
ex
 = 
	`INSERT
(
r
, 
key
, 
v®
, 
node
);

1432 ià(
ex
 !ğ
NULL
) {

1433 
	`»Ëa£Node
(
node
);

1435  ((
ex
 =ğ
NULL
è? 
TRUE
 : 
FALSE
);

1436 
	}
}

1444 
boŞ_t


1445 
	$TMrbŒ“_š£¹
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
, * 
v®
)

1447 
node_t
* 
node
 = 
	`TMg‘Node
(
TM_ARG_ALONE
);

1448 
node_t
* 
ex
 = 
	`TX_INSERT
(
r
, 
key
, 
v®
, 
node
);

1449 ià(
ex
 !ğ
NULL
) {

1450 
	`TM»Ëa£Node
(
TM_ARG
 
node
);

1452  ((
ex
 =ğ
NULL
è? 
TRUE
 : 
FALSE
);

1453 
	}
}

1461 
boŞ_t


1462 
	$rbŒ“_d–‘e
 (
rbŒ“_t
* 
r
, * 
key
)

1464 
node_t
* 
node
 = 
NULL
;

1465 
node
 = 
	`LOOKUP
(
r
, 
key
);

1466 ià(
node
 !ğ
NULL
) {

1467 
node
 = 
	`DELETE
(
r
,‚ode);

1469 ià(
node
 !ğ
NULL
) {

1470 
	`»Ëa£Node
(
node
);

1472  ((
node
 !ğ
NULL
è? 
TRUE
 : 
FALSE
);

1473 
	}
}

1481 
boŞ_t


1482 
	$TMrbŒ“_d–‘e
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
)

1484 
node_t
* 
node
 = 
NULL
;

1485 
node
 = 
	`TX_LOOKUP
(
r
, 
key
);

1486 ià(
node
 !ğ
NULL
) {

1487 
node
 = 
	`TX_DELETE
(
r
,‚ode);

1489 ià(
node
 !ğ
NULL
) {

1490 
	`TM»Ëa£Node
(
TM_ARG
 
node
);

1492  ((
node
 !ğ
NULL
è? 
TRUE
 : 
FALSE
);

1493 
	}
}

1501 
boŞ_t


1502 
	$rbŒ“_upd©e
 (
rbŒ“_t
* 
r
, * 
key
, * 
v®
)

1504 
node_t
* 
Â
 = 
	`g‘Node
();

1505 
node_t
* 
ex
 = 
	`INSERT
(
r
, 
key
, 
v®
, 
Â
);

1506 ià(
ex
 !ğ
NULL
) {

1507 
	`STF
(
ex
, 
v
, 
v®
);

1508 
	`»Ëa£Node
(
Â
);

1509  
TRUE
;

1511  
FALSE
;

1512 
	}
}

1520 
boŞ_t


1521 
	$TMrbŒ“_upd©e
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
, * 
v®
)

1523 
node_t
* 
Â
 = 
	`TMg‘Node
(
TM_ARG_ALONE
);

1524 
node_t
* 
ex
 = 
	`TX_INSERT
(
r
, 
key
, 
v®
, 
Â
);

1525 ià(
ex
 !ğ
NULL
) {

1526 
	`TX_STF
(
ex
, 
v
, 
v®
);

1527 
	`TM»Ëa£Node
(
TM_ARG
 
Â
);

1528  
TRUE
;

1530  
FALSE
;

1531 
	}
}

1539 
	$rbŒ“_g‘
 (
rbŒ“_t
* 
r
, * 
key
) {

1540 
node_t
* 
n
 = 
	`LOOKUP
(
r
, 
key
);

1541 ià(
n
 !ğ
NULL
) {

1542 * 
v®
 = 
	`LDF
(
n
, 
v
);

1543  
v®
;

1545  
NULL
;

1546 
	}
}

1554 
	$TMrbŒ“_g‘
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
) {

1555 
node_t
* 
n
 = 
	`TX_LOOKUP
(
r
, 
key
);

1556 ià(
n
 !ğ
NULL
) {

1557 * 
v®
 = 
	`TX_LDF_P
(
n
, 
v
);

1558  
v®
;

1560  
NULL
;

1561 
	}
}

1569 
	$rbŒ“_cÚšs
 (
rbŒ“_t
* 
r
, * 
key
)

1571 
node_t
* 
n
 = 
	`LOOKUP
(
r
, 
key
);

1572  (
n
 !ğ
NULL
);

1573 
	}
}

1581 
	$TMrbŒ“_cÚšs
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
)

1583 
node_t
* 
n
 = 
	`TX_LOOKUP
(
r
, 
key
);

1584  (
n
 !ğ
NULL
);

1585 
	}
}

1592 #ifdeà
TEST_RBTREE


1595 
	~<as£¹.h
>

1596 
	~<¡dio.h
>

1600 
	$com·»
 (cÚ¡ * 
a
, cÚ¡ * 
b
)

1602  (*((cÚ¡ *)
a
è- *((cÚ¡ *)
b
));

1603 
	}
}

1607 
	$š£¹IÁ
 (
rbŒ“_t
* 
rbŒ“PŒ
, * 
d©a
)

1609 
	`´štf
("In£¹šg: %li\n", *
d©a
);

1610 
	`rbŒ“_š£¹
(
rbŒ“PŒ
, (*)
d©a
, (*)data);

1611 
	`as£¹
(*(*)
	`rbŒ“_g‘
(
rbŒ“PŒ
, (*)
d©a
) == *data);

1612 
	`as£¹
(
	`rbŒ“_v”ify
(
rbŒ“PŒ
, 0) > 0);

1613 
	}
}

1617 
	$»moveIÁ
 (
rbŒ“_t
* 
rbŒ“PŒ
, * 
d©a
)

1619 
	`´štf
("Removšg: %li\n", *
d©a
);

1620 
	`rbŒ“_d–‘e
(
rbŒ“PŒ
, (*)
d©a
);

1621 
	`as£¹
(
	`rbŒ“_g‘
(
rbŒ“PŒ
, (*)
d©a
è=ğ
NULL
);

1622 
	`as£¹
(
	`rbŒ“_v”ify
(
rbŒ“PŒ
, 0) > 0);

1623 
	}
}

1627 
	$maš
 ()

1629 
d©a
[] = {3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5, 8, 9, 7};

1630 
numD©a
 = (
d©a
) / (data[0]);

1631 
i
;

1633 
	`puts
("Starting...");

1635 
rbŒ“_t
* 
rbŒ“PŒ
 = 
	`rbŒ“_®loc
(&
com·»
);

1636 
	`as£¹
(
rbŒ“PŒ
);

1638 
i
 = 0; i < 
numD©a
; i++) {

1639 
	`š£¹IÁ
(
rbŒ“PŒ
, &
d©a
[
i
]);

1642 
i
 = 0; i < 
numD©a
; i++) {

1643 
	`»moveIÁ
(
rbŒ“PŒ
, &
d©a
[
i
]);

1646 
	`rbŒ“_ä“
(
rbŒ“PŒ
);

1648 
	`puts
("Done.");

1651 
	}
}

	@utils/estm-0.2.4.3/bench/lf-rbtree/rbtree.h

83 #iâdeà
RBTREE_H


84 
	#RBTREE_H
 1

	)

88 
	~"ty³s.h
"

91 #ifdeà
__ılu¥lus


96 
rbŒ“
 
	trbŒ“_t
;

104 
rbŒ“_v”ify
 (
rbŒ“_t
* 
s
, 
v”bo£
);

111 
rbŒ“_t
*

112 
rbŒ“_®loc
 ((*
com·»
)(const *, const *));

119 
rbŒ“_t
*

120 
TMrbŒ“_®loc
 (
TM_ARGDECL
 (*
com·»
)(const *, const *));

128 
rbŒ“_ä“
 (
rbŒ“_t
* 
r
);

136 
TMrbŒ“_ä“
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
);

144 
boŞ_t


145 
rbŒ“_š£¹
 (
rbŒ“_t
* 
r
, * 
key
, * 
v®
);

153 
TM_CALLABLE


154 
boŞ_t


155 
TMrbŒ“_š£¹
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
, * 
v®
);

162 
boŞ_t


163 
rbŒ“_d–‘e
 (
rbŒ“_t
* 
r
, * 
key
);

170 
TM_CALLABLE


171 
boŞ_t


172 
TMrbŒ“_d–‘e
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
);

180 
boŞ_t


181 
rbŒ“_upd©e
 (
rbŒ“_t
* 
r
, * 
key
, * 
v®
);

189 
TM_CALLABLE


190 
boŞ_t


191 
TMrbŒ“_upd©e
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
, * 
v®
);

199 
rbŒ“_g‘
 (
rbŒ“_t
* 
r
, * 
key
);

206 
TM_CALLABLE


208 
TMrbŒ“_g‘
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
);

215 
boŞ_t


216 
rbŒ“_cÚšs
 (
rbŒ“_t
* 
r
, * 
key
);

223 
TM_CALLABLE


224 
boŞ_t


225 
TMrbŒ“_cÚšs
 (
TM_ARGDECL
 
rbŒ“_t
* 
r
, * 
key
);

228 
	#TMRBTREE_ALLOC
(è
	`TMrbŒ“_®loc
(
TM_ARG_ALONE
)

	)

229 
	#TMRBTREE_FREE
(
r
è
	`TMrbŒ“_ä“
(
TM_ARG
„)

	)

230 
	#TMRBTREE_INSERT
(
r
, 
k
, 
v
è
	`TMrbŒ“_š£¹
(
TM_ARG
„, (*)(k), (*)(v))

	)

231 
	#TMRBTREE_DELETE
(
r
, 
k
è
	`TMrbŒ“_d–‘e
(
TM_ARG
„, (*)(k))

	)

232 
	#TMRBTREE_UPDATE
(
r
, 
k
, 
v
è
	`TMrbŒ“_upd©e
(
TM_ARG
„, (*)(k), (*)(v))

	)

233 
	#TMRBTREE_GET
(
r
, 
k
è
	`TMrbŒ“_g‘
(
TM_ARG
„, (*)(k))

	)

234 
	#TMRBTREE_CONTAINS
(
r
, 
k
è
	`TMrbŒ“_cÚšs
(
TM_ARG
„, (*)(k))

	)

237 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/bench/lf-rbtree/types.h

73 #iâdeà
TYPES_H


74 
	#TYPES_H
 1

	)

77 #ifdeà
__ılu¥lus


82 #ifdeà
SIMULATOR


83 #undeà
TRUE


84 #undeà
FALSE


85 #undeà
boŞ


89 
	tulÚg_t
;

92 
FALSE
 = 0,

93 
TRUE
 = 1

96 
	tboŞ_t
;

99 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/bench/lf-skiplist/intset.c

23 
	~<as£¹.h
>

24 
	~<g‘İt.h
>

25 
	~<lim™s.h
>

26 
	~<±h»ad.h
>

27 
	~<sigÇl.h
>

28 
	~<¡dlib.h
>

29 
	~<¡dio.h
>

30 
	~<sys/time.h
>

31 
	~<time.h
>

32 
	~<¡dšt.h
>

34 
	~<©omic_İs.h
>

36 
	~"¡m.h
"

37 
	~"mod_mem.h
"

39 #ifdeà
DEBUG


40 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

50 
	#TX_START
(
ty³
è{ 
sigjmp_buf
 *
_e
 = 
	`¡m_g‘_’v
(); 
	`sig£tjmp
(*_e, 0); 
	`¡m_¡¬t
(_e, 0,y³)

	)

51 
	#TX_LOAD
(
addr
è
	`¡m_lßd
((
¡m_wÜd_t
 *ïddr)

	)

52 
	#TX_STORE
(
addr
, 
v®
è
	`¡m_¡Üe
((
¡m_wÜd_t
 *ïddr, (¡m_wÜd_t)v®)

	)

53 
	#TX_END
 
	`¡m_comm™
(); }

	)

55 
	#MALLOC
(
size
è
	`¡m_m®loc
(size)

	)

56 
	#FREE
(
addr
, 
size
è
	`¡m_ä“
×ddr, size)

	)

58 
	#DEFAULT_DURATION
 10000

	)

59 
	#DEFAULT_INITIAL
 256

	)

60 
	#DEFAULT_NB_THREADS
 1

	)

61 
	#DEFAULT_RANGE
 0xFFFF

	)

62 
	#DEFAULT_SEED
 0

	)

63 
	#DEFAULT_UPDATE
 20

	)

65 
	#XSTR
(
s
è
	`STR
(s)

	)

66 
	#STR
(
s
è#s

	)

68 
	#ATOMIC_CAS_MB
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

69 
	#ATOMIC_FETCH_AND_INC_FULL
(
a
è(
	`AO_ãtch_ªd_add1_fuÎ
((vŞ©
AO_t
 *)×)))

	)

75 vŞ©
AO_t
 
	g¡İ
;

76 
	gglob®_£ed
;

83 #ifdeà
TLS


84 
__th»ad
 *
	gºg_£ed
;

86 
±h»ad_key_t
 
	gºg_£ed_key
;

88 
	gËv–max
;

90 
	#TRANSACTIONAL
 
d
->
un™_tx


	)

92 
šŒ_t
 
	tv®_t
;

93 
šŒ_t
 
	tËv–_t
;

94 
	#VAL_MIN
 
INT_MIN


	)

95 
	#VAL_MAX
 
INT_MAX


	)

98 
	s¦_node
 {

99 
v®_t
 
	mv®
;

100 
šŒ_t
 
	md–‘ed
;

101 
	mtİËv–
;

102 
¦_node
 **
	mÃxt
;

103 } 
	t¦_node_t
;

105 
	s¦_št£t
 {

106 
¦_node_t
 *
	mh—d
;

107 } 
	t¦_št£t_t
;

109 
šlše
 
	$¿nd_100
()

111 #ifdeà
TLS


112  
	`¿nd_r
(
ºg_£ed
) % 100;

114  
	`¿nd_r
((*)
	`±h»ad_g‘¥ecific
(
ºg_£ed_key
)) % 100;

116 
	}
}

118 
	$g‘_¿nd_Ëv–
() {

119 
i
, 
Ëv–
 = 1;

120 
i
 = 0; i < 
Ëv–max
 - 1; i++) {

121 ià(
	`¿nd_100
() < 50)

122 
Ëv–
++;

127  
Ëv–
;

128 
	}
}

130 
	$æoÜ_log_2
(
n
) {

131 
pos
 = 0;

132 ià(
n
 >ğ1<<16è{‚ >>ğ16; 
pos
 += 16; }

133 ià(
n
 >ğ1<< 8è{‚ >>ğ8; 
pos
 += 8; }

134 ià(
n
 >ğ1<< 4è{‚ >>ğ4; 
pos
 += 4; }

135 ià(
n
 >ğ1<< 2è{‚ >>ğ2; 
pos
 += 2; }

136 ià(
n
 >ğ1<< 1è{ 
pos
 += 1; }

137  ((
n
 =ğ0è? (-1è: 
pos
);

138 
	}
}

143 
¦_node_t
 *
	$¦_Ãw_sim¶e_node
(
v®_t
 
v®
, 
tİËv–
, 
Œª§ùiÚ®
)

145 
¦_node_t
 *
node
;

147 ià(
Œª§ùiÚ®
 > 0 &&ransactional < 6)

148 
node
 = (
¦_node_t
 *)
	`MALLOC
((sl_node_t));

150 
node
 = (
¦_node_t
 *)
	`m®loc
((sl_node_t));

151 ià(
node
 =ğ
NULL
) {

152 
	`³¼Ü
("malloc");

153 
	`ex™
(1);

156 ià(
Œª§ùiÚ®
 > 0 &&ransactional < 6)

157 
node
->
Ãxt
 = (
¦_node_t
 **)
	`MALLOC
(
tİËv–
 * (sl_node_t *));

159 
node
->
Ãxt
 = (
¦_node_t
 **)
	`m®loc
(
tİËv–
 * (sl_node_t *));

160 ià(
node
->
Ãxt
 =ğ
NULL
) {

161 
	`³¼Ü
("malloc");

162 
	`ex™
(1);

165 
node
->
v®
 = val;

166 
node
->
tİËv–
 =oplevel;

167 
node
->
d–‘ed
 = 0;

169  
node
;

170 
	}
}

176 
¦_node_t
 *
	$¦_Ãw_node
(
v®_t
 
v®
, 
¦_node_t
 *
Ãxt
, 
tİËv–
, 
Œª§ùiÚ®
)

178 
¦_node_t
 *
node
;

179 
i
;

181 
node
 = 
	`¦_Ãw_sim¶e_node
(
v®
, 
tİËv–
, 
Œª§ùiÚ®
);

183 
i
 = 0; i < 
Ëv–max
; i++)

184 
node
->
Ãxt
[
i
] =‚ext;

186  
node
;

187 
	}
}

189 
	$¦_d–‘e_node
(
¦_node_t
 *
n
)

191 
	`ä“
(
n
->
Ãxt
);

192 
	`ä“
(
n
);

193 
	}
}

195 
¦_št£t_t
 *
	$¦_£t_Ãw
()

197 
¦_št£t_t
 *
£t
;

198 
¦_node_t
 *
mš
, *
max
;

200 ià((
£t
 = (
¦_št£t_t
 *)
	`m®loc
((¦_št£t_t))è=ğ
NULL
) {

201 
	`³¼Ü
("malloc");

202 
	`ex™
(1);

204 
max
 = 
	`¦_Ãw_node
(
VAL_MAX
, 
NULL
, 
Ëv–max
, 0);

205 
mš
 = 
	`¦_Ãw_node
(
VAL_MIN
, 
max
, 
Ëv–max
, 0);

206 
£t
->
h—d
 = 
mš
;

207  
£t
;

208 
	}
}

210 
	$¦_£t_d–‘e
(
¦_št£t_t
 *
£t
)

212 
¦_node_t
 *
node
, *
Ãxt
;

214 
node
 = 
£t
->
h—d
;

215 
node
 !ğ
NULL
) {

216 
Ãxt
 = 
node
->next[0];

217 
	`¦_d–‘e_node
(
node
);

218 
node
 = 
Ãxt
;

220 
	`ä“
(
£t
);

221 
	}
}

223 
	$¦_£t_size
(
¦_št£t_t
 *
£t
)

225 
size
 = 0;

226 
¦_node_t
 *
node
;

228 
node
 = 
£t
->
h—d
->
Ãxt
[0];

229 
node
->
Ãxt
[0] !ğ
NULL
) {

230 ià(!
node
->
d–‘ed
)

231 
size
++;

232 
node
 =‚ode->
Ãxt
[0];

235  
size
;

236 
	}
}

	@utils/estm-0.2.4.3/bench/lf-skiplist/lf-sl.c

23 
	~"št£t.c
"

24 
	#ATOMIC_LOAD_MB
(
a
è(
	`AO_lßd
((vŞ©
AO_t
 *)×)))

	)

25 
	#MAXLEVEL
 32

	)

31 
šlše
 
	$is_m¬ked
(
ušŒ_t
 
i
) {

32  ()(
i
 & (
ušŒ_t
)0x01);

33 
	}
}

35 
šlše
 
ušŒ_t
 
	$un£t_m¬k
(
ušŒ_t
 
i
) {

36  (
i
 & ~(
ušŒ_t
)0x01);

37 
	}
}

39 
šlše
 
ušŒ_t
 
	$£t_m¬k
(
ušŒ_t
 
i
) {

40  (
i
 | (
ušŒ_t
)0x01);

41 
	}
}

43 
šlše
 
v®_t
 
	$g‘_v®
(
¦_node_t
 *
n
) {

44  ((
¦_node_t
 *)
	`un£t_m¬k
((
ušŒ_t
)
n
))->
v®
;

45 
	}
}

47 
	$äa£r_£¬ch
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
, 
¦_node_t
 **
Ëá_li¡
, sl_node_ˆ**
right_li¡
) {

48 
i
;

49 
¦_node_t
 *
Ëá
, *
Ëá_Ãxt
, *
right
, *
right_Ãxt
;

51 #ifdeà
DEBUG


52 
	`´štf
("++> fraser_search\n");

53 
IO_FLUSH
;

56 
»Œy
:

57 
Ëá
 = 
£t
->
h—d
;

58 
i
 = 
Ëv–max
 - 1; i >= 0; i--) {

59 
Ëá_Ãxt
 = 
Ëá
->
Ãxt
[
i
];

60 ià(
	`is_m¬ked
((
ušŒ_t
)
Ëá_Ãxt
))

61 
»Œy
;

63 
right
 = 
Ëá_Ãxt
; ;„ighˆğ
right_Ãxt
) {

66 
right_Ãxt
 = 
right
->
Ãxt
[
i
];

67 ià(!
	`is_m¬ked
((
ušŒ_t
)
right_Ãxt
))

69 
right
 = (
¦_node_t
*)
	`un£t_m¬k
((
ušŒ_t
)
right_Ãxt
);

71 ià(
right
->
v®
 >= val)

73 
Ëá
 = 
right
;

74 
Ëá_Ãxt
 = 
right_Ãxt
;

77 ià((
Ëá_Ãxt
 !ğ
right
) &&

78 (!
	`ATOMIC_CAS_MB
(&
Ëá
->
Ãxt
[
i
], 
Ëá_Ãxt
, 
right
)))

79 
»Œy
;

80 ià(
Ëá_li¡
 !ğ
NULL
)

81 
Ëá_li¡
[
i
] = 
Ëá
;

82 ià(
right_li¡
 !ğ
NULL
)

83 
right_li¡
[
i
] = 
right
;

86 #ifdeà
DEBUG


87 
	`´štf
("++> fraser_searchƒnds\n");

88 
IO_FLUSH
;

90 
	}
}

92 
	$äa£r_fšd
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
) {

93 
¦_node_t
 **
succs
;

94 
»suÉ
;

96 #ifdeà
DEBUG


97 
	`´štf
("++> fraser_find\n");

98 
IO_FLUSH
;

101 
succs
 = (
¦_node_t
 **)
	`m®loc
(
Ëv–max
 * (sl_node_t *));

102 
	`äa£r_£¬ch
(
£t
, 
v®
, 
NULL
, 
succs
);

103 
»suÉ
 = (
succs
[0]->
v®
 =ğv® && !succs[0]->
d–‘ed
);

104 
	`ä“
(
succs
);

105  
»suÉ
;

106 
	}
}

108 
	$m¬k_node_±rs
(
¦_node_t
 *
n
) {

109 
i
;

110 
¦_node_t
 *
n_Ãxt
;

112 
i
=
n
->
tİËv–
-1; i>=0; i--) {

114 
n_Ãxt
 = 
n
->
Ãxt
[
i
];

115 ià(
	`is_m¬ked
((
ušŒ_t
)
n_Ãxt
))

117 } !
	`ATOMIC_CAS_MB
(&
n
->
Ãxt
[
i
], 
n_Ãxt
, 
	`£t_m¬k
((
ušŒ_t
)n_next)));

119 
	}
}

121 
	$äa£r_»move
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
) {

122 
¦_node_t
 **
succs
;

123 
»suÉ
;

125 #ifdeà
DEBUG


126 
	`´štf
("++> fraser_remove\n");

127 
IO_FLUSH
;

130 
succs
 = (
¦_node_t
 **)
	`m®loc
(
Ëv–max
 * (sl_node_t *));

131 
	`äa£r_£¬ch
(
£t
, 
v®
, 
NULL
, 
succs
);

132 
»suÉ
 = (
succs
[0]->
v®
 == val);

133 ià(
»suÉ
 == 0)

134 
’d
;

136 ià(
succs
[0]->
d–‘ed
) {

137 #ifdeà
DEBUG


138 
	`´štf
("++> fraser_removeƒnds\n");

139 
IO_FLUSH
;

141 
»suÉ
 = 0;

142 
’d
;

144 
	`ATOMIC_FETCH_AND_INC_FULL
(&
succs
[0]->
d–‘ed
);

146 
	`m¬k_node_±rs
(
succs
[0]);

147 
	`äa£r_£¬ch
(
£t
, 
v®
, 
NULL
, NULL);

148 
’d
:

149 
	`ä“
(
succs
);

150 #ifdeà
DEBUG


151 
	`´štf
("++> fraser_removeƒnds\n");

152 
IO_FLUSH
;

155  
»suÉ
;

156 
	}
}

158 
	$äa£r_š£¹
(
¦_št£t_t
 *
£t
, 
v®_t
 
v
) {

159 
¦_node_t
 *
Ãw
, *
Ãw_Ãxt
, *
´ed
, *
succ
, **
succs
, **
´eds
;

160 
i
;

161 
»suÉ
;

163 #ifdeà
DEBUG


164 
	`´štf
("++> fraser_insert\n");

165 
IO_FLUSH
;

168 
Ãw
 = 
	`¦_Ãw_sim¶e_node
(
v
, 
	`g‘_¿nd_Ëv–
(), 6);

169 
´eds
 = (
¦_node_t
 **)
	`m®loc
(
Ëv–max
 * (sl_node_t *));

170 
succs
 = (
¦_node_t
 **)
	`m®loc
(
Ëv–max
 * (sl_node_t *));

171 
»Œy
:

172 
	`äa£r_£¬ch
(
£t
, 
v
, 
´eds
, 
succs
);

174 ià(
succs
[0]->
v®
 =ğ
v
) {

176 ià(
succs
[0]->
d–‘ed
) {

178 
	`m¬k_node_±rs
(
succs
[0]);

179 
»Œy
;

181 
»suÉ
 = 0;

182 
	`¦_d–‘e_node
(
Ãw
);

183 
’d
;

185 
i
 = 0; i < 
Ãw
->
tİËv–
; i++)

186 
Ãw
->
Ãxt
[
i
] = 
succs
[i];

188 ià(!
	`ATOMIC_CAS_MB
(&
´eds
[0]->
Ãxt
[0], 
succs
[0], 
Ãw
))

189 
»Œy
;

190 
i
 = 1; i < 
Ãw
->
tİËv–
; i++) {

192 
´ed
 = 
´eds
[
i
];

193 
succ
 = 
succs
[
i
];

195 
Ãw_Ãxt
 = 
Ãw
->
Ãxt
[
i
];

196 ià((
Ãw_Ãxt
 !ğ
succ
) &&

197 (!
	`ATOMIC_CAS_MB
(&
Ãw
->
Ãxt
[
i
], 
	`un£t_m¬k
((
ušŒ_t
)
Ãw_Ãxt
), 
succ
)))

200 ià(
succ
->
v®
 =ğ
v
)

201 
succ
 = (
¦_node_t
 *)
	`un£t_m¬k
((
ušŒ_t
)succ->
Ãxt
);

203 ià(
	`ATOMIC_CAS_MB
(&
´ed
->
Ãxt
[
i
], 
succ
, 
Ãw
))

205 
	`äa£r_£¬ch
(
£t
, 
v
, 
´eds
, 
succs
);

208 
»suÉ
 = 1;

209 
’d
:

210 
	`ä“
(
´eds
);

211 
	`ä“
(
succs
);

213  
»suÉ
;

214 
	}
}

220 
	$¦_cÚšs
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

222 
»suÉ
 = 0;

223 
i
;

224 
¦_node_t
 *
node
, *
Ãxt
;

225 
v®_t
 
v
 = 
VAL_MIN
;

227 #ifdeà
DEBUG


228 
	`´štf
("++> sl_cÚšs(%d)\n", (è
v®
);

229 
IO_FLUSH
;

232 
Œª§ùiÚ®
) {

235 
node
 = 
£t
->
h—d
;

236 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

237 
Ãxt
 = 
node
->Ãxt[
i
];

238 
Ãxt
->
v®
 < val) {

239 
node
 = 
Ãxt
;

240 
Ãxt
 = 
node
->Ãxt[
i
];

243 
node
 =‚ode->
Ãxt
[0];

244 
»suÉ
 = (
node
->
v®
 == val);

248 
	`TX_START
(
NL
);

249 
node
 = 
£t
->
h—d
;

250 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

251 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

252 (
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
)) < val) {

253 
node
 = 
Ãxt
;

254 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

257 
node
 = (
¦_node_t
 *)
	`TX_LOAD
(&node->
Ãxt
[0]);

258 
»suÉ
 = (
v
 =ğ
v®
);

259 
TX_END
;

265 
	`TX_START
(
EL
);

266 
node
 = 
£t
->
h—d
;

267 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

268 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

269 (
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
)) < val) {

270 
node
 = 
Ãxt
;

271 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

274 
node
 = (
¦_node_t
 *)
	`TX_LOAD
(&node->
Ãxt
[0]);

275 
»suÉ
 = (
v
 =ğ
v®
);

276 
TX_END
;

280 
»suÉ
 = 
	`äa£r_fšd
(
£t
, 
v®
);

284 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

285 
	`ex™
(1);

288  
»suÉ
;

289 
	}
}

291 
	$¦_add
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

293 
»suÉ
 = 0;

294 
i
, 
l
;

295 
¦_node_t
 *
node
, *
Ãxt
;

296 
¦_node_t
 *
´eds
[
MAXLEVEL
], *
succs
[MAXLEVEL];

297 
v®_t
 
v
;

299 #ifdeà
DEBUG


300 
	`´štf
("++> sl_add(%d)\n", (è
v®
);

301 
IO_FLUSH
;

304 
Œª§ùiÚ®
) {

307 
node
 = 
£t
->
h—d
;

308 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

309 
Ãxt
 = 
node
->Ãxt[
i
];

310 
Ãxt
->
v®
 < val) {

311 
node
 = 
Ãxt
;

312 
Ãxt
 = 
node
->Ãxt[
i
];

314 
´eds
[
i
] = 
node
;

315 
succs
[
i
] = 
node
->
Ãxt
[i];

317 
node
 =‚ode->
Ãxt
[0];

318 ià((
»suÉ
 = (
node
->
v®
 != val)) == 1) {

319 
l
 = 
	`g‘_¿nd_Ëv–
();

320 
node
 = 
	`¦_Ãw_sim¶e_node
(
v®
, 
l
, 
Œª§ùiÚ®
);

321 
i
 = 0; i < 
l
; i++) {

322 
node
->
Ãxt
[
i
] = 
succs
[i];

323 
´eds
[
i
]->
Ãxt
[i] = 
node
;

330 
	`TX_START
(
NL
);

331 
v
 = 
VAL_MIN
;

332 
node
 = 
£t
->
h—d
;

333 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

334 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

335 (
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
)) < val) {

336 
node
 = 
Ãxt
;

337 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

339 
´eds
[
i
] = 
node
;

340 
succs
[
i
] = 
Ãxt
;

342 ià((
»suÉ
 = (
v
 !ğ
v®
)) == 1) {

343 
l
 = 
	`g‘_¿nd_Ëv–
();

344 
node
 = 
	`¦_Ãw_sim¶e_node
(
v®
, 
l
, 
Œª§ùiÚ®
);

345 
i
 = 0; i < 
l
; i++) {

346 
node
->
Ãxt
[
i
] = (
¦_node_t
 *)
	`TX_LOAD
(&
succs
[i]);

347 
	`TX_STORE
(&
´eds
[
i
]->
Ãxt
[i], 
node
);

350 
TX_END
;

355 
	`TX_START
(
EL
);

356 
v
 = 
VAL_MIN
;

357 
node
 = 
£t
->
h—d
;

358 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

359 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

360 (
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
)) < val) {

361 
node
 = 
Ãxt
;

362 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

364 
´eds
[
i
] = 
node
;

365 
succs
[
i
] = 
Ãxt
;

367 ià((
»suÉ
 = (
v
 !ğ
v®
)) == 1) {

368 
l
 = 
	`g‘_¿nd_Ëv–
();

369 
node
 = 
	`¦_Ãw_sim¶e_node
(
v®
, 
l
, 
Œª§ùiÚ®
);

370 
i
 = 0; i < 
l
; i++) {

371 
node
->
Ãxt
[
i
] = (
¦_node_t
 *)
	`TX_LOAD
(&
succs
[i]);

372 
	`TX_STORE
(&
´eds
[
i
]->
Ãxt
[i], 
node
);

375 
TX_END
;

379 
»suÉ
 = 
	`äa£r_š£¹
(
£t
, 
v®
);

383 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

384 
	`ex™
(1);

388  
»suÉ
;

389 
	}
}

391 
	$¦_»move
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

393 
»suÉ
 = 0;

394 
i
;

395 
¦_node_t
 *
node
, *
Ãxt
 = 
NULL
;

396 
¦_node_t
 *
´eds
[
MAXLEVEL
], *
succs
[MAXLEVEL];

397 
v®_t
 
v
;

399 #ifdeà
DEBUG


400 
	`´štf
("++> sl_»move(%d)\n", (è
v®
);

401 
IO_FLUSH
;

404 
Œª§ùiÚ®
) {

407 
node
 = 
£t
->
h—d
;

408 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

409 
Ãxt
 = 
node
->Ãxt[
i
];

410 
Ãxt
->
v®
 < val) {

411 
node
 = 
Ãxt
;

412 
Ãxt
 = 
node
->Ãxt[
i
];

414 
´eds
[
i
] = 
node
;

415 
succs
[
i
] = 
node
->
Ãxt
[i];

417 ià((
»suÉ
 = (
Ãxt
->
v®
 == val)) == 1) {

418 
i
 = 0; i < 
£t
->
h—d
->
tİËv–
; i++)

419 ià(
succs
[
i
]->
v®
 == val)

420 
´eds
[
i
]->
Ãxt
[i] = 
succs
[i]->next[i];

427 
	`TX_START
(
NL
);

428 
v
 = 
VAL_MIN
;

429 
node
 = 
£t
->
h—d
;

430 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

431 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

432 (
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
)) < val) {

433 
node
 = 
Ãxt
;

434 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

437 
´eds
[
i
] = 
node
;

438 
succs
[
i
] = 
Ãxt
;

440 ià((
»suÉ
 = (
Ãxt
->
v®
 == val))) {

441 
i
 = 0; i < 
£t
->
h—d
->
tİËv–
; i++)

442 ià(
succs
[
i
]->
v®
 == val)

443 
	`TX_STORE
(&
´eds
[
i
]->
Ãxt
[i], (
¦_node_t
 *)
	`TX_LOAD
(&
succs
[i]->next[i]));

445 
	`FREE
(
Ãxt
, (
¦_node_t
));

447 
TX_END
;

451 
	`TX_START
(
EL
);

452 
v
 = 
VAL_MIN
;

453 
node
 = 
£t
->
h—d
;

454 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

455 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

456 (
v
 = 
	`TX_LOAD
(&
Ãxt
->
v®
)) < val) {

457 
node
 = 
Ãxt
;

458 
Ãxt
 = (
¦_node_t
 *)
	`TX_LOAD
(&
node
->Ãxt[
i
]);

461 
´eds
[
i
] = 
node
;

462 
succs
[
i
] = 
Ãxt
;

464 ià((
»suÉ
 = (
Ãxt
->
v®
 == val))) {

465 
i
 = 0; i < 
£t
->
h—d
->
tİËv–
; i++)

466 ià(
succs
[
i
]->
v®
 == val)

467 
	`TX_STORE
(&
´eds
[
i
]->
Ãxt
[i], (
¦_node_t
 *)
	`TX_LOAD
(&
succs
[i]->next[i]));

470 
	`FREE
(
Ãxt
, (
¦_node_t
));

473 
TX_END
;

477 
»suÉ
 = 
	`äa£r_»move
(
£t
, 
v®
);

481 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØ–a¡ic™y.\n", 
Œª§ùiÚ®
);

482 
	`ex™
(1);

485  
»suÉ
;

486 
	}
}

493 
	sb¬r›r
 {

494 
±h»ad_cÚd_t
 
	mcom¶‘e
;

495 
±h»ad_mu‹x_t
 
	mmu‹x
;

496 
	mcouÁ
;

497 
	müossšg
;

498 } 
	tb¬r›r_t
;

500 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

502 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

503 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

504 
b
->
couÁ
 = 
n
;

505 
b
->
üossšg
 = 0;

506 
	}
}

508 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

510 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

512 
b
->
üossšg
++;

514 ià(
b
->
üossšg
 < b->
couÁ
) {

515 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

517 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

519 
b
->
üossšg
 = 0;

521 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

522 
	}
}

534 
šlše
 
	$¿nd_¿nge
(
r
) {

535 
m
 = 
RAND_MAX
;

536 
d
;

537 
v
 = 0;

540 
d
 = (
m
 > 
r
 ?„ : m);

541 
v
 +ğ1 + ()(
d
 * (()
	`¿nd
()/(()(
m
)+1.0)));

542 
r
 -ğ
m
;

543 } 
r
 > 0);

544  
v
;

545 
	}
}

547 
	sth»ad_d©a
 {

548 
	m¿nge
;

549 
	mupd©e
;

550 #iâdeà
USE_RBTREE


551 
	mun™_tx
;

553 
	mnb_add
;

554 
	mnb_»move
;

555 
	mnb_cÚšs
;

556 
	mnb_found
;

557 
	mnb_abÜts
;

558 
	mnb_abÜts_locked_»ad
;

559 
	mnb_abÜts_locked_wr™e
;

560 
	mnb_abÜts_v®id©e_»ad
;

561 
	mnb_abÜts_v®id©e_wr™e
;

562 
	mnb_abÜts_v®id©e_comm™
;

563 
	mnb_abÜts_šv®id_memÜy
;

564 
	mnb_abÜts_doubË_wr™e
;

565 
	mmax_»Œ›s
;

566 
	mdiff
;

567 
	m£ed
;

568 
¦_št£t_t
 *
	m£t
;

569 
b¬r›r_t
 *
	mb¬r›r
;

570 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

571 } 
	tth»ad_d©a_t
;

574 
	$´št_skli¡
(
¦_št£t_t
 *
£t
) {

575 
¦_node_t
 *
cu¼
;

576 
i
, 
j
;

577 
¬r
[
Ëv–max
];

579 
i
=0; i<  
¬r
/‡rr[0]; i++)‡rr[i] = 0;

581 
cu¼
 = 
£t
->
h—d
;

583 
	`´štf
("%d", (è
cu¼
->
v®
);

584 
i
=0; i<
cu¼
->
tİËv–
; i++) {

585 
	`´štf
("-*");

587 
¬r
[
cu¼
->
tİËv–
-1]++;

588 
	`´štf
("\n");

589 
cu¼
 = cu¼->
Ãxt
[0];

590 } 
cu¼
);

591 
j
=0; j<
Ëv–max
; j++)

592 
	`´štf
("%d‚ode oàËv– %d\n", 
¬r
[
j
], j);

593 
	}
}

595 *
	$‹¡
(*
d©a
)

597 
v®
, 
Ï¡
 = 0;

598 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

600 #ifdeà
TLS


601 
ºg_£ed
 = &
d
->
£ed
;

603 
	`±h»ad_£t¥ecific
(
ºg_£ed_key
, &
d
->
£ed
);

607 
	`¡m_š™_th»ad
();

609 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

611 
Ï¡
 = -1;

612 
¡İ
 == 0) {

613 
v®
 = 
	`¿nd_r
(&
d
->
£ed
) % 100;

614 ià(
v®
 < 
d
->
upd©e
) {

615 ià(
Ï¡
 < 0) {

617 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

618 ià(
	`¦_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

619 
d
->
diff
++;

620 
Ï¡
 = 
v®
;

623 
d
->
nb_add
++;

626 ià(
	`¦_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
)) {

627 
d
->
diff
--;

629 
Ï¡
 = -1;

631 
d
->
nb_»move
++;

635 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

636 ià(
	`¦_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

637 
d
->
nb_found
++;

638 
d
->
nb_cÚšs
++;

641 
	`¡m_g‘_¡©s
("nb_abÜts", &
d
->
nb_abÜts
);

642 
	`¡m_g‘_¡©s
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
);

643 
	`¡m_g‘_¡©s
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
);

644 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
);

645 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
);

646 
	`¡m_g‘_¡©s
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
);

647 
	`¡m_g‘_¡©s
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
);

648 
	`¡m_g‘_¡©s
("nb_abÜts_doubË_wr™e", &
d
->
nb_abÜts_doubË_wr™e
);

649 
	`¡m_g‘_¡©s
("max_»Œ›s", &
d
->
max_»Œ›s
);

651 
	`¡m_ex™_th»ad
();

653  
NULL
;

654 
	}
}

656 
	$ÿtch”
(
sig
)

658 
	`´štf
("CAUGHT SIGNAL %d\n", 
sig
);

659 
	}
}

661 
	$maš
(
¬gc
, **
¬gv
)

663 
İtiÚ
 
lÚg_İtiÚs
[] = {

665 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

666 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

667 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

668 {"num-th»ads", 
»quœed_¬gum’t
, 
NULL
, 'n'},

669 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

670 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 's'},

671 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

672 {"–a¡ic™y", 
»quœed_¬gum’t
, 
NULL
, 'x'},

673 {
NULL
, 0, NULL, 0}

676 
¦_št£t_t
 *
£t
;

677 
i
, 
c
, 
v®
, 
size
;

678 *
s
;

679 
»ads
, 
upd©es
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

680 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

681 
abÜts_šv®id_memÜy
, 
abÜts_doubË_wr™e
, 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

682 
th»ad_d©a_t
 *
d©a
;

683 
±h»ad_t
 *
th»ads
;

684 
±h»ad_©Œ_t
 
©Œ
;

685 
b¬r›r_t
 
b¬r›r
;

686 
timev®
 
¡¬t
, 
’d
;

687 
time¥ec
 
timeout
;

688 
du¿tiÚ
 = 
DEFAULT_DURATION
;

689 
š™Ÿl
 = 
DEFAULT_INITIAL
;

690 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

691 
¿nge
 = 
DEFAULT_RANGE
;

692 
£ed
 = 
DEFAULT_SEED
;

693 
upd©e
 = 
DEFAULT_UPDATE
;

694 #iâdeà
USE_RBTREE


695 
un™_tx
 = 4;

697 
sig£t_t
 
block_£t
;

700 
i
 = 0;

701 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hd:i:n:r:s:u:"

702 #iâdeà
USE_RBTREE


705 , 
lÚg_İtiÚs
, &
i
);

707 if(
c
 == -1)

710 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

711 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

713 
c
) {

717 
	`´štf
("intset -- STM stressest "

718 #ifdeà
USE_RBTREE


731 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

733 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

735 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

737 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

739 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

741 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

742 #iâdeà
USE_RBTREE


753 
	`ex™
(0);

755 
du¿tiÚ
 = 
	`©oi
(
İrg
);

758 
š™Ÿl
 = 
	`©oi
(
İrg
);

761 
nb_th»ads
 = 
	`©oi
(
İrg
);

764 
¿nge
 = 
	`©oi
(
İrg
);

767 
£ed
 = 
	`©oi
(
İrg
);

770 
upd©e
 = 
	`©oi
(
İrg
);

772 #iâdeà
USE_RBTREE


774 
un™_tx
 = 
	`©oi
(
İrg
);

778 
	`´štf
("Use -h or --help for help\n");

779 
	`ex™
(0);

781 
	`ex™
(1);

785 
	`as£¹
(
du¿tiÚ
 >= 0);

786 
	`as£¹
(
š™Ÿl
 >= 0);

787 
	`as£¹
(
nb_th»ads
 > 0);

788 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

789 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

791 #ifdeà
USE_RBTREE


792 
	`´štf
("Setype :„ed-blackree\n");

794 
	`´štf
("Setype : skip†ist\n");

796 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

797 
	`´štf
("In™ŸÈsiz: %u\n", 
š™Ÿl
);

798 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

799 
	`´štf
("V®u¿ng : %d\n", 
¿nge
);

800 
	`´štf
("S“d : %d\n", 
£ed
);

801 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

802 #iâdeà
USE_RBTREE


803 
	`´štf
("EÏ¡ic™y : %d\n", 
un™_tx
);

805 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

809 ()(
¡m_wÜd_t
));

811 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

812 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

814 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

815 
	`³¼Ü
("malloc");

816 
	`ex™
(1);

818 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

819 
	`³¼Ü
("malloc");

820 
	`ex™
(1);

823 ià(
£ed
 == 0)

824 
	`¤ªd
(()
	`time
(0));

826 
	`¤ªd
(
£ed
);

828 
Ëv–max
 = 
	`æoÜ_log_2
((è
š™Ÿl
);

829 
£t
 = 
	`¦_£t_Ãw
();

830 
¡İ
 = 0;

832 
glob®_£ed
 = 
	`¿nd
();

833 #ifdeà
TLS


834 
ºg_£ed
 = &
glob®_£ed
;

836 ià(
	`±h»ad_key_ü—‹
(&
ºg_£ed_key
, 
NULL
) != 0) {

837 
	`årštf
(
¡d”r
, "Error creatinghread†ocal\n");

838 
	`ex™
(1);

840 
	`±h»ad_£t¥ecific
(
ºg_£ed_key
, &
glob®_£ed
);

844 
	`´štf
("Initializing STM\n");

845 
	`¡m_š™
();

846 
	`mod_mem_š™
();

848 ià(
	`¡m_g‘_·¿m‘”
("compe_æags", &
s
))

849 
	`´štf
("STM fÏg  : %s\n", 
s
);

852 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

853 
i
 = 0;

854 
i
 < 
š™Ÿl
) {

856 
v®
 = 
	`¿nd_¿nge
(
¿nge
);

857 ià(
	`¦_add
(
£t
, 
v®
, 0))

858 
i
++;

860 
size
 = 
	`¦_£t_size
(
£t
);

861 
	`´štf
("S‘ siz : %d\n", 
size
);

862 
	`´štf
("Lev– max : %d\n", 
Ëv–max
);

865 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

866 
	`±h»ad_©Œ_š™
(&
©Œ
);

867 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

868 
i
 = 0; i < 
nb_th»ads
; i++) {

869 
	`´štf
("C»©šgh»ad %d\n", 
i
);

870 
d©a
[
i
].
¿nge
 =„ange;

871 
d©a
[
i
].
upd©e
 = update;

872 #iâdeà
USE_RBTREE


873 
d©a
[
i
].
un™_tx
 = unit_tx;

875 
d©a
[
i
].
nb_add
 = 0;

876 
d©a
[
i
].
nb_»move
 = 0;

877 
d©a
[
i
].
nb_cÚšs
 = 0;

878 
d©a
[
i
].
nb_found
 = 0;

879 
d©a
[
i
].
nb_abÜts
 = 0;

880 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

881 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

882 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

883 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

884 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

885 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

886 
d©a
[
i
].
nb_abÜts_doubË_wr™e
 = 0;

887 
d©a
[
i
].
max_»Œ›s
 = 0;

888 
d©a
[
i
].
diff
 = 0;

889 
d©a
[
i
].
£ed
 = 
	`¿nd
();

890 
d©a
[
i
].
£t
 = set;

891 
d©a
[
i
].
b¬r›r
 = &barrier;

892 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

893 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

894 
	`årštf
(
¡d”r
, "Error creatinghread\n");

895 
	`ex™
(1);

898 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

901 ià(
	`sigÇl
(
SIGHUP
, 
ÿtch”
è=ğ
SIG_ERR
 ||

903 
	`sigÇl
(
SIGTERM
, 
ÿtch”
è=ğ
SIG_ERR
) {

904 
	`³¼Ü
("signal");

905 
	`ex™
(1);

909 
	`b¬r›r_üoss
(&
b¬r›r
);

911 
	`´štf
("STARTING...\n");

912 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

913 ià(
du¿tiÚ
 > 0) {

914 
	`Çno¦“p
(&
timeout
, 
NULL
);

916 
	`sigem±y£t
(&
block_£t
);

917 
	`sigsu¥’d
(&
block_£t
);

919 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

920 
	`g‘timeofday
(&
’d
, 
NULL
);

921 
	`´štf
("STOPPING...\n");

924 
i
 = 0; i < 
nb_th»ads
; i++) {

925 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

926 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

927 
	`ex™
(1);

931 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

932 
abÜts
 = 0;

933 
abÜts_locked_»ad
 = 0;

934 
abÜts_locked_wr™e
 = 0;

935 
abÜts_v®id©e_»ad
 = 0;

936 
abÜts_v®id©e_wr™e
 = 0;

937 
abÜts_v®id©e_comm™
 = 0;

938 
abÜts_šv®id_memÜy
 = 0;

939 
abÜts_doubË_wr™e
 = 0;

940 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

941 
»ads
 = 0;

942 
upd©es
 = 0;

943 
max_»Œ›s
 = 0;

944 
i
 = 0; i < 
nb_th»ads
; i++) {

945 
	`´štf
("Th»ad %d\n", 
i
);

946 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

947 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

948 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

949 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

950 
	`´štf
(" #difà : %d\n", 
d©a
[
i
].
diff
);

951 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

952 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

953 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

954 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

955 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

956 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

957 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

958 
	`´štf
(" #dup-w : %lu\n", 
d©a
[
i
].
nb_abÜts_doubË_wr™e
);

959 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

960 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

961 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

962 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

963 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

964 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

965 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

966 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

967 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

968 
abÜts_doubË_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_doubË_wr™e
;

969 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

970 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

971 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

972 
size
 +ğ
d©a
[
i
].
diff
;

973 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

974 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

976 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`¦_£t_size
(
£t
), 
size
);

977 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

978 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
, (»ad + upd©esè* 1000.0 / 
du¿tiÚ
);

979 
	`´štf
("#»adx  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

980 
	`´štf
("#upd©tx  : %lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

981 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

982 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

983 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

984 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

985 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

986 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

987 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

988 
	`´štf
(" #dup-w : %lu (%à/ s)\n", 
abÜts_doubË_wr™e
,‡bÜts_doubË_wr™* 1000.0 / 
du¿tiÚ
);

989 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

990 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

996 
	`¦_£t_d–‘e
(
£t
);

999 
	`¡m_ex™
();

1001 #iâdeà
TLS


1002 
	`±h»ad_key_d–‘e
(
ºg_£ed_key
);

1005 
	`ä“
(
th»ads
);

1006 
	`ä“
(
d©a
);

1009 
	}
}

	@utils/estm-0.2.4.3/bench/lf-skiplist/lf-sl.h

15 
	$is_m¬ked_»f
(
i
) {

17  (è(
i
 &ğ
LONG_MIN
+1);

18 
	}
}

20 
	$un£t_m¬k
(
i
) {

21 
i
 &ğ
LONG_MAX
-1;

22  
i
;

23 
	}
}

25 
	$£t_m¬k
(
i
) {

26 
i
 = 
	`un£t_m¬k
(i);

27 
i
 += 1;

28  
i
;

29 
	}
}

31 
	$g‘_unm¬ked_»f
(
w
) {

32  
	`un£t_m¬k
(
w
);

33 
	}
}

35 
	$g‘_m¬ked_»f
(
w
) {

36  
	`£t_m¬k
(
w
);

37 
	}
}

39 
node_t
 *
	$h¬ris_£¬ch
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
node_t
 **
Ëá_node
) {

40 
node_t
 *
Ëá_node_Ãxt
, *
right_node
;

41 
Ëá_node_Ãxt
 = 
£t
->
h—d
;

43 
£¬ch_agaš
:

45 
node_t
 *
t
 = 
£t
->
h—d
;

46 
node_t
 *
t_Ãxt
 = 
£t
->
h—d
->
Ãxt
;

50 ià(!
	`is_m¬ked_»f
((è
t_Ãxt
)) {

51 (*
Ëá_node
èğ
t
;

52 
Ëá_node_Ãxt
 = 
t_Ãxt
;

54 
t
 = (
node_t
 *è
	`g‘_unm¬ked_»f
((è
t_Ãxt
);

55 ià(!
t
->
Ãxt
) ;

56 
t_Ãxt
 = 
t
->
Ãxt
;

57 } 
	`is_m¬ked_»f
((è
t_Ãxt
è|| (
t
->
v®
 < val));

58 
right_node
 = 
t
;

61 ià(
Ëá_node_Ãxt
 =ğ
right_node
) {

62 ià(
right_node
->
Ãxt
 && 
	`is_m¬ked_»f
(()„ight_node->next))

63 
£¬ch_agaš
;

64  
right_node
;

68 ià(
	`ATOMIC_CAS_MB
(&(*
Ëá_node
)->
Ãxt
,

69 
Ëá_node_Ãxt
,

70 
right_node
)) {

71 ià(
right_node
->
Ãxt
 && 
	`is_m¬ked_»f
(()„ight_node->next))

72 
£¬ch_agaš
;

73  
right_node
;

77 
	}
}

79 
	$h¬ris_fšd
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

80 
node_t
 *
right_node
, *
Ëá_node
;

81 
Ëá_node
 = 
£t
->
h—d
;

83 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

84 ià((!
right_node
->
Ãxt
è||„ight_node->
v®
 != val)

88 
	}
}

90 
	$h¬ris_š£¹
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

91 
node_t
 *
Ãwnode
, *
right_node
, *
Ëá_node
;

92 
Ëá_node
 = 
£t
->
h—d
;

95 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

96 ià(
right_node
->
v®
 == val)

98 
Ãwnode
 = 
	`Ãw_node
(
v®
, 
right_node
, 0);

100 
	`AO_nİ_fuÎ
();

101 ià(
	`ATOMIC_CAS_MB
(&
Ëá_node
->
Ãxt
, 
right_node
, 
Ãwnode
))

104 
	}
}

106 
	$h¬ris_d–‘e
(
št£t_t
 *
£t
, 
v®_t
 
v®
) {

107 
node_t
 *
right_node
, *
right_node_Ãxt
, *
Ëá_node
;

108 
Ëá_node
 = 
£t
->
h—d
;

111 
right_node
 = 
	`h¬ris_£¬ch
(
£t
, 
v®
, &
Ëá_node
);

112 ià(
right_node
->
v®
 != val)

114 
right_node_Ãxt
 = 
right_node
->
Ãxt
;

115 ià(!
	`is_m¬ked_»f
((è
right_node_Ãxt
))

116 ià(
	`ATOMIC_CAS_MB
(&
right_node
->
Ãxt
,

117 
right_node_Ãxt
,

118 
	`g‘_m¬ked_»f
((è
right_node_Ãxt
)))

121 ià(!
	`ATOMIC_CAS_MB
(&
Ëá_node
->
Ãxt
, 
right_node
, 
right_node_Ãxt
))

122 
right_node
 = 
	`h¬ris_£¬ch
(
£t
,„ight_node->
v®
, &
Ëá_node
);

124 
	}
}

130 
¦_node_t
 **
	$äa£r_£¬ch
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
, 
¦_node_t
 ***
Ëá_li¡
) {

131 
i
;

132 
¦_node_t
 *
Ëá
, *
Ëá_Ãxt
, *
right
, *
right_Ãxt
, **
right_li¡
;

134 *
Ëá_li¡
 = (
¦_node_t
 **)
	`m®loc
((
Ëv–max
+1) * (sl_node_t));

135 
right_li¡
 = (
¦_node_t
 **)
	`m®loc
((
Ëv–max
+1) * (sl_node_t));

137 #ifdeà
DEBUG


138 
	`´štf
("++> fraser_search\n");

139 
IO_FLUSH
;

143 
»Œy
:

144 
Ëá
 = 
£t
->
h—d
;

145 
i
=
Ëá
->
tİËv–
-1; i>=0; i--){

146 
Ëá_Ãxt
 = 
Ëá
->
Ãxt
[
i
];

147 ià(
	`is_m¬ked_»f
((è
Ëá_Ãxt
)è
»Œy
;

149 
right
 = 
Ëá_Ãxt
; ;„ighˆğ
right_Ãxt
) {

152 
right_Ãxt
 = 
right
->
Ãxt
[
i
];

153 ià(!
	`is_m¬ked_»f
((è
right_Ãxt
)) ;

154 
right
 = (
¦_node_t
*è
	`un£t_m¬k
((è
right_Ãxt
);

156 ià(
right
->
v®
 >= val) ;

157 
Ëá
 = 
right
;

158 
Ëá_Ãxt
 = 
right_Ãxt
;

162 ià((
Ëá_Ãxt
 !ğ
right
) &&

163 (!
	`ATOMIC_CAS_MB
(&
Ëá
->
Ãxt
[
i
], 
Ëá_Ãxt
, 
right
)))

164 
»Œy
;

165 (*
Ëá_li¡
)[
i
] = 
Ëá
;

166 
right_li¡
[
i
] = 
right
;

169  
right_li¡
;

170 
	}
}

172 
	$äa£r_fšd
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
) {

173 
¦_node_t
 **
Ëá_li¡
, **
succs
;

175 #ifdeà
DEBUG


176 
	`´štf
("++> fraser_find\n");

177 
IO_FLUSH
;

180 
succs
 = 
	`äa£r_£¬ch
(
£t
, 
v®
, &
Ëá_li¡
);

181  (
succs
[0]->
v®
 == val);

182 
	}
}

187 
	$m¬k_node_±rs
(
¦_node_t
 *
n
) {

188 
i
;

189 
¦_node_t
 *
n_Ãxt
;

191 
i
=
n
->
tİËv–
-1; i>=0; i--) {

193 
n_Ãxt
 = 
n
->
Ãxt
[
i
];

194 ià(
	`is_m¬ked_»f
((è
n_Ãxt
)) ;

195 } !
	`ATOMIC_CAS_MB
(&
n
->
Ãxt
[
i
], 
n_Ãxt
, 
	`£t_m¬k
(()‚_next)));

197 
	`AO_nİ_fuÎ
();

199 
	}
}

201 
	$äa£r_»move
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
) {

202 
¦_node_t
 **
Ëá_li¡
, **
succs
;

204 #ifdeà
DEBUG


205 
	`´štf
("++> fraser_remove\n");

206 
IO_FLUSH
;

210 
succs
 = 
	`äa£r_£¬ch
(
£t
, 
v®
, &
Ëá_li¡
);

211 ià(
succs
[0]->
v®
 != val)  0;

215 ià(
	`is_m¬ked_»f
(()
succs
[0]))  0;

216 
	`AO_nİ_fuÎ
();

217 } !
	`ATOMIC_CAS_MB
(&
succs
[0]->
v®
, v®, 
NULL
));

219 
	`AO_nİ_fuÎ
();

221 
	`m¬k_node_±rs
(
succs
[0]);

222 
	`äa£r_£¬ch
(
£t
, 
v®
, &
Ëá_li¡
);

223 
	`AO_nİ_fuÎ
();

226 
	}
}

228 
	$äa£r_upd©e
(
¦_št£t_t
 *
£t
, 
v®_t
 
v1
, v®_ˆ
v2
) {

229 
¦_node_t
 *
Ãw
, *
Ãw_Ãxt
, *
´ed
, *
succ
, **
succs
, **
´eds
;

230 
v®_t
 
Şd_v
;

231 
i
;

233 #ifdeà
DEBUG


234 
	`´štf
("++> fraser_update\n");

235 
IO_FLUSH
;

238 
succs
 = 
	`äa£r_£¬ch
(
£t
, 
v1
, &
´eds
);

239 
»Œy
:

241 ià(
succs
[0]->
v®
 =ğ
v1
) {

243 ià(!(
Şd_v
 = 
succs
[0]->
v®
)) {

244 
	`m¬k_node_±rs
(
succs
[0]);

245 
	`AO_nİ_fuÎ
();

246 
»Œy
;

248 } !
	`ATOMIC_CAS_MB
(&
succs
[0]->
v®
, 
Şd_v
, 
v2
));

251 
Ãw
 = 
	`¦_Ãw_node
(
v2
, 
NULL
, 
	`g‘_¿nd_Ëv–
(), 0);

252 
i
=0; i<
Ãw
->
tİËv–
; i++èÃw->
Ãxt
[i] = 
succs
[i];

254 
	`AO_nİ_fuÎ
();

257 ià(!
	`ATOMIC_CAS_MB
(&
´eds
[0]->
Ãxt
[0], 
succs
[0], 
Ãw
))

258 
»Œy
;

259 
i
=1; i < 
Ãw
->
tİËv–
; i++)

261 
´ed
 = 
´eds
[
i
];

262 
succ
 = 
succs
[
i
];

264 
Ãw_Ãxt
 = 
Ãw
->
Ãxt
[
i
];

265 
	`AO_nİ_fuÎ
();

266 ià((
Ãw_Ãxt
 !ğ
succ
) &&

267 (!
	`ATOMIC_CAS_MB
(&
Ãw
->
Ãxt
[
i
], 
	`g‘_unm¬ked_»f
((è
Ãw_Ãxt
), 
succ
)))

270 ià(
succ
->
v®
 =ğ
v1
) {

272 
	`AO_nİ_fuÎ
();

273 
succ
 = (
¦_node_t
 *è
	`g‘_unm¬ked_»f
((èsucc->
Ãxt
);

275 
	`AO_nİ_fuÎ
();

277 ià(
	`ATOMIC_CAS_MB
(&
´ed
->
Ãxt
[
i
], 
succ
, 
Ãw
)) ;

279 
	`AO_nİ_fuÎ
();

280 
succs
 = 
	`äa£r_£¬ch
(
£t
, 
v1
, &
´eds
);

281 
	`AO_nİ_fuÎ
();

284 
	}
}

286 
	$äa£r_š£¹
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
) {

287 
¦_node_t
 *
Ãw
, *
Ãw_Ãxt
, *
´ed
, *
succ
, **
succs
, **
´eds
;

288 
i
, 
Ëv–
;

290 #ifdeà
DEBUG


291 
	`´štf
("++> fraser_insert\n");

292 
IO_FLUSH
;

295 ià((
´eds
 = (
¦_node_t
 **)
	`m®loc
(
Ëv–max
 * (¦_node_t))è=ğ
NULL
 ||

296 (
succs
 = (
¦_node_t
 **)
	`m®loc
(
Ëv–max
 * (¦_node_t))è=ğ
NULL
) {

297 
	`³¼Ü
("malloc");

298 
	`ex™
(1);

302 
succs
 = 
	`äa£r_£¬ch
(
£t
, 
v®
, &
´eds
);

303 
»Œy
:

305 ià(
succs
[0]->
v®
 == val)  0;

306 
Ëv–
 = 
	`g‘_¿nd_Ëv–
();

307 
Ãw
 = 
	`¦_Ãw_node
(
v®
, 
NULL
, 
Ëv–
, 0);

309 
	`AO_nİ_fuÎ
();

310 
i
=0; i<
Ãw
->
tİËv–
; i++èÃw->
Ãxt
[i] = 
succs
[i];

311 
	`AO_nİ_fuÎ
();

314 ià(!
	`ATOMIC_CAS_MB
(&
´eds
[0]->
Ãxt
[0], 
succs
[0], 
Ãw
))

315 
»Œy
;

316 
i
=1; i < 
Ãw
->
tİËv–
; i++)

318 
´ed
 = 
´eds
[
i
];

319 
succ
 = 
succs
[
i
];

321 
Ãw_Ãxt
 = 
Ãw
->
Ãxt
[
i
];

322 
	`AO_nİ_fuÎ
();

323 ià((
Ãw_Ãxt
 !ğ
succ
) &&

324 (!
	`ATOMIC_CAS_MB
(&
Ãw
->
Ãxt
[
i
], 
	`g‘_unm¬ked_»f
((è
Ãw_Ãxt
), 
succ
)))

327 ià(
succ
->
v®
 == val) {

329 
	`AO_nİ_fuÎ
();

330 
succ
 = (
¦_node_t
 *è
	`g‘_unm¬ked_»f
((èsucc->
Ãxt
);

331 
	`AO_nİ_fuÎ
();

334 ià(
	`ATOMIC_CAS_MB
(&
´ed
->
Ãxt
[
i
], 
succ
, 
Ãw
)) ;

336 
	`AO_nİ_fuÎ
();

337 
succs
 = 
	`äa£r_£¬ch
(
£t
, 
v®
, &
´eds
);

338 
	`AO_nİ_fuÎ
();

342 
	}
}

350 
	$»c_£¬ch
(
¡m_wÜd_t
 *
¡¬t_ts
, 
node_t
 *
´ev
,‚ode_ˆ*
Ãxt
,

351 
v®_t
 
v®
, v®_ˆ*
v
) {

352 
¡m_wÜd_t
 
ts
, 
cu¼_ts
;

353 
node_t
 *
cu¼
;

354 
»suÉ
=0;

356 *
v
 = 
	`UNIT_LOAD
(&
Ãxt
->
v®
, &
ts
);

358 ià(
ts
 > *
¡¬t_ts
 || !
Ãxt
->next) {

359  (è
ts
;

363 ià(*
v
 >ğ
v®
)

367 
cu¼
 = 
Ãxt
;

368 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&Ãxt->Ãxt, &
ts
);

369 ià(
ts
 > *
¡¬t_ts
) {

371 
	`UNIT_LOAD
(&
cu¼
->
v®
, &
cu¼_ts
);

372 ià(
cu¼_ts
 > *
¡¬t_ts
) {

373  (è
cu¼_ts
;

375 *
¡¬t_ts
 = 
ts
;

379 
»¡¬t5
:

380 ià(!(
»suÉ
 = 
	`»c_£¬ch
(
¡¬t_ts
, 
cu¼
, 
Ãxt
, 
v®
, 
v
)))  0;

382 
	`UNIT_LOAD
(&
Ãxt
, &
ts
);

384 ià(
ts
 > *
¡¬t_ts
)  1;

386 *
¡¬t_ts
 = 
»suÉ
;

387 
»¡¬t5
;

390 
	}
}

392 
	$»c_£¬ch2
(
¡m_wÜd_t
 *
¡¬t_ts
, 
node_t
 **
´ev
,‚ode_ˆ**
Ãxt
,

393 
v®_t
 
v®
, v®_ˆ*
v
) {

394 
¡m_wÜd_t
 
ts
, 
cu¼_ts
;

395 
»suÉ
=0;

397 *
v
 = 
	`UNIT_LOAD
(&(*
Ãxt
)->
v®
, &
ts
);

399 ià(
ts
 > *
¡¬t_ts
 || !(*
Ãxt
)->next)

400  (è
ts
;

403 ià(*
v
 >ğ
v®
)

407 *
´ev
 = *
Ãxt
;

408 *
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&(*Ãxt)->Ãxt, &
ts
);

409 ià(
ts
 > *
¡¬t_ts
) {

411 
	`UNIT_LOAD
(&(*
´ev
)->
v®
, &
cu¼_ts
);

412 ià(
cu¼_ts
 > *
¡¬t_ts
) {

413  (è
cu¼_ts
;

415 *
¡¬t_ts
 = 
ts
;

419 
»¡¬t4
:

420 ià(!(
»suÉ
 = 
	`»c_£¬ch2
(
¡¬t_ts
, 
´ev
, 
Ãxt
, 
v®
, 
v
)))  0;

424 ià(
»suÉ
 > *
¡¬t_ts
)  1;

426 *
¡¬t_ts
 = 
»suÉ
;

427 
»¡¬t4
;

430 
	}
}

436 
	$£t_cÚšs
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

438 
»suÉ
;

439 
node_t
 *
´ev
, *
Ãxt
;

440 
v®_t
 
v
;

441 
¡m_wÜd_t
 
ts
, 
¡¬t_ts
, 
´ev_ts
;

443 #ifdeà
DEBUG


444 
	`´štf
("++> s‘_cÚšs(%d)\n", (è
v®
);

445 
IO_FLUSH
;

448 
Œª§ùiÚ®
) {

450 
´ev
 = 
£t
->
h—d
;

451 
Ãxt
 = 
´ev
->next;

452 
Ãxt
->
v®
 < val) {

453 
´ev
 = 
Ãxt
;

454 
Ãxt
 = 
´ev
->next;

456 
»suÉ
 = (
Ãxt
->
v®
 == val);

460 
START_RO
;

461 
´ev
 = (
node_t
 *)
	`LOAD
(&
£t
->
h—d
);

462 
Ãxt
 = (
node_t
 *)
	`LOAD
(&
´ev
->next);

464 
v
 = 
	`LOAD
(&
Ãxt
->
v®
);

465 ià(
v
 >ğ
v®
)

467 
´ev
 = 
Ãxt
;

468 
Ãxt
 = (
node_t
 *)
	`LOAD
(&
´ev
->next);

470 
»suÉ
 = (
v
 =ğ
v®
);

471 
COMMIT
;

477 
»¡¬t
:

478 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

480 
´ev
 = (
node_t
 *)
	`UNIT_LOAD
(&
£t
->
h—d
, &
ts
);

481 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

482 ià(
ts
 > 
¡¬t_ts
)

483 
¡¬t_ts
 = 
ts
;

485 
v
 = 
	`UNIT_LOAD
(&
Ãxt
->
v®
, &
ts
);

486 ià(
ts
 > 
¡¬t_ts
) {

488 
»¡¬t
;

490 ià(
v
 >ğ
v®
)

492 
´ev
 = 
Ãxt
;

493 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

494 ià(
ts
 > 
¡¬t_ts
) {

497 
	`UNIT_LOAD
(&
´ev
->
v®
, &
´ev_ts
);

498 ià(
´ev_ts
 > 
¡¬t_ts
) {

500 
»¡¬t
;

502 
¡¬t_ts
 = 
ts
;

505 
»suÉ
 = (
v
 =ğ
v®
);

510 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

511 
´ev
 = (
node_t
 *)
	`UNIT_LOAD
(&
£t
->
h—d
, &
ts
);

512 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

513 ià(
ts
 > 
¡¬t_ts
) start_ts =s;

514 } 
	`»c_£¬ch2
(&
¡¬t_ts
, &
´ev
, &
Ãxt
, 
v®
, &
v
));

515 
»suÉ
 = (
v
==
v®
);

519 
»suÉ
 = 
	`h¬ris_fšd
(
£t
, 
v®
);

522  
»suÉ
;

523 
	}
}

525 
	$£t_add
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

527 
»suÉ
;

528 
node_t
 *
´ev
, *
Ãxt
;

529 
v®_t
 
v
;

530 
¡m_wÜd_t
 
ts
, 
¡¬t_ts
, 
´ev_ts
;

532 #ifdeà
DEBUG


533 
	`´štf
("++> s‘_add(%d)\n", (è
v®
);

534 
IO_FLUSH
;

537 
Œª§ùiÚ®
) {

539 
´ev
 = 
£t
->
h—d
;

540 
Ãxt
 = 
´ev
->next;

541 
Ãxt
->
v®
 < val) {

542 
´ev
 = 
Ãxt
;

543 
Ãxt
 = 
´ev
->next;

545 
»suÉ
 = (
Ãxt
->
v®
 != val);

546 ià(
»suÉ
) {

547 
´ev
->
Ãxt
 = 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
);

553 
START
;

554 
´ev
 = (
node_t
 *)
	`LOAD
(&
£t
->
h—d
);

555 
Ãxt
 = (
node_t
 *)
	`LOAD
(&
´ev
->next);

557 
v
 = 
	`LOAD
(&
Ãxt
->
v®
);

558 ià(
v
 >ğ
v®
)

560 
´ev
 = 
Ãxt
;

561 
Ãxt
 = (
node_t
 *)
	`LOAD
(&
´ev
->next);

563 
»suÉ
 = (
v
 !ğ
v®
);

564 ià(
»suÉ
) {

565 
	`STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
));

567 
COMMIT
;

572 
»¡¬t
:

573 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

575 
´ev
 = (
node_t
 *)
	`UNIT_LOAD
(&
£t
->
h—d
, &
ts
);

576 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

577 ià(
ts
 > 
¡¬t_ts
)

578 
¡¬t_ts
 = 
ts
;

580 
v
 = 
	`UNIT_LOAD
(&
Ãxt
->
v®
, &
ts
);

581 ià(
ts
 > 
¡¬t_ts
) {

583 
»¡¬t
;

585 ià(
v
 >ğ
v®
)

587 
´ev
 = 
Ãxt
;

588 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

589 ià(
ts
 > 
¡¬t_ts
) {

592 
	`UNIT_LOAD
(&
´ev
->
v®
, &
´ev_ts
);

593 ià(
´ev_ts
 > 
¡¬t_ts
) {

595 
»¡¬t
;

597 
¡¬t_ts
 = 
ts
;

600 
»suÉ
 = (
v
 !ğ
v®
);

601 ià(
»suÉ
) {

604 
	`START_TS
(
¡¬t_ts
, 
»¡¬t
);

605 
	`STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
));

606 
COMMIT
;

611 
»¡¬t2
:

613 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

614 
´ev
 = (
node_t
 *)
	`UNIT_LOAD
(&
£t
->
h—d
, &
ts
);

615 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

616 ià(
ts
 > 
¡¬t_ts
) start_ts =s;

617 } 
	`»c_£¬ch2
(&
¡¬t_ts
, &
´ev
, &
Ãxt
, 
v®
, &
v
));

618 
»suÉ
 = (
v
 !ğ
v®
);

624 ià(
»suÉ
) {

625 
	`START_TS
(
¡¬t_ts
, 
»¡¬t2
);

626 
	`STORE
(&
´ev
->
Ãxt
, 
	`Ãw_node
(
v®
,‚ext, 
Œª§ùiÚ®
));

627 
COMMIT
;

632 
»suÉ
 = 
	`h¬ris_š£¹
(
£t
, 
v®
);

635  
»suÉ
;

636 
	}
}

638 
	$£t_»move
(
št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

640 
»suÉ
;

641 
node_t
 *
´ev
, *
Ãxt
;

642 
v®_t
 
v
;

643 
node_t
 *
n
;

644 
¡m_wÜd_t
 
ts
, 
¡¬t_ts
, 
´ev_ts
;

646 #ifdeà
DEBUG


647 
	`´štf
("++> s‘_»move(%d)\n", (è
v®
);

648 
IO_FLUSH
;

651 
Œª§ùiÚ®
) {

653 
´ev
 = 
£t
->
h—d
;

654 
Ãxt
 = 
´ev
->next;

655 
Ãxt
->
v®
 < val) {

656 
´ev
 = 
Ãxt
;

657 
Ãxt
 = 
´ev
->next;

659 
»suÉ
 = (
Ãxt
->
v®
 == val);

660 ià(
»suÉ
) {

661 
´ev
->
Ãxt
 =‚ext->next;

662 
	`ä“
(
Ãxt
);

669 
START
;

670 
´ev
 = (
node_t
 *)
	`LOAD
(&
£t
->
h—d
);

671 
Ãxt
 = (
node_t
 *)
	`LOAD
(&
´ev
->next);

673 
v
 = 
	`LOAD
(&
Ãxt
->
v®
);

674 ià(
v
 >ğ
v®
)

676 
´ev
 = 
Ãxt
;

677 
Ãxt
 = (
node_t
 *)
	`LOAD
(&
´ev
->next);

679 
»suÉ
 = (
v
 =ğ
v®
);

680 ià(
»suÉ
) {

681 
n
 = (
node_t
 *)
	`LOAD
(&
Ãxt
->next);

682 
	`STORE
(&
´ev
->
Ãxt
, 
n
);

684 
	`FREE
(
Ãxt
, (
node_t
));

686 
COMMIT
;

690 
»¡¬t
:

691 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

693 
´ev
 = (
node_t
 *)
	`UNIT_LOAD
(&
£t
->
h—d
, &
ts
);

694 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

695 ià(
ts
 > 
¡¬t_ts
)

696 
¡¬t_ts
 = 
ts
;

698 
v
 = 
	`UNIT_LOAD
(&
Ãxt
->
v®
, &
ts
);

699 ià(
ts
 > 
¡¬t_ts
) {

701 
»¡¬t
;

703 ià(
v
 >ğ
v®
)

705 
´ev
 = 
Ãxt
;

706 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

707 ià(
ts
 > 
¡¬t_ts
) {

710 
	`UNIT_LOAD
(&
´ev
->
v®
, &
´ev_ts
);

711 ià(
´ev_ts
 > 
¡¬t_ts
) {

713 
»¡¬t
;

715 
¡¬t_ts
 = 
ts
;

718 
»suÉ
 = (
v
 =ğ
v®
);

719 ià(
»suÉ
) {

722 
	`START_TS
(
¡¬t_ts
, 
»¡¬t
);

723 
n
 = (
node_t
 *)
	`LOAD
(&
Ãxt
->next);

724 
	`STORE
(&
´ev
->
Ãxt
, 
n
);

726 
	`FREE
(
Ãxt
, (
node_t
));

727 
COMMIT
;

732 
»¡¬t3
:

734 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

735 
´ev
 = (
node_t
 *)
	`UNIT_LOAD
(&
£t
->
h—d
, &
ts
);

736 
Ãxt
 = (
node_t
 *)
	`UNIT_LOAD
(&
´ev
->Ãxt, &
ts
);

737 ià(
ts
 > 
¡¬t_ts
) start_ts =s;

738 } 
	`»c_£¬ch2
(&
¡¬t_ts
, &
´ev
, &
Ãxt
, 
v®
, &
v
));

739 
»suÉ
 = (
v
 =ğ
v®
);

740 ià(
»suÉ
) {

741 
	`START_TS
(
¡¬t_ts
, 
»¡¬t3
);

742 
n
 = (
node_t
 *)
	`LOAD
(&
Ãxt
->next);

743 
	`STORE
(&
´ev
->
Ãxt
, 
n
);

745 
	`FREE
(
Ãxt
, (
node_t
));

746 
COMMIT
;

751 
»suÉ
 = 
	`h¬ris_d–‘e
(
£t
, 
v®
);

754  
»suÉ
;

755 
	}
}

761 
	$¦_cÚšs
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

763 
»suÉ
 = 0;

764 
i
;

765 
¦_node_t
 *
node
, *
Ãxt
;

766 
v®_t
 
v
;

767 
¡m_wÜd_t
 
ts
, 
¡¬t_ts
, 
´ev_ts
;

769 #ifdeà
DEBUG


770 
	`´štf
("++> sl_cÚšs(%d)\n", (è
v®
);

771 
IO_FLUSH
;

774 
Œª§ùiÚ®
) {

777 
node
 = 
£t
->
h—d
;

778 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

779 
Ãxt
 = 
node
->Ãxt[
i
];

780 
Ãxt
->
v®
 < val) {

781 
node
 = 
Ãxt
;

782 
Ãxt
 = 
node
->Ãxt[
i
];

785 
node
 =‚ode->
Ãxt
[0];

786 
»suÉ
 = (
node
->
v®
 == val);

790 
START_RO
;

791 
node
 = 
£t
->
h—d
;

792 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

793 
Ãxt
 = (
¦_node_t
 *)
	`LOAD
(&
node
->Ãxt[
i
]);

794 (
v
 = 
	`LOAD
(&
Ãxt
->
v®
)) < val) {

795 
node
 = 
Ãxt
;

796 
Ãxt
 = (
¦_node_t
 *)
	`LOAD
(&
node
->Ãxt[
i
]);

799 
node
 = (
¦_node_t
 *)
	`LOAD
(&node->
Ãxt
[0]);

800 
»suÉ
 = (
v
 =ğ
v®
);

801 
COMMIT
;

807 
v
 = 
VAL_MIN
;

808 
»¡¬t
:

809 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

810 
node
 = 
£t
->
h—d
;

811 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

812 
Ãxt
 = (
¦_node_t
 *)
	`UNIT_LOAD
(&
node
->Ãxt[
i
], &
ts
);

814 
v
 = 
	`UNIT_LOAD
(&
Ãxt
->
v®
, &
ts
);

815 ià(
ts
 > 
¡¬t_ts
) {

817 
»¡¬t
;

819 ià(
v
 >ğ
v®
) ;

820 
node
 = 
Ãxt
;

821 
Ãxt
 = (
¦_node_t
 *)
	`UNIT_LOAD
(&
node
->Ãxt[
i
], &
ts
);

822 ià(
ts
 > 
¡¬t_ts
) {

825 
	`UNIT_LOAD
(&
node
->
v®
, &
´ev_ts
);

826 ià(
´ev_ts
 > 
¡¬t_ts
) {

828 
»¡¬t
;

830 
¡¬t_ts
 = 
ts
;

834 
»suÉ
 = (
v
 =ğ
v®
);

841 
»suÉ
 = 
	`äa£r_fšd
(
£t
, 
v®
);

845 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØªy un™-tx mode.\n", 
Œª§ùiÚ®
);

847  
»suÉ
;

848 
	}
}

850 
	$¦_add
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

852 
»suÉ
 = 0;

853 
i
, 
l
;

854 
¦_node_t
 *
node
, *
Ãxt
;

855 
¦_node_t
 *
´eds
[16], *
succs
[16];

856 
v®_t
 
v
;

857 
¡m_wÜd_t
 
ts
, 
¡¬t_ts
, 
´ev_ts
;

859 #ifdeà
DEBUG


860 
	`´štf
("++> sl_add(%d)\n", (è
v®
);

861 
IO_FLUSH
;

864 
Œª§ùiÚ®
) {

873 
node
 = 
£t
->
h—d
;

874 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

875 
Ãxt
 = 
node
->Ãxt[
i
];

876 
Ãxt
->
v®
 < val) {

877 
node
 = 
Ãxt
;

878 
Ãxt
 = 
node
->Ãxt[
i
];

880 
´eds
[
i
] = 
node
;

881 
succs
[
i
] = 
node
->
Ãxt
[i];

883 
node
 =‚ode->
Ãxt
[0];

884 ià(
node
->
v®
 == val) {

885 
»suÉ
 = 0;

887 
l
 = 
	`g‘_¿nd_Ëv–
();

888 
node
 = 
	`¦_Ãw_sim¶e_node
(
v®
, 
l
, 
Œª§ùiÚ®
);

889 
i
 = 0; i < 
l
; i++) {

890 
node
->
Ãxt
[
i
] = 
succs
[i];

891 
´eds
[
i
]->
Ãxt
[i] = 
node
;

893 
»suÉ
 = 1;

899 
START
;

900 
v
 = 
VAL_MIN
;

906 
node
 = 
£t
->
h—d
;

907 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

908 
Ãxt
 = (
¦_node_t
 *)
	`LOAD
(&
node
->Ãxt[
i
]);

909 (
v
 = 
	`LOAD
(&
Ãxt
->
v®
)) < val) {

910 
node
 = 
Ãxt
;

911 
Ãxt
 = (
¦_node_t
 *)
	`LOAD
(&
node
->Ãxt[
i
]);

913 
´eds
[
i
] = 
node
;

914 
succs
[
i
] = 
Ãxt
;

916 ià(
v
 =ğ
v®
) {

917 
»suÉ
 = 0;

919 
l
 = 
	`g‘_¿nd_Ëv–
();

920 
node
 = 
	`¦_Ãw_sim¶e_node
(
v®
, 
l
, 
Œª§ùiÚ®
);

921 
i
 = 0; i < 
l
; i++) {

922 
node
->
Ãxt
[
i
] = (
¦_node_t
 *)
	`LOAD
(&
succs
[i]);

923 
	`STORE
(&
´eds
[
i
]->
Ãxt
[i], 
node
);

925 
»suÉ
 = 1;

927 
COMMIT
;

932 
v
 = 
VAL_MIN
;

933 
»¡¬t
:

934 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

935 
node
 = 
£t
->
h—d
;

938 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

940 
Ãxt
 = (
¦_node_t
 *)
	`UNIT_LOAD
(&
node
->Ãxt[
i
], &
ts
);

943 
v
 = 
	`UNIT_LOAD
(&
Ãxt
->
v®
, &
ts
);

945 ià(
ts
 > 
¡¬t_ts
è
»¡¬t
;

946 ià(
v
 >ğ
v®
) ;

947 
node
 = 
Ãxt
;

949 
Ãxt
 = (
¦_node_t
 *)
	`UNIT_LOAD
(&
node
->Ãxt[
i
], &
ts
);

951 ià(
ts
 > 
¡¬t_ts
) {

953 
	`UNIT_LOAD
(&
node
->
v®
, &
´ev_ts
);

954 ià(
´ev_ts
 > 
¡¬t_ts
è
»¡¬t
;

955 
¡¬t_ts
 = 
ts
;

958 
´eds
[
i
] = 
node
;

959 
succs
[
i
] = 
Ãxt
;

962 ià(
v
 =ğ
v®
) {

963 
»suÉ
 = 0;

965 
l
 = 
	`g‘_¿nd_Ëv–
();

966 
node
 = 
	`¦_Ãw_sim¶e_node
(
v®
, 
l
, 
Œª§ùiÚ®
);

967 
	`START_TS
(
¡¬t_ts
, 
»¡¬t
);

969 
i
 = 0; i < 
l
; i++) {

970 
node
->
Ãxt
[
i
] = (
¦_node_t
 *)
	`LOAD
(&
succs
[i]);

972 
i
 = 0; i < 
l
; i++) {

973 
	`STORE
(&
´eds
[
i
]->
Ãxt
[i], 
node
);

975 
COMMIT
;

976 
»suÉ
 = 1;

984 
»suÉ
 = 
	`äa£r_š£¹
(
£t
, 
v®
);

988 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØªy un™-tx mode.\n", 
Œª§ùiÚ®
);

991  
»suÉ
;

992 
	}
}

994 
	$¦_»move
(
¦_št£t_t
 *
£t
, 
v®_t
 
v®
, 
Œª§ùiÚ®
)

996 
»suÉ
 = 0;

997 
i
;

998 
¦_node_t
 *
node
, *
Ãxt
;

999 
¦_node_t
 *
´eds
[16], *
succs
[16];

1000 
v®_t
 
v
;

1001 
¡m_wÜd_t
 
ts
, 
¡¬t_ts
, 
´ev_ts
;

1003 #ifdeà
DEBUG


1004 
	`´štf
("++> sl_»move(%d)\n", (è
v®
);

1005 
IO_FLUSH
;

1008 
Œª§ùiÚ®
) {

1011 
node
 = 
£t
->
h—d
;

1012 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

1013 
Ãxt
 = 
node
->Ãxt[
i
];

1014 
Ãxt
->
v®
 < val) {

1015 
node
 = 
Ãxt
;

1016 
Ãxt
 = 
node
->Ãxt[
i
];

1018 
´eds
[
i
] = 
node
;

1019 
succs
[
i
] = 
node
->
Ãxt
[i];

1021 
node
 =‚ode->
Ãxt
[0];

1023 ià(
node
->
v®
 != val) {

1024 
»suÉ
 = 0;

1026 
i
 = 0; i < 
£t
->
h—d
->
tİËv–
; i++)

1027 
´eds
[
i
]->
Ãxt
[i] = 
succs
[i];

1028 
»suÉ
 = 1;

1035 
START
;

1036 
v
 = 
VAL_MIN
;

1037 
node
 = 
£t
->
h—d
;

1038 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

1039 
Ãxt
 = (
¦_node_t
 *)
	`LOAD
(&
node
->Ãxt[
i
]);

1040 (
v
 = 
	`LOAD
(&
Ãxt
->
v®
)) < val) {

1041 
node
 = 
Ãxt
;

1042 
Ãxt
 = (
¦_node_t
 *)
	`LOAD
(&
node
->Ãxt[
i
]);

1045 
´eds
[
i
] = 
node
;

1046 
succs
[
i
] = 
Ãxt
;

1048 
node
 = (
¦_node_t
 *)
	`LOAD
(&node->
Ãxt
[0]);

1050 ià(
v
 !ğ
v®
) {

1051 
»suÉ
 = 0;

1053 
i
 = 0; i < 
£t
->
h—d
->
tİËv–
; i++)

1055 
	`STORE
(&
´eds
[
i
]->
Ãxt
[i], (
¦_node_t
 *)
	`LOAD
(&
succs
[i]));

1056 
»suÉ
 = 1;

1058 
COMMIT
;

1062 
v
 = 
VAL_MIN
;

1063 
»¡¬t
:

1064 
¡¬t_ts
 = 
	`¡m_g‘_şock
();

1065 
node
 = 
£t
->
h—d
;

1066 
i
 = 
node
->
tİËv–
-1; i >= 0; i--) {

1067 
Ãxt
 = (
¦_node_t
 *)
	`UNIT_LOAD
(&
node
->Ãxt[
i
], &
ts
);

1068 ià(
ts
 > 
¡¬t_ts
) start_ts =s;

1070 
v
 = 
	`UNIT_LOAD
(&
Ãxt
->
v®
, &
ts
);

1071 ià(
ts
 > 
¡¬t_ts
è
»¡¬t
;

1072 ià(
v
 >ğ
v®
) ;

1073 
node
 = 
Ãxt
;

1074 
Ãxt
 = (
¦_node_t
 *)
	`UNIT_LOAD
(&
node
->Ãxt[
i
], &
ts
);

1075 ià(
ts
 > 
¡¬t_ts
) {

1076 
	`UNIT_LOAD
(&
node
->
v®
, &
´ev_ts
);

1077 ià(
´ev_ts
 > 
¡¬t_ts
è
»¡¬t
;

1078 
¡¬t_ts
 = 
ts
;

1081 
´eds
[
i
] = 
node
;

1082 
succs
[
i
] = 
Ãxt
;

1085 ià(
node
->
v®
 != val) {

1086 
»suÉ
 = 0;

1088 
	`START_TS
(
¡¬t_ts
, 
»¡¬t
);

1089 
i
 = 0; i < 
£t
->
h—d
->
tİËv–
; i++)

1090 
	`STORE
(&
´eds
[
i
]->
Ãxt
[i], (
¦_node_t
 *)
	`LOAD
(&
succs
[i]));

1091 
COMMIT
;

1092 
»suÉ
 = 1;

1100 
»suÉ
 = 
	`äa£r_»move
(
£t
, 
v®
);

1104 
	`´štf
("numb” %d dØnÙ cÜ»¥ÚdØªy un™-tx mode.\n", 
Œª§ùiÚ®
);

1107  
»suÉ
;

1108 
	}
}

1117 
	sb¬r›r
 {

1118 
±h»ad_cÚd_t
 
	mcom¶‘e
;

1119 
±h»ad_mu‹x_t
 
	mmu‹x
;

1120 
	mcouÁ
;

1121 
	müossšg
;

1122 } 
	tb¬r›r_t
;

1124 
	$b¬r›r_š™
(
b¬r›r_t
 *
b
, 
n
)

1126 
	`±h»ad_cÚd_š™
(&
b
->
com¶‘e
, 
NULL
);

1127 
	`±h»ad_mu‹x_š™
(&
b
->
mu‹x
, 
NULL
);

1128 
b
->
couÁ
 = 
n
;

1129 
b
->
üossšg
 = 0;

1130 
	}
}

1132 
	$b¬r›r_üoss
(
b¬r›r_t
 *
b
)

1134 
	`±h»ad_mu‹x_lock
(&
b
->
mu‹x
);

1136 
b
->
üossšg
++;

1138 ià(
b
->
üossšg
 < b->
couÁ
) {

1139 
	`±h»ad_cÚd_wa™
(&
b
->
com¶‘e
, &b->
mu‹x
);

1141 
	`±h»ad_cÚd_brßdÿ¡
(&
b
->
com¶‘e
);

1143 
b
->
üossšg
 = 0;

1145 
	`±h»ad_mu‹x_uÆock
(&
b
->
mu‹x
);

1146 
	}
}

1152 
	sth»ad_d©a
 {

1153 
	m¿nge
;

1154 
	mupd©e
;

1155 #iâdeà
USE_RBTREE


1156 
	mun™_tx
;

1158 
	mnb_add
;

1159 
	mnb_»move
;

1160 
	mnb_cÚšs
;

1161 
	mnb_found
;

1162 
	mnb_abÜts
;

1163 
	mnb_abÜts_locked_»ad
;

1164 
	mnb_abÜts_locked_wr™e
;

1165 
	mnb_abÜts_v®id©e_»ad
;

1166 
	mnb_abÜts_v®id©e_wr™e
;

1167 
	mnb_abÜts_v®id©e_comm™
;

1168 
	mnb_abÜts_šv®id_memÜy
;

1169 
	mmax_»Œ›s
;

1170 
	mdiff
;

1171 
	m£ed
;

1172 
¦_št£t_t
 *
	m£t
;

1173 
b¬r›r_t
 *
	mb¬r›r
;

1174 
	mçu»s_beÿu£_cÚ‹ÁiÚ
;

1175 } 
	tth»ad_d©a_t
;

1177 *
	$‹¡
(*
d©a
)

1179 
v®
, 
Ï¡
 = 0;

1180 
th»ad_d©a_t
 *
d
 = (th»ad_d©a_ˆ*)
d©a
;

1182 #ifdeà
TLS


1183 
ºg_£ed
 = &
d
->
£ed
;

1185 
	`±h»ad_£t¥ecific
(
ºg_£ed_key
, &
d
->
£ed
);

1189 
	`¡m_š™_th»ad
();

1191 
	`b¬r›r_üoss
(
d
->
b¬r›r
);

1193 
Ï¡
 = -1;

1194 
¡İ
 == 0) {

1195 
v®
 = 
	`¿nd_r
(&
d
->
£ed
) % 100;

1196 ià(
v®
 < 
d
->
upd©e
) {

1197 ià(
Ï¡
 < 0) {

1199 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

1200 ià(
	`¦_add
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
)) {

1201 
d
->
diff
++;

1202 
Ï¡
 = 
v®
;

1204 
d
->
nb_add
++;

1207 ià(
	`¦_»move
(
d
->
£t
, 
Ï¡
, 
TRANSACTIONAL
))

1208 
d
->
diff
--;

1209 
d
->
nb_»move
++;

1210 
Ï¡
 = -1;

1214 
v®
 = (
	`¿nd_r
(&
d
->
£ed
è% d->
¿nge
) + 1;

1215 ià(
	`¦_cÚšs
(
d
->
£t
, 
v®
, 
TRANSACTIONAL
))

1216 
d
->
nb_found
++;

1217 
d
->
nb_cÚšs
++;

1220 
	`¡m_g‘_·¿m‘”
("nb_abÜts", &
d
->
nb_abÜts
);

1221 
	`¡m_g‘_·¿m‘”
("nb_abÜts_locked_»ad", &
d
->
nb_abÜts_locked_»ad
);

1222 
	`¡m_g‘_·¿m‘”
("nb_abÜts_locked_wr™e", &
d
->
nb_abÜts_locked_wr™e
);

1223 
	`¡m_g‘_·¿m‘”
("nb_abÜts_v®id©e_»ad", &
d
->
nb_abÜts_v®id©e_»ad
);

1224 
	`¡m_g‘_·¿m‘”
("nb_abÜts_v®id©e_wr™e", &
d
->
nb_abÜts_v®id©e_wr™e
);

1225 
	`¡m_g‘_·¿m‘”
("nb_abÜts_v®id©e_comm™", &
d
->
nb_abÜts_v®id©e_comm™
);

1226 
	`¡m_g‘_·¿m‘”
("nb_abÜts_šv®id_memÜy", &
d
->
nb_abÜts_šv®id_memÜy
);

1227 
	`¡m_g‘_·¿m‘”
("max_»Œ›s", &
d
->
max_»Œ›s
);

1228 
	`¡m_g‘_·¿m‘”
("çu»s_beÿu£_cÚ‹ÁiÚ", &
d
->
çu»s_beÿu£_cÚ‹ÁiÚ
);

1230 
	`¡m_ex™_th»ad
();

1232  
NULL
;

1233 
	}
}

1235 
	$ÿtch”
(
sig
)

1237 
	`´štf
("CAUGHT SIGNAL %d\n", 
sig
);

1238 
	}
}

1240 
	$´št_skli¡
(
¦_št£t_t
 *
£t
) {

1241 
¦_node_t
 *
cu¼
;

1242 
i
, 
j
;

1243 
¬r
[
Ëv–max
];

1245 
i
=0; i<  
¬r
/‡rr[0]; i++)‡rr[i] = 0;

1247 
cu¼
 = 
£t
->
h—d
;

1249 
	`´štf
("%d", (è
cu¼
->
v®
);

1250 
i
=0; i<
cu¼
->
tİËv–
; i++) {

1251 
	`´štf
("-*");

1253 
¬r
[
cu¼
->
tİËv–
-1]++;

1254 
	`´štf
("\n");

1255 
cu¼
 = cu¼->
Ãxt
[0];

1256 } 
cu¼
);

1257 
j
=0; j<
Ëv–max
; j++)

1258 
	`´štf
("%d‚ode oàËv– %d\n", 
¬r
[
j
], j);

1259 
	}
}

1261 
	$maš
(
¬gc
, **
¬gv
)

1263 
İtiÚ
 
lÚg_İtiÚs
[] = {

1265 {"h–p", 
no_¬gum’t
, 
NULL
, 'h'},

1266 {"du¿tiÚ", 
»quœed_¬gum’t
, 
NULL
, 'd'},

1267 {"š™Ÿl-size", 
»quœed_¬gum’t
, 
NULL
, 'i'},

1268 {"num-th»ads", 
»quœed_¬gum’t
, 
NULL
, 'n'},

1269 {"¿nge", 
»quœed_¬gum’t
, 
NULL
, 'r'},

1270 {"£ed", 
»quœed_¬gum’t
, 
NULL
, 's'},

1271 {"upd©e-¿‹", 
»quœed_¬gum’t
, 
NULL
, 'u'},

1272 {"un™-tx", 
»quœed_¬gum’t
, 
NULL
, 'x'},

1273 {
NULL
, 0, NULL, 0}

1276 
¦_št£t_t
 *
£t
;

1277 
i
, 
c
, 
v®
, 
size
;

1278 *
s
;

1279 
»ads
, 
upd©es
, 
abÜts
, 
abÜts_locked_»ad
, 
abÜts_locked_wr™e
,

1280 
abÜts_v®id©e_»ad
, 
abÜts_v®id©e_wr™e
, 
abÜts_v®id©e_comm™
,

1281 
abÜts_šv®id_memÜy
, 
max_»Œ›s
, 
çu»s_beÿu£_cÚ‹ÁiÚ
;

1282 
th»ad_d©a_t
 *
d©a
;

1283 
±h»ad_t
 *
th»ads
;

1284 
±h»ad_©Œ_t
 
©Œ
;

1285 
b¬r›r_t
 
b¬r›r
;

1286 
timev®
 
¡¬t
, 
’d
;

1287 
time¥ec
 
timeout
;

1288 
du¿tiÚ
 = 
DEFAULT_DURATION
;

1289 
š™Ÿl
 = 
DEFAULT_INITIAL
;

1290 
nb_th»ads
 = 
DEFAULT_NB_THREADS
;

1291 
¿nge
 = 
DEFAULT_RANGE
;

1292 
£ed
 = 
DEFAULT_SEED
;

1293 
upd©e
 = 
DEFAULT_UPDATE
;

1294 #iâdeà
USE_RBTREE


1295 
un™_tx
 = 1;

1297 
sig£t_t
 
block_£t
;

1300 
i
 = 0;

1301 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hd:i:n:r:s:u:"

1302 #iâdeà
USE_RBTREE


1305 , 
lÚg_İtiÚs
, &
i
);

1307 if(
c
 == -1)

1310 if(
c
 =ğ0 && 
lÚg_İtiÚs
[
i
].
æag
 == 0)

1311 
c
 = 
lÚg_İtiÚs
[
i
].
v®
;

1313 
c
) {

1317 
	`´štf
("intset -- STM stressest "

1318 #ifdeà
USE_RBTREE


1331 " Te¡ du¿tiÚ iÀmli£cÚd (0=šfš™e, deçuÉ=" 
	`XSTR
(
DEFAULT_DURATION
) ")\n"

1333 " Numb” oà–em’t tØš£¹ befÜ‹¡ (deçuÉ=" 
	`XSTR
(
DEFAULT_INITIAL
) ")\n"

1335 " Numb” oàth»ad (deçuÉ=" 
	`XSTR
(
DEFAULT_NB_THREADS
) ")\n"

1337 " Rªgoàš‹g” v®ue š£¹ed iÀ£ˆ(deçuÉ=" 
	`XSTR
(
DEFAULT_RANGE
) ")\n"

1339 " RNG s“d (0ñime-ba£d, deçuÉ=" 
	`XSTR
(
DEFAULT_SEED
) ")\n"

1341 " P”ûÁagoàupd©Œª§ùiÚ (deçuÉ=" 
	`XSTR
(
DEFAULT_UPDATE
) ")\n"

1342 #iâdeà
USE_RBTREE


1354 
	`ex™
(0);

1356 
du¿tiÚ
 = 
	`©oi
(
İrg
);

1359 
š™Ÿl
 = 
	`©oi
(
İrg
);

1362 
nb_th»ads
 = 
	`©oi
(
İrg
);

1365 
¿nge
 = 
	`©oi
(
İrg
);

1368 
£ed
 = 
	`©oi
(
İrg
);

1371 
upd©e
 = 
	`©oi
(
İrg
);

1373 #iâdeà
USE_RBTREE


1375 
un™_tx
 = 
	`©oi
(
İrg
);

1379 
	`´štf
("Use -h or --help for help\n");

1380 
	`ex™
(0);

1382 
	`ex™
(1);

1386 
	`as£¹
(
du¿tiÚ
 >= 0);

1387 
	`as£¹
(
š™Ÿl
 >= 0);

1388 
	`as£¹
(
nb_th»ads
 > 0);

1389 
	`as£¹
(
¿nge
 > 0 &&„ªg>ğ
š™Ÿl
);

1390 
	`as£¹
(
upd©e
 >= 0 && update <= 100);

1392 #ifdeà
USE_RBTREE


1393 
	`´štf
("Setype :„ed-blackree\n");

1395 
	`´štf
("Setype : skip†ist\n");

1397 
	`´štf
("Du¿tiÚ : %d\n", 
du¿tiÚ
);

1398 
	`´štf
("In™ŸÈsiz: %u\n", 
š™Ÿl
);

1399 
	`´štf
("Nbh»ad  : %d\n", 
nb_th»ads
);

1400 
	`´štf
("V®u¿ng : %d\n", 
¿nge
);

1401 
	`´štf
("S“d : %d\n", 
£ed
);

1402 
	`´štf
("Upd©¿‹ : %d\n", 
upd©e
);

1403 #iâdeà
USE_RBTREE


1404 
	`´štf
("Un™x : %d\n", 
un™_tx
);

1406 
	`´štf
("Type sizes : int=%d/long=%d/ptr=%d/word=%d\n",

1410 ()(
¡m_wÜd_t
));

1412 
timeout
.
tv_£c
 = 
du¿tiÚ
 / 1000;

1413 
timeout
.
tv_n£c
 = (
du¿tiÚ
 % 1000) * 1000000;

1415 ià((
d©a
 = (
th»ad_d©a_t
 *)
	`m®loc
(
nb_th»ads
 * Ñh»ad_d©a_t))è=ğ
NULL
) {

1416 
	`³¼Ü
("malloc");

1417 
	`ex™
(1);

1419 ià((
th»ads
 = (
±h»ad_t
 *)
	`m®loc
(
nb_th»ads
 * Õth»ad_t))è=ğ
NULL
) {

1420 
	`³¼Ü
("malloc");

1421 
	`ex™
(1);

1424 ià(
£ed
 == 0)

1425 
	`¤ªd
(()
	`time
(0));

1427 
	`¤ªd
(
£ed
);

1429 
Ëv–max
 = 
	`æoÜ_log_2
((è
š™Ÿl
);

1430 
£t
 = 
	`¦_£t_Ãw
();

1431 
¡İ
 = 0;

1433 
glob®_£ed
 = 
	`¿nd
();

1434 #ifdeà
TLS


1435 
ºg_£ed
 = &
glob®_£ed
;

1437 ià(
	`±h»ad_key_ü—‹
(&
ºg_£ed_key
, 
NULL
) != 0) {

1438 
	`årštf
(
¡d”r
, "Error creatinghread†ocal\n");

1439 
	`ex™
(1);

1441 
	`±h»ad_£t¥ecific
(
ºg_£ed_key
, &
glob®_£ed
);

1445 
	`´štf
("Initializing STM\n");

1446 
	`¡m_š™
();

1447 
	`mod_mem_š™
();

1449 ià(
	`¡m_g‘_·¿m‘”
("compe_æags", &
s
))

1450 
	`´štf
("STM fÏg  : %s\n", 
s
);

1453 
	`´štf
("Addšg %dƒÁr› tØ£t\n", 
š™Ÿl
);

1454 
i
 = 0;

1455 
i
 < 
š™Ÿl
) {

1456 
v®
 = (
	`¿nd
(è% 
¿nge
) + 1;

1457 ià(
	`¦_add
(
£t
, 
v®
, 0))

1458 
i
++;

1460 
size
 = 
	`¦_£t_size
(
£t
);

1461 
	`´štf
("S‘ siz : %d\n", 
size
);

1462 
	`´štf
("Lev– max : %d\n", 
Ëv–max
);

1465 
	`b¬r›r_š™
(&
b¬r›r
, 
nb_th»ads
 + 1);

1466 
	`±h»ad_©Œ_š™
(&
©Œ
);

1467 
	`±h»ad_©Œ_£td‘ach¡©e
(&
©Œ
, 
PTHREAD_CREATE_JOINABLE
);

1468 
i
 = 0; i < 
nb_th»ads
; i++) {

1469 
	`´štf
("C»©šgh»ad %d\n", 
i
);

1470 
d©a
[
i
].
¿nge
 =„ange;

1471 
d©a
[
i
].
upd©e
 = update;

1472 #iâdeà
USE_RBTREE


1473 
d©a
[
i
].
un™_tx
 = unit_tx;

1475 
d©a
[
i
].
nb_add
 = 0;

1476 
d©a
[
i
].
nb_»move
 = 0;

1477 
d©a
[
i
].
nb_cÚšs
 = 0;

1478 
d©a
[
i
].
nb_found
 = 0;

1479 
d©a
[
i
].
nb_abÜts
 = 0;

1480 
d©a
[
i
].
nb_abÜts_locked_»ad
 = 0;

1481 
d©a
[
i
].
nb_abÜts_locked_wr™e
 = 0;

1482 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
 = 0;

1483 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
 = 0;

1484 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
 = 0;

1485 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
 = 0;

1486 
d©a
[
i
].
max_»Œ›s
 = 0;

1487 
d©a
[
i
].
diff
 = 0;

1488 
d©a
[
i
].
£ed
 = 
	`¿nd
();

1489 
d©a
[
i
].
£t
 = set;

1490 
d©a
[
i
].
b¬r›r
 = &barrier;

1491 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

1492 ià(
	`±h»ad_ü—‹
(&
th»ads
[
i
], &
©Œ
, 
‹¡
, (*)(&
d©a
[i])) != 0) {

1493 
	`årštf
(
¡d”r
, "Error creatinghread\n");

1494 
	`ex™
(1);

1497 
	`±h»ad_©Œ_de¡roy
(&
©Œ
);

1500 ià(
	`sigÇl
(
SIGHUP
, 
ÿtch”
è=ğ
SIG_ERR
 ||

1501 
	`sigÇl
(
SIGINT
, 
ÿtch”
è=ğ
SIG_ERR
 ||

1502 
	`sigÇl
(
SIGTERM
, 
ÿtch”
è=ğ
SIG_ERR
) {

1503 
	`³¼Ü
("signal");

1504 
	`ex™
(1);

1508 
	`b¬r›r_üoss
(&
b¬r›r
);

1510 
	`´štf
("STARTING...\n");

1511 
	`g‘timeofday
(&
¡¬t
, 
NULL
);

1512 ià(
du¿tiÚ
 > 0) {

1513 
	`Çno¦“p
(&
timeout
, 
NULL
);

1515 
	`sigem±y£t
(&
block_£t
);

1516 
	`sigsu¥’d
(&
block_£t
);

1518 
	`AO_¡Üe_fuÎ
(&
¡İ
, 1);

1519 
	`g‘timeofday
(&
’d
, 
NULL
);

1520 
	`´štf
("STOPPING...\n");

1523 
i
 = 0; i < 
nb_th»ads
; i++) {

1524 ià(
	`±h»ad_još
(
th»ads
[
i
], 
NULL
) != 0) {

1525 
	`årštf
(
¡d”r
, "Error waiting forhread completion\n");

1526 
	`ex™
(1);

1530 
du¿tiÚ
 = (
’d
.
tv_£c
 * 1000 +ƒnd.
tv_u£c
 / 1000è- (
¡¬t
.tv_sec * 1000 + start.tv_usec / 1000);

1531 
abÜts
 = 0;

1532 
abÜts_locked_»ad
 = 0;

1533 
abÜts_locked_wr™e
 = 0;

1534 
abÜts_v®id©e_»ad
 = 0;

1535 
abÜts_v®id©e_wr™e
 = 0;

1536 
abÜts_v®id©e_comm™
 = 0;

1537 
abÜts_šv®id_memÜy
 = 0;

1538 
çu»s_beÿu£_cÚ‹ÁiÚ
 = 0;

1539 
»ads
 = 0;

1540 
upd©es
 = 0;

1541 
max_»Œ›s
 = 0;

1542 
i
 = 0; i < 
nb_th»ads
; i++) {

1543 
	`´štf
("Th»ad %d\n", 
i
);

1544 
	`´štf
(" #add : %lu\n", 
d©a
[
i
].
nb_add
);

1545 
	`´štf
(" #»mov : %lu\n", 
d©a
[
i
].
nb_»move
);

1546 
	`´štf
(" #cÚš  : %lu\n", 
d©a
[
i
].
nb_cÚšs
);

1547 
	`´štf
(" #found : %lu\n", 
d©a
[
i
].
nb_found
);

1548 
	`´štf
(" #abÜt  : %lu\n", 
d©a
[
i
].
nb_abÜts
);

1549 
	`´štf
(" #lock-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_»ad
);

1550 
	`´štf
(" #lock-w : %lu\n", 
d©a
[
i
].
nb_abÜts_locked_wr™e
);

1551 
	`´štf
(" #v®-¸ : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_»ad
);

1552 
	`´štf
(" #v®-w : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
);

1553 
	`´štf
(" #v®-ø : %lu\n", 
d©a
[
i
].
nb_abÜts_v®id©e_comm™
);

1554 
	`´štf
(" #šv-mem : %lu\n", 
d©a
[
i
].
nb_abÜts_šv®id_memÜy
);

1555 
	`´štf
(" #çu» : %lu\n", 
d©a
[
i
].
çu»s_beÿu£_cÚ‹ÁiÚ
);

1556 
	`´štf
(" Max„‘r› : %lu\n", 
d©a
[
i
].
max_»Œ›s
);

1557 
abÜts
 +ğ
d©a
[
i
].
nb_abÜts
;

1558 
abÜts_locked_»ad
 +ğ
d©a
[
i
].
nb_abÜts_locked_»ad
;

1559 
abÜts_locked_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_locked_wr™e
;

1560 
abÜts_v®id©e_»ad
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_»ad
;

1561 
abÜts_v®id©e_wr™e
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_wr™e
;

1562 
abÜts_v®id©e_comm™
 +ğ
d©a
[
i
].
nb_abÜts_v®id©e_comm™
;

1563 
abÜts_šv®id_memÜy
 +ğ
d©a
[
i
].
nb_abÜts_šv®id_memÜy
;

1564 
çu»s_beÿu£_cÚ‹ÁiÚ
 +ğ
d©a
[
i
].failures_because_contention;

1565 
»ads
 +ğ
d©a
[
i
].
nb_cÚšs
;

1566 
upd©es
 +ğ(
d©a
[
i
].
nb_add
 + d©a[i].
nb_»move
);

1567 
size
 +ğ
d©a
[
i
].
diff
;

1568 ià(
max_»Œ›s
 < 
d©a
[
i
].max_retries)

1569 
max_»Œ›s
 = 
d©a
[
i
].max_retries;

1571 
	`´štf
("S‘ siz : %d (ex³ùed: %d)\n", 
	`¦_£t_size
(
£t
), 
size
);

1572 
	`´štf
("Du¿tiÚ : %d (ms)\n", 
du¿tiÚ
);

1573 
	`´štf
("#tx  : %lu (%à/ s)\n", 
»ads
 + 
upd©es
, (»ad + upd©esè* 1000.0 / 
du¿tiÚ
);

1574 
	`´štf
("#»adx  : %lu (%à/ s)\n", 
»ads
,„—d * 1000.0 / 
du¿tiÚ
);

1575 
	`´štf
("#upd©tx  : %lu (%à/ s)\n", 
upd©es
, upd©e * 1000.0 / 
du¿tiÚ
);

1576 
	`´štf
("#abÜt  : %lu (%à/ s)\n", 
abÜts
,‡bÜt * 1000.0 / 
du¿tiÚ
);

1577 
	`´štf
(" #lock-¸ : %lu (%à/ s)\n", 
abÜts_locked_»ad
,‡bÜts_locked_»ad * 1000.0 / 
du¿tiÚ
);

1578 
	`´štf
(" #lock-w : %lu (%à/ s)\n", 
abÜts_locked_wr™e
,‡bÜts_locked_wr™* 1000.0 / 
du¿tiÚ
);

1579 
	`´štf
(" #v®-¸ : %lu (%à/ s)\n", 
abÜts_v®id©e_»ad
,‡bÜts_v®id©e_»ad * 1000.0 / 
du¿tiÚ
);

1580 
	`´štf
(" #v®-w : %lu (%à/ s)\n", 
abÜts_v®id©e_wr™e
,‡bÜts_v®id©e_wr™* 1000.0 / 
du¿tiÚ
);

1581 
	`´štf
(" #v®-ø : %lu (%à/ s)\n", 
abÜts_v®id©e_comm™
,‡bÜts_v®id©e_comm™ * 1000.0 / 
du¿tiÚ
);

1582 
	`´štf
(" #šv-mem : %lu (%à/ s)\n", 
abÜts_šv®id_memÜy
,‡bÜts_šv®id_memÜy * 1000.0 / 
du¿tiÚ
);

1583 
	`´štf
(" #çu»  : %lu\n", 
çu»s_beÿu£_cÚ‹ÁiÚ
);

1584 
	`´štf
("Max„‘r›  : %lu\n", 
max_»Œ›s
);

1587 
	`¦_£t_d–‘e
(
£t
);

1590 
	`¡m_ex™
();

1592 #iâdeà
TLS


1593 
	`±h»ad_key_d–‘e
(
ºg_£ed_key
);

1596 
	`ä“
(
th»ads
);

1597 
	`ä“
(
d©a
);

1600 
	}
}

	@utils/estm-0.2.4.3/include/mod_local.h

34 #iâdeà
_MOD_LOCAL_H_


35 
	#_MOD_LOCAL_H_


	)

37 
	~"¡m.h
"

39 #ifdeà
__ılu¥lus


51 
¡m_¡Üe_loÿl
(
TXPARAMS
 
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
);

61 
¡m_¡Üe_loÿl_ch¬
(
TXPARAMS
 *
addr
, 
v®ue
);

71 
¡m_¡Üe_loÿl_uch¬
(
TXPARAMS
 *
addr
, 
v®ue
);

81 
¡m_¡Üe_loÿl_shÜt
(
TXPARAMS
 *
addr
, 
v®ue
);

91 
¡m_¡Üe_loÿl_ushÜt
(
TXPARAMS
 *
addr
, 
v®ue
);

101 
¡m_¡Üe_loÿl_št
(
TXPARAMS
 *
addr
, 
v®ue
);

111 
¡m_¡Üe_loÿl_ušt
(
TXPARAMS
 *
addr
, 
v®ue
);

121 
¡m_¡Üe_loÿl_lÚg
(
TXPARAMS
 *
addr
, 
v®ue
);

131 
¡m_¡Üe_loÿl_ulÚg
(
TXPARAMS
 *
addr
, 
v®ue
);

141 
¡m_¡Üe_loÿl_æßt
(
TXPARAMS
 *
addr
, 
v®ue
);

151 
¡m_¡Üe_loÿl_doubË
(
TXPARAMS
 *
addr
, 
v®ue
);

161 
¡m_¡Üe_loÿl_±r
(
TXPARAMS
 **
addr
, *
v®ue
);

168 
mod_loÿl_š™
();

170 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/include/mod_mem.h

35 #iâdeà
_MOD_MEM_H_


36 
	#_MOD_MEM_H_


	)

38 
	~"¡m.h
"

40 #ifdeà
__ılu¥lus


53 *
¡m_m®loc
(
TXPARAMS
 
size_t
 
size
);

67 
¡m_ä“
(
TXPARAMS
 *
addr
, 
size_t
 
size
);

83 
¡m_ä“2
(
TXPARAMS
 *
addr
, 
size_t
 
idx
, size_ˆ
size
);

90 
mod_mem_š™
();

92 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/include/mod_print.h

32 #iâdeà
_MOD_PRINT_H_


33 
	#_MOD_PRINT_H_


	)

35 #ifdeà
__ılu¥lus


44 
mod_´št_š™
();

46 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/include/mod_stats.h

36 #iâdeà
_MOD_STATS_H_


37 
	#_MOD_STATS_H_


	)

39 
	~"¡m.h
"

41 #ifdeà
__ılu¥lus


57 
¡m_g‘_glob®_¡©s
(cÚ¡ *
Çme
, *
v®
);

71 
¡m_g‘_loÿl_¡©s
(
TXPARAMS
 cÚ¡ *
Çme
, *
v®
);

78 
mod_¡©s_š™
();

80 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/include/stm.h

80 #iâdeà
_STM_H_


81 
	#_STM_H_


	)

83 
	~<£tjmp.h
>

84 
	~<¡dšt.h
>

85 
	~<¡dio.h
>

86 
	~<¡dlib.h
>

88 #ifdeà
__ılu¥lus


100 #ifdeà
EXPLICIT_TX_PARAMETER


101 
¡m_tx
;

102 
	#TXTYPE
 
¡m_tx
 *

	)

103 
	#TXPARAM
 
¡m_tx
 *
tx


	)

104 
	#TXPARAMS
 
¡m_tx
 *
tx
,

	)

105 
	#TXARG
 (
¡m_tx
 *)
tx


	)

106 
	#TXARGS
 (
¡m_tx
 *)
tx
,

	)

107 
¡m_tx
 *
¡m_cu¼’t_tx
();

109 
	#TXTYPE
 

	)

110 
	#TXPARAM


	)

111 
	#TXPARAMS


	)

112 
	#TXARG


	)

113 
	#TXARGS


	)

116 
	#EL
 0

	)

117 
	#NL
 1

	)

127 
ušŒ_t
 
	t¡m_wÜd_t
;

132 
	s¡m_tx_©Œ
 {

140 
	gid
;

147 
	gro
;

148 } 
	t¡m_tx_©Œ_t
;

159 
¡m_š™
();

165 
¡m_ex™
();

172 
TXTYPE
 
¡m_š™_th»ad
();

178 
¡m_ex™_th»ad
(
TXPARAM
);

210 
¡m_¡¬t
(
TXPARAMS
 
sigjmp_buf
 *
’v
, 
¡m_tx_©Œ_t
 *
©Œ
, 
ty³
);

230 
¡m_comm™
(
TXPARAM
);

238 
¡m_abÜt
(
TXPARAM
);

283 
¡m_wÜd_t
 
¡m_lßd
(
TXPARAMS
 vŞ©¡m_wÜd_ˆ*
addr
);

304 
¡m_¡Üe
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
);

316 
¡m_¡Üe
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
);

317 
¡m_¡Üe2
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
);

351 
¡m_¡Üe2
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
);

359 
¡m_aùive
(
TXPARAM
);

367 
¡m_abÜ‹d
(
TXPARAM
);

381 
sigjmp_buf
 *
¡m_g‘_’v
(
TXPARAM
);

391 
¡m_tx_©Œ_t
 *
¡m_g‘_©Œibu‹s
(
TXPARAM
);

405 
¡m_g‘_¡©s
(
TXPARAMS
 cÚ¡ *
Çme
, *
v®
);

419 
¡m_g‘_·¿m‘”
(cÚ¡ *
Çme
, *
v®
);

432 
¡m_£t_·¿m‘”
(cÚ¡ *
Çme
, *
v®
);

442 
¡m_ü—‹_¥ecific
();

453 *
¡m_g‘_¥ecific
(
TXPARAMS
 
key
);

464 
¡m_£t_¥ecific
(
TXPARAMS
 
key
, *
d©a
);

485 
¡m_»gi¡”
((*
Ú_th»ad_š™
)(
TXPARAMS
 *
¬g
),

486 (*
Ú_th»ad_ex™
)(
TXPARAMS
 *
¬g
),

487 (*
Ú_¡¬t
)(
TXPARAMS
 *
¬g
),

488 (*
Ú_comm™
)(
TXPARAMS
 *
¬g
),

489 (*
Ú_abÜt
)(
TXPARAMS
 *
¬g
),

490 *
¬g
);

506 
¡m_wÜd_t
 
¡m_un™_lßd
(vŞ©¡m_wÜd_ˆ*
addr
, stm_wÜd_ˆ*
time¡amp
);

508 
¡m_wÜd_t
 
nÚ_¡m_un™_lßd
(vŞ©¡m_wÜd_ˆ*
addr
, stm_wÜd_ˆ*
time¡amp
);

531 
¡m_un™_¡Üe
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ*
time¡amp
);

558 
¡m_un™_¡Üe2
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
, stm_wÜd_ˆ*
time¡amp
);

574 
¡m_£t_ex‹nsiÚ
(
TXPARAMS
 
’abË
, 
¡m_wÜd_t
 *
time¡amp
);

583 
¡m_wÜd_t
 
¡m_g‘_şock
();

585 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/include/wrappers.h

33 #iâdeà
_WRAPPERS_H_


34 
	#_WRAPPERS_H_


	)

36 
	~<¡dšt.h
>

38 
	~"¡m.h
"

40 #ifdeà
__ılu¥lus


52 
ušt8_t
 
¡m_lßd8
(
TXPARAMS
 vŞ©ušt8_ˆ*
addr
);

62 
ušt16_t
 
¡m_lßd16
(
TXPARAMS
 vŞ©ušt16_ˆ*
addr
);

72 
ušt32_t
 
¡m_lßd32
(
TXPARAMS
 vŞ©ušt32_ˆ*
addr
);

82 
ušt64_t
 
¡m_lßd64
(
TXPARAMS
 vŞ©ušt64_ˆ*
addr
);

92 
¡m_lßd_ch¬
(
TXPARAMS
 vŞ©*
addr
);

102 
¡m_lßd_uch¬
(
TXPARAMS
 vŞ©*
addr
);

112 
¡m_lßd_shÜt
(
TXPARAMS
 vŞ©*
addr
);

122 
¡m_lßd_ushÜt
(
TXPARAMS
 vŞ©*
addr
);

132 
¡m_lßd_št
(
TXPARAMS
 vŞ©*
addr
);

142 
¡m_lßd_ušt
(
TXPARAMS
 vŞ©*
addr
);

152 
¡m_lßd_lÚg
(
TXPARAMS
 vŞ©*
addr
);

162 
¡m_lßd_ulÚg
(
TXPARAMS
 vŞ©*
addr
);

172 
¡m_lßd_æßt
(
TXPARAMS
 vŞ©*
addr
);

182 
¡m_lßd_doubË
(
TXPARAMS
 vŞ©*
addr
);

192 *
¡m_lßd_±r
(
TXPARAMS
 vŞ©**
addr
);

207 
¡m_lßd_by‹s
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ*
buf
, 
size_t
 
size
);

217 
¡m_¡Üe8
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ
v®ue
);

227 
¡m_¡Üe16
(
TXPARAMS
 vŞ©
ušt16_t
 *
addr
, ušt16_ˆ
v®ue
);

237 
¡m_¡Üe32
(
TXPARAMS
 vŞ©
ušt32_t
 *
addr
, ušt32_ˆ
v®ue
);

247 
¡m_¡Üe64
(
TXPARAMS
 vŞ©
ušt64_t
 *
addr
, ušt64_ˆ
v®ue
);

257 
¡m_¡Üe_ch¬
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

267 
¡m_¡Üe_uch¬
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

277 
¡m_¡Üe_shÜt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

287 
¡m_¡Üe_ushÜt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

297 
¡m_¡Üe_št
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

307 
¡m_¡Üe_ušt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

317 
¡m_¡Üe_lÚg
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

327 
¡m_¡Üe_ulÚg
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

337 
¡m_¡Üe_æßt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

347 
¡m_¡Üe_doubË
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

357 
¡m_¡Üe_±r
(
TXPARAMS
 vŞ©**
addr
, *
v®ue
);

371 
¡m_¡Üe_by‹s
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ*
buf
, 
size_t
 
size
);

373 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/src/atomic.h

22 #iâdeà
_ATOMIC_H_


23 
	#_ATOMIC_H_


	)

25 
	~<©omic_İs.h
>

27 
AO_t
 
	t©omic_t
;

29 #ifdeà
NO_AO


31 
	#ATOMIC_CAS_FULL
(
a
, 
e
, 
v
è(*×èğ(v), 1)

	)

32 
	#ATOMIC_FETCH_INC_FULL
(
a
è((*×))++)

	)

33 
	#ATOMIC_FETCH_DEC_FULL
(
a
è((*×))--)

	)

34 
	#ATOMIC_FETCH_ADD_FULL
(
a
, 
v
è((*×)è+ğ(v))

	)

35 
	#ATOMIC_LOAD_ACQ
(
a
è(*×))

	)

36 
	#ATOMIC_LOAD
(
a
è(*×))

	)

37 
	#ATOMIC_STORE_REL
(
a
, 
v
è(*×èğ(v))

	)

38 
	#ATOMIC_STORE
(
a
, 
v
è(*×èğ(v))

	)

39 
	#ATOMIC_MB_READ


	)

40 
	#ATOMIC_MB_WRITE


	)

41 
	#ATOMIC_MB_FULL


	)

43 
	#ATOMIC_CAS_FULL
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

44 
	#ATOMIC_FETCH_INC_FULL
(
a
è(
	`AO_ãtch_ªd_add1_fuÎ
((vŞ©
AO_t
 *)×)))

	)

45 
	#ATOMIC_FETCH_DEC_FULL
(
a
è(
	`AO_ãtch_ªd_sub1_fuÎ
((vŞ©
AO_t
 *)×)))

	)

46 
	#ATOMIC_FETCH_ADD_FULL
(
a
, 
v
è(
	`AO_ãtch_ªd_add_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)(v)))

	)

47 #ifdeà
SAFE


48 
	#ATOMIC_LOAD_ACQ
(
a
è(
	`AO_lßd_fuÎ
((vŞ©
AO_t
 *)×)))

	)

49 
	#ATOMIC_LOAD
(
a
è(
	`AO_lßd_fuÎ
((vŞ©
AO_t
 *)×)))

	)

50 
	#ATOMIC_STORE_REL
(
a
, 
v
è(
	`AO_¡Üe_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)(v)))

	)

51 
	#ATOMIC_STORE
(
a
, 
v
è(
	`AO_¡Üe_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)(v)))

	)

52 
	#ATOMIC_MB_READ
 
	`AO_nİ_fuÎ
()

	)

53 
	#ATOMIC_MB_WRITE
 
	`AO_nİ_fuÎ
()

	)

54 
	#ATOMIC_MB_FULL
 
	`AO_nİ_fuÎ
()

	)

56 
	#ATOMIC_LOAD_ACQ
(
a
è(
	`AO_lßd_acquœe_»ad
((vŞ©
AO_t
 *)×)))

	)

57 
	#ATOMIC_LOAD
(
a
è(*((vŞ©
AO_t
 *)×)))

	)

58 
	#ATOMIC_STORE_REL
(
a
, 
v
è(
	`AO_¡Üe_»Ëa£
((vŞ©
AO_t
 *)×), (AO_t)(v)))

	)

59 
	#ATOMIC_STORE
(
a
, 
v
è(*((vŞ©
AO_t
 *)×)èğ(AO_t)(v))

	)

60 
	#ATOMIC_MB_READ
 
	`AO_nİ_»ad
()

	)

61 
	#ATOMIC_MB_WRITE
 
	`AO_nİ_wr™e
()

	)

62 
	#ATOMIC_MB_FULL
 
	`AO_nİ_fuÎ
()

	)

	@utils/estm-0.2.4.3/src/gc.c

23 
	~<as£¹.h
>

24 
	~<¡dio.h
>

25 
	~<¡dšt.h
>

27 
	~<±h»ad.h
>

29 
	~"gc.h
"

31 
	~"©omic.h
"

32 
	~"¡m.h
"

40 
	#MAX_THREADS
 1024

	)

41 
	#EPOCH_MAX
 (~(
gc_wÜd_t
)0)

	)

43 #iâdeà
NO_PERIODIC_CLEANUP


44 #iâdeà
CLEANUP_FREQUENCY


45 
	#CLEANUP_FREQUENCY
 1

	)

49 #ifdeà
DEBUG


51 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

52 
	#PRINT_DEBUG
(...è
	`´štf
(
__VA_ARGS__
); 
	`fæush
(
NULL
)

	)

54 
	#IO_FLUSH


	)

55 
	#PRINT_DEBUG
(...)

	)

63 
	mGC_NULL
 = 0,

64 
	mGC_BUSY
 = 1,

65 
	mGC_FREE_EMPTY
 = 2,

66 
	mGC_FREE_FULL
 = 3

69 
	smem_block
 {

70 *
	maddr
;

71 
mem_block
 *
	mÃxt
;

72 } 
	tmem_block_t
;

74 
	smem_»giÚ
 {

75 
mem_block
 *
	mblocks
;

76 
gc_wÜd_t
 
	mts
;

77 
mem_»giÚ
 *
	mÃxt
;

78 } 
	tmem_»giÚ_t
;

80 
	stm_th»ad
 {

81 
gc_wÜd_t
 
	mu£d
;

82 
±h»ad_t
 
	mth»ad
;

83 
gc_wÜd_t
 
	mts
;

84 
mem_»giÚ_t
 *
	mh—d
;

85 
mem_»giÚ_t
 *
	m
;

86 #iâdeà
NO_PERIODIC_CLEANUP


87 
	mä“s
;

89 } 
	ttm_th»ad_t
;

91 vŞ©
tm_th»ad_t
 *
	gth»ads
;

92 vŞ©
gc_wÜd_t
 
	gnb_th»ads
;

94 
gc_wÜd_t
 (*
cu¼’t_•och
)();

96 #ifdeà
TLS


97 
__th»ad
 
	gth»ad_idx
;

99 
±h»ad_key_t
 
	gth»ad_idx
;

109 
šlše
 
	$gc_g‘_idx
()

111 #ifdeà
TLS


112  
th»ad_idx
;

114  ()
	`±h»ad_g‘¥ecific
(
th»ad_idx
);

116 
	}
}

121 
šlše
 
gc_wÜd_t
 
	$gc_compu‹_mš
(
gc_wÜd_t
 
now
)

123 
i
;

124 
gc_wÜd_t
 
mš
, 
ts
;

125 
¡m_wÜd_t
 
u£d
;

127 
	`PRINT_DEBUG
("==> gc_compu‹_mš(%d)\n", 
	`gc_g‘_idx
());

129 
mš
 = 
now
;

130 
i
 = 0; i < 
MAX_THREADS
; i++) {

131 
u£d
 = (
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].used);

132 ià(
u£d
 =ğ
GC_NULL
)

134 ià(
u£d
 !ğ
GC_BUSY
)

137 
ts
 = (
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].ts);

138 ià(
ts
 < 
mš
)

139 
mš
 = 
ts
;

142 
	`PRINT_DEBUG
("==> gc_compu‹_mš(%d,m=%lu)\n", 
	`gc_g‘_idx
(), ()
mš
);

144  
mš
;

145 
	}
}

150 
šlše
 
	$gc_ş—n_blocks
(
mem_block_t
 *
mb
)

152 
mem_block_t
 *
Ãxt_mb
;

154 
mb
 !ğ
NULL
) {

155 
	`PRINT_DEBUG
("==> f»e(%d,a=%p)\n", 
	`gc_g‘_idx
(), 
mb
->
addr
);

156 
	`ä“
(
mb
->
addr
);

157 
Ãxt_mb
 = 
mb
->
Ãxt
;

158 
	`ä“
(
mb
);

159 
mb
 = 
Ãxt_mb
;

161 
	}
}

166 
šlše
 
	$gc_ş—n_»giÚs
(
mem_»giÚ_t
 *
mr
)

168 
mem_»giÚ_t
 *
Ãxt_mr
;

170 
mr
 !ğ
NULL
) {

171 
	`gc_ş—n_blocks
(
mr
->
blocks
);

172 
Ãxt_mr
 = 
mr
->
Ãxt
;

173 
	`ä“
(
mr
);

174 
mr
 = 
Ãxt_mr
;

176 
	}
}

181 
	$gc_ş—nup_th»ad
(
idx
, 
gc_wÜd_t
 
mš
)

183 
mem_»giÚ_t
 *
mr
;

185 
	`PRINT_DEBUG
("==> gc_ş—nup_th»ad(%d,m=%lu)\n", 
idx
, ()
mš
);

187 ià(
th»ads
[
idx
].
h—d
 =ğ
NULL
) {

192 
mš
 > 
th»ads
[
idx
].
h—d
->
ts
) {

193 
	`gc_ş—n_blocks
(
th»ads
[
idx
].
h—d
->
blocks
);

194 
mr
 = 
th»ads
[
idx
].
h—d
->
Ãxt
;

195 
	`ä“
(
th»ads
[
idx
].
h—d
);

196 
th»ads
[
idx
].
h—d
 = 
mr
;

197 if(
mr
 =ğ
NULL
) {

199 
th»ads
[
idx
].

 = 
NULL
;

203 
	}
}

212 
gc_š™
(
	$gc_wÜd_t
 (*
•och
)())

214 
i
;

216 
	`PRINT_DEBUG
("==> gc_init()\n");

218 
cu¼’t_•och
 = 
•och
;

219 ià((
th»ads
 = (
tm_th»ad_t
 *)
	`m®loc
(
MAX_THREADS
 * Ñm_th»ad_t))è=ğ
NULL
) {

220 
	`³¼Ü
("malloc");

221 
	`ex™
(1);

223 
i
 = 0; i < 
MAX_THREADS
; i++) {

224 
th»ads
[
i
].
u£d
 = 
GC_NULL
;

225 
th»ads
[
i
].
ts
 = 
EPOCH_MAX
;

226 
th»ads
[
i
].
h—d
 =h»ads[i].

 = 
NULL
;

227 #iâdeà
NO_PERIODIC_CLEANUP


228 
th»ads
[
i
].
ä“s
 = 0;

231 
nb_th»ads
 = 0;

232 #iâdeà
TLS


233 ià(
	`±h»ad_key_ü—‹
(&
th»ad_idx
, 
NULL
) != 0) {

234 
	`årštf
(
¡d”r
, "Error creatinghread†ocal\n");

235 
	`ex™
(1);

238 
	}
}

243 
	$gc_ex™
()

245 
i
;

247 
	`PRINT_DEBUG
("==> gc_exit()\n");

250 ià(
	`ATOMIC_LOAD
(&
nb_th»ads
) != 0) {

251 
	`årštf
(
¡d”r
, "Error: somehreads have‚ot been cleaned up\n");

252 
	`ex™
(1);

255 
i
 = 0; i < 
MAX_THREADS
; i++)

256 
	`gc_ş—n_»giÚs
(
th»ads
[
i
].
h—d
);

258 
	`ä“
((*)
th»ads
);

259 
	}
}

264 
	$gc_š™_th»ad
()

266 
i
, 
idx
;

267 
gc_wÜd_t
 
u£d
;

269 
	`PRINT_DEBUG
("==> gc_init_thread()\n");

271 ià(
	`ATOMIC_FETCH_INC_FULL
(&
nb_th»ads
è>ğ
MAX_THREADS
) {

272 
	`årštf
(
¡d”r
, "Error:oo many concurrenthreads created\n");

273 
	`ex™
(1);

276 
i
 = 0;

279 
u£d
 = (
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].used);

280 ià(
u£d
 !ğ
GC_BUSY
) {

281 ià(
	`ATOMIC_CAS_FULL
(&
th»ads
[
i
].
u£d
, u£d, 
GC_BUSY
) != 0) {

282 
idx
 = 
i
;

284 
	`ATOMIC_STORE
(&
th»ads
[
idx
].
ts
, 
	`cu¼’t_•och
());

288 
	`as£¹
 (
th»ads
[
i
].
u£d
 !ğ
GC_NULL
);

290 ià(++
i
 >ğ
MAX_THREADS
)

291 
i
 = 0;

293 #ifdeà
TLS


294 
th»ad_idx
 = 
idx
;

296 
	`±h»ad_£t¥ecific
(
th»ad_idx
, (*)
idx
);

299 
	`PRINT_DEBUG
("==> gc_š™_th»ad(i=%d)\n", 
idx
);

300 
	}
}

305 
	$gc_ex™_th»ad
()

307 
idx
 = 
	`gc_g‘_idx
();

309 
	`PRINT_DEBUG
("==> gc_ex™_th»ad(%d)\n", 
idx
);

312 
	`ATOMIC_STORE
(&
th»ads
[
idx
].
ts
, 
EPOCH_MAX
);

314 
	`ATOMIC_STORE
(&
th»ads
[
idx
].
u£d
,h»ads[idx].
h—d
 =ğ
NULL
 ? 
GC_FREE_EMPTY
 : 
GC_FREE_FULL
);

315 
	`ATOMIC_FETCH_DEC_FULL
(&
nb_th»ads
);

317 
	}
}

323 
	$gc_£t_•och
(
gc_wÜd_t
 
•och
)

325 
idx
 = 
	`gc_g‘_idx
();

327 
	`PRINT_DEBUG
("==> gc_£t_•och(%d,%lu)\n", 
idx
, ()
•och
);

329 ià(
•och
 >ğ
EPOCH_MAX
) {

330 
	`årštf
(
¡d”r
, "Exûeded maximumƒpoch‚umb”: 0x%lx\n", ()
•och
);

336 
	`ATOMIC_STORE
(&
th»ads
[
idx
].
ts
, 
•och
);

337 
	}
}

342 
	$gc_ä“
(*
addr
, 
gc_wÜd_t
 
•och
)

344 
mem_»giÚ_t
 *
mr
;

345 
mem_block_t
 *
mb
;

346 
idx
 = 
	`gc_g‘_idx
();

348 
	`PRINT_DEBUG
("==> gc_ä“(%d,%lu)\n", 
idx
, ()
•och
);

350 ià(
th»ads
[
idx
].
h—d
 =ğ
NULL
 ||h»ads[idx].h—d->
ts
 < 
•och
) {

352 ià((
mr
 = (
mem_»giÚ_t
 *)
	`m®loc
((mem_»giÚ_t))è=ğ
NULL
) {

353 
	`³¼Ü
("malloc");

354 
	`ex™
(1);

356 
mr
->
ts
 = 
•och
;

357 
mr
->
blocks
 = 
NULL
;

358 
mr
->
Ãxt
 = 
NULL
;

359 ià(
th»ads
[
idx
].
h—d
 =ğ
NULL
) {

360 
th»ads
[
idx
].
h—d
 =h»ads[idx].

 = 
mr
;

362 
th»ads
[
idx
].

->
Ãxt
 = 
mr
;

363 
th»ads
[
idx
].

 = 
mr
;

367 
mr
 = 
th»ads
[
idx
].
h—d
;

371 ià((
mb
 = (
mem_block_t
 *)
	`m®loc
((mem_block_t))è=ğ
NULL
) {

372 
	`³¼Ü
("malloc");

373 
	`ex™
(1);

375 
mb
->
addr
 =‡ddr;

376 
mb
->
Ãxt
 = 
mr
->
blocks
;

377 
mr
->
blocks
 = 
mb
;

379 #iâdeà
NO_PERIODIC_CLEANUP


380 
th»ads
[
idx
].
ä“s
++;

381 ià(
th»ads
[
idx
].
ä“s
 % 
CLEANUP_FREQUENCY
 == 0)

382 
	`gc_ş—nup
();

384 
	}
}

390 
	$gc_ş—nup
()

392 
gc_wÜd_t
 
mš
;

393 
idx
 = 
	`gc_g‘_idx
();

395 
	`PRINT_DEBUG
("==> gc_ş—nup(%d)\n", 
idx
);

397 ià(
th»ads
[
idx
].
h—d
 =ğ
NULL
) {

402 
mš
 = 
	`gc_compu‹_mš
(
	`cu¼’t_•och
());

404 
	`gc_ş—nup_th»ad
(
idx
, 
mš
);

405 
	}
}

411 
	$gc_ş—nup_®l
()

413 
i
;

414 
gc_wÜd_t
 
mš
 = 
EPOCH_MAX
;

416 
	`PRINT_DEBUG
("==> gc_cleanup_all()\n");

418 
i
 = 0; i < 
MAX_THREADS
; i++) {

419 ià((
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].
u£d
è=ğ
GC_NULL
)

421 ià((
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].
u£d
è=ğ
GC_FREE_FULL
) {

422 ià(
	`ATOMIC_CAS_FULL
(&
th»ads
[
i
].
u£d
, 
GC_FREE_FULL
, 
GC_BUSY
) != 0) {

423 ià(
mš
 =ğ
EPOCH_MAX
)

424 
mš
 = 
	`gc_compu‹_mš
(
	`cu¼’t_•och
());

425 
	`gc_ş—nup_th»ad
(
i
, 
mš
);

426 
	`ATOMIC_STORE
(&
th»ads
[
i
].
u£d
,h»ads[i].
h—d
 =ğ
NULL
 ? 
GC_FREE_EMPTY
 : 
GC_FREE_FULL
);

430 
	}
}

436 
	$gc_»£t
()

438 
i
;

440 
	`PRINT_DEBUG
("==> gc_reset()\n");

442 
	`as£¹
(
nb_th»ads
 == 0);

444 
i
 = 0; i < 
MAX_THREADS
; i++) {

445 ià(
th»ads
[
i
].
u£d
 =ğ
GC_NULL
)

447 
	`gc_ş—n_»giÚs
(
th»ads
[
i
].
h—d
);

448 
th»ads
[
i
].
ts
 = 
EPOCH_MAX
;

449 
th»ads
[
i
].
h—d
 =h»ads[i].

 = 
NULL
;

450 #iâdeà
NO_PERIODIC_CLEANUP


451 
th»ads
[
i
].
ä“s
 = 0;

454 
	}
}

	@utils/estm-0.2.4.3/src/gc.h

23 #iâdeà
_GC_H_


24 
	#_GC_H_


	)

26 
	~<¡dlib.h
>

28 #ifdeà
__ılu¥lus


32 
ušŒ_t
 
	tgc_wÜd_t
;

34 
gc_š™
(
gc_wÜd_t
 (*
•och
)());

35 
gc_ex™
();

37 
gc_š™_th»ad
();

38 
gc_ex™_th»ad
();

40 
gc_£t_•och
(
gc_wÜd_t
 
•och
);

42 
gc_ä“
(*
addr
, 
gc_wÜd_t
 
•och
);

44 
gc_ş—nup
();

46 
gc_ş—nup_®l
();

48 
gc_»£t
();

50 #ifdeà
__ılu¥lus


	@utils/estm-0.2.4.3/src/mod_local.c

22 
	~<as£¹.h
>

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

26 
	~"mod_loÿl.h
"

28 
	~"¡m.h
"

30 #iâdeà
LW_SET_SIZE


31 
	#LW_SET_SIZE
 1024

	)

39 
	mTYPE_WORD
,

40 
	mTYPE_CHAR
,

41 
	mTYPE_UCHAR
,

42 
	mTYPE_SHORT
,

43 
	mTYPE_USHORT
,

44 
	mTYPE_INT
,

45 
	mTYPE_UINT
,

46 
	mTYPE_LONG
,

47 
	mTYPE_ULONG
,

48 
	mTYPE_FLOAT
,

49 
	mTYPE_DOUBLE


52 
	sw_’Œy
 {

53 
	mty³
;

55 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mc
;

56 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	muc
;

57 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	ms
;

58 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mus
;

59 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mi
;

60 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mui
;

61 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	ml
;

62 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mul
;

63 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mf
;

64 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	md
;

65 ¡ruù { vŞ©
¡m_wÜd_t
 *
	ma
; stm_wÜd_ˆ
	mv
; } 
	mw
;

66 } 
	md©a
;

67 } 
	tw_’Œy_t
;

69 
	sw_£t
 {

70 
w_’Œy_t
 *
	m’Œ›s
;

71 
	mnb_’Œ›s
;

72 
	msize
;

73 } 
	tw_£t_t
;

75 
	gkey
;

76 
	gš™Ÿlized
 = 0;

85 
šlše
 
w_’Œy_t
 *
	$g‘_’Œy
(
TXPARAM
)

87 
w_£t_t
 *
ws
;

89 ià(!
š™Ÿlized
) {

90 
	`årštf
(
¡d”r
, "Module mod_local‚ot initialized\n");

91 
	`ex™
(1);

95 
ws
 = (
w_£t_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

96 
	`as£¹
(
ws
 !ğ
NULL
);

98 ià(
ws
->
nb_’Œ›s
 =ğws->
size
) {

100 
ws
->
size
 = (ws->siz< 
LW_SET_SIZE
 ? LW_SET_SIZE : ws->size * 2);

101 ià((
ws
->
’Œ›s
 = (
w_’Œy_t
 *)
	`»®loc
(ws->’Œ›s, ws->
size
 * (w_’Œy_t))è=ğ
NULL
) {

102 
	`³¼Ü
("realloc");

103 
	`ex™
(1);

107  &
ws
->
’Œ›s
[ws->
nb_’Œ›s
++];

108 
	}
}

114 
	$¡m_¡Üe_loÿl
(
TXPARAMS
 
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
)

116 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

118 
w
->
ty³
 = 
TYPE_WORD
;

119 
w
->
d©a
.w.
a
 = 
addr
;

120 
w
->
d©a
.w.
v
 = *
addr
;

123 *
addr
 = 
v®ue
;

124 
	}
}

126 
	$¡m_¡Üe_loÿl_ch¬
(
TXPARAMS
 *
addr
, 
v®ue
)

128 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

130 
w
->
ty³
 = 
TYPE_CHAR
;

131 
w
->
d©a
.
c
.
a
 = 
addr
;

132 
w
->
d©a
.
c
.
v
 = *
addr
;

135 *
addr
 = 
v®ue
;

136 
	}
}

138 
	$¡m_¡Üe_loÿl_uch¬
(
TXPARAMS
 *
addr
, 
v®ue
)

140 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

142 
w
->
ty³
 = 
TYPE_UCHAR
;

143 
w
->
d©a
.
uc
.
a
 = 
addr
;

144 
w
->
d©a
.
uc
.
v
 = *
addr
;

147 *
addr
 = 
v®ue
;

148 
	}
}

150 
	$¡m_¡Üe_loÿl_shÜt
(
TXPARAMS
 *
addr
, 
v®ue
)

152 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

154 
w
->
ty³
 = 
TYPE_SHORT
;

155 
w
->
d©a
.
s
.
a
 = 
addr
;

156 
w
->
d©a
.
s
.
v
 = *
addr
;

159 *
addr
 = 
v®ue
;

160 
	}
}

162 
	$¡m_¡Üe_loÿl_ushÜt
(
TXPARAMS
 *
addr
, 
v®ue
)

164 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

166 
w
->
ty³
 = 
TYPE_USHORT
;

167 
w
->
d©a
.
us
.
a
 = 
addr
;

168 
w
->
d©a
.
us
.
v
 = *
addr
;

171 *
addr
 = 
v®ue
;

172 
	}
}

174 
	$¡m_¡Üe_loÿl_št
(
TXPARAMS
 *
addr
, 
v®ue
)

176 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

178 
w
->
ty³
 = 
TYPE_INT
;

179 
w
->
d©a
.
i
.
a
 = 
addr
;

180 
w
->
d©a
.
i
.
v
 = *
addr
;

183 *
addr
 = 
v®ue
;

184 
	}
}

186 
	$¡m_¡Üe_loÿl_ušt
(
TXPARAMS
 *
addr
, 
v®ue
)

188 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

190 
w
->
ty³
 = 
TYPE_UINT
;

191 
w
->
d©a
.
ui
.
a
 = 
addr
;

192 
w
->
d©a
.
ui
.
v
 = *
addr
;

195 *
addr
 = 
v®ue
;

196 
	}
}

198 
	$¡m_¡Üe_loÿl_lÚg
(
TXPARAMS
 *
addr
, 
v®ue
)

200 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

202 
w
->
ty³
 = 
TYPE_LONG
;

203 
w
->
d©a
.
l
.
a
 = 
addr
;

204 
w
->
d©a
.
l
.
v
 = *
addr
;

207 *
addr
 = 
v®ue
;

208 
	}
}

210 
	$¡m_¡Üe_loÿl_ulÚg
(
TXPARAMS
 *
addr
, 
v®ue
)

212 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

214 
w
->
ty³
 = 
TYPE_ULONG
;

215 
w
->
d©a
.
ul
.
a
 = 
addr
;

216 
w
->
d©a
.
ul
.
v
 = *
addr
;

219 *
addr
 = 
v®ue
;

220 
	}
}

222 
	$¡m_¡Üe_loÿl_æßt
(
TXPARAMS
 *
addr
, 
v®ue
)

224 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

226 
w
->
ty³
 = 
TYPE_FLOAT
;

227 
w
->
d©a
.
f
.
a
 = 
addr
;

228 
w
->
d©a
.
f
.
v
 = *
addr
;

231 *
addr
 = 
v®ue
;

232 
	}
}

234 
	$¡m_¡Üe_loÿl_doubË
(
TXPARAMS
 *
addr
, 
v®ue
)

236 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

238 
w
->
ty³
 = 
TYPE_DOUBLE
;

239 
w
->
d©a
.
d
.
a
 = 
addr
;

240 
w
->
d©a
.
d
.
v
 = *
addr
;

243 *
addr
 = 
v®ue
;

244 
	}
}

246 
	$¡m_¡Üe_loÿl_±r
(
TXPARAMS
 **
addr
, *
v®ue
)

248 uniÚ { 
¡m_wÜd_t
 
w
; *
v
; } 
cÚv”t
;

249 
cÚv”t
.
v
 = 
v®ue
;

250 
	`¡m_¡Üe_loÿl
(
	`TXARGS
 (
¡m_wÜd_t
 *)
addr
, 
cÚv”t
.
w
);

251 
	}
}

256 
	$Ú_th»ad_š™
(
TXPARAMS
 *
¬g
)

258 
w_£t_t
 *
ws
;

260 ià((
ws
 = (
w_£t_t
 *)
	`m®loc
((w_£t_t))è=ğ
NULL
) {

261 
	`³¼Ü
("malloc");

262 
	`ex™
(1);

264 
ws
->
’Œ›s
 = 
NULL
;

265 
ws
->
nb_’Œ›s
 = ws->
size
 = 0;

267 
	`¡m_£t_¥ecific
(
TXARGS
 
key
, 
ws
);

268 
	}
}

273 
	$Ú_th»ad_ex™
(
TXPARAMS
 *
¬g
)

275 
w_£t_t
 *
ws
;

277 
ws
 = (
w_£t_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

278 
	`as£¹
(
ws
 !ğ
NULL
);

280 
	`ä“
(
ws
->
’Œ›s
);

281 
	`ä“
(
ws
);

282 
	}
}

287 
	$Ú_comm™
(
TXPARAMS
 *
¬g
)

289 
w_£t_t
 *
ws
;

291 
ws
 = (
w_£t_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

292 
	`as£¹
(
ws
 !ğ
NULL
);

295 
ws
->
nb_’Œ›s
 = 0;

296 
	}
}

301 
	$Ú_abÜt
(
TXPARAMS
 *
¬g
)

303 
w_£t_t
 *
ws
;

304 
i
;

306 
ws
 = (
w_£t_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

307 
	`as£¹
(
ws
 !ğ
NULL
);

310 
i
 = 
ws
->
nb_’Œ›s
 - 1; i >= 0; i--) {

311 
ws
->
’Œ›s
[
i
].
ty³
) {

312 
TYPE_WORD
:

313 *
ws
->
’Œ›s
[
i
].
d©a
.
w
.
a
 = ws->’Œ›s[i].d©a.w.
v
;

315 
TYPE_CHAR
:

316 *
ws
->
’Œ›s
[
i
].
d©a
.
c
.
a
 = ws->’Œ›s[i].d©a.c.
v
;

318 
TYPE_UCHAR
:

319 *
ws
->
’Œ›s
[
i
].
d©a
.
uc
.
a
 = ws->’Œ›s[i].d©a.uc.
v
;

321 
TYPE_SHORT
:

322 *
ws
->
’Œ›s
[
i
].
d©a
.
s
.
a
 = ws->’Œ›s[i].d©a.s.
v
;

324 
TYPE_USHORT
:

325 *
ws
->
’Œ›s
[
i
].
d©a
.
us
.
a
 = ws->’Œ›s[i].d©a.us.
v
;

327 
TYPE_INT
:

328 *
ws
->
’Œ›s
[
i
].
d©a
.i.
a
 = ws->’Œ›s[i].d©a.i.
v
;

330 
TYPE_UINT
:

331 *
ws
->
’Œ›s
[
i
].
d©a
.
ui
.
a
 = ws->’Œ›s[i].d©a.ui.
v
;

333 
TYPE_LONG
:

334 *
ws
->
’Œ›s
[
i
].
d©a
.
l
.
a
 = ws->’Œ›s[i].d©a.l.
v
;

336 
TYPE_ULONG
:

337 *
ws
->
’Œ›s
[
i
].
d©a
.
ul
.
a
 = ws->’Œ›s[i].d©a.ul.
v
;

339 
TYPE_FLOAT
:

340 *
ws
->
’Œ›s
[
i
].
d©a
.
f
.
a
 = ws->’Œ›s[i].d©a.f.
v
;

342 
TYPE_DOUBLE
:

343 *
ws
->
’Œ›s
[
i
].
d©a
.
d
.
a
 = ws->’Œ›s[i].d©a.d.
v
;

346 
	`årštf
(
¡d”r
, "Unexpectedƒntry in undo†og\n");

347 
	`abÜt
();

348 
	`ex™
(1);

351 
	}
}

356 
	$mod_loÿl_š™
()

358 ià(
š™Ÿlized
)

361 
	`¡m_»gi¡”
(
Ú_th»ad_š™
, 
Ú_th»ad_ex™
, 
NULL
, 
Ú_comm™
, 
Ú_abÜt
, NULL);

362 
key
 = 
	`¡m_ü—‹_¥ecific
();

363 ià(
key
 < 0) {

364 
	`årštf
(
¡d”r
, "Cannot create specific key\n");

365 
	`ex™
(1);

367 
š™Ÿlized
 = 1;

368 
	}
}

	@utils/estm-0.2.4.3/src/mod_mem.c

23 
	~<as£¹.h
>

24 
	~<¡dio.h
>

25 
	~<¡dlib.h
>

27 
	~"mod_mem.h
"

29 
	~"gc.h
"

30 
	~"¡m.h
"

36 
	smem_block
 {

37 *
	maddr
;

38 
mem_block
 *
	mÃxt
;

39 } 
	tmem_block_t
;

41 
	smem_šfo
 {

42 
mem_block_t
 *
	m®loÿ‹d
;

43 
mem_block_t
 *
	mä“d
;

44 } 
	tmem_šfo_t
;

46 
	gkey
;

47 
	gš™Ÿlized
 = 0;

56 *
	$¡m_m®loc
(
TXPARAMS
 
size_t
 
size
)

59 
mem_šfo_t
 *
mi
;

60 
mem_block_t
 *
mb
;

62 ià(!
š™Ÿlized
) {

63 
	`årštf
(
¡d”r
, "Module mod_mem‚ot initialized\n");

64 
	`ex™
(1);

67 
mi
 = (
mem_šfo_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

68 
	`as£¹
(
mi
 !ğ
NULL
);

71 ià((
¡m_wÜd_t
) == 4) {

72 
size
 = (siz+ 3è& ~(
size_t
)0x03;

74 
size
 = (siz+ 7è& ~(
size_t
)0x07;

77 ià((
mb
 = (
mem_block_t
 *)
	`m®loc
((mem_block_t))è=ğ
NULL
) {

78 
	`³¼Ü
("malloc");

79 
	`ex™
(1);

81 ià((
mb
->
addr
 = 
	`m®loc
(
size
)è=ğ
NULL
) {

82 
	`³¼Ü
("malloc");

83 
	`ex™
(1);

85 
mb
->
Ãxt
 = 
mi
->
®loÿ‹d
;

86 
mi
->
®loÿ‹d
 = 
mb
;

88  
mb
->
addr
;

89 
	}
}

94 
	$¡m_ä“
(
TXPARAMS
 *
addr
, 
size_t
 
size
)

96 
	`¡m_ä“2
(
TXARGS
 
addr
, 0, 
size
);

97 
	}
}

102 
	$¡m_ä“2
(
TXPARAMS
 *
addr
, 
size_t
 
idx
, size_ˆ
size
)

105 
mem_šfo_t
 *
mi
;

106 
mem_block_t
 *
mb
;

107 
¡m_wÜd_t
 *
a
;

109 ià(!
š™Ÿlized
) {

110 
	`årštf
(
¡d”r
, "Module mod_mem‚ot initialized\n");

111 
	`ex™
(1);

114 
mi
 = (
mem_šfo_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

115 
	`as£¹
(
mi
 !ğ
NULL
);

118 ià(
size
 > 0) {

120 ià((
¡m_wÜd_t
) == 4) {

121 
idx
 = (idx + 3) >> 2;

122 
size
 = (size + 3) >> 2;

124 
idx
 = (idx + 7) >> 3;

125 
size
 = (size + 7) >> 3;

127 
a
 = (
¡m_wÜd_t
 *)
addr
 + 
idx
;

128 
size
-- > 0) {

130 
	`¡m_¡Üe2
(
TXARGS
 
a
++, 0, 0);

134 ià((
mb
 = (
mem_block_t
 *)
	`m®loc
((mem_block_t))è=ğ
NULL
) {

135 
	`³¼Ü
("malloc");

136 
	`ex™
(1);

138 
mb
->
addr
 =‡ddr;

139 
mb
->
Ãxt
 = 
mi
->
ä“d
;

140 
mi
->
ä“d
 = 
mb
;

141 
	}
}

146 
	$Ú_th»ad_š™
(
TXPARAMS
 *
¬g
)

148 
mem_šfo_t
 *
mi
;

150 ià((
mi
 = (
mem_šfo_t
 *)
	`m®loc
((mem_šfo_t))è=ğ
NULL
) {

151 
	`³¼Ü
("malloc");

152 
	`ex™
(1);

154 
mi
->
®loÿ‹d
 = mi->
ä“d
 = 
NULL
;

156 
	`¡m_£t_¥ecific
(
TXARGS
 
key
, 
mi
);

157 
	}
}

162 
	$Ú_th»ad_ex™
(
TXPARAMS
 *
¬g
)

164 
	`ä“
(
	`¡m_g‘_¥ecific
(
TXARGS
 
key
));

165 
	}
}

170 
	$Ú_comm™
(
TXPARAMS
 *
¬g
)

172 
mem_šfo_t
 *
mi
;

173 
mem_block_t
 *
mb
, *
Ãxt
;

175 
mi
 = (
mem_šfo_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

176 
	`as£¹
(
mi
 !ğ
NULL
);

179 ià(
mi
->
®loÿ‹d
 !ğ
NULL
) {

180 
mb
 = 
mi
->
®loÿ‹d
;

181 
mb
 !ğ
NULL
) {

182 
Ãxt
 = 
mb
->next;

183 
	`ä“
(
mb
);

184 
mb
 = 
Ãxt
;

186 
mi
->
®loÿ‹d
 = 
NULL
;

190 ià(
mi
->
ä“d
 !ğ
NULL
) {

191 #ifdeà
EPOCH_GC


192 
¡m_wÜd_t
 
t
 = 
	`¡m_g‘_şock
();

194 
mb
 = 
mi
->
ä“d
;

195 
mb
 !ğ
NULL
) {

196 
Ãxt
 = 
mb
->next;

197 #ifdeà
EPOCH_GC


198 
	`gc_ä“
(
mb
->
addr
, 
t
);

200 
	`ä“
(
mb
->
addr
);

202 
	`ä“
(
mb
);

203 
mb
 = 
Ãxt
;

205 
mi
->
ä“d
 = 
NULL
;

207 
	}
}

212 
	$Ú_abÜt
(
TXPARAMS
 *
¬g
)

214 
mem_šfo_t
 *
mi
;

215 
mem_block_t
 *
mb
, *
Ãxt
;

217 
mi
 = (
mem_šfo_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

218 
	`as£¹
 (
mi
 !ğ
NULL
);

221 ià(
mi
->
®loÿ‹d
 !ğ
NULL
) {

222 
mb
 = 
mi
->
®loÿ‹d
;

223 
mb
 !ğ
NULL
) {

224 
Ãxt
 = 
mb
->next;

225 
	`ä“
(
mb
->
addr
);

226 
	`ä“
(
mb
);

227 
mb
 = 
Ãxt
;

229 
mi
->
®loÿ‹d
 = 
NULL
;

233 ià(
mi
->
ä“d
 !ğ
NULL
) {

234 
mb
 = 
mi
->
ä“d
;

235 
mb
 !ğ
NULL
) {

236 
Ãxt
 = 
mb
->next;

237 
	`ä“
(
mb
);

238 
mb
 = 
Ãxt
;

240 
mi
->
ä“d
 = 
NULL
;

242 
	}
}

247 
	$mod_mem_š™
()

249 ià(
š™Ÿlized
)

252 
	`¡m_»gi¡”
(
Ú_th»ad_š™
, 
Ú_th»ad_ex™
, 
NULL
, 
Ú_comm™
, 
Ú_abÜt
, NULL);

253 
key
 = 
	`¡m_ü—‹_¥ecific
();

254 ià(
key
 < 0) {

255 
	`årštf
(
¡d”r
, "Cannot create specific key\n");

256 
	`ex™
(1);

258 
š™Ÿlized
 = 1;

259 
	}
}

	@utils/estm-0.2.4.3/src/mod_print.c

22 
	~"mod_´št.h
"

24 
	~"¡m.h
"

29 
	$Ú_th»ad_š™
(
TXPARAMS
 *
¬g
)

31 
	`´štf
("==> on_thread_init()\n");

32 
	`fæush
(
NULL
);

33 
	}
}

38 
	$Ú_th»ad_ex™
(
TXPARAMS
 *
¬g
)

40 
	`´štf
("==> on_thread_exit()\n");

41 
	`fæush
(
NULL
);

42 
	}
}

47 
	$Ú_¡¬t
(
TXPARAMS
 *
¬g
)

49 
	`´štf
("==> on_start()\n");

50 
	`fæush
(
NULL
);

51 
	}
}

56 
	$Ú_comm™
(
TXPARAMS
 *
¬g
)

58 
	`´štf
("==> on_commit()\n");

59 
	`fæush
(
NULL
);

60 
	}
}

65 
	$Ú_abÜt
(
TXPARAMS
 *
¬g
)

67 
	`´štf
("==> on_abort()\n");

68 
	`fæush
(
NULL
);

69 
	}
}

74 
	$mod_´št_š™
()

76 
	`¡m_»gi¡”
(
Ú_th»ad_š™
, 
Ú_th»ad_ex™
, 
Ú_¡¬t
, 
Ú_comm™
, 
Ú_abÜt
, 
NULL
);

77 
	}
}

	@utils/estm-0.2.4.3/src/mod_stats.c

22 
	~<as£¹.h
>

23 
	~<¡dio.h
>

24 
	~<¡ršg.h
>

26 
	~"mod_¡©s.h
"

28 
	~"©omic.h
"

29 
	~"¡m.h
"

35 
	stx_¡©s
 {

36 
	mcomm™s
;

37 
	mabÜts
;

38 
	m»Œ›s
;

39 
	mmax_»Œ›s
;

40 } 
	ttx_¡©s_t
;

42 
	gkey
;

43 
	gš™Ÿlized
 = 0;

45 
tx_¡©s_t
 
	gglob®_¡©s
 = { 0, 0, 0, 0 };

54 
	$¡m_g‘_glob®_¡©s
(cÚ¡ *
Çme
, *
v®
)

56 ià(!
š™Ÿlized
) {

57 
	`årštf
(
¡d”r
, "Module mod_stats‚ot initialized\n");

58 
	`ex™
(1);

61 ià(
	`¡rcmp
("glob®_nb_comm™s", 
Çme
) == 0) {

62 *(*)
v®
 = 
glob®_¡©s
.
comm™s
;

65 ià(
	`¡rcmp
("glob®_nb_abÜts", 
Çme
) == 0) {

66 *(*)
v®
 = 
glob®_¡©s
.
abÜts
;

69 ià(
	`¡rcmp
("glob®_max_»Œ›s", 
Çme
) == 0) {

70 *(*)
v®
 = 
glob®_¡©s
.
max_»Œ›s
;

75 
	}
}

80 
	$¡m_g‘_loÿl_¡©s
(
TXPARAMS
 cÚ¡ *
Çme
, *
v®
)

82 
tx_¡©s_t
 *
¡©s
;

84 ià(!
š™Ÿlized
) {

85 
	`årštf
(
¡d”r
, "Module mod_stats‚ot initialized\n");

86 
	`ex™
(1);

89 
¡©s
 = (
tx_¡©s_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

90 
	`as£¹
(
¡©s
 !ğ
NULL
);

92 ià(
	`¡rcmp
("nb_comm™s", 
Çme
) == 0) {

93 *(*)
v®
 = 
¡©s
->
comm™s
;

96 ià(
	`¡rcmp
("nb_abÜts", 
Çme
) == 0) {

97 *(*)
v®
 = 
¡©s
->
abÜts
;

100 ià(
	`¡rcmp
("max_»Œ›s", 
Çme
) == 0) {

101 *(*)
v®
 = 
¡©s
->
max_»Œ›s
;

106 
	}
}

111 
	$Ú_th»ad_š™
(
TXPARAMS
 *
¬g
)

113 
tx_¡©s_t
 *
¡©s
;

115 ià((
¡©s
 = (
tx_¡©s_t
 *)
	`m®loc
(Ñx_¡©s_t))è=ğ
NULL
) {

116 
	`³¼Ü
("malloc");

117 
	`ex™
(1);

119 
¡©s
->
comm™s
 = 0;

120 
¡©s
->
abÜts
 = 0;

121 
¡©s
->
»Œ›s
 = 0;

122 
¡©s
->
max_»Œ›s
 = 0;

124 
	`¡m_£t_¥ecific
(
TXARGS
 
key
, 
¡©s
);

125 
	}
}

130 
	$Ú_th»ad_ex™
(
TXPARAMS
 *
¬g
)

132 
tx_¡©s_t
 *
¡©s
;

133 
max
;

135 
¡©s
 = (
tx_¡©s_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

136 
	`as£¹
(
¡©s
 !ğ
NULL
);

138 
	`ATOMIC_FETCH_ADD_FULL
(&
glob®_¡©s
.
comm™s
, 
¡©s
->commits);

139 
	`ATOMIC_FETCH_ADD_FULL
(&
glob®_¡©s
.
abÜts
, 
¡©s
->aborts);

140 
»Œy
:

141 
max
 = 
	`ATOMIC_LOAD
(&
glob®_¡©s
.
max_»Œ›s
);

142 ià(
¡©s
->
max_»Œ›s
 > 
max
) {

143 ià(
	`ATOMIC_CAS_FULL
(&
glob®_¡©s
.
max_»Œ›s
, 
max
, 
¡©s
->max_retries) == 0)

144 
»Œy
;

147 
	`ä“
(
¡©s
);

148 
	}
}

153 
	$Ú_comm™
(
TXPARAMS
 *
¬g
)

155 
tx_¡©s_t
 *
¡©s
;

157 
¡©s
 = (
tx_¡©s_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

158 
	`as£¹
(
¡©s
 !ğ
NULL
);

160 
¡©s
->
comm™s
++;

161 
¡©s
->
»Œ›s
 = 0;

162 
	}
}

167 
	$Ú_abÜt
(
TXPARAMS
 *
¬g
)

169 
tx_¡©s_t
 *
¡©s
;

171 
¡©s
 = (
tx_¡©s_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

172 
	`as£¹
(
¡©s
 !ğ
NULL
);

174 
¡©s
->
abÜts
++;

175 
¡©s
->
»Œ›s
++;

176 ià(
¡©s
->
max_»Œ›s
 < sts->
»Œ›s
)

177 
¡©s
->
max_»Œ›s
 = sts->
»Œ›s
;

178 
	}
}

183 
	$mod_¡©s_š™
()

185 ià(
š™Ÿlized
)

188 
	`¡m_»gi¡”
(
Ú_th»ad_š™
, 
Ú_th»ad_ex™
, 
NULL
, 
Ú_comm™
, 
Ú_abÜt
, NULL);

189 
key
 = 
	`¡m_ü—‹_¥ecific
();

190 ià(
key
 < 0) {

191 
	`årštf
(
¡d”r
, "Cannot create specific key\n");

192 
	`ex™
(1);

194 
š™Ÿlized
 = 1;

195 
	}
}

	@utils/estm-0.2.4.3/src/stm.c

23 
	~<as£¹.h
>

24 
	~<sigÇl.h
>

25 
	~<¡dio.h
>

26 
	~<¡ršg.h
>

28 
	~<±h»ad.h
>

29 
	~<sched.h
>

31 
	~"¡m.h
"

33 
	~"©omic.h
"

34 
	~"gc.h
"

40 
	#COMPILE_TIME_ASSERT
(
´ed
è0è{ 0: ´ed: ; }

	)

43 
	#WRITE_BACK_ETL
 0

	)

44 
	#WRITE_BACK_CTL
 1

	)

45 
	#WRITE_THROUGH
 2

	)

47 
	#EL
 0

	)

48 
	#NL
 1

	)

50 cÚ¡ *
	gdesign_Çmes
[] = {

58 
	#CM_SUICIDE
 0

	)

59 
	#CM_DELAY
 1

	)

60 
	#CM_BACKOFF
 2

	)

61 
	#CM_PRIORITY
 3

	)

63 cÚ¡ *
	gcm_Çmes
[] = {

75 #ifdeà
EXPLICIT_TX_PARAMETER


76 
	#TX_RETURN
  
tx


	)

77 
	#TX_GET


	)

79 
	#TX_RETURN


	)

80 
	#TX_GET
 
¡m_tx_t
 *
tx
 = 
	`¡m_g‘_tx
()

	)

84 
	#IO_FLUSH


	)

85 
	#PRINT_DEBUG
(...)

	)

87 
	#PRINT_DEBUG2
(...)

	)

89 #iâdeà
RW_SET_SIZE


90 
	#RW_SET_SIZE
 4096

	)

93 #iâdeà
LOCK_ARRAY_LOG_SIZE


94 
	#LOCK_ARRAY_LOG_SIZE
 20

	)

97 #iâdeà
LOCK_SHIFT_EXTRA


98 
	#LOCK_SHIFT_EXTRA
 2

	)

103 
	#XSTR
(
s
è
	`STR
(s)

	)

104 
	#STR
(
s
è#s

	)

116 
	mTX_IDLE
 = 0,

117 
	mTX_ACTIVE
 = 1,

118 
	mTX_COMMITTED
 = 2,

119 
	mTX_ABORTED
 = 3

122 
	sr_’Œy
 {

123 
¡m_wÜd_t
 
	mv”siÚ
;

124 vŞ©
¡m_wÜd_t
 *
	mlock
;

125 } 
	tr_’Œy_t
;

127 
	sr_£t
 {

128 
r_’Œy_t
 *
	m’Œ›s
;

129 
	mnb_’Œ›s
;

130 
	msize
;

131 } 
	tr_£t_t
;

133 
	sw_’Œy
 {

136 vŞ©
¡m_wÜd_t
 *
	maddr
;

137 
¡m_wÜd_t
 
	mv®ue
;

138 
¡m_wÜd_t
 
	mmask
;

139 
¡m_wÜd_t
 
	mv”siÚ
;

140 vŞ©
¡m_wÜd_t
 *
	mlock
;

141 
w_’Œy
 *
	mÃxt
;

144 } 
	tw_’Œy_t
;

146 
	sw_£t
 {

147 
w_’Œy_t
 *
	m’Œ›s
;

148 
	mnb_’Œ›s
;

149 
	msize
;

150 
	m»®loÿ‹
;

151 } 
	tw_£t_t
;

153 #iâdeà
MAX_SPECIFIC


154 
	#MAX_SPECIFIC
 16

	)

157 
	s¡m_tx
 {

158 
¡m_tx_©Œ_t
 *
	m©Œ
;

159 
¡m_wÜd_t
 
	m¡©us
;

160 
¡m_wÜd_t
 
	m¡¬t
;

161 
¡m_wÜd_t
 
	m’d
;

162 
r_£t_t
 
	mr_£t
;

163 
w_£t_t
 
	mw_£t
;

164 
sigjmp_buf
 
	m’v
;

165 
sigjmp_buf
 *
	mjmp
;

166 
	mÃ¡šg
;

167 
	mro
;

168 
	mÿn_ex‹nd
;

169 *
	md©a
[
MAX_SPECIFIC
];

170 
	m»Œ›s
;

171 
	mabÜts
;

172 
	mabÜts_ro
;

173 
	mabÜts_locked_»ad
;

174 
	mabÜts_locked_wr™e
;

175 
	mabÜts_v®id©e_»ad
;

176 
	mabÜts_v®id©e_wr™e
;

177 
	mabÜts_v®id©e_comm™
;

178 
	mabÜts_šv®id_memÜy
;

179 
	mabÜts_doubË_wr™e
;

180 
	mabÜts_»®loÿ‹
;

181 
	mabÜts_rŞlov”
;

182 
	mmax_»Œ›s
;

183 
	mty³
;

184 
¡m_wÜd_t
 *
	mÏ¡¿ddr
;

185 } 
	t¡m_tx_t
;

187 
	gnb_¥ecific
 = 0;

225 
	scb_’Œy
 {

226 (*
	mf
)(
TXPARAMS
 *);

227 *
	m¬g
;

228 } 
	tcb_’Œy_t
;

230 
	#MAX_CB
 16

	)

233 
cb_’Œy_t
 
	gš™_cb
[
MAX_CB
];

234 
cb_’Œy_t
 
	gex™_cb
[
MAX_CB
];

235 
cb_’Œy_t
 
	g¡¬t_cb
[
MAX_CB
];

236 
cb_’Œy_t
 
	gcomm™_cb
[
MAX_CB
];

237 
cb_’Œy_t
 
	gabÜt_cb
[
MAX_CB
];

239 
	gnb_š™_cb
 = 0;

240 
	gnb_ex™_cb
 = 0;

241 
	gnb_¡¬t_cb
 = 0;

242 
	gnb_comm™_cb
 = 0;

243 
	gnb_abÜt_cb
 = 0;

250 #ifdeà
TLS


251 
__th»ad
 
¡m_tx_t
* 
	gth»ad_tx
;

253 
±h»ad_key_t
 
	gth»ad_tx
;

284 
	#OWNED_MASK
 0x01

	)

285 
	#VERSION_MAX
 (~(
¡m_wÜd_t
)0 >> 1)

	)

287 
	#LOCK_GET_OWNED
(
l
èÖ & 
OWNED_MASK
)

	)

288 
	#LOCK_SET_ADDR
(
a
è× | 
OWNED_MASK
è

	)

289 
	#LOCK_GET_ADDR
(
l
èÖ & ~(
¡m_wÜd_t
)
OWNED_MASK
)

	)

290 
	#LOCK_GET_TIMESTAMP
(
l
èÖ >> 1è

	)

291 
	#LOCK_SET_TIMESTAMP
(
t
èÑ << 1è

	)

292 
	#LOCK_UNIT
 (~(
¡m_wÜd_t
)0)

	)

303 
	#LOCK_ARRAY_SIZE
 (1 << 
LOCK_ARRAY_LOG_SIZE
)

	)

304 
	#LOCK_MASK
 (
LOCK_ARRAY_SIZE
 - 1)

	)

305 
	#LOCK_SHIFT
 ((((
¡m_wÜd_t
è=ğ4è? 2 : 3è+ 
LOCK_SHIFT_EXTRA
)

	)

306 
	#LOCK_IDX
(
a
è(((
¡m_wÜd_t
)×è>> 
LOCK_SHIFT
è& 
LOCK_MASK
)

	)

307 
	#GET_LOCK
(
a
è(
locks
 + 
	`LOCK_IDX
×))

	)

309 vŞ©
¡m_wÜd_t
 
	glocks
[
LOCK_ARRAY_SIZE
];

316 vŞ©
¡m_wÜd_t
 
	ggşock
[1024 / (stm_word_t)];

317 
	#CLOCK
 (
gşock
[512 / (
¡m_wÜd_t
)])

	)

319 
	#GET_CLOCK
 (
	`ATOMIC_LOAD_ACQ
(&
CLOCK
))

	)

320 
	#FETCH_INC_CLOCK
 (
	`ATOMIC_FETCH_INC_FULL
(&
CLOCK
))

	)

329 
šlše
 
¡m_tx_t
 *
	$¡m_g‘_tx
()

331 #ifdeà
TLS


332  
th»ad_tx
;

334  (
¡m_tx_t
 *)
	`±h»ad_g‘¥ecific
(
th»ad_tx
);

336 
	}
}

356 
±h»ad_mu‹x_t
 
	gtx_couÁ_mu‹x
;

357 
±h»ad_cÚd_t
 
	gtx_»£t
;

358 
	gtx_couÁ
;

359 
	gtx_ov”æow
;

364 
šlše
 
	$¡m_rŞlov”_’‹r
(
¡m_tx_t
 *
tx
)

366 
	`PRINT_DEBUG
("==> stm_rŞlov”_’‹r(%p)\n", 
tx
);

368 
	`±h»ad_mu‹x_lock
(&
tx_couÁ_mu‹x
);

369 
tx_ov”æow
 != 0)

370 
	`±h»ad_cÚd_wa™
(&
tx_»£t
, &
tx_couÁ_mu‹x
);

372 
tx_couÁ
++;

373 
	`±h»ad_mu‹x_uÆock
(&
tx_couÁ_mu‹x
);

374 
	}
}

379 
šlše
 
	$¡m_rŞlov”_ex™
(
¡m_tx_t
 *
tx
)

381 
	`PRINT_DEBUG
("==> stm_rŞlov”_ex™(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

383 
	`±h»ad_mu‹x_lock
(&
tx_couÁ_mu‹x
);

385 
tx_couÁ
--;

386 
	`as£¹
(
tx_couÁ
 >= 0);

388 ià(
tx_ov”æow
 !ğ0 && 
tx_couÁ
 == 0) {

390 
	`mem£t
((*)
locks
, 0, 
LOCK_ARRAY_SIZE
 * (
¡m_wÜd_t
));

391 
CLOCK
 = 0;

392 
tx_ov”æow
 = 0;

394 
	`gc_»£t
();

396 
	`±h»ad_cÚd_brßdÿ¡
(&
tx_»£t
);

398 
	`±h»ad_mu‹x_uÆock
(&
tx_couÁ_mu‹x
);

399 
	}
}

404 
šlše
 
	$¡m_ov”æow
(
¡m_tx_t
 *
tx
)

406 
	`PRINT_DEBUG
("==> stm_ov”æow(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

408 
	`±h»ad_mu‹x_lock
(&
tx_couÁ_mu‹x
);

410 
tx_ov”æow
 = 1;

412 
tx_couÁ
--;

413 
	`as£¹
(
tx_couÁ
 >= 0);

415 ià(
tx_couÁ
 == 0) {

417 
	`mem£t
((*)
locks
, 0, 
LOCK_ARRAY_SIZE
 * (
¡m_wÜd_t
));

418 
CLOCK
 = 0;

419 
tx_ov”æow
 = 0;

421 
	`gc_»£t
();

423 
	`±h»ad_cÚd_brßdÿ¡
(&
tx_»£t
);

426 
	`±h»ad_cÚd_wa™
(&
tx_»£t
, &
tx_couÁ_mu‹x
);

429 
tx_couÁ
++;

430 
	`±h»ad_mu‹x_uÆock
(&
tx_couÁ_mu‹x
);

431 
	}
}

436 
šlše
 
r_’Œy_t
 *
	$¡m_has_»ad
(
¡m_tx_t
 *
tx
, vŞ©
¡m_wÜd_t
 *
lock
)

438 
r_’Œy_t
 *
r
;

439 
i
;

441 
	`PRINT_DEBUG
("==> stm_has_»ad(%p[%lu-%lu],%p)\n", 
tx
, (éx->
¡¬t
, (éx->
’d
, 
lock
);

444 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

447 
r
 = 
tx
->
r_£t
.
’Œ›s
;

448 
i
 = 
tx
->
r_£t
.
nb_’Œ›s
; i > 0; i--, 
r
++) {

449 ià(
r
->
lock
 ==†ock) {

451  
r
;

454  
NULL
;

455 
	}
}

461 
šlše
 
	$¡m_®loÿ‹_rs_’Œ›s
(
¡m_tx_t
 *
tx
, 
ex‹nd
)

463 ià(
ex‹nd
) {

465 
tx
->
r_£t
.
size
 *= 2;

466 
	`PRINT_DEBUG2
("==>„—Îoÿ‹„—d s‘ (%p[%lu-%lu],%d)\n", 
tx
, (éx->
¡¬t
, (éx->
’d
,x->
r_£t
.
size
);

467 ià((
tx
->
r_£t
.
’Œ›s
 = (
r_’Œy_t
 *)
	`»®loc
Ñx->r_£t.’Œ›s,x->r_£t.
size
 * Ô_’Œy_t))è=ğ
NULL
) {

468 
	`³¼Ü
("realloc");

469 
	`ex™
(1);

473 ià((
tx
->
r_£t
.
’Œ›s
 = (
r_’Œy_t
 *)
	`m®loc
Ñx->r_£t.
size
 * Ô_’Œy_t))è=ğ
NULL
) {

474 
	`³¼Ü
("malloc");

475 
	`ex™
(1);

478 
	}
}

483 
šlše
 
	$¡m_®loÿ‹_ws_’Œ›s
(
¡m_tx_t
 *
tx
, 
ex‹nd
)

486 ià(
ex‹nd
) {

488 
tx
->
w_£t
.
size
 *= 2;

489 
	`PRINT_DEBUG
("==>„—Îoÿ‹ wr™£ˆ(%p[%lu-%lu],%d)\n", 
tx
, (éx->
¡¬t
, (éx->
’d
,x->
w_£t
.
size
);

490 ià((
tx
->
w_£t
.
’Œ›s
 = (
w_’Œy_t
 *)
	`»®loc
Ñx->w_£t.’Œ›s,x->w_£t.
size
 * (w_’Œy_t))è=ğ
NULL
) {

491 
	`³¼Ü
("realloc");

492 
	`ex™
(1);

496 ià((
tx
->
w_£t
.
’Œ›s
 = (
w_’Œy_t
 *)
	`m®loc
Ñx->w_£t.
size
 * (w_’Œy_t))è=ğ
NULL
) {

497 
	`³¼Ü
("malloc");

498 
	`ex™
(1);

502 
	}
}

507 
šlše
 
	$¡m_v®id©e
(
¡m_tx_t
 *
tx
)

509 
r_’Œy_t
 *
r
;

510 
i
;

511 
¡m_wÜd_t
 
l
;

513 
	`PRINT_DEBUG
("==> stm_v®id©e(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

516 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

519 
r
 = 
tx
->
r_£t
.
’Œ›s
;

520 
i
 = 
tx
->
r_£t
.
nb_’Œ›s
; i > 0; i--, 
r
++) {

522 
l
 = 
	`ATOMIC_LOAD
(
r
->
lock
);

524 ià(
	`LOCK_GET_OWNED
(
l
)) {

526 
w_’Œy_t
 *
w
 = (w_’Œy_ˆ*)
	`LOCK_GET_ADDR
(
l
);

528 ià(!(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
))

535 ià(
	`LOCK_GET_TIMESTAMP
(
l
è!ğ
r
->
v”siÚ
) {

543 
	}
}

548 
šlše
 
	$¡m_ex‹nd
(
¡m_tx_t
 *
tx
)

550 
¡m_wÜd_t
 
now
;

552 
	`PRINT_DEBUG
("==> stm_ex‹nd(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

555 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

558 
now
 = 
GET_CLOCK
;

559 ià(
now
 >ğ
VERSION_MAX
) {

564 ià(
	`¡m_v®id©e
(
tx
)) {

566 
tx
->
’d
 = 
now
;

570 
	}
}

575 
šlše
 
	$¡m_rŞlback
(
¡m_tx_t
 *
tx
)

577 
w_’Œy_t
 *
w
;

578 
i
;

580 
	`PRINT_DEBUG
("==> stm_rŞlback(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

583 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

586 
i
 = 
tx
->
w_£t
.
nb_’Œ›s
;

587 ià(
i
 > 0) {

588 
w
 = 
tx
->
w_£t
.
’Œ›s
;

589 ; 
i
 > 0; i--, 
w
++) {

590 ià(
w
->
Ãxt
 =ğ
NULL
) {

592 
	`ATOMIC_STORE
(
w
->
lock
, 
	`LOCK_SET_TIMESTAMP
(w->
v”siÚ
));

594 
	`PRINT_DEBUG2
("==> discard(t=%p[%lu-%lu],a=%p,d=%p-%lu,v=%lu)\n",

595 
tx
, (éx->
¡¬t
, (éx->
’d
, 
w
->
addr
, (*)w->
v®ue
, ()w->v®ue, ()w->
v”siÚ
);

598 
ATOMIC_MB_WRITE
;

601 
tx
->
»Œ›s
++;

602 
tx
->
abÜts
++;

603 ià(
tx
->
max_»Œ›s
 <x->
»Œ›s
)

604 
tx
->
max_»Œ›s
 =x->
»Œ›s
;

607 ià(
nb_abÜt_cb
 != 0) {

608 
cb
;

609 
cb
 = 0; cb < 
nb_abÜt_cb
; cb++)

610 
abÜt_cb
[
cb
].
	`f
(
TXARGS
‡bÜt_cb[cb].
¬g
);

614 
tx
->
¡©us
 = 
TX_ABORTED
;

617 
tx
->
Ã¡šg
 = 0;

621 ià(
tx
->
jmp
 !ğ
NULL
)

622 
	`siglÚgjmp
(*
tx
->
jmp
, 1);

623 
	}
}

629 
šlše
 
w_’Œy_t
 *
	$¡m_–a¡ic_wr™e
(
¡m_tx_t
 *
tx
, vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
)

631 vŞ©
¡m_wÜd_t
 *
lock
, *
lock2
;

632 
¡m_wÜd_t
 
ts_x
 = 0;

633 
¡m_wÜd_t
 
l
, 
l2
, 
v”siÚ
;

634 
w_’Œy_t
 *
w
;

635 
w_’Œy_t
 *
´ev
 = 
NULL
;

637 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,d=%p-%lu,m=0x%lx)\n",

638 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, (*)
v®ue
, ()v®ue, ()
mask
);

641 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

643 
tx
->
ty³
 = 
NL
;

645 ià(
tx
->
ro
) {

647 
	`as£¹
(
tx
->
©Œ
 !ğ
NULL
);

648 
tx
->
©Œ
->
ro
 = 0;

649 
tx
->
abÜts_ro
++;

650 
	`¡m_rŞlback
(
tx
);

651  
NULL
;

655 
lock
 = 
	`GET_LOCK
(
addr
);

658 
»¡¬t
:

659 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

660 
»¡¬t_no_lßd
:

661 ià(
	`LOCK_GET_OWNED
(
l
)) {

664 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

666 ià(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
) {

668 
´ev
 = 
w
;

671 ià(
addr
 =ğ
´ev
->addr) {

672 ià(
mask
 == 0)

673  
´ev
;

675 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu,m=0x%lx)\n",

676 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()v®ue, ()
mask
);

677 ià(
mask
 !ğ~(
¡m_wÜd_t
)0) {

678 ià(
´ev
->
mask
 == 0)

679 
´ev
->
v®ue
 = 
	`ATOMIC_LOAD
(
addr
);

680 
v®ue
 = (
´ev
->v®u& ~
mask
) | (value & mask);

682 
´ev
->
v®ue
 = value;

683 
´ev
->
mask
 |= mask;

684  
´ev
;

686 ià(
´ev
->
Ãxt
 =ğ
NULL
) {

690 
´ev
 =…»v->
Ãxt
;

693 
v”siÚ
 = 
´ev
->version;

695 ià(
tx
->
w_£t
.
nb_’Œ›s
 =ğtx->w_£t.
size
) {

697 
tx
->
w_£t
.
size
 *= 2;

698 
tx
->
w_£t
.
»®loÿ‹
 = 1;

699 
tx
->
abÜts_»®loÿ‹
++;

700 
	`¡m_rŞlback
(
tx
);

701  
NULL
;

703 
w
 = &
tx
->
w_£t
.
’Œ›s
[tx->w_£t.
nb_’Œ›s
];

704 
do_wr™e
;

709 
tx
->
abÜts_locked_wr™e
++;

710 
	`¡m_rŞlback
(
tx
);

711  
NULL
;

715 ià(
tx
->
Ï¡¿ddr
) {

716 
lock2
 = 
	`GET_LOCK
(
tx
->
Ï¡¿ddr
);

717 
l2
 = 
	`ATOMIC_LOAD_ACQ
(
lock2
);

718 ià(
	`LOCK_GET_OWNED
(
l2
è&& (
¡m_tx_t
 *)
	`LOCK_GET_ADDR
(
l
è!ğ
tx
) {

720 
tx
->
abÜts_locked_wr™e
++;

721 
	`¡m_rŞlback
(
tx
);

724 
ts_x
 = (
¡m_wÜd_t
)
	`LOCK_GET_TIMESTAMP
(
l2
);

725 ià(
ts_x
 > 
tx
->
¡¬t
) {

727 
tx
->
abÜts_doubË_wr™e
++;

728 
	`¡m_rŞlback
(
tx
);

731 
tx
->
Ï¡¿ddr
 = 
NULL
;

735 
v”siÚ
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

736 ià(
v”siÚ
 > 
tx
->
’d
) {

738 ià(!
tx
->
ÿn_ex‹nd
 || 
	`¡m_has_»ad
Ñx, 
lock
è!ğ
NULL
) {

741 
tx
->
abÜts_v®id©e_wr™e
++;

742 
	`¡m_rŞlback
(
tx
);

743  
NULL
;

747 ià(
tx
->
w_£t
.
nb_’Œ›s
 =ğtx->w_£t.
size
) {

749 
tx
->
w_£t
.
size
 *= 2;

750 
tx
->
w_£t
.
»®loÿ‹
 = 1;

751 
tx
->
abÜts_»®loÿ‹
++;

752 
	`¡m_rŞlback
(
tx
);

753  
NULL
;

755 
w
 = &
tx
->
w_£t
.
’Œ›s
[tx->w_£t.
nb_’Œ›s
];

756 ià(
	`ATOMIC_CAS_FULL
(
lock
, 
l
, 
	`LOCK_SET_ADDR
((
¡m_wÜd_t
)
w
)) == 0)

757 
»¡¬t
;

760 
do_wr™e
:

761 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu,m=0x%lx)\n",

762 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()v®ue, ()
mask
);

765 ià(
tx
->
w_£t
.
nb_’Œ›s
 =ğtx->w_£t.
size
)

766 
	`¡m_®loÿ‹_ws_’Œ›s
(
tx
, 1);

767 
w
 = &
tx
->
w_£t
.
’Œ›s
[tx->w_£t.
nb_’Œ›s
++];

768 
w
->
addr
 =‡ddr;

769 
w
->
mask
 = mask;

770 
w
->
lock
 =†ock;

771 ià(
mask
 == 0) {

773 #iâdeà
NDEBUG


774 
w
->
v®ue
 = 0;

778 ià(
mask
 !ğ~(
¡m_wÜd_t
)0)

779 
v®ue
 = (
	`ATOMIC_LOAD
(
addr
è& ~
mask
) | (value & mask);

780 
w
->
v®ue
 = value;

782 
w
->
v”siÚ
 = version;

783 
w
->
Ãxt
 = 
NULL
;

784 ià(
´ev
 !ğ
NULL
) {

786 
´ev
->
Ãxt
 = 
w
;

788 
tx
->
w_£t
.
nb_’Œ›s
++;

790  
w
;

791 
	}
}

797 
šlše
 
w_’Œy_t
 *
	$¡m_wr™e
(
¡m_tx_t
 *
tx
, vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
)

799 vŞ©
¡m_wÜd_t
 *
lock
;

800 
¡m_wÜd_t
 
l
, 
v”siÚ
;

801 
w_’Œy_t
 *
w
;

802 
w_’Œy_t
 *
´ev
 = 
NULL
;

804 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,d=%p-%lu,m=0x%lx)\n",

805 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, (*)
v®ue
, ()v®ue, ()
mask
);

808 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

810 ià(
tx
->
ro
) {

812 
	`as£¹
(
tx
->
©Œ
 !ğ
NULL
);

813 
tx
->
©Œ
->
ro
 = 0;

814 
tx
->
abÜts_ro
++;

815 
	`¡m_rŞlback
(
tx
);

816  
NULL
;

820 
lock
 = 
	`GET_LOCK
(
addr
);

823 
»¡¬t
:

824 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

825 
»¡¬t_no_lßd
:

826 ià(
	`LOCK_GET_OWNED
(
l
)) {

829 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

831 ià(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
) {

833 
´ev
 = 
w
;

836 ià(
addr
 =ğ
´ev
->addr) {

837 ià(
mask
 == 0)

838  
´ev
;

840 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu,m=0x%lx)\n",

841 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()v®ue, ()
mask
);

842 ià(
mask
 !ğ~(
¡m_wÜd_t
)0) {

843 ià(
´ev
->
mask
 == 0)

844 
´ev
->
v®ue
 = 
	`ATOMIC_LOAD
(
addr
);

845 
v®ue
 = (
´ev
->v®u& ~
mask
) | (value & mask);

847 
´ev
->
v®ue
 = value;

848 
´ev
->
mask
 |= mask;

849  
´ev
;

851 ià(
´ev
->
Ãxt
 =ğ
NULL
) {

855 
´ev
 =…»v->
Ãxt
;

858 
v”siÚ
 = 
´ev
->version;

860 ià(
tx
->
w_£t
.
nb_’Œ›s
 =ğtx->w_£t.
size
) {

862 
tx
->
w_£t
.
size
 *= 2;

863 
tx
->
w_£t
.
»®loÿ‹
 = 1;

864 
tx
->
abÜts_»®loÿ‹
++;

865 
	`¡m_rŞlback
(
tx
);

866  
NULL
;

868 
w
 = &
tx
->
w_£t
.
’Œ›s
[tx->w_£t.
nb_’Œ›s
];

869 
do_wr™e
;

873 
tx
->
abÜts_locked_wr™e
++;

874 
	`¡m_rŞlback
(
tx
);

875  
NULL
;

879 
v”siÚ
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

880 ià(
v”siÚ
 > 
tx
->
’d
) {

882 ià(!
tx
->
ÿn_ex‹nd
 || 
	`¡m_has_»ad
Ñx, 
lock
è!ğ
NULL
) {

885 
tx
->
abÜts_v®id©e_wr™e
++;

886 
	`¡m_rŞlback
(
tx
);

887  
NULL
;

891 ià(
tx
->
w_£t
.
nb_’Œ›s
 =ğtx->w_£t.
size
) {

893 
tx
->
w_£t
.
size
 *= 2;

894 
tx
->
w_£t
.
»®loÿ‹
 = 1;

895 
tx
->
abÜts_»®loÿ‹
++;

896 
	`¡m_rŞlback
(
tx
);

897  
NULL
;

899 
w
 = &
tx
->
w_£t
.
’Œ›s
[tx->w_£t.
nb_’Œ›s
];

900 ià(
	`ATOMIC_CAS_FULL
(
lock
, 
l
, 
	`LOCK_SET_ADDR
((
¡m_wÜd_t
)
w
)) == 0)

901 
»¡¬t
;

904 
do_wr™e
:

905 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu,m=0x%lx)\n",

906 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()v®ue, ()
mask
);

909 
w
->
addr
 =‡ddr;

910 
w
->
mask
 = mask;

911 
w
->
lock
 =†ock;

912 ià(
mask
 == 0) {

914 #iâdeà
NDEBUG


915 
w
->
v®ue
 = 0;

920 ià(
mask
 !ğ~(
¡m_wÜd_t
)0)

921 
v®ue
 = (
	`ATOMIC_LOAD
(
addr
è& ~
mask
) | (value & mask);

922 
w
->
v®ue
 = value;

924 
w
->
v”siÚ
 = version;

925 
w
->
Ãxt
 = 
NULL
;

926 ià(
´ev
 !ğ
NULL
) {

928 
´ev
->
Ãxt
 = 
w
;

930 
tx
->
w_£t
.
nb_’Œ›s
++;

932  
w
;

933 
	}
}

938 
šlše
 
	$¡m_un™_wr™e
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
, stm_wÜd_ˆ*
time¡amp
)

940 vŞ©
¡m_wÜd_t
 *
lock
;

941 
¡m_wÜd_t
 
l
;

943 
	`PRINT_DEBUG2
("==> stm_unit_write(a=%p,d=%p-%lu,m=0x%lx)\n",

944 
addr
, (*)
v®ue
, ()v®ue, ()
mask
);

947 
lock
 = 
	`GET_LOCK
(
addr
);

950 
»¡¬t
:

951 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

952 ià(
	`LOCK_GET_OWNED
(
l
)) {

954 
»¡¬t
;

957 ià(
time¡amp
 !ğ
NULL
 && 
	`LOCK_GET_TIMESTAMP
(
l
) > *timestamp) {

959 *
time¡amp
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

963 ià(
	`ATOMIC_CAS_FULL
(
lock
, 
l
, 
LOCK_UNIT
) == 0)

964 
»¡¬t
;

965 
	`ATOMIC_STORE
(
addr
, 
v®ue
);

967 
l
 = 
FETCH_INC_CLOCK
 + 1;

968 ià(
time¡amp
 !ğ
NULL
)

969 *
time¡amp
 = 
l
;

971 
	`ATOMIC_STORE_REL
(
lock
, 
	`LOCK_SET_TIMESTAMP
(
l
));

973 
	}
}

978 
	$sigÇl_ÿtch”
(
sig
)

980 
¡m_tx_t
 *
tx
 = 
	`¡m_g‘_tx
();

983 
	`PRINT_DEBUG
("CaughˆsigÇl: %d\n", 
sig
);

985 ià(
tx
 =ğ
NULL
 ||x->
jmp
 == NULL) {

987 
	`årštf
(
¡d”r
, "Error: invalid memory‡ccessed‡nd‚o†ongjmp destination\n");

988 
	`ex™
(1);

991 
tx
->
abÜts_šv®id_memÜy
++;

993 
	`¡m_rŞlback
(
tx
);

994 
	}
}

1003 
	$¡m_š™
()

1005 
sigaùiÚ
 
aù
;

1007 
	`PRINT_DEBUG
("==> stm_init()\n");

1009 
	`PRINT_DEBUG
("\tsizeof(wÜd)=%d\n", ()(
¡m_wÜd_t
));

1011 
	`PRINT_DEBUG
("\tVERSION_MAX=0x%lx\n", ()
VERSION_MAX
);

1013 
	`COMPILE_TIME_ASSERT
((
¡m_wÜd_t
) == (*));

1014 
	`COMPILE_TIME_ASSERT
((
¡m_wÜd_t
è=ğ(
©omic_t
));

1016 
	`gc_š™
(
¡m_g‘_şock
);

1018 
	`mem£t
((*)
locks
, 0, 
LOCK_ARRAY_SIZE
 * (
¡m_wÜd_t
));

1021 
CLOCK
 = 0;

1022 ià(
	`±h»ad_mu‹x_š™
(&
tx_couÁ_mu‹x
, 
NULL
) != 0) {

1023 
	`årštf
(
¡d”r
, "Error creating mutex\n");

1024 
	`ex™
(1);

1026 ià(
	`±h»ad_cÚd_š™
(&
tx_»£t
, 
NULL
) != 0) {

1027 
	`årštf
(
¡d”r
, "Error creating condition variable\n");

1028 
	`ex™
(1);

1030 
tx_couÁ
 = 0;

1031 
tx_ov”æow
 = 0;

1033 #iâdeà
TLS


1034 ià(
	`±h»ad_key_ü—‹
(&
th»ad_tx
, 
NULL
) != 0) {

1035 
	`årštf
(
¡d”r
, "Error creatinghread†ocal\n");

1036 
	`ex™
(1);

1041 
aù
.
§_hªdËr
 = 
sigÇl_ÿtch”
;

1042 
aù
.
§_æags
 = 0;

1043 
	`sigem±y£t
(&
aù
.
§_mask
);

1044 ià(
	`sigaùiÚ
(
SIGBUS
, &
aù
, 
NULL
è< 0 || sigaùiÚ(
SIGSEGV
, &act, NULL) < 0) {

1045 
	`³¼Ü
("sigaction");

1046 
	`ex™
(1);

1049 
	}
}

1054 
	$¡m_ex™
()

1056 
	`PRINT_DEBUG
("==> stm_exit()\n");

1058 #iâdeà
TLS


1059 
	`±h»ad_key_d–‘e
(
th»ad_tx
);

1061 
	`±h»ad_cÚd_de¡roy
(&
tx_»£t
);

1062 
	`±h»ad_mu‹x_de¡roy
(&
tx_couÁ_mu‹x
);

1064 
	`gc_ex™
();

1065 
	}
}

1070 
TXTYPE
 
	$¡m_š™_th»ad
()

1072 
¡m_tx_t
 *
tx
;

1074 
	`PRINT_DEBUG
("==> stm_init_thread()\n");

1076 
	`gc_š™_th»ad
();

1079 ià((
tx
 = (
¡m_tx_t
 *)
	`m®loc
((¡m_tx_t))è=ğ
NULL
) {

1080 
	`³¼Ü
("malloc");

1081 
	`ex™
(1);

1084 
tx
->
¡©us
 = 
TX_IDLE
;

1086 
tx
->
r_£t
.
nb_’Œ›s
 = 0;

1087 
tx
->
r_£t
.
size
 = 
RW_SET_SIZE
;

1088 
	`¡m_®loÿ‹_rs_’Œ›s
(
tx
, 0);

1090 
tx
->
w_£t
.
nb_’Œ›s
 = 0;

1091 
tx
->
w_£t
.
size
 = 
RW_SET_SIZE
;

1092 
tx
->
w_£t
.
»®loÿ‹
 = 0;

1093 
	`¡m_®loÿ‹_ws_’Œ›s
(
tx
, 0);

1095 
tx
->
Ã¡šg
 = 0;

1097 
	`mem£t
(
tx
->
d©a
, 0, 
MAX_SPECIFIC
 * (*));

1098 
tx
->
»Œ›s
 = 0;

1100 
tx
->
abÜts
 = 0;

1101 
tx
->
abÜts_ro
 = 0;

1102 
tx
->
abÜts_locked_»ad
 = 0;

1103 
tx
->
abÜts_locked_wr™e
 = 0;

1104 
tx
->
abÜts_v®id©e_»ad
 = 0;

1105 
tx
->
abÜts_v®id©e_wr™e
 = 0;

1106 
tx
->
abÜts_v®id©e_comm™
 = 0;

1107 
tx
->
abÜts_šv®id_memÜy
 = 0;

1108 
tx
->
abÜts_»®loÿ‹
 = 0;

1109 
tx
->
abÜts_rŞlov”
 = 0;

1110 
tx
->
max_»Œ›s
 = 0;

1112 #ifdeà
TLS


1113 
th»ad_tx
 = 
tx
;

1115 
	`±h»ad_£t¥ecific
(
th»ad_tx
, 
tx
);

1117 
	`¡m_rŞlov”_’‹r
(
tx
);

1120 ià(
nb_š™_cb
 != 0) {

1121 
cb
;

1122 
cb
 = 0; cb < 
nb_š™_cb
; cb++)

1123 
š™_cb
[
cb
].
	`f
(
TXARGS
 in™_cb[cb].
¬g
);

1126 
	`PRINT_DEBUG
("==> %p\n", 
tx
);

1128 
TX_RETURN
;

1129 
	}
}

1134 
	$¡m_ex™_th»ad
(
TXPARAM
)

1136 
¡m_wÜd_t
 
t
;

1137 
TX_GET
;

1139 
	`PRINT_DEBUG
("==> stm_ex™_th»ad(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

1142 ià(
nb_ex™_cb
 != 0) {

1143 
cb
;

1144 
cb
 = 0; cb < 
nb_ex™_cb
; cb++)

1145 
ex™_cb
[
cb
].
	`f
(
TXARGS
ƒx™_cb[cb].
¬g
);

1148 
	`¡m_rŞlov”_ex™
(
tx
);

1150 
t
 = 
GET_CLOCK
;

1151 
	`gc_ä“
(
tx
->
r_£t
.
’Œ›s
, 
t
);

1152 
	`gc_ä“
(
tx
->
w_£t
.
’Œ›s
, 
t
);

1153 
	`gc_ä“
(
tx
, 
t
);

1154 
	`gc_ex™_th»ad
();

1155 
	}
}

1161 
šlše
 
	$¡m_–a¡ic_¡¬t
(
TXPARAMS
 
sigjmp_buf
 *
’v
, 
¡m_tx_©Œ_t
 *
©Œ
)

1163 
TX_GET
;

1164 
tx
->
ty³
 = 
EL
;

1165 
tx
->
Ï¡¿ddr
 = 
NULL
;

1167 
	`PRINT_DEBUG
("==> stm_–a¡ic_¡¬t(%p)\n", 
tx
);

1170 ià(
tx
->
Ã¡šg
++ > 0)

1174 
tx
->
jmp
 = 
’v
;

1176 
tx
->
©Œ
 =‡ttr;

1177 
tx
->
ro
 = (
©Œ
 =ğ
NULL
 ? 0 :‡ttr->ro);

1179 
tx
->
¡©us
 = 
TX_ACTIVE
;

1180 
¡¬t
:

1182 
tx
->
¡¬t
 =x->
’d
 = 
GET_CLOCK
;

1184 
tx
->
ÿn_ex‹nd
 = 0;

1185 ià(
tx
->
¡¬t
 >ğ
VERSION_MAX
) {

1187 
	`¡m_ov”æow
(
tx
);

1188 
¡¬t
;

1191 ià(
tx
->
w_£t
.
»®loÿ‹
) {

1193 
	`gc_ä“
(
tx
->
w_£t
.
’Œ›s
,x->
¡¬t
);

1194 
	`¡m_®loÿ‹_ws_’Œ›s
(
tx
, 0);

1195 
tx
->
w_£t
.
»®loÿ‹
 = 0;

1197 
tx
->
w_£t
.
nb_’Œ›s
 = 0;

1198 
tx
->
r_£t
.
nb_’Œ›s
 = 0;

1200 
	`gc_£t_•och
(
tx
->
¡¬t
);

1203 ià(
nb_¡¬t_cb
 != 0) {

1204 
cb
;

1205 
cb
 = 0; cb < 
nb_¡¬t_cb
; cb++)

1206 
¡¬t_cb
[
cb
].
	`f
(
TXARGS
 s¹_cb[cb].
¬g
);

1208 
	}
}

1213 
šlše
 
	$¡m_nÜm®_¡¬t
(
TXPARAMS
 
sigjmp_buf
 *
’v
, 
¡m_tx_©Œ_t
 *
©Œ
)

1215 
TX_GET
;

1216 
tx
->
ty³
 = 
NL
;

1218 
	`PRINT_DEBUG
("==> stm_nÜm®_¡¬t(%p)\n", 
tx
);

1221 ià(
tx
->
Ã¡šg
++ > 0)

1225 
tx
->
jmp
 = 
’v
;

1227 
tx
->
©Œ
 =‡ttr;

1228 
tx
->
ro
 = (
©Œ
 =ğ
NULL
 ? 0 :‡ttr->ro);

1230 
tx
->
¡©us
 = 
TX_ACTIVE
;

1231 
¡¬t
:

1233 
tx
->
¡¬t
 =x->
’d
 = 
GET_CLOCK
;

1235 
tx
->
ÿn_ex‹nd
 = 1;

1236 ià(
tx
->
¡¬t
 >ğ
VERSION_MAX
) {

1238 
	`¡m_ov”æow
(
tx
);

1239 
¡¬t
;

1242 ià(
tx
->
w_£t
.
»®loÿ‹
) {

1244 
	`gc_ä“
(
tx
->
w_£t
.
’Œ›s
,x->
¡¬t
);

1245 
	`¡m_®loÿ‹_ws_’Œ›s
(
tx
, 0);

1246 
tx
->
w_£t
.
»®loÿ‹
 = 0;

1248 
tx
->
w_£t
.
nb_’Œ›s
 = 0;

1249 
tx
->
r_£t
.
nb_’Œ›s
 = 0;

1251 
	`gc_£t_•och
(
tx
->
¡¬t
);

1254 ià(
nb_¡¬t_cb
 != 0) {

1255 
cb
;

1256 
cb
 = 0; cb < 
nb_¡¬t_cb
; cb++)

1257 
¡¬t_cb
[
cb
].
	`f
(
TXARGS
 s¹_cb[cb].
¬g
);

1259 
	}
}

1261 
	$¡m_¡¬t
(
TXPARAMS
 
sigjmp_buf
 *
’v
, 
¡m_tx_©Œ_t
 *
©Œ
, 
ty³
) {

1262 ià(
ty³
 =ğ
NL
è
	`¡m_nÜm®_¡¬t
(
’v
, 
©Œ
);

1263 
	`¡m_–a¡ic_¡¬t
(
’v
, 
©Œ
);

1264 
	}
}

1269 
šlše
 
	$¡m_–a¡ic_comm™
(
TXPARAM
)

1271 
TX_GET
;

1273 
	`PRINT_DEBUG
("==> stm_–a¡ic_comm™(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

1276 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1279 ià(--
tx
->
Ã¡šg
 > 0)

1282 
tx
->
»Œ›s
 = 0;

1287 ià(
nb_comm™_cb
 != 0) {

1288 
cb
;

1289 
cb
 = 0; cb < 
nb_comm™_cb
; cb++)

1290 
comm™_cb
[
cb
].
	`f
(
TXARGS
 comm™_cb[cb].
¬g
);

1294 
tx
->
¡©us
 = 
TX_COMMITTED
;

1297 
	}
}

1302 
šlše
 
	$¡m_nÜm®_comm™
(
TXPARAM
)

1304 
w_’Œy_t
 *
w
;

1305 
¡m_wÜd_t
 
t
;

1306 
i
;

1307 
TX_GET
;

1309 
	`PRINT_DEBUG
("==> stm_nÜm®_comm™(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

1312 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1315 ià(--
tx
->
Ã¡šg
 > 0)

1318 ià(
tx
->
w_£t
.
nb_’Œ›s
 > 0) {

1323 
t
 = 
FETCH_INC_CLOCK
 + 1;

1324 ià(
t
 >ğ
VERSION_MAX
) {

1326 
tx
->
abÜts_rŞlov”
++;

1327 
	`¡m_rŞlback
(
tx
);

1332 ià(
tx
->
¡¬t
 !ğ
t
 - 1 && !
	`¡m_v®id©e
(tx)) {

1334 
tx
->
abÜts_v®id©e_comm™
++;

1335 
	`¡m_rŞlback
(
tx
);

1340 
w
 = 
tx
->
w_£t
.
’Œ›s
;

1341 
i
 = 
tx
->
w_£t
.
nb_’Œ›s
; i > 0; i--, 
w
++) {

1342 ià(
w
->
mask
 != 0)

1343 
	`ATOMIC_STORE
(
w
->
addr
, w->
v®ue
);

1345 ià(
w
->
Ãxt
 =ğ
NULL
)

1346 
	`ATOMIC_STORE_REL
(
w
->
lock
, 
	`LOCK_SET_TIMESTAMP
(
t
));

1348 
	`PRINT_DEBUG2
("==> write(t=%p[%lu-%lu],a=%p,d=%p-%d,v=%d)\n",

1349 
tx
, (éx->
¡¬t
, (éx->
’d
, 
w
->
addr
, (*)w->
v®ue
, ()w->v®ue, ()w->
v”siÚ
);

1353 
tx
->
»Œ›s
 = 0;

1358 ià(
nb_comm™_cb
 != 0) {

1359 
cb
;

1360 
cb
 = 0; cb < 
nb_comm™_cb
; cb++)

1361 
comm™_cb
[
cb
].
	`f
(
TXARGS
 comm™_cb[cb].
¬g
);

1365 
tx
->
¡©us
 = 
TX_COMMITTED
;

1368 
	}
}

1370 
	$¡m_comm™
(
TXPARAM
) {

1371 
TX_GET
;

1372 ià(
tx
->
ty³
 =ğ
NL
è 
	`¡m_nÜm®_comm™
();

1373  
	`¡m_–a¡ic_comm™
();

1374 
	}
}

1379 
	$¡m_abÜt
(
TXPARAM
)

1381 
TX_GET
;

1382 
	`¡m_rŞlback
(
tx
);

1383 
	}
}

1388 
šlše
 
¡m_wÜd_t
 
	$¡m_»ad_v”v®v”
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ*
time¡amp
)

1390 vŞ©
¡m_wÜd_t
 *
lock
;

1391 
¡m_wÜd_t
 
l
, 
l2
, 
v®ue
;

1392 
w_’Œy_t
 *
w
;

1394 
TX_GET
;

1396 
	`PRINT_DEBUG2
("==> stm_un™_lßd×=%p)\n", 
addr
);

1399 
lock
 = 
	`GET_LOCK
(
addr
);

1402 
»¡¬t
:

1403 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1404 
»¡¬t_no_lßd
:

1405 ià(
	`LOCK_GET_OWNED
(
l
)) {

1407 ià((
¡m_tx_t
 *)
	`LOCK_GET_ADDR
(
l
è=ğ
tx
) {

1409 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

1411 ià(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
) {

1414 ià(
addr
 =ğ
w
->addr) {

1416 
v®ue
 = (
w
->
mask
 =ğ0 ? 
	`ATOMIC_LOAD
(
addr
) : w->value);

1419 ià(
w
->
Ãxt
 =ğ
NULL
) {

1421 
v®ue
 = 
	`ATOMIC_LOAD
(
addr
);

1424 
w
 = w->
Ãxt
;

1427 
	`PRINT_DEBUG2
("==> stm_normal_load(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu)\n",

1428 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()value);

1429  
v®ue
;

1436 
»¡¬t
;

1439 
v®ue
 = 
	`ATOMIC_LOAD_ACQ
(
addr
);

1440 
l2
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1441 ià(
l
 !ğ
l2
) {

1442 
l
 = 
l2
;

1443 
»¡¬t_no_lßd
;

1446 ià(
time
 !ğ
NULL
)

1447 *
time¡amp
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

1449 
	`PRINT_DEBUG2
("==> stm_read_vervalver(a=%p,l=%p,*l=%lu,d=%p-%lu)\n",

1450 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()value);

1452  
v®ue
;

1453 
	}
}

1459 
šlše
 
¡m_wÜd_t
 
	$¡m_–a¡ic_lßd
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
x
)

1461 
¡m_wÜd_t
 
v_x
;

1462 
¡m_wÜd_t
 *
y
;

1463 
¡m_wÜd_t
 
ts_x
 = 0;

1464 
¡m_wÜd_t
 
ts_y
 = 0;

1466 
TX_GET
;

1469 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1475 
	`PRINT_DEBUG2
("==> stm_–a¡ic_lßdÑ=%p[%lu-%lu],a=%p)\n", 
tx
,

1476 ()
tx
->
¡¬t
, (éx->
’d
, 
addr
);

1478 
v_x
 = 
	`¡m_»ad_v”v®v”
(
x
, &
ts_x
);

1479 ià(!
tx
->
Ï¡¿ddr
) {

1480 ià(
ts_x
 > 
tx
->
¡¬t
)x->start =s_x;

1482 ià(
ts_x
 > 
tx
->
¡¬t
) {

1483 
y
 = 
tx
->
Ï¡¿ddr
;

1484 
	`¡m_»ad_v”v®v”
(
y
, &
ts_y
);

1485 ià(
ts_y
 > 
tx
->
¡¬t
) {

1487 
	`¡m_rŞlback
(
tx
);

1490 
tx
->
¡¬t
 = 
ts_x
;

1493 
tx
->
Ï¡¿ddr
 = (
¡m_wÜd_t
 *)
x
;

1494  
v_x
;

1495 
	}
}

1526 
šlše
 
¡m_wÜd_t
 
	$¡m_nÜm®_lßd
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
)

1528 vŞ©
¡m_wÜd_t
 *
lock
;

1529 
¡m_wÜd_t
 
l
, 
l2
, 
v®ue
, 
v”siÚ
;

1530 
r_’Œy_t
 *
r
;

1531 
w_’Œy_t
 *
w
;

1532 
TX_GET
;

1534 
	`PRINT_DEBUG2
("==> stm_nÜm®_lßdÑ=%p[%lu-%lu],a=%p)\n", 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
);

1537 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1542 
lock
 = 
	`GET_LOCK
(
addr
);

1547 
»¡¬t
:

1548 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1549 
»¡¬t_no_lßd
:

1550 ià(
	`LOCK_GET_OWNED
(
l
)) {

1553 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

1555 ià(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
) {

1558 ià(
addr
 =ğ
w
->addr) {

1560 
v®ue
 = (
w
->
mask
 =ğ0 ? 
	`ATOMIC_LOAD
(
addr
) : w->value);

1563 ià(
w
->
Ãxt
 =ğ
NULL
) {

1565 
v®ue
 = 
	`ATOMIC_LOAD
(
addr
);

1568 
w
 = w->
Ãxt
;

1571 
	`PRINT_DEBUG2
("==> stm_normal_load(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu)\n",

1572 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()value);

1573  
v®ue
;

1579 
	`¡m_rŞlback
(
tx
);

1583 
v®ue
 = 
	`ATOMIC_LOAD_ACQ
(
addr
);

1584 
l2
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1585 ià(
l
 !ğ
l2
) {

1586 
l
 = 
l2
;

1587 
»¡¬t_no_lßd
;

1590 
v”siÚ
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

1592 ià(
v”siÚ
 > 
tx
->
’d
) {

1594 ià(
tx
->
ro
 || !tx->
ÿn_ex‹nd
 || !
	`¡m_ex‹nd
(tx)) {

1597 
	`¡m_rŞlback
(
tx
);

1603 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1604 ià(
l
 !ğ
l2
) {

1605 
l
 = 
l2
;

1606 
»¡¬t_no_lßd
;

1613 ià(!
tx
->
ro
) {

1615 ià(
tx
->
r_£t
.
nb_’Œ›s
 =ğtx->r_£t.
size
)

1616 
	`¡m_®loÿ‹_rs_’Œ›s
(
tx
, 1);

1617 
r
 = &
tx
->
r_£t
.
’Œ›s
[tx->r_£t.
nb_’Œ›s
++];

1618 
r
->
v”siÚ
 = version;

1619 
r
->
lock
 =†ock;

1622 
	`PRINT_DEBUG2
("==> stm_normal_load(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu,v=%lu)\n",

1623 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()v®ue, ()
v”siÚ
);

1625  
v®ue
;

1626 
	}
}

1632 
¡m_wÜd_t
 
	$¡m_lßd
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
) {

1633 
TX_GET
;

1634 ià(
tx
->
ty³
 =ğ
NL
è 
	`¡m_nÜm®_lßd
(
addr
);

1635  
	`¡m_–a¡ic_lßd
(
addr
);

1636 
	}
}

1642 
šlše
 
	$¡m_–a¡ic_¡Üe
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
)

1644 
¡m_wÜd_t
 
ts_x
;

1645 vŞ©
¡m_wÜd_t
 *
lock
;

1646 
¡m_wÜd_t
 
l
;

1647 
w_’Œy_t
 *
w
;

1649 
TX_GET
;

1651 
	`PRINT_DEBUG2
("==> stm_–a¡ic_¡ÜeÑ=%p[%lu-%lu],a=%p)\n", 
tx
,

1652 ()
tx
->
¡¬t
, (éx->
’d
, 
addr
);

1654 
tx
->
ty³
 = 
NL
;

1655 
	`¡m_wr™e
(
tx
, 
addr
, 
v®ue
, ~(
¡m_wÜd_t
)0);

1657 ià(
tx
->
Ï¡¿ddr
) {

1658 
lock
 = 
	`GET_LOCK
(
tx
->
Ï¡¿ddr
);

1659 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1660 ià(
	`LOCK_GET_OWNED
(
l
)) {

1661 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

1663 ià((
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
))

1668 
	`¡m_rŞlback
(
tx
);

1671 
ts_x
 = (
¡m_wÜd_t
)
	`LOCK_GET_TIMESTAMP
(
l
);

1672 ià(
ts_x
 > 
tx
->
¡¬t
) {

1675 
	`¡m_rŞlback
(
tx
);

1678 
tx
->
Ï¡¿ddr
 = 
NULL
;

1681 
	}
}

1687 
šlše
 
	$¡m_nÜm®_¡Üe
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
)

1689 
TX_GET
;

1690 
	`¡m_wr™e
(
tx
, 
addr
, 
v®ue
, ~(
¡m_wÜd_t
)0);

1691 
	}
}

1697 
	$¡m_¡Üe
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
)

1699 
TX_GET
;

1700 ià(
tx
->
ty³
 =ğ
EL
è
	`¡m_–a¡ic_¡Üe
(
addr
, 
v®ue
);

1701 
	`¡m_nÜm®_¡Üe
(
addr
, 
v®ue
);

1702 
	}
}

1709 
	$¡m_nÜm®_¡Üe2
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
)

1711 
TX_GET
;

1712 ià(
tx
->
ty³
 =ğ
EL
è
	`¡m_–a¡ic_wr™e
Ñx, 
addr
, 
v®ue
, 
mask
);

1713 
	`¡m_wr™e
(
tx
, 
addr
, 
v®ue
, 
mask
);

1714 
	}
}

1748 
	$¡m_¡Üe2
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
)

1750 
TX_GET
;

1751 
	`¡m_wr™e
(
tx
, 
addr
, 
v®ue
, 
mask
);

1752 
	}
}

1757 
	$¡m_aùive
(
TXPARAM
)

1759 
TX_GET
;

1761  (
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1762 
	}
}

1767 
	$¡m_abÜ‹d
(
TXPARAM
)

1769 
TX_GET
;

1771  (
tx
->
¡©us
 =ğ
TX_ABORTED
);

1772 
	}
}

1777 
sigjmp_buf
 *
	$¡m_g‘_’v
(
TXPARAM
)

1779 
TX_GET
;

1782  
tx
->
Ã¡šg
 =ğ0 ? &tx->
’v
 : 
NULL
;

1783 
	}
}

1788 
¡m_tx_©Œ_t
 *
	$¡m_g‘_©Œibu‹s
(
TXPARAM
)

1790 
TX_GET
;

1792  
tx
->
©Œ
;

1793 
	}
}

1798 
	$¡m_g‘_¡©s
(
TXPARAMS
 cÚ¡ *
Çme
, *
v®
)

1800 
TX_GET
;

1802 ià(
	`¡rcmp
("»ad_£t_size", 
Çme
) == 0) {

1803 *(*)
v®
 = 
tx
->
r_£t
.
size
;

1806 ià(
	`¡rcmp
("wr™e_£t_size", 
Çme
) == 0) {

1807 *(*)
v®
 = 
tx
->
w_£t
.
size
;

1810 ià(
	`¡rcmp
("»ad_£t_nb_’Œ›s", 
Çme
) == 0) {

1811 *(*)
v®
 = 
tx
->
r_£t
.
nb_’Œ›s
;

1814 ià(
	`¡rcmp
("wr™e_£t_nb_’Œ›s", 
Çme
) == 0) {

1815 *(*)
v®
 = 
tx
->
w_£t
.
nb_’Œ›s
;

1818 ià(
	`¡rcmp
("»ad_Úly", 
Çme
) == 0) {

1819 *(*)
v®
 = 
tx
->
ro
;

1822 ià(
	`¡rcmp
("nb_abÜts", 
Çme
) == 0) {

1823 *(*)
v®
 = 
tx
->
abÜts
;

1826 ià(
	`¡rcmp
("nb_abÜts_ro", 
Çme
) == 0) {

1827 *(*)
v®
 = 
tx
->
abÜts_ro
;

1830 ià(
	`¡rcmp
("nb_abÜts_locked_»ad", 
Çme
) == 0) {

1831 *(*)
v®
 = 
tx
->
abÜts_locked_»ad
;

1834 ià(
	`¡rcmp
("nb_abÜts_locked_wr™e", 
Çme
) == 0) {

1835 *(*)
v®
 = 
tx
->
abÜts_locked_wr™e
;

1838 ià(
	`¡rcmp
("nb_abÜts_v®id©e_»ad", 
Çme
) == 0) {

1839 *(*)
v®
 = 
tx
->
abÜts_v®id©e_»ad
;

1842 ià(
	`¡rcmp
("nb_abÜts_v®id©e_wr™e", 
Çme
) == 0) {

1843 *(*)
v®
 = 
tx
->
abÜts_v®id©e_wr™e
;

1846 ià(
	`¡rcmp
("nb_abÜts_v®id©e_comm™", 
Çme
) == 0) {

1847 *(*)
v®
 = 
tx
->
abÜts_v®id©e_comm™
;

1850 ià(
	`¡rcmp
("nb_abÜts_šv®id_memÜy", 
Çme
) == 0) {

1851 *(*)
v®
 = 
tx
->
abÜts_šv®id_memÜy
;

1854 ià(
	`¡rcmp
("nb_abÜts_doubË_wr™e", 
Çme
) == 0) {

1855 *(*)
v®
 = 
tx
->
abÜts_doubË_wr™e
;

1859 ià(
	`¡rcmp
("nb_abÜts_»®loÿ‹", 
Çme
) == 0) {

1860 *(*)
v®
 = 
tx
->
abÜts_»®loÿ‹
;

1863 ià(
	`¡rcmp
("nb_abÜts_rŞlov”", 
Çme
) == 0) {

1864 *(*)
v®
 = 
tx
->
abÜts_rŞlov”
;

1867 ià(
	`¡rcmp
("max_»Œ›s", 
Çme
) == 0) {

1868 *(*)
v®
 = 
tx
->
max_»Œ›s
;

1872 
	}
}

1877 
	$¡m_g‘_·¿m‘”
(cÚ¡ *
Çme
, *
v®
)

1879 ià(
	`¡rcmp
("cÚ‹ÁiÚ_mªag”", 
Çme
) == 0) {

1880 *(cÚ¡ **)
v®
 = 
cm_Çmes
[
CM
];

1883 ià(
	`¡rcmp
("design", 
Çme
) == 0) {

1884 *(cÚ¡ **)
v®
 = 
design_Çmes
[
DESIGN
];

1887 ià(
	`¡rcmp
("š™Ÿl_rw_£t_size", 
Çme
) == 0) {

1888 *(*)
v®
 = 
RW_SET_SIZE
;

1891 #ifdeà
COMPILE_FLAGS


1892 ià(
	`¡rcmp
("compe_æags", 
Çme
) == 0) {

1893 *(cÚ¡ **)
v®
 = 
	`XSTR
(
COMPILE_FLAGS
);

1898 
	}
}

1903 
	$¡m_£t_·¿m‘”
(cÚ¡ *
Çme
, *
v®
)

1906 
	}
}

1911 
	$¡m_ü—‹_¥ecific
()

1913 ià(
nb_¥ecific
 >ğ
MAX_SPECIFIC
) {

1914 
	`årštf
(
¡d”r
, "Error: maximum‚umber of specific slots„eached\n");

1917  
nb_¥ecific
++;

1918 
	}
}

1923 
	$¡m_£t_¥ecific
(
TXPARAMS
 
key
, *
d©a
)

1925 
TX_GET
;

1927 
	`as£¹
 (
key
 >ğ0 && key < 
nb_¥ecific
);

1928 
tx
->
d©a
[
key
] = data;

1929 
	}
}

1934 *
	$¡m_g‘_¥ecific
(
TXPARAMS
 
key
)

1936 
TX_GET
;

1938 
	`as£¹
 (
key
 >ğ0 && key < 
nb_¥ecific
);

1939  
tx
->
d©a
[
key
];

1940 
	}
}

1945 
¡m_»gi¡”
((*
Ú_th»ad_š™
)(
TXPARAMS
 *
¬g
),

1946 (*
Ú_th»ad_ex™
)(
TXPARAMS
 *
¬g
),

1947 (*
Ú_¡¬t
)(
TXPARAMS
 *
¬g
),

1948 (*
Ú_comm™
)(
TXPARAMS
 *
¬g
),

1949 (*
Ú_abÜt
)(
TXPARAMS
 *
¬g
),

1950 *
¬g
)

1952 ià((
Ú_th»ad_š™
 !ğ
NULL
 && 
nb_š™_cb
 >ğ
MAX_CB
) ||

1953 (
Ú_th»ad_ex™
 !ğ
NULL
 && 
nb_ex™_cb
 >ğ
MAX_CB
) ||

1954 (
Ú_¡¬t
 !ğ
NULL
 && 
nb_¡¬t_cb
 >ğ
MAX_CB
) ||

1955 (
Ú_comm™
 !ğ
NULL
 && 
nb_comm™_cb
 >ğ
MAX_CB
) ||

1956 (
Ú_abÜt
 !ğ
NULL
 && 
nb_abÜt_cb
 >ğ
MAX_CB
)) {

1957 
	`årštf
(
¡d”r
, "Error: maximum‚umber of modules„eached\n");

1961 ià(
Ú_th»ad_š™
 !ğ
NULL
) {

1962 
š™_cb
[
nb_š™_cb
].
f
 = 
Ú_th»ad_š™
;

1963 
š™_cb
[
nb_š™_cb
++].
¬g
 =‡rg;

1966 ià(
Ú_th»ad_ex™
 !ğ
NULL
) {

1967 
ex™_cb
[
nb_ex™_cb
].
f
 = 
Ú_th»ad_ex™
;

1968 
ex™_cb
[
nb_ex™_cb
++].
¬g
 =‡rg;

1971 ià(
Ú_¡¬t
 !ğ
NULL
) {

1972 
¡¬t_cb
[
nb_¡¬t_cb
].
f
 = 
Ú_¡¬t
;

1973 
¡¬t_cb
[
nb_¡¬t_cb
++].
¬g
 =‡rg;

1976 ià(
Ú_comm™
 !ğ
NULL
) {

1977 
comm™_cb
[
nb_comm™_cb
].
f
 = 
Ú_comm™
;

1978 
comm™_cb
[
nb_comm™_cb
++].
¬g
 =‡rg;

1981 ià(
Ú_abÜt
 !ğ
NULL
) {

1982 
abÜt_cb
[
nb_abÜt_cb
].
f
 = 
Ú_abÜt
;

1983 
abÜt_cb
[
nb_abÜt_cb
++].
¬g
 =‡rg;

1987 
	}
}

1990 
¡m_wÜd_t
 
	$nÚ_¡m_un™_lßd
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ*
time¡amp
) {

1991 vŞ©
¡m_wÜd_t
 *
lock
;

1992 
¡m_wÜd_t
 
l
, 
l2
, 
v®ue
;

1994 
	`PRINT_DEBUG2
("==> stm_un™_lßd×=%p)\n", 
addr
);

1999 
lock
 = 
	`GET_LOCK
(
addr
);

2002 
»¡¬t
:

2003 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

2004 
»¡¬t_no_lßd
:

2005 ià(
	`LOCK_GET_OWNED
(
l
)) {

2007 ià(
l
 =ğ
LOCK_UNIT
) {

2009 
»¡¬t
;

2013 #ifdeà
WAIT_YIELD


2014 
	`sched_y›ld
();

2016 
»¡¬t
;

2020 
v®ue
 = 
	`ATOMIC_LOAD_ACQ
(
addr
);

2021 
l2
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

2022 ià(
l
 !ğ
l2
) {

2023 
l
 = 
l2
;

2024 
»¡¬t_no_lßd
;

2027 ià(
time¡amp
 !ğ
NULL
)

2028 *
time¡amp
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

2038  
v®ue
;

2039 
	}
}

2046 
¡m_wÜd_t
 
	$¡m_un™_lßd
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ*
time¡amp
)

2048 vŞ©
¡m_wÜd_t
 *
lock
;

2049 
¡m_wÜd_t
 
l
, 
l2
, 
v®ue
;

2051 
	`PRINT_DEBUG2
("==> stm_un™_lßd×=%p)\n", 
addr
);

2054 
lock
 = 
	`GET_LOCK
(
addr
);

2057 
»¡¬t
:

2058 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

2059 
»¡¬t_no_lßd
:

2060 ià(
	`LOCK_GET_OWNED
(
l
)) {

2062 
»¡¬t
;

2065 
v®ue
 = 
	`ATOMIC_LOAD_ACQ
(
addr
);

2066 
l2
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

2067 ià(
l
 !ğ
l2
) {

2068 
l
 = 
l2
;

2069 
»¡¬t_no_lßd
;

2072 ià(
time¡amp
 !ğ
NULL
)

2073 *
time¡amp
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

2075 
	`PRINT_DEBUG2
("==> stm_unit_load(a=%p,l=%p,*l=%lu,d=%p-%lu)\n",

2076 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()value);

2078  
v®ue
;

2079 
	}
}

2084 
	$¡m_un™_¡Üe
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ*
time¡amp
)

2086  
	`¡m_un™_wr™e
(
addr
, 
v®ue
, ~(
¡m_wÜd_t
)0, 
time¡amp
);

2087 
	}
}

2092 
	$¡m_un™_¡Üe2
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
, stm_wÜd_ˆ*
time¡amp
)

2094  
	`¡m_un™_wr™e
(
addr
, 
v®ue
, 
mask
, 
time¡amp
);

2095 
	}
}

2100 
	$¡m_£t_ex‹nsiÚ
(
TXPARAMS
 
’abË
, 
¡m_wÜd_t
 *
time¡amp
)

2102 
TX_GET
;

2104 
tx
->
ÿn_ex‹nd
 = 
’abË
;

2105 ià(
time¡amp
 !ğ
NULL
 && *time¡am°< 
tx
->
’d
)

2106 
tx
->
’d
 = *
time¡amp
;

2107 
	}
}

2112 
¡m_wÜd_t
 
	$¡m_g‘_şock
()

2114  
GET_CLOCK
;

2115 
	}
}

2120 
¡m_tx_t
 *
	$¡m_cu¼’t_tx
()

2122  
	`¡m_g‘_tx
();

2123 
	}
}

	@utils/estm-0.2.4.3/src/wrappers.c

22 
	~<as£¹.h
>

24 
	~"w¿µ”s.h
"

26 
	#COMPILE_TIME_ASSERT
(
´ed
è0è{ 0: ´ed: ; }

	)

28 
	ucÚv”t_64
 {

29 
ušt64_t
 
	mu64
;

30 
ušt32_t
 
	mu32
[2];

31 
ušt16_t
 
	mu16
[4];

32 
ušt8_t
 
	mu8
[8];

33 
št64_t
 
	ms64
;

34 
	md
;

35 } 
	tcÚv”t_64_t
;

37 
	ucÚv”t_32
 {

38 
ušt32_t
 
	mu32
;

39 
ušt16_t
 
	mu16
[2];

40 
ušt8_t
 
	mu8
[4];

41 
št32_t
 
	ms32
;

42 
	mf
;

43 } 
	tcÚv”t_32_t
;

45 
	ucÚv”t_16
 {

46 
ušt16_t
 
	mu16
;

47 
št16_t
 
	ms16
;

48 } 
	tcÚv”t_16_t
;

50 
	ucÚv”t_8
 {

51 
ušt8_t
 
	mu8
;

52 
št8_t
 
	ms8
;

53 } 
	tcÚv”t_8_t
;

55 
	ucÚv”t
 {

56 
¡m_wÜd_t
 
	mw
;

57 
ušt8_t
 
	mb
[(
¡m_wÜd_t
)];

58 } 
	tcÚv”t_t
;

60 
	$§n™y_checks
()

62 
	`COMPILE_TIME_ASSERT
((
cÚv”t_64_t
) == 8);

63 
	`COMPILE_TIME_ASSERT
((
cÚv”t_32_t
) == 4);

64 
	`COMPILE_TIME_ASSERT
((
¡m_wÜd_t
) == 4 || (stm_word_t) == 8);

65 
	`COMPILE_TIME_ASSERT
(() == 1);

66 
	`COMPILE_TIME_ASSERT
(() == 2);

67 
	`COMPILE_TIME_ASSERT
(() == 4);

68 
	`COMPILE_TIME_ASSERT
(() == 4 || () == 8);

69 
	`COMPILE_TIME_ASSERT
(() == 4);

70 
	`COMPILE_TIME_ASSERT
(() == 8);

71 
	}
}

77 
ušt8_t
 
	$¡m_lßd8
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
)

79 ià((
¡m_wÜd_t
) == 4) {

80 
cÚv”t_32_t
 
v®
;

81 
v®
.
u32
 = (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x03));

82  
v®
.
u8
[(
ušŒ_t
)
addr
 & 0x03];

84 
cÚv”t_64_t
 
v®
;

85 
v®
.
u64
 = (
ušt64_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x07));

86  
v®
.
u8
[(
ušŒ_t
)
addr
 & 0x07];

88 
	}
}

90 
ušt16_t
 
	$¡m_lßd16
(
TXPARAMS
 vŞ©
ušt16_t
 *
addr
)

92 ià(((
ušŒ_t
)
addr
 & 0x01) != 0) {

93 
ušt16_t
 
v®
;

94 
	`¡m_lßd_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®
, (
ušt16_t
));

95  
v®
;

96 } ià((
¡m_wÜd_t
) == 4) {

97 
cÚv”t_32_t
 
v®
;

98 
v®
.
u32
 = (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x03));

99  
v®
.
u16
[((
ušŒ_t
)
addr
 & 0x03) >> 1];

101 
cÚv”t_64_t
 
v®
;

102 
v®
.
u64
 = (
ušt64_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x07));

103  
v®
.
u16
[((
ušŒ_t
)
addr
 & 0x07) >> 1];

105 
	}
}

107 
ušt32_t
 
	$¡m_lßd32
(
TXPARAMS
 vŞ©
ušt32_t
 *
addr
)

109 ià(((
ušŒ_t
)
addr
 & 0x03) != 0) {

110 
ušt32_t
 
v®
;

111 
	`¡m_lßd_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®
, (
ušt32_t
));

112  
v®
;

113 } ià((
¡m_wÜd_t
) == 4) {

114  (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
);

116 
cÚv”t_64_t
 
v®
;

117 
v®
.
u64
 = (
ušt64_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x07));

118  
v®
.
u32
[((
ušŒ_t
)
addr
 & 0x07) >> 2];

120 
	}
}

122 
ušt64_t
 
	$¡m_lßd64
(
TXPARAMS
 vŞ©
ušt64_t
 *
addr
)

124 ià(((
ušŒ_t
)
addr
 & 0x07) != 0) {

125 
ušt64_t
 
v®
;

126 
	`¡m_lßd_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®
, (
ušt64_t
));

127  
v®
;

128 } ià((
¡m_wÜd_t
) == 4) {

129 
cÚv”t_64_t
 
v®
;

130 
v®
.
u32
[0] = (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
);

131 
v®
.
u32
[1] = (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
 + 1);

132  
v®
.
u64
;

134  (
ušt64_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
);

136 
	}
}

138 
	$¡m_lßd_ch¬
(
TXPARAMS
 vŞ©*
addr
)

140 
cÚv”t_8_t
 
v®
;

141 
v®
.
u8
 = 
	`¡m_lßd8
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
);

142  
v®
.
s8
;

143 
	}
}

145 
	$¡m_lßd_uch¬
(
TXPARAMS
 vŞ©*
addr
)

147  ()
	`¡m_lßd8
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
);

148 
	}
}

150 
	$¡m_lßd_shÜt
(
TXPARAMS
 vŞ©*
addr
)

152 
cÚv”t_16_t
 
v®
;

153 
v®
.
u16
 = 
	`¡m_lßd16
(
	`TXARGS
 (vŞ©
ušt16_t
 *)
addr
);

154  
v®
.
s16
;

155 
	}
}

157 
	$¡m_lßd_ushÜt
(
TXPARAMS
 vŞ©*
addr
)

159  ()
	`¡m_lßd16
(
	`TXARGS
 (vŞ©
ušt16_t
 *)
addr
);

160 
	}
}

162 
	$¡m_lßd_št
(
TXPARAMS
 vŞ©*
addr
)

164 
cÚv”t_32_t
 
v®
;

165 
v®
.
u32
 = 
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

166  
v®
.
s32
;

167 
	}
}

169 
	$¡m_lßd_ušt
(
TXPARAMS
 vŞ©*
addr
)

171  ()
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

172 
	}
}

174 
	$¡m_lßd_lÚg
(
TXPARAMS
 vŞ©*
addr
)

177 
cÚv”t_32_t
 
v®
;

178 
v®
.
u32
 = 
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

179  
v®
.
s32
;

181 
cÚv”t_64_t
 
v®
;

182 
v®
.
u64
 = 
	`¡m_lßd64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
);

183  
v®
.
s64
;

185 
	}
}

187 
	$¡m_lßd_ulÚg
(
TXPARAMS
 vŞ©*
addr
)

190  ()
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

192  ()
	`¡m_lßd64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
);

194 
	}
}

196 
	$¡m_lßd_æßt
(
TXPARAMS
 vŞ©*
addr
)

198 
cÚv”t_32_t
 
v®
;

199 
v®
.
u32
 = 
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

200  
v®
.
f
;

201 
	}
}

203 
	$¡m_lßd_doubË
(
TXPARAMS
 vŞ©*
addr
)

205 
cÚv”t_64_t
 
v®
;

206 
v®
.
u64
 = 
	`¡m_lßd64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
);

207  
v®
.
d
;

208 
	}
}

210 *
	$¡m_lßd_±r
(
TXPARAMS
 vŞ©**
addr
)

212 uniÚ { 
¡m_wÜd_t
 
w
; *
v
; } 
cÚv”t
;

213 
cÚv”t
.
w
 = 
	`¡m_lßd
(
	`TXARGS
 (
¡m_wÜd_t
 *)
addr
);

214  
cÚv”t
.
v
;

215 
	}
}

217 
	$¡m_lßd_by‹s
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ*
buf
, 
size_t
 
size
)

219 
cÚv”t_t
 
v®
;

220 
i
;

221 
¡m_wÜd_t
 *
a
;

223 ià(
size
 == 0)

225 
i
 = (
ušŒ_t
)
addr
 & ((
¡m_wÜd_t
) - 1);

226 ià(
i
 != 0) {

228 
a
 = (
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)((stm_word_t) - 1));

229 
v®
.
w
 = 
	`¡m_lßd
(
TXARGS
 
a
++);

230 ; 
i
 < (
¡m_wÜd_t
è&& 
size
 > 0; i++, size--)

231 *
buf
++ = 
v®
.
b
[
i
];

233 
a
 = (
¡m_wÜd_t
 *)
addr
;

235 
size
 >ğ(
¡m_wÜd_t
)) {

236 #ifdeà
ALLOW_MISALIGNED_ACCESSES


237 *((
¡m_wÜd_t
 *)
buf
èğ
	`¡m_lßd
(
TXARGS
 
a
++);

238 
buf
 +ğ(
¡m_wÜd_t
);

240 
v®
.
w
 = 
	`¡m_lßd
(
TXARGS
 
a
++);

241 
i
 = 0; i < (
¡m_wÜd_t
); i++)

242 *
buf
++ = 
v®
.
b
[
i
];

244 
size
 -ğ(
¡m_wÜd_t
);

246 ià(
size
 > 0) {

248 
v®
.
w
 = 
	`¡m_lßd
(
TXARGS
 
a
);

249 
i
 = 0;

250 
i
 = 0; 
size
 > 0; i++, size--)

251 *
buf
++ = 
v®
.
b
[
i
];

253 
	}
}

259 
	$¡m_¡Üe8
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ
v®ue
)

261 ià((
¡m_wÜd_t
) == 4) {

262 
cÚv”t_32_t
 
v®
, 
mask
;

263 
v®
.
u8
[(
ušŒ_t
)
addr
 & 0x03] = 
v®ue
;

264 
mask
.
u32
 = 0;

265 
mask
.
u8
[(
ušŒ_t
)
addr
 & 0x03] = ~(
ušt8_t
)0;

266 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x03), (¡m_wÜd_t)
v®
.
u32
, (¡m_wÜd_t)
mask
.u32);

268 
cÚv”t_64_t
 
v®
, 
mask
;

269 
v®
.
u8
[(
ušŒ_t
)
addr
 & 0x07] = 
v®ue
;

270 
mask
.
u64
 = 0;

271 
mask
.
u8
[(
ušŒ_t
)
addr
 & 0x07] = ~(
ušt8_t
)0;

272 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x07), (¡m_wÜd_t)
v®
.
u64
, (¡m_wÜd_t)
mask
.u64);

274 
	}
}

276 
	$¡m_¡Üe16
(
TXPARAMS
 vŞ©
ušt16_t
 *
addr
, ušt16_ˆ
v®ue
)

278 ià(((
ušŒ_t
)
addr
 & 0x01) != 0) {

279 
	`¡m_¡Üe_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®ue
, (
ušt16_t
));

280 } ià((
¡m_wÜd_t
) == 4) {

281 
cÚv”t_32_t
 
v®
, 
mask
;

282 
v®
.
u16
[((
ušŒ_t
)
addr
 & 0x03è>> 1] = 
v®ue
;

283 
mask
.
u32
 = 0;

284 
mask
.
u16
[((
ušŒ_t
)
addr
 & 0x03è>> 1] = ~(
ušt16_t
)0;

285 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x03), (¡m_wÜd_t)
v®
.
u32
, (¡m_wÜd_t)
mask
.u32);

287 
cÚv”t_64_t
 
v®
, 
mask
;

288 
v®
.
u16
[((
ušŒ_t
)
addr
 & 0x07è>> 1] = 
v®ue
;

289 
mask
.
u64
 = 0;

290 
mask
.
u16
[((
ušŒ_t
)
addr
 & 0x07è>> 1] = ~(
ušt16_t
)0;

291 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x07), (¡m_wÜd_t)
v®
.
u64
, (¡m_wÜd_t)
mask
.u64);

293 
	}
}

295 
	$¡m_¡Üe32
(
TXPARAMS
 vŞ©
ušt32_t
 *
addr
, ušt32_ˆ
v®ue
)

297 ià(((
ušŒ_t
)
addr
 & 0x03) != 0) {

298 
	`¡m_¡Üe_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®ue
, (
ušt32_t
));

299 } ià((
¡m_wÜd_t
) == 4) {

300 
	`¡m_¡Üe
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
, (¡m_wÜd_t)
v®ue
);

302 
cÚv”t_64_t
 
v®
, 
mask
;

303 
v®
.
u32
[((
ušŒ_t
)
addr
 & 0x07è>> 2] = 
v®ue
;

304 
mask
.
u64
 = 0;

305 
mask
.
u32
[((
ušŒ_t
)
addr
 & 0x07è>> 2] = ~(
ušt32_t
)0;

306 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x07), (¡m_wÜd_t)
v®
.
u64
, (¡m_wÜd_t)
mask
.u64);

308 
	}
}

310 
	$¡m_¡Üe64
(
TXPARAMS
 vŞ©
ušt64_t
 *
addr
, ušt64_ˆ
v®ue
)

312 ià(((
ušŒ_t
)
addr
 & 0x07) != 0) {

313 
	`¡m_¡Üe_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®ue
, (
ušt64_t
));

314 } ià((
¡m_wÜd_t
) == 4) {

315 
cÚv”t_64_t
 
v®
;

316 
v®
.
u64
 = 
v®ue
;

317 
	`¡m_¡Üe
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
, (¡m_wÜd_t)
v®
.
u32
[0]);

318 
	`¡m_¡Üe
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
 + 1, (¡m_wÜd_t)
v®
.
u32
[1]);

320  
	`¡m_¡Üe
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
, (¡m_wÜd_t)
v®ue
);

322 
	}
}

324 
	$¡m_¡Üe_ch¬
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

326 
cÚv”t_8_t
 
v®
;

327 
v®
.
s8
 = 
v®ue
;

328 
	`¡m_¡Üe8
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, 
v®
.
u8
);

329 
	}
}

331 
	$¡m_¡Üe_uch¬
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

333 
	`¡m_¡Üe8
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_t)
v®ue
);

334 
	}
}

336 
	$¡m_¡Üe_shÜt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

338 
cÚv”t_16_t
 
v®
;

339 
v®
.
s16
 = 
v®ue
;

340 
	`¡m_¡Üe16
(
	`TXARGS
 (vŞ©
ušt16_t
 *)
addr
, 
v®
.
u16
);

341 
	}
}

343 
	$¡m_¡Üe_ushÜt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

345 
	`¡m_¡Üe16
(
	`TXARGS
 (vŞ©
ušt16_t
 *)
addr
, (ušt16_t)
v®ue
);

346 
	}
}

348 
	$¡m_¡Üe_št
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

350 
cÚv”t_32_t
 
v®
;

351 
v®
.
s32
 = 
v®ue
;

352 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, 
v®
.
u32
);

353 
	}
}

355 
	$¡m_¡Üe_ušt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

357 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, (ušt32_t)
v®ue
);

358 
	}
}

360 
	$¡m_¡Üe_lÚg
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

363 
cÚv”t_32_t
 
v®
;

364 
v®
.
s32
 = 
v®ue
;

365 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, 
v®
.
u32
);

367 
cÚv”t_64_t
 
v®
;

368 
v®
.
s64
 = 
v®ue
;

369 
	`¡m_¡Üe64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
, 
v®
.
u64
);

371 
	}
}

373 
	$¡m_¡Üe_ulÚg
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

376 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, (ušt32_t)
v®ue
);

378 
	`¡m_¡Üe64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
, (ušt64_t)
v®ue
);

380 
	}
}

382 
	$¡m_¡Üe_æßt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

384 
cÚv”t_32_t
 
v®
;

385 
v®
.
f
 = 
v®ue
;

386 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, 
v®
.
u32
);

387 
	}
}

389 
	$¡m_¡Üe_doubË
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

391 
cÚv”t_64_t
 
v®
;

392 
v®
.
d
 = 
v®ue
;

393 
	`¡m_¡Üe64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
, 
v®
.
u64
);

394 
	}
}

396 
	$¡m_¡Üe_±r
(
TXPARAMS
 vŞ©**
addr
, *
v®ue
)

398 uniÚ { 
¡m_wÜd_t
 
w
; *
v
; } 
cÚv”t
;

399 
cÚv”t
.
v
 = 
v®ue
;

400 
	`¡m_¡Üe
(
	`TXARGS
 (
¡m_wÜd_t
 *)
addr
, 
cÚv”t
.
w
);

401 
	}
}

403 
	$¡m_¡Üe_by‹s
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ*
buf
, 
size_t
 
size
)

405 
cÚv”t_t
 
v®
, 
mask
;

406 
i
;

407 
¡m_wÜd_t
 *
a
;

409 ià(
size
 == 0)

411 
i
 = (
ušŒ_t
)
addr
 & ((
¡m_wÜd_t
) - 1);

412 ià(
i
 != 0) {

414 
a
 = (
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)((stm_word_t) - 1));

415 
v®
.
w
 = 
mask
.w = 0;

416 ; 
i
 < (
¡m_wÜd_t
è&& 
size
 > 0; i++, size--) {

417 
mask
.
b
[
i
] = 0xFF;

418 
v®
.
b
[
i
] = *
buf
++;

420 
	`¡m_¡Üe2
(
TXARGS
 
a
++, 
v®
.
w
, 
mask
.w);

422 
a
 = (
¡m_wÜd_t
 *)
addr
;

424 
size
 >ğ(
¡m_wÜd_t
)) {

425 #ifdeà
ALLOW_MISALIGNED_ACCESSES


426 
	`¡m_¡Üe
(
TXARGS
 
a
++, *((
¡m_wÜd_t
 *)
buf
));

427 
buf
 +ğ(
¡m_wÜd_t
);

429 
i
 = 0; i < (
¡m_wÜd_t
); i++)

430 
v®
.
b
[
i
] = *
buf
++;

431 
	`¡m_¡Üe
(
TXARGS
 
a
++, 
v®
.
w
);

433 
size
 -ğ(
¡m_wÜd_t
);

435 ià(
size
 > 0) {

437 
v®
.
w
 = 
mask
.w = 0;

438 
i
 = 0; 
size
 > 0; i++, size--) {

439 
mask
.
b
[
i
] = 0xFF;

440 
v®
.
b
[
i
] = *
buf
++;

442 
	`¡m_¡Üe2
(
TXARGS
 
a
, 
v®
.
w
, 
mask
.w);

444 
	}
}

	@utils/estm-0.3.0/include/mod_local.h

34 #iâdeà
_MOD_LOCAL_H_


35 
	#_MOD_LOCAL_H_


	)

37 
	~"¡m.h
"

39 #ifdeà
__ılu¥lus


51 
¡m_¡Üe_loÿl
(
TXPARAMS
 
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
);

61 
¡m_¡Üe_loÿl_ch¬
(
TXPARAMS
 *
addr
, 
v®ue
);

71 
¡m_¡Üe_loÿl_uch¬
(
TXPARAMS
 *
addr
, 
v®ue
);

81 
¡m_¡Üe_loÿl_shÜt
(
TXPARAMS
 *
addr
, 
v®ue
);

91 
¡m_¡Üe_loÿl_ushÜt
(
TXPARAMS
 *
addr
, 
v®ue
);

101 
¡m_¡Üe_loÿl_št
(
TXPARAMS
 *
addr
, 
v®ue
);

111 
¡m_¡Üe_loÿl_ušt
(
TXPARAMS
 *
addr
, 
v®ue
);

121 
¡m_¡Üe_loÿl_lÚg
(
TXPARAMS
 *
addr
, 
v®ue
);

131 
¡m_¡Üe_loÿl_ulÚg
(
TXPARAMS
 *
addr
, 
v®ue
);

141 
¡m_¡Üe_loÿl_æßt
(
TXPARAMS
 *
addr
, 
v®ue
);

151 
¡m_¡Üe_loÿl_doubË
(
TXPARAMS
 *
addr
, 
v®ue
);

161 
¡m_¡Üe_loÿl_±r
(
TXPARAMS
 **
addr
, *
v®ue
);

168 
mod_loÿl_š™
();

170 #ifdeà
__ılu¥lus


	@utils/estm-0.3.0/include/mod_mem.h

35 #iâdeà
_MOD_MEM_H_


36 
	#_MOD_MEM_H_


	)

38 
	~"¡m.h
"

40 #ifdeà
__ılu¥lus


53 *
¡m_m®loc
(
TXPARAMS
 
size_t
 
size
);

67 
¡m_ä“
(
TXPARAMS
 *
addr
, 
size_t
 
size
);

83 
¡m_ä“2
(
TXPARAMS
 *
addr
, 
size_t
 
idx
, size_ˆ
size
);

90 
mod_mem_š™
();

92 #ifdeà
__ılu¥lus


	@utils/estm-0.3.0/include/mod_print.h

32 #iâdeà
_MOD_PRINT_H_


33 
	#_MOD_PRINT_H_


	)

35 #ifdeà
__ılu¥lus


44 
mod_´št_š™
();

46 #ifdeà
__ılu¥lus


	@utils/estm-0.3.0/include/mod_stats.h

36 #iâdeà
_MOD_STATS_H_


37 
	#_MOD_STATS_H_


	)

39 
	~"¡m.h
"

41 #ifdeà
__ılu¥lus


57 
¡m_g‘_glob®_¡©s
(cÚ¡ *
Çme
, *
v®
);

71 
¡m_g‘_loÿl_¡©s
(
TXPARAMS
 cÚ¡ *
Çme
, *
v®
);

78 
mod_¡©s_š™
();

80 #ifdeà
__ılu¥lus


	@utils/estm-0.3.0/include/stm.h

80 #iâdeà
_STM_H_


81 
	#_STM_H_


	)

83 
	~<£tjmp.h
>

84 
	~<¡dšt.h
>

85 
	~<¡dio.h
>

86 
	~<¡dlib.h
>

88 #ifdeà
__ılu¥lus


100 #ifdeà
EXPLICIT_TX_PARAMETER


101 
¡m_tx
;

102 
	#TXTYPE
 
¡m_tx
 *

	)

103 
	#TXPARAM
 
¡m_tx
 *
tx


	)

104 
	#TXPARAMS
 
¡m_tx
 *
tx
,

	)

105 
	#TXARG
 (
¡m_tx
 *)
tx


	)

106 
	#TXARGS
 (
¡m_tx
 *)
tx
,

	)

107 
¡m_tx
 *
¡m_cu¼’t_tx
();

109 
	#TXTYPE
 

	)

110 
	#TXPARAM


	)

111 
	#TXPARAMS


	)

112 
	#TXARG


	)

113 
	#TXARGS


	)

116 
	#EL
 0

	)

117 
	#NL
 1

	)

127 
ušŒ_t
 
	t¡m_wÜd_t
;

132 
	s¡m_tx_©Œ
 {

140 
	gid
;

147 
	gro
;

148 } 
	t¡m_tx_©Œ_t
;

159 
¡m_š™
();

165 
¡m_ex™
();

172 
TXTYPE
 
¡m_š™_th»ad
();

178 
¡m_ex™_th»ad
(
TXPARAM
);

197 
¡m_¡¬t
(
TXPARAMS
 
sigjmp_buf
 *
’v
, 
¡m_tx_©Œ_t
 *
©Œ
, 
ty³
);

206 
¡m_comm™
(
TXPARAM
);

214 
¡m_abÜt
(
TXPARAM
);

239 
¡m_wÜd_t
 
¡m_lßd
(
TXPARAMS
 vŞ©¡m_wÜd_ˆ*
addr
);

262 
¡m_¡Üe
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
);

277 
¡m_¡Üe2
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
);

285 
¡m_aùive
(
TXPARAM
);

293 
¡m_abÜ‹d
(
TXPARAM
);

307 
sigjmp_buf
 *
¡m_g‘_’v
(
TXPARAM
);

317 
¡m_tx_©Œ_t
 *
¡m_g‘_©Œibu‹s
(
TXPARAM
);

331 
¡m_g‘_¡©s
(
TXPARAMS
 cÚ¡ *
Çme
, *
v®
);

345 
¡m_g‘_·¿m‘”
(cÚ¡ *
Çme
, *
v®
);

358 
¡m_£t_·¿m‘”
(cÚ¡ *
Çme
, *
v®
);

368 
¡m_ü—‹_¥ecific
();

379 *
¡m_g‘_¥ecific
(
TXPARAMS
 
key
);

390 
¡m_£t_¥ecific
(
TXPARAMS
 
key
, *
d©a
);

411 
¡m_»gi¡”
((*
Ú_th»ad_š™
)(
TXPARAMS
 *
¬g
),

412 (*
Ú_th»ad_ex™
)(
TXPARAMS
 *
¬g
),

413 (*
Ú_¡¬t
)(
TXPARAMS
 *
¬g
),

414 (*
Ú_comm™
)(
TXPARAMS
 *
¬g
),

415 (*
Ú_abÜt
)(
TXPARAMS
 *
¬g
),

416 *
¬g
);

425 
¡m_wÜd_t
 
¡m_g‘_şock
();

427 #ifdeà
__ılu¥lus


	@utils/estm-0.3.0/include/wrappers.h

33 #iâdeà
_WRAPPERS_H_


34 
	#_WRAPPERS_H_


	)

36 
	~<¡dšt.h
>

38 
	~"¡m.h
"

40 #ifdeà
__ılu¥lus


52 
ušt8_t
 
¡m_lßd8
(
TXPARAMS
 vŞ©ušt8_ˆ*
addr
);

62 
ušt16_t
 
¡m_lßd16
(
TXPARAMS
 vŞ©ušt16_ˆ*
addr
);

72 
ušt32_t
 
¡m_lßd32
(
TXPARAMS
 vŞ©ušt32_ˆ*
addr
);

82 
ušt64_t
 
¡m_lßd64
(
TXPARAMS
 vŞ©ušt64_ˆ*
addr
);

92 
¡m_lßd_ch¬
(
TXPARAMS
 vŞ©*
addr
);

102 
¡m_lßd_uch¬
(
TXPARAMS
 vŞ©*
addr
);

112 
¡m_lßd_shÜt
(
TXPARAMS
 vŞ©*
addr
);

122 
¡m_lßd_ushÜt
(
TXPARAMS
 vŞ©*
addr
);

132 
¡m_lßd_št
(
TXPARAMS
 vŞ©*
addr
);

142 
¡m_lßd_ušt
(
TXPARAMS
 vŞ©*
addr
);

152 
¡m_lßd_lÚg
(
TXPARAMS
 vŞ©*
addr
);

162 
¡m_lßd_ulÚg
(
TXPARAMS
 vŞ©*
addr
);

172 
¡m_lßd_æßt
(
TXPARAMS
 vŞ©*
addr
);

182 
¡m_lßd_doubË
(
TXPARAMS
 vŞ©*
addr
);

192 *
¡m_lßd_±r
(
TXPARAMS
 vŞ©**
addr
);

207 
¡m_lßd_by‹s
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ*
buf
, 
size_t
 
size
);

217 
¡m_¡Üe8
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ
v®ue
);

227 
¡m_¡Üe16
(
TXPARAMS
 vŞ©
ušt16_t
 *
addr
, ušt16_ˆ
v®ue
);

237 
¡m_¡Üe32
(
TXPARAMS
 vŞ©
ušt32_t
 *
addr
, ušt32_ˆ
v®ue
);

247 
¡m_¡Üe64
(
TXPARAMS
 vŞ©
ušt64_t
 *
addr
, ušt64_ˆ
v®ue
);

257 
¡m_¡Üe_ch¬
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

267 
¡m_¡Üe_uch¬
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

277 
¡m_¡Üe_shÜt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

287 
¡m_¡Üe_ushÜt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

297 
¡m_¡Üe_št
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

307 
¡m_¡Üe_ušt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

317 
¡m_¡Üe_lÚg
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

327 
¡m_¡Üe_ulÚg
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

337 
¡m_¡Üe_æßt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

347 
¡m_¡Üe_doubË
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
);

357 
¡m_¡Üe_±r
(
TXPARAMS
 vŞ©**
addr
, *
v®ue
);

371 
¡m_¡Üe_by‹s
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ*
buf
, 
size_t
 
size
);

373 #ifdeà
__ılu¥lus


	@utils/estm-0.3.0/src/atomic.h

22 #iâdeà
_ATOMIC_H_


23 
	#_ATOMIC_H_


	)

25 
	~<©omic_İs.h
>

27 
AO_t
 
	t©omic_t
;

29 #ifdeà
NO_AO


31 
	#ATOMIC_CAS_FULL
(
a
, 
e
, 
v
è(*×èğ(v), 1)

	)

32 
	#ATOMIC_FETCH_INC_FULL
(
a
è((*×))++)

	)

33 
	#ATOMIC_FETCH_DEC_FULL
(
a
è((*×))--)

	)

34 
	#ATOMIC_FETCH_ADD_FULL
(
a
, 
v
è((*×)è+ğ(v))

	)

35 
	#ATOMIC_LOAD_ACQ
(
a
è(*×))

	)

36 
	#ATOMIC_LOAD
(
a
è(*×))

	)

37 
	#ATOMIC_STORE_REL
(
a
, 
v
è(*×èğ(v))

	)

38 
	#ATOMIC_STORE
(
a
, 
v
è(*×èğ(v))

	)

39 
	#ATOMIC_MB_READ


	)

40 
	#ATOMIC_MB_WRITE


	)

41 
	#ATOMIC_MB_FULL


	)

43 
	#ATOMIC_CAS_FULL
(
a
, 
e
, 
v
è(
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)Ó), (AO_t)(v)))

	)

44 
	#ATOMIC_FETCH_INC_FULL
(
a
è(
	`AO_ãtch_ªd_add1_fuÎ
((vŞ©
AO_t
 *)×)))

	)

45 
	#ATOMIC_FETCH_DEC_FULL
(
a
è(
	`AO_ãtch_ªd_sub1_fuÎ
((vŞ©
AO_t
 *)×)))

	)

46 
	#ATOMIC_FETCH_ADD_FULL
(
a
, 
v
è(
	`AO_ãtch_ªd_add_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)(v)))

	)

47 #ifdeà
SAFE


48 
	#ATOMIC_LOAD_ACQ
(
a
è(
	`AO_lßd_fuÎ
((vŞ©
AO_t
 *)×)))

	)

49 
	#ATOMIC_LOAD
(
a
è(
	`AO_lßd_fuÎ
((vŞ©
AO_t
 *)×)))

	)

50 
	#ATOMIC_STORE_REL
(
a
, 
v
è(
	`AO_¡Üe_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)(v)))

	)

51 
	#ATOMIC_STORE
(
a
, 
v
è(
	`AO_¡Üe_fuÎ
((vŞ©
AO_t
 *)×), (AO_t)(v)))

	)

52 
	#ATOMIC_MB_READ
 
	`AO_nİ_fuÎ
()

	)

53 
	#ATOMIC_MB_WRITE
 
	`AO_nİ_fuÎ
()

	)

54 
	#ATOMIC_MB_FULL
 
	`AO_nİ_fuÎ
()

	)

56 
	#ATOMIC_LOAD_ACQ
(
a
è(
	`AO_lßd_acquœe_»ad
((vŞ©
AO_t
 *)×)))

	)

57 
	#ATOMIC_LOAD
(
a
è(*((vŞ©
AO_t
 *)×)))

	)

58 
	#ATOMIC_STORE_REL
(
a
, 
v
è(
	`AO_¡Üe_»Ëa£
((vŞ©
AO_t
 *)×), (AO_t)(v)))

	)

59 
	#ATOMIC_STORE
(
a
, 
v
è(*((vŞ©
AO_t
 *)×)èğ(AO_t)(v))

	)

60 
	#ATOMIC_MB_READ
 
	`AO_nİ_»ad
()

	)

61 
	#ATOMIC_MB_WRITE
 
	`AO_nİ_wr™e
()

	)

62 
	#ATOMIC_MB_FULL
 
	`AO_nİ_fuÎ
()

	)

	@utils/estm-0.3.0/src/gc.c

23 
	~<as£¹.h
>

24 
	~<¡dio.h
>

25 
	~<¡dšt.h
>

27 
	~<±h»ad.h
>

29 
	~"gc.h
"

31 
	~"©omic.h
"

32 
	~"¡m.h
"

40 
	#MAX_THREADS
 1024

	)

41 
	#EPOCH_MAX
 (~(
gc_wÜd_t
)0)

	)

43 #iâdeà
NO_PERIODIC_CLEANUP


44 #iâdeà
CLEANUP_FREQUENCY


45 
	#CLEANUP_FREQUENCY
 1

	)

49 #ifdeà
DEBUG


51 
	#IO_FLUSH
 
	`fæush
(
NULL
)

	)

52 
	#PRINT_DEBUG
(...è
	`´štf
(
__VA_ARGS__
); 
	`fæush
(
NULL
)

	)

54 
	#IO_FLUSH


	)

55 
	#PRINT_DEBUG
(...)

	)

63 
	mGC_NULL
 = 0,

64 
	mGC_BUSY
 = 1,

65 
	mGC_FREE_EMPTY
 = 2,

66 
	mGC_FREE_FULL
 = 3

69 
	smem_block
 {

70 *
	maddr
;

71 
mem_block
 *
	mÃxt
;

72 } 
	tmem_block_t
;

74 
	smem_»giÚ
 {

75 
mem_block
 *
	mblocks
;

76 
gc_wÜd_t
 
	mts
;

77 
mem_»giÚ
 *
	mÃxt
;

78 } 
	tmem_»giÚ_t
;

80 
	stm_th»ad
 {

81 
gc_wÜd_t
 
	mu£d
;

82 
±h»ad_t
 
	mth»ad
;

83 
gc_wÜd_t
 
	mts
;

84 
mem_»giÚ_t
 *
	mh—d
;

85 
mem_»giÚ_t
 *
	m
;

86 #iâdeà
NO_PERIODIC_CLEANUP


87 
	mä“s
;

89 } 
	ttm_th»ad_t
;

91 vŞ©
tm_th»ad_t
 *
	gth»ads
;

92 vŞ©
gc_wÜd_t
 
	gnb_th»ads
;

94 
gc_wÜd_t
 (*
cu¼’t_•och
)();

96 #ifdeà
TLS


97 
__th»ad
 
	gth»ad_idx
;

99 
±h»ad_key_t
 
	gth»ad_idx
;

109 
šlše
 
	$gc_g‘_idx
()

111 #ifdeà
TLS


112  
th»ad_idx
;

114  ()
	`±h»ad_g‘¥ecific
(
th»ad_idx
);

116 
	}
}

121 
šlše
 
gc_wÜd_t
 
	$gc_compu‹_mš
(
gc_wÜd_t
 
now
)

123 
i
;

124 
gc_wÜd_t
 
mš
, 
ts
;

125 
¡m_wÜd_t
 
u£d
;

127 
	`PRINT_DEBUG
("==> gc_compu‹_mš(%d)\n", 
	`gc_g‘_idx
());

129 
mš
 = 
now
;

130 
i
 = 0; i < 
MAX_THREADS
; i++) {

131 
u£d
 = (
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].used);

132 ià(
u£d
 =ğ
GC_NULL
)

134 ià(
u£d
 !ğ
GC_BUSY
)

137 
ts
 = (
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].ts);

138 ià(
ts
 < 
mš
)

139 
mš
 = 
ts
;

142 
	`PRINT_DEBUG
("==> gc_compu‹_mš(%d,m=%lu)\n", 
	`gc_g‘_idx
(), ()
mš
);

144  
mš
;

145 
	}
}

150 
šlše
 
	$gc_ş—n_blocks
(
mem_block_t
 *
mb
)

152 
mem_block_t
 *
Ãxt_mb
;

154 
mb
 !ğ
NULL
) {

155 
	`PRINT_DEBUG
("==> f»e(%d,a=%p)\n", 
	`gc_g‘_idx
(), 
mb
->
addr
);

156 
	`ä“
(
mb
->
addr
);

157 
Ãxt_mb
 = 
mb
->
Ãxt
;

158 
	`ä“
(
mb
);

159 
mb
 = 
Ãxt_mb
;

161 
	}
}

166 
šlše
 
	$gc_ş—n_»giÚs
(
mem_»giÚ_t
 *
mr
)

168 
mem_»giÚ_t
 *
Ãxt_mr
;

170 
mr
 !ğ
NULL
) {

171 
	`gc_ş—n_blocks
(
mr
->
blocks
);

172 
Ãxt_mr
 = 
mr
->
Ãxt
;

173 
	`ä“
(
mr
);

174 
mr
 = 
Ãxt_mr
;

176 
	}
}

181 
	$gc_ş—nup_th»ad
(
idx
, 
gc_wÜd_t
 
mš
)

183 
mem_»giÚ_t
 *
mr
;

185 
	`PRINT_DEBUG
("==> gc_ş—nup_th»ad(%d,m=%lu)\n", 
idx
, ()
mš
);

187 ià(
th»ads
[
idx
].
h—d
 =ğ
NULL
) {

192 
mš
 > 
th»ads
[
idx
].
h—d
->
ts
) {

193 
	`gc_ş—n_blocks
(
th»ads
[
idx
].
h—d
->
blocks
);

194 
mr
 = 
th»ads
[
idx
].
h—d
->
Ãxt
;

195 
	`ä“
(
th»ads
[
idx
].
h—d
);

196 
th»ads
[
idx
].
h—d
 = 
mr
;

197 if(
mr
 =ğ
NULL
) {

199 
th»ads
[
idx
].

 = 
NULL
;

203 
	}
}

212 
gc_š™
(
	$gc_wÜd_t
 (*
•och
)())

214 
i
;

216 
	`PRINT_DEBUG
("==> gc_init()\n");

218 
cu¼’t_•och
 = 
•och
;

219 ià((
th»ads
 = (
tm_th»ad_t
 *)
	`m®loc
(
MAX_THREADS
 * Ñm_th»ad_t))è=ğ
NULL
) {

220 
	`³¼Ü
("malloc");

221 
	`ex™
(1);

223 
i
 = 0; i < 
MAX_THREADS
; i++) {

224 
th»ads
[
i
].
u£d
 = 
GC_NULL
;

225 
th»ads
[
i
].
ts
 = 
EPOCH_MAX
;

226 
th»ads
[
i
].
h—d
 =h»ads[i].

 = 
NULL
;

227 #iâdeà
NO_PERIODIC_CLEANUP


228 
th»ads
[
i
].
ä“s
 = 0;

231 
nb_th»ads
 = 0;

232 #iâdeà
TLS


233 ià(
	`±h»ad_key_ü—‹
(&
th»ad_idx
, 
NULL
) != 0) {

234 
	`årštf
(
¡d”r
, "Error creatinghread†ocal\n");

235 
	`ex™
(1);

238 
	}
}

243 
	$gc_ex™
()

245 
i
;

247 
	`PRINT_DEBUG
("==> gc_exit()\n");

250 ià(
	`ATOMIC_LOAD
(&
nb_th»ads
) != 0) {

251 
	`årštf
(
¡d”r
, "Error: somehreads have‚ot been cleaned up\n");

252 
	`ex™
(1);

255 
i
 = 0; i < 
MAX_THREADS
; i++)

256 
	`gc_ş—n_»giÚs
(
th»ads
[
i
].
h—d
);

258 
	`ä“
((*)
th»ads
);

259 
	}
}

264 
	$gc_š™_th»ad
()

266 
i
, 
idx
;

267 
gc_wÜd_t
 
u£d
;

269 
	`PRINT_DEBUG
("==> gc_init_thread()\n");

271 ià(
	`ATOMIC_FETCH_INC_FULL
(&
nb_th»ads
è>ğ
MAX_THREADS
) {

272 
	`årštf
(
¡d”r
, "Error:oo many concurrenthreads created\n");

273 
	`ex™
(1);

276 
i
 = 0;

279 
u£d
 = (
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].used);

280 ià(
u£d
 !ğ
GC_BUSY
) {

281 ià(
	`ATOMIC_CAS_FULL
(&
th»ads
[
i
].
u£d
, u£d, 
GC_BUSY
) != 0) {

282 
idx
 = 
i
;

284 
	`ATOMIC_STORE
(&
th»ads
[
idx
].
ts
, 
	`cu¼’t_•och
());

288 
	`as£¹
 (
th»ads
[
i
].
u£d
 !ğ
GC_NULL
);

290 ià(++
i
 >ğ
MAX_THREADS
)

291 
i
 = 0;

293 #ifdeà
TLS


294 
th»ad_idx
 = 
idx
;

296 
	`±h»ad_£t¥ecific
(
th»ad_idx
, (*)
idx
);

299 
	`PRINT_DEBUG
("==> gc_š™_th»ad(i=%d)\n", 
idx
);

300 
	}
}

305 
	$gc_ex™_th»ad
()

307 
idx
 = 
	`gc_g‘_idx
();

309 
	`PRINT_DEBUG
("==> gc_ex™_th»ad(%d)\n", 
idx
);

312 
	`ATOMIC_STORE
(&
th»ads
[
idx
].
ts
, 
EPOCH_MAX
);

314 
	`ATOMIC_STORE
(&
th»ads
[
idx
].
u£d
,h»ads[idx].
h—d
 =ğ
NULL
 ? 
GC_FREE_EMPTY
 : 
GC_FREE_FULL
);

315 
	`ATOMIC_FETCH_DEC_FULL
(&
nb_th»ads
);

317 
	}
}

323 
	$gc_£t_•och
(
gc_wÜd_t
 
•och
)

325 
idx
 = 
	`gc_g‘_idx
();

327 
	`PRINT_DEBUG
("==> gc_£t_•och(%d,%lu)\n", 
idx
, ()
•och
);

329 ià(
•och
 >ğ
EPOCH_MAX
) {

330 
	`årštf
(
¡d”r
, "Exûeded maximumƒpoch‚umb”: 0x%lx\n", ()
•och
);

336 
	`ATOMIC_STORE
(&
th»ads
[
idx
].
ts
, 
•och
);

337 
	}
}

342 
	$gc_ä“
(*
addr
, 
gc_wÜd_t
 
•och
)

344 
mem_»giÚ_t
 *
mr
;

345 
mem_block_t
 *
mb
;

346 
idx
 = 
	`gc_g‘_idx
();

348 
	`PRINT_DEBUG
("==> gc_ä“(%d,%lu)\n", 
idx
, ()
•och
);

350 ià(
th»ads
[
idx
].
h—d
 =ğ
NULL
 ||h»ads[idx].h—d->
ts
 < 
•och
) {

352 ià((
mr
 = (
mem_»giÚ_t
 *)
	`m®loc
((mem_»giÚ_t))è=ğ
NULL
) {

353 
	`³¼Ü
("malloc");

354 
	`ex™
(1);

356 
mr
->
ts
 = 
•och
;

357 
mr
->
blocks
 = 
NULL
;

358 
mr
->
Ãxt
 = 
NULL
;

359 ià(
th»ads
[
idx
].
h—d
 =ğ
NULL
) {

360 
th»ads
[
idx
].
h—d
 =h»ads[idx].

 = 
mr
;

362 
th»ads
[
idx
].

->
Ãxt
 = 
mr
;

363 
th»ads
[
idx
].

 = 
mr
;

367 
mr
 = 
th»ads
[
idx
].
h—d
;

371 ià((
mb
 = (
mem_block_t
 *)
	`m®loc
((mem_block_t))è=ğ
NULL
) {

372 
	`³¼Ü
("malloc");

373 
	`ex™
(1);

375 
mb
->
addr
 =‡ddr;

376 
mb
->
Ãxt
 = 
mr
->
blocks
;

377 
mr
->
blocks
 = 
mb
;

379 #iâdeà
NO_PERIODIC_CLEANUP


380 
th»ads
[
idx
].
ä“s
++;

381 ià(
th»ads
[
idx
].
ä“s
 % 
CLEANUP_FREQUENCY
 == 0)

382 
	`gc_ş—nup
();

384 
	}
}

390 
	$gc_ş—nup
()

392 
gc_wÜd_t
 
mš
;

393 
idx
 = 
	`gc_g‘_idx
();

395 
	`PRINT_DEBUG
("==> gc_ş—nup(%d)\n", 
idx
);

397 ià(
th»ads
[
idx
].
h—d
 =ğ
NULL
) {

402 
mš
 = 
	`gc_compu‹_mš
(
	`cu¼’t_•och
());

404 
	`gc_ş—nup_th»ad
(
idx
, 
mš
);

405 
	}
}

411 
	$gc_ş—nup_®l
()

413 
i
;

414 
gc_wÜd_t
 
mš
 = 
EPOCH_MAX
;

416 
	`PRINT_DEBUG
("==> gc_cleanup_all()\n");

418 
i
 = 0; i < 
MAX_THREADS
; i++) {

419 ià((
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].
u£d
è=ğ
GC_NULL
)

421 ià((
gc_wÜd_t
)
	`ATOMIC_LOAD
(&
th»ads
[
i
].
u£d
è=ğ
GC_FREE_FULL
) {

422 ià(
	`ATOMIC_CAS_FULL
(&
th»ads
[
i
].
u£d
, 
GC_FREE_FULL
, 
GC_BUSY
) != 0) {

423 ià(
mš
 =ğ
EPOCH_MAX
)

424 
mš
 = 
	`gc_compu‹_mš
(
	`cu¼’t_•och
());

425 
	`gc_ş—nup_th»ad
(
i
, 
mš
);

426 
	`ATOMIC_STORE
(&
th»ads
[
i
].
u£d
,h»ads[i].
h—d
 =ğ
NULL
 ? 
GC_FREE_EMPTY
 : 
GC_FREE_FULL
);

430 
	}
}

436 
	$gc_»£t
()

438 
i
;

440 
	`PRINT_DEBUG
("==> gc_reset()\n");

442 
	`as£¹
(
nb_th»ads
 == 0);

444 
i
 = 0; i < 
MAX_THREADS
; i++) {

445 ià(
th»ads
[
i
].
u£d
 =ğ
GC_NULL
)

447 
	`gc_ş—n_»giÚs
(
th»ads
[
i
].
h—d
);

448 
th»ads
[
i
].
ts
 = 
EPOCH_MAX
;

449 
th»ads
[
i
].
h—d
 =h»ads[i].

 = 
NULL
;

450 #iâdeà
NO_PERIODIC_CLEANUP


451 
th»ads
[
i
].
ä“s
 = 0;

454 
	}
}

	@utils/estm-0.3.0/src/gc.h

23 #iâdeà
_GC_H_


24 
	#_GC_H_


	)

26 
	~<¡dlib.h
>

28 #ifdeà
__ılu¥lus


32 
ušŒ_t
 
	tgc_wÜd_t
;

34 
gc_š™
(
gc_wÜd_t
 (*
•och
)());

35 
gc_ex™
();

37 
gc_š™_th»ad
();

38 
gc_ex™_th»ad
();

40 
gc_£t_•och
(
gc_wÜd_t
 
•och
);

42 
gc_ä“
(*
addr
, 
gc_wÜd_t
 
•och
);

44 
gc_ş—nup
();

46 
gc_ş—nup_®l
();

48 
gc_»£t
();

50 #ifdeà
__ılu¥lus


	@utils/estm-0.3.0/src/mod_local.c

22 
	~<as£¹.h
>

23 
	~<¡dio.h
>

24 
	~<¡dlib.h
>

26 
	~"mod_loÿl.h
"

28 
	~"¡m.h
"

30 #iâdeà
LW_SET_SIZE


31 
	#LW_SET_SIZE
 1024

	)

39 
	mTYPE_WORD
,

40 
	mTYPE_CHAR
,

41 
	mTYPE_UCHAR
,

42 
	mTYPE_SHORT
,

43 
	mTYPE_USHORT
,

44 
	mTYPE_INT
,

45 
	mTYPE_UINT
,

46 
	mTYPE_LONG
,

47 
	mTYPE_ULONG
,

48 
	mTYPE_FLOAT
,

49 
	mTYPE_DOUBLE


52 
	sw_’Œy
 {

53 
	mty³
;

55 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mc
;

56 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	muc
;

57 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	ms
;

58 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mus
;

59 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mi
;

60 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mui
;

61 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	ml
;

62 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mul
;

63 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	mf
;

64 ¡ruù { vŞ©*
	ma
; 
	mv
; } 
	md
;

65 ¡ruù { vŞ©
¡m_wÜd_t
 *
	ma
; stm_wÜd_ˆ
	mv
; } 
	mw
;

66 } 
	md©a
;

67 } 
	tw_’Œy_t
;

69 
	sw_£t
 {

70 
w_’Œy_t
 *
	m’Œ›s
;

71 
	mnb_’Œ›s
;

72 
	msize
;

73 } 
	tw_£t_t
;

75 
	gkey
;

76 
	gš™Ÿlized
 = 0;

85 
šlše
 
w_’Œy_t
 *
	$g‘_’Œy
(
TXPARAM
)

87 
w_£t_t
 *
ws
;

89 ià(!
š™Ÿlized
) {

90 
	`årštf
(
¡d”r
, "Module mod_local‚ot initialized\n");

91 
	`ex™
(1);

95 
ws
 = (
w_£t_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

96 
	`as£¹
(
ws
 !ğ
NULL
);

98 ià(
ws
->
nb_’Œ›s
 =ğws->
size
) {

100 
ws
->
size
 = (ws->siz< 
LW_SET_SIZE
 ? LW_SET_SIZE : ws->size * 2);

101 ià((
ws
->
’Œ›s
 = (
w_’Œy_t
 *)
	`»®loc
(ws->’Œ›s, ws->
size
 * (w_’Œy_t))è=ğ
NULL
) {

102 
	`³¼Ü
("realloc");

103 
	`ex™
(1);

107  &
ws
->
’Œ›s
[ws->
nb_’Œ›s
++];

108 
	}
}

114 
	$¡m_¡Üe_loÿl
(
TXPARAMS
 
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
)

116 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

118 
w
->
ty³
 = 
TYPE_WORD
;

119 
w
->
d©a
.w.
a
 = 
addr
;

120 
w
->
d©a
.w.
v
 = *
addr
;

123 *
addr
 = 
v®ue
;

124 
	}
}

126 
	$¡m_¡Üe_loÿl_ch¬
(
TXPARAMS
 *
addr
, 
v®ue
)

128 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

130 
w
->
ty³
 = 
TYPE_CHAR
;

131 
w
->
d©a
.
c
.
a
 = 
addr
;

132 
w
->
d©a
.
c
.
v
 = *
addr
;

135 *
addr
 = 
v®ue
;

136 
	}
}

138 
	$¡m_¡Üe_loÿl_uch¬
(
TXPARAMS
 *
addr
, 
v®ue
)

140 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

142 
w
->
ty³
 = 
TYPE_UCHAR
;

143 
w
->
d©a
.
uc
.
a
 = 
addr
;

144 
w
->
d©a
.
uc
.
v
 = *
addr
;

147 *
addr
 = 
v®ue
;

148 
	}
}

150 
	$¡m_¡Üe_loÿl_shÜt
(
TXPARAMS
 *
addr
, 
v®ue
)

152 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

154 
w
->
ty³
 = 
TYPE_SHORT
;

155 
w
->
d©a
.
s
.
a
 = 
addr
;

156 
w
->
d©a
.
s
.
v
 = *
addr
;

159 *
addr
 = 
v®ue
;

160 
	}
}

162 
	$¡m_¡Üe_loÿl_ushÜt
(
TXPARAMS
 *
addr
, 
v®ue
)

164 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

166 
w
->
ty³
 = 
TYPE_USHORT
;

167 
w
->
d©a
.
us
.
a
 = 
addr
;

168 
w
->
d©a
.
us
.
v
 = *
addr
;

171 *
addr
 = 
v®ue
;

172 
	}
}

174 
	$¡m_¡Üe_loÿl_št
(
TXPARAMS
 *
addr
, 
v®ue
)

176 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

178 
w
->
ty³
 = 
TYPE_INT
;

179 
w
->
d©a
.
i
.
a
 = 
addr
;

180 
w
->
d©a
.
i
.
v
 = *
addr
;

183 *
addr
 = 
v®ue
;

184 
	}
}

186 
	$¡m_¡Üe_loÿl_ušt
(
TXPARAMS
 *
addr
, 
v®ue
)

188 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

190 
w
->
ty³
 = 
TYPE_UINT
;

191 
w
->
d©a
.
ui
.
a
 = 
addr
;

192 
w
->
d©a
.
ui
.
v
 = *
addr
;

195 *
addr
 = 
v®ue
;

196 
	}
}

198 
	$¡m_¡Üe_loÿl_lÚg
(
TXPARAMS
 *
addr
, 
v®ue
)

200 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

202 
w
->
ty³
 = 
TYPE_LONG
;

203 
w
->
d©a
.
l
.
a
 = 
addr
;

204 
w
->
d©a
.
l
.
v
 = *
addr
;

207 *
addr
 = 
v®ue
;

208 
	}
}

210 
	$¡m_¡Üe_loÿl_ulÚg
(
TXPARAMS
 *
addr
, 
v®ue
)

212 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

214 
w
->
ty³
 = 
TYPE_ULONG
;

215 
w
->
d©a
.
ul
.
a
 = 
addr
;

216 
w
->
d©a
.
ul
.
v
 = *
addr
;

219 *
addr
 = 
v®ue
;

220 
	}
}

222 
	$¡m_¡Üe_loÿl_æßt
(
TXPARAMS
 *
addr
, 
v®ue
)

224 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

226 
w
->
ty³
 = 
TYPE_FLOAT
;

227 
w
->
d©a
.
f
.
a
 = 
addr
;

228 
w
->
d©a
.
f
.
v
 = *
addr
;

231 *
addr
 = 
v®ue
;

232 
	}
}

234 
	$¡m_¡Üe_loÿl_doubË
(
TXPARAMS
 *
addr
, 
v®ue
)

236 
w_’Œy_t
 *
w
 = 
	`g‘_’Œy
(
TXARG
);

238 
w
->
ty³
 = 
TYPE_DOUBLE
;

239 
w
->
d©a
.
d
.
a
 = 
addr
;

240 
w
->
d©a
.
d
.
v
 = *
addr
;

243 *
addr
 = 
v®ue
;

244 
	}
}

246 
	$¡m_¡Üe_loÿl_±r
(
TXPARAMS
 **
addr
, *
v®ue
)

248 uniÚ { 
¡m_wÜd_t
 
w
; *
v
; } 
cÚv”t
;

249 
cÚv”t
.
v
 = 
v®ue
;

250 
	`¡m_¡Üe_loÿl
(
	`TXARGS
 (
¡m_wÜd_t
 *)
addr
, 
cÚv”t
.
w
);

251 
	}
}

256 
	$Ú_th»ad_š™
(
TXPARAMS
 *
¬g
)

258 
w_£t_t
 *
ws
;

260 ià((
ws
 = (
w_£t_t
 *)
	`m®loc
((w_£t_t))è=ğ
NULL
) {

261 
	`³¼Ü
("malloc");

262 
	`ex™
(1);

264 
ws
->
’Œ›s
 = 
NULL
;

265 
ws
->
nb_’Œ›s
 = ws->
size
 = 0;

267 
	`¡m_£t_¥ecific
(
TXARGS
 
key
, 
ws
);

268 
	}
}

273 
	$Ú_th»ad_ex™
(
TXPARAMS
 *
¬g
)

275 
w_£t_t
 *
ws
;

277 
ws
 = (
w_£t_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

278 
	`as£¹
(
ws
 !ğ
NULL
);

280 
	`ä“
(
ws
->
’Œ›s
);

281 
	`ä“
(
ws
);

282 
	}
}

287 
	$Ú_comm™
(
TXPARAMS
 *
¬g
)

289 
w_£t_t
 *
ws
;

291 
ws
 = (
w_£t_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

292 
	`as£¹
(
ws
 !ğ
NULL
);

295 
ws
->
nb_’Œ›s
 = 0;

296 
	}
}

301 
	$Ú_abÜt
(
TXPARAMS
 *
¬g
)

303 
w_£t_t
 *
ws
;

304 
i
;

306 
ws
 = (
w_£t_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

307 
	`as£¹
(
ws
 !ğ
NULL
);

310 
i
 = 
ws
->
nb_’Œ›s
 - 1; i >= 0; i--) {

311 
ws
->
’Œ›s
[
i
].
ty³
) {

312 
TYPE_WORD
:

313 *
ws
->
’Œ›s
[
i
].
d©a
.
w
.
a
 = ws->’Œ›s[i].d©a.w.
v
;

315 
TYPE_CHAR
:

316 *
ws
->
’Œ›s
[
i
].
d©a
.
c
.
a
 = ws->’Œ›s[i].d©a.c.
v
;

318 
TYPE_UCHAR
:

319 *
ws
->
’Œ›s
[
i
].
d©a
.
uc
.
a
 = ws->’Œ›s[i].d©a.uc.
v
;

321 
TYPE_SHORT
:

322 *
ws
->
’Œ›s
[
i
].
d©a
.
s
.
a
 = ws->’Œ›s[i].d©a.s.
v
;

324 
TYPE_USHORT
:

325 *
ws
->
’Œ›s
[
i
].
d©a
.
us
.
a
 = ws->’Œ›s[i].d©a.us.
v
;

327 
TYPE_INT
:

328 *
ws
->
’Œ›s
[
i
].
d©a
.i.
a
 = ws->’Œ›s[i].d©a.i.
v
;

330 
TYPE_UINT
:

331 *
ws
->
’Œ›s
[
i
].
d©a
.
ui
.
a
 = ws->’Œ›s[i].d©a.ui.
v
;

333 
TYPE_LONG
:

334 *
ws
->
’Œ›s
[
i
].
d©a
.
l
.
a
 = ws->’Œ›s[i].d©a.l.
v
;

336 
TYPE_ULONG
:

337 *
ws
->
’Œ›s
[
i
].
d©a
.
ul
.
a
 = ws->’Œ›s[i].d©a.ul.
v
;

339 
TYPE_FLOAT
:

340 *
ws
->
’Œ›s
[
i
].
d©a
.
f
.
a
 = ws->’Œ›s[i].d©a.f.
v
;

342 
TYPE_DOUBLE
:

343 *
ws
->
’Œ›s
[
i
].
d©a
.
d
.
a
 = ws->’Œ›s[i].d©a.d.
v
;

346 
	`årštf
(
¡d”r
, "Unexpectedƒntry in undo†og\n");

347 
	`abÜt
();

348 
	`ex™
(1);

351 
	}
}

356 
	$mod_loÿl_š™
()

358 ià(
š™Ÿlized
)

361 
	`¡m_»gi¡”
(
Ú_th»ad_š™
, 
Ú_th»ad_ex™
, 
NULL
, 
Ú_comm™
, 
Ú_abÜt
, NULL);

362 
key
 = 
	`¡m_ü—‹_¥ecific
();

363 ià(
key
 < 0) {

364 
	`årštf
(
¡d”r
, "Cannot create specific key\n");

365 
	`ex™
(1);

367 
š™Ÿlized
 = 1;

368 
	}
}

	@utils/estm-0.3.0/src/mod_mem.c

23 
	~<as£¹.h
>

24 
	~<¡dio.h
>

25 
	~<¡dlib.h
>

27 
	~"mod_mem.h
"

29 
	~"gc.h
"

30 
	~"¡m.h
"

36 
	smem_block
 {

37 *
	maddr
;

38 
mem_block
 *
	mÃxt
;

39 } 
	tmem_block_t
;

41 
	smem_šfo
 {

42 
mem_block_t
 *
	m®loÿ‹d
;

43 
mem_block_t
 *
	mä“d
;

44 } 
	tmem_šfo_t
;

46 
	gkey
;

47 
	gš™Ÿlized
 = 0;

56 *
	$¡m_m®loc
(
TXPARAMS
 
size_t
 
size
)

59 
mem_šfo_t
 *
mi
;

60 
mem_block_t
 *
mb
;

62 ià(!
š™Ÿlized
) {

63 
	`årštf
(
¡d”r
, "Module mod_mem‚ot initialized\n");

64 
	`ex™
(1);

67 
mi
 = (
mem_šfo_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

68 
	`as£¹
(
mi
 !ğ
NULL
);

71 ià((
¡m_wÜd_t
) == 4) {

72 
size
 = (siz+ 3è& ~(
size_t
)0x03;

74 
size
 = (siz+ 7è& ~(
size_t
)0x07;

77 ià((
mb
 = (
mem_block_t
 *)
	`m®loc
((mem_block_t))è=ğ
NULL
) {

78 
	`³¼Ü
("malloc");

79 
	`ex™
(1);

81 ià((
mb
->
addr
 = 
	`m®loc
(
size
)è=ğ
NULL
) {

82 
	`³¼Ü
("malloc");

83 
	`ex™
(1);

85 
mb
->
Ãxt
 = 
mi
->
®loÿ‹d
;

86 
mi
->
®loÿ‹d
 = 
mb
;

88  
mb
->
addr
;

89 
	}
}

94 
	$¡m_ä“
(
TXPARAMS
 *
addr
, 
size_t
 
size
)

96 
	`¡m_ä“2
(
TXARGS
 
addr
, 0, 
size
);

97 
	}
}

102 
	$¡m_ä“2
(
TXPARAMS
 *
addr
, 
size_t
 
idx
, size_ˆ
size
)

105 
mem_šfo_t
 *
mi
;

106 
mem_block_t
 *
mb
;

107 
¡m_wÜd_t
 *
a
;

109 ià(!
š™Ÿlized
) {

110 
	`årštf
(
¡d”r
, "Module mod_mem‚ot initialized\n");

111 
	`ex™
(1);

114 
mi
 = (
mem_šfo_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

115 
	`as£¹
(
mi
 !ğ
NULL
);

118 ià(
size
 > 0) {

120 ià((
¡m_wÜd_t
) == 4) {

121 
idx
 = (idx + 3) >> 2;

122 
size
 = (size + 3) >> 2;

124 
idx
 = (idx + 7) >> 3;

125 
size
 = (size + 7) >> 3;

127 
a
 = (
¡m_wÜd_t
 *)
addr
 + 
idx
;

128 
size
-- > 0) {

130 
	`¡m_¡Üe2
(
TXARGS
 
a
++, 0, 0);

134 ià((
mb
 = (
mem_block_t
 *)
	`m®loc
((mem_block_t))è=ğ
NULL
) {

135 
	`³¼Ü
("malloc");

136 
	`ex™
(1);

138 
mb
->
addr
 =‡ddr;

139 
mb
->
Ãxt
 = 
mi
->
ä“d
;

140 
mi
->
ä“d
 = 
mb
;

141 
	}
}

146 
	$Ú_th»ad_š™
(
TXPARAMS
 *
¬g
)

148 
mem_šfo_t
 *
mi
;

150 ià((
mi
 = (
mem_šfo_t
 *)
	`m®loc
((mem_šfo_t))è=ğ
NULL
) {

151 
	`³¼Ü
("malloc");

152 
	`ex™
(1);

154 
mi
->
®loÿ‹d
 = mi->
ä“d
 = 
NULL
;

156 
	`¡m_£t_¥ecific
(
TXARGS
 
key
, 
mi
);

157 
	}
}

162 
	$Ú_th»ad_ex™
(
TXPARAMS
 *
¬g
)

164 
	`ä“
(
	`¡m_g‘_¥ecific
(
TXARGS
 
key
));

165 
	}
}

170 
	$Ú_comm™
(
TXPARAMS
 *
¬g
)

172 
mem_šfo_t
 *
mi
;

173 
mem_block_t
 *
mb
, *
Ãxt
;

175 
mi
 = (
mem_šfo_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

176 
	`as£¹
(
mi
 !ğ
NULL
);

179 ià(
mi
->
®loÿ‹d
 !ğ
NULL
) {

180 
mb
 = 
mi
->
®loÿ‹d
;

181 
mb
 !ğ
NULL
) {

182 
Ãxt
 = 
mb
->next;

183 
	`ä“
(
mb
);

184 
mb
 = 
Ãxt
;

186 
mi
->
®loÿ‹d
 = 
NULL
;

190 ià(
mi
->
ä“d
 !ğ
NULL
) {

191 #ifdeà
EPOCH_GC


192 
¡m_wÜd_t
 
t
 = 
	`¡m_g‘_şock
();

194 
mb
 = 
mi
->
ä“d
;

195 
mb
 !ğ
NULL
) {

196 
Ãxt
 = 
mb
->next;

197 #ifdeà
EPOCH_GC


198 
	`gc_ä“
(
mb
->
addr
, 
t
);

200 
	`ä“
(
mb
->
addr
);

202 
	`ä“
(
mb
);

203 
mb
 = 
Ãxt
;

205 
mi
->
ä“d
 = 
NULL
;

207 
	}
}

212 
	$Ú_abÜt
(
TXPARAMS
 *
¬g
)

214 
mem_šfo_t
 *
mi
;

215 
mem_block_t
 *
mb
, *
Ãxt
;

217 
mi
 = (
mem_šfo_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

218 
	`as£¹
 (
mi
 !ğ
NULL
);

221 ià(
mi
->
®loÿ‹d
 !ğ
NULL
) {

222 
mb
 = 
mi
->
®loÿ‹d
;

223 
mb
 !ğ
NULL
) {

224 
Ãxt
 = 
mb
->next;

225 
	`ä“
(
mb
->
addr
);

226 
	`ä“
(
mb
);

227 
mb
 = 
Ãxt
;

229 
mi
->
®loÿ‹d
 = 
NULL
;

233 ià(
mi
->
ä“d
 !ğ
NULL
) {

234 
mb
 = 
mi
->
ä“d
;

235 
mb
 !ğ
NULL
) {

236 
Ãxt
 = 
mb
->next;

237 
	`ä“
(
mb
);

238 
mb
 = 
Ãxt
;

240 
mi
->
ä“d
 = 
NULL
;

242 
	}
}

247 
	$mod_mem_š™
()

249 ià(
š™Ÿlized
)

252 
	`¡m_»gi¡”
(
Ú_th»ad_š™
, 
Ú_th»ad_ex™
, 
NULL
, 
Ú_comm™
, 
Ú_abÜt
, NULL);

253 
key
 = 
	`¡m_ü—‹_¥ecific
();

254 ià(
key
 < 0) {

255 
	`årštf
(
¡d”r
, "Cannot create specific key\n");

256 
	`ex™
(1);

258 
š™Ÿlized
 = 1;

259 
	}
}

	@utils/estm-0.3.0/src/mod_print.c

22 
	~"mod_´št.h
"

24 
	~"¡m.h
"

29 
	$Ú_th»ad_š™
(
TXPARAMS
 *
¬g
)

31 
	`´štf
("==> on_thread_init()\n");

32 
	`fæush
(
NULL
);

33 
	}
}

38 
	$Ú_th»ad_ex™
(
TXPARAMS
 *
¬g
)

40 
	`´štf
("==> on_thread_exit()\n");

41 
	`fæush
(
NULL
);

42 
	}
}

47 
	$Ú_¡¬t
(
TXPARAMS
 *
¬g
)

49 
	`´štf
("==> on_start()\n");

50 
	`fæush
(
NULL
);

51 
	}
}

56 
	$Ú_comm™
(
TXPARAMS
 *
¬g
)

58 
	`´štf
("==> on_commit()\n");

59 
	`fæush
(
NULL
);

60 
	}
}

65 
	$Ú_abÜt
(
TXPARAMS
 *
¬g
)

67 
	`´štf
("==> on_abort()\n");

68 
	`fæush
(
NULL
);

69 
	}
}

74 
	$mod_´št_š™
()

76 
	`¡m_»gi¡”
(
Ú_th»ad_š™
, 
Ú_th»ad_ex™
, 
Ú_¡¬t
, 
Ú_comm™
, 
Ú_abÜt
, 
NULL
);

77 
	}
}

	@utils/estm-0.3.0/src/mod_stats.c

22 
	~<as£¹.h
>

23 
	~<¡dio.h
>

24 
	~<¡ršg.h
>

26 
	~"mod_¡©s.h
"

28 
	~"©omic.h
"

29 
	~"¡m.h
"

35 
	stx_¡©s
 {

36 
	mcomm™s
;

37 
	mabÜts
;

38 
	m»Œ›s
;

39 
	mmax_»Œ›s
;

40 } 
	ttx_¡©s_t
;

42 
	gkey
;

43 
	gš™Ÿlized
 = 0;

45 
tx_¡©s_t
 
	gglob®_¡©s
 = { 0, 0, 0, 0 };

54 
	$¡m_g‘_glob®_¡©s
(cÚ¡ *
Çme
, *
v®
)

56 ià(!
š™Ÿlized
) {

57 
	`årštf
(
¡d”r
, "Module mod_stats‚ot initialized\n");

58 
	`ex™
(1);

61 ià(
	`¡rcmp
("glob®_nb_comm™s", 
Çme
) == 0) {

62 *(*)
v®
 = 
glob®_¡©s
.
comm™s
;

65 ià(
	`¡rcmp
("glob®_nb_abÜts", 
Çme
) == 0) {

66 *(*)
v®
 = 
glob®_¡©s
.
abÜts
;

69 ià(
	`¡rcmp
("glob®_max_»Œ›s", 
Çme
) == 0) {

70 *(*)
v®
 = 
glob®_¡©s
.
max_»Œ›s
;

75 
	}
}

80 
	$¡m_g‘_loÿl_¡©s
(
TXPARAMS
 cÚ¡ *
Çme
, *
v®
)

82 
tx_¡©s_t
 *
¡©s
;

84 ià(!
š™Ÿlized
) {

85 
	`årštf
(
¡d”r
, "Module mod_stats‚ot initialized\n");

86 
	`ex™
(1);

89 
¡©s
 = (
tx_¡©s_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

90 
	`as£¹
(
¡©s
 !ğ
NULL
);

92 ià(
	`¡rcmp
("nb_comm™s", 
Çme
) == 0) {

93 *(*)
v®
 = 
¡©s
->
comm™s
;

96 ià(
	`¡rcmp
("nb_abÜts", 
Çme
) == 0) {

97 *(*)
v®
 = 
¡©s
->
abÜts
;

100 ià(
	`¡rcmp
("max_»Œ›s", 
Çme
) == 0) {

101 *(*)
v®
 = 
¡©s
->
max_»Œ›s
;

106 
	}
}

111 
	$Ú_th»ad_š™
(
TXPARAMS
 *
¬g
)

113 
tx_¡©s_t
 *
¡©s
;

115 ià((
¡©s
 = (
tx_¡©s_t
 *)
	`m®loc
(Ñx_¡©s_t))è=ğ
NULL
) {

116 
	`³¼Ü
("malloc");

117 
	`ex™
(1);

119 
¡©s
->
comm™s
 = 0;

120 
¡©s
->
abÜts
 = 0;

121 
¡©s
->
»Œ›s
 = 0;

122 
¡©s
->
max_»Œ›s
 = 0;

124 
	`¡m_£t_¥ecific
(
TXARGS
 
key
, 
¡©s
);

125 
	}
}

130 
	$Ú_th»ad_ex™
(
TXPARAMS
 *
¬g
)

132 
tx_¡©s_t
 *
¡©s
;

133 
max
;

135 
¡©s
 = (
tx_¡©s_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

136 
	`as£¹
(
¡©s
 !ğ
NULL
);

138 
	`ATOMIC_FETCH_ADD_FULL
(&
glob®_¡©s
.
comm™s
, 
¡©s
->commits);

139 
	`ATOMIC_FETCH_ADD_FULL
(&
glob®_¡©s
.
abÜts
, 
¡©s
->aborts);

140 
»Œy
:

141 
max
 = 
	`ATOMIC_LOAD
(&
glob®_¡©s
.
max_»Œ›s
);

142 ià(
¡©s
->
max_»Œ›s
 > 
max
) {

143 ià(
	`ATOMIC_CAS_FULL
(&
glob®_¡©s
.
max_»Œ›s
, 
max
, 
¡©s
->max_retries) == 0)

144 
»Œy
;

147 
	`ä“
(
¡©s
);

148 
	}
}

153 
	$Ú_comm™
(
TXPARAMS
 *
¬g
)

155 
tx_¡©s_t
 *
¡©s
;

157 
¡©s
 = (
tx_¡©s_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

158 
	`as£¹
(
¡©s
 !ğ
NULL
);

160 
¡©s
->
comm™s
++;

161 
¡©s
->
»Œ›s
 = 0;

162 
	}
}

167 
	$Ú_abÜt
(
TXPARAMS
 *
¬g
)

169 
tx_¡©s_t
 *
¡©s
;

171 
¡©s
 = (
tx_¡©s_t
 *)
	`¡m_g‘_¥ecific
(
TXARGS
 
key
);

172 
	`as£¹
(
¡©s
 !ğ
NULL
);

174 
¡©s
->
abÜts
++;

175 
¡©s
->
»Œ›s
++;

176 ià(
¡©s
->
max_»Œ›s
 < sts->
»Œ›s
)

177 
¡©s
->
max_»Œ›s
 = sts->
»Œ›s
;

178 
	}
}

183 
	$mod_¡©s_š™
()

185 ià(
š™Ÿlized
)

188 
	`¡m_»gi¡”
(
Ú_th»ad_š™
, 
Ú_th»ad_ex™
, 
NULL
, 
Ú_comm™
, 
Ú_abÜt
, NULL);

189 
key
 = 
	`¡m_ü—‹_¥ecific
();

190 ià(
key
 < 0) {

191 
	`årštf
(
¡d”r
, "Cannot create specific key\n");

192 
	`ex™
(1);

194 
š™Ÿlized
 = 1;

195 
	}
}

	@utils/estm-0.3.0/src/stm.c

23 
	~<as£¹.h
>

24 
	~<sigÇl.h
>

25 
	~<¡dio.h
>

26 
	~<¡ršg.h
>

28 
	~<±h»ad.h
>

29 
	~<sched.h
>

31 
	~"¡m.h
"

32 
	~"©omic.h
"

33 
	~"gc.h
"

39 
	#COMPILE_TIME_ASSERT
(
´ed
è0è{ 0: ´ed: ; }

	)

42 
	#WRITE_BACK_ETL
 0

	)

43 
	#WRITE_BACK_CTL
 1

	)

44 
	#WRITE_THROUGH
 2

	)

46 
	#EL
 0

	)

47 
	#NL
 1

	)

49 #ifdeà
EXPLICIT_TX_PARAMETER


50 
	#TX_RETURN
  
tx


	)

51 
	#TX_GET


	)

53 
	#TX_RETURN


	)

54 
	#TX_GET
 
¡m_tx_t
 *
tx
 = 
	`¡m_g‘_tx
()

	)

57 
	#IO_FLUSH


	)

58 
	#PRINT_DEBUG
(...)

	)

59 
	#PRINT_DEBUG2
(...)

	)

61 #iâdeà
RW_SET_SIZE


62 
	#RW_SET_SIZE
 4096

	)

65 #iâdeà
LOCK_ARRAY_LOG_SIZE


66 
	#LOCK_ARRAY_LOG_SIZE
 20

	)

69 #iâdeà
LOCK_SHIFT_EXTRA


70 
	#LOCK_SHIFT_EXTRA
 2

	)

73 
	#XSTR
(
s
è
	`STR
(s)

	)

74 
	#STR
(
s
è#s

	)

81 
	mTX_IDLE
 = 0,

82 
	mTX_ACTIVE
 = 1,

83 
	mTX_COMMITTED
 = 2,

84 
	mTX_ABORTED
 = 3

87 
	sr_’Œy
 {

88 
¡m_wÜd_t
 
	mv”siÚ
;

89 vŞ©
¡m_wÜd_t
 *
	mlock
;

90 } 
	tr_’Œy_t
;

92 
	sr_£t
 {

93 
r_’Œy_t
 *
	m’Œ›s
;

94 
	mnb_’Œ›s
;

95 
	msize
;

96 } 
	tr_£t_t
;

98 
	sw_’Œy
 {

101 vŞ©
¡m_wÜd_t
 *
	maddr
;

102 
¡m_wÜd_t
 
	mv®ue
;

103 
¡m_wÜd_t
 
	mmask
;

104 
¡m_wÜd_t
 
	mv”siÚ
;

105 vŞ©
¡m_wÜd_t
 *
	mlock
;

106 
w_’Œy
 *
	mÃxt
;

109 } 
	tw_’Œy_t
;

111 
	sw_£t
 {

112 
w_’Œy_t
 *
	m’Œ›s
;

113 
	mnb_’Œ›s
;

114 
	msize
;

115 
	m»®loÿ‹
;

116 } 
	tw_£t_t
;

118 
	#ELASTICITY
 2

	)

119 #iâdeà
MAX_SPECIFIC


120 
	#MAX_SPECIFIC
 16

	)

123 
	s¡m_tx
 {

124 
¡m_tx_©Œ_t
 *
	m©Œ
;

125 
¡m_wÜd_t
 
	m¡©us
;

126 
¡m_wÜd_t
 
	m¡¬t
;

127 
¡m_wÜd_t
 
	m’d
;

128 
r_£t_t
 
	mr_£t
;

129 
w_£t_t
 
	mw_£t
;

130 
sigjmp_buf
 
	m’v
;

131 
sigjmp_buf
 *
	mjmp
;

132 
	mÃ¡šg
;

133 
	mro
;

134 
	mÿn_ex‹nd
;

135 *
	md©a
[
MAX_SPECIFIC
];

136 
	m»Œ›s
;

137 
	mabÜts
;

138 
	mabÜts_ro
;

139 
	mabÜts_locked_»ad
;

140 
	mabÜts_locked_wr™e
;

141 
	mabÜts_v®id©e_»ad
;

142 
	mabÜts_v®id©e_wr™e
;

143 
	mabÜts_v®id©e_comm™
;

144 
	mabÜts_šv®id_memÜy
;

145 
	mabÜts_doubË_wr™e
;

146 
	mabÜts_»®loÿ‹
;

147 
	mabÜts_rŞlov”
;

148 
	mmax_»Œ›s
;

149 
	mty³
;

150 
¡m_wÜd_t
 *
	mÏ¡¿ddr
[
ELASTICITY
];

151 
	mm¬k”
;

152 } 
	t¡m_tx_t
;

154 
	gnb_¥ecific
 = 0;

192 
	scb_’Œy
 {

193 (*
	mf
)(
TXPARAMS
 *);

194 *
	m¬g
;

195 } 
	tcb_’Œy_t
;

197 
	#MAX_CB
 16

	)

200 
cb_’Œy_t
 
	gš™_cb
[
MAX_CB
];

201 
cb_’Œy_t
 
	gex™_cb
[
MAX_CB
];

202 
cb_’Œy_t
 
	g¡¬t_cb
[
MAX_CB
];

203 
cb_’Œy_t
 
	gcomm™_cb
[
MAX_CB
];

204 
cb_’Œy_t
 
	gabÜt_cb
[
MAX_CB
];

206 
	gnb_š™_cb
 = 0;

207 
	gnb_ex™_cb
 = 0;

208 
	gnb_¡¬t_cb
 = 0;

209 
	gnb_comm™_cb
 = 0;

210 
	gnb_abÜt_cb
 = 0;

216 #ifdeà
TLS


217 
__th»ad
 
¡m_tx_t
* 
	gth»ad_tx
;

219 
±h»ad_key_t
 
	gth»ad_tx
;

250 
	#OWNED_MASK
 0x01

	)

251 
	#VERSION_MAX
 (~(
¡m_wÜd_t
)0 >> 1)

	)

253 
	#LOCK_GET_OWNED
(
l
èÖ & 
OWNED_MASK
)

	)

254 
	#LOCK_SET_ADDR
(
a
è× | 
OWNED_MASK
è

	)

255 
	#LOCK_GET_ADDR
(
l
èÖ & ~(
¡m_wÜd_t
)
OWNED_MASK
)

	)

256 
	#LOCK_GET_TIMESTAMP
(
l
èÖ >> 1è

	)

257 
	#LOCK_SET_TIMESTAMP
(
t
èÑ << 1è

	)

258 
	#LOCK_UNIT
 (~(
¡m_wÜd_t
)0)

	)

269 
	#LOCK_ARRAY_SIZE
 (1 << 
LOCK_ARRAY_LOG_SIZE
)

	)

270 
	#LOCK_MASK
 (
LOCK_ARRAY_SIZE
 - 1)

	)

271 
	#LOCK_SHIFT
 ((((
¡m_wÜd_t
è=ğ4è? 2 : 3è+ 
LOCK_SHIFT_EXTRA
)

	)

272 
	#LOCK_IDX
(
a
è(((
¡m_wÜd_t
)×è>> 
LOCK_SHIFT
è& 
LOCK_MASK
)

	)

273 
	#GET_LOCK
(
a
è(
locks
 + 
	`LOCK_IDX
×))

	)

275 vŞ©
¡m_wÜd_t
 
	glocks
[
LOCK_ARRAY_SIZE
];

282 vŞ©
¡m_wÜd_t
 
	ggşock
[1024 / (stm_word_t)];

283 
	#CLOCK
 (
gşock
[512 / (
¡m_wÜd_t
)])

	)

285 
	#GET_CLOCK
 (
	`ATOMIC_LOAD_ACQ
(&
CLOCK
))

	)

286 
	#FETCH_INC_CLOCK
 (
	`ATOMIC_FETCH_INC_FULL
(&
CLOCK
))

	)

295 
šlše
 
¡m_tx_t
 *
	$¡m_g‘_tx
()

297 #ifdeà
TLS


298  
th»ad_tx
;

300  (
¡m_tx_t
 *)
	`±h»ad_g‘¥ecific
(
th»ad_tx
);

302 
	}
}

322 
±h»ad_mu‹x_t
 
	gtx_couÁ_mu‹x
;

323 
±h»ad_cÚd_t
 
	gtx_»£t
;

324 
	gtx_couÁ
;

325 
	gtx_ov”æow
;

330 
šlše
 
	$¡m_rŞlov”_’‹r
(
¡m_tx_t
 *
tx
)

332 
	`PRINT_DEBUG
("==> stm_rŞlov”_’‹r(%p)\n", 
tx
);

334 
	`±h»ad_mu‹x_lock
(&
tx_couÁ_mu‹x
);

335 
tx_ov”æow
 != 0)

336 
	`±h»ad_cÚd_wa™
(&
tx_»£t
, &
tx_couÁ_mu‹x
);

338 
tx_couÁ
++;

339 
	`±h»ad_mu‹x_uÆock
(&
tx_couÁ_mu‹x
);

340 
	}
}

345 
šlše
 
	$¡m_rŞlov”_ex™
(
¡m_tx_t
 *
tx
)

347 
	`PRINT_DEBUG
("==> stm_rŞlov”_ex™(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

349 
	`±h»ad_mu‹x_lock
(&
tx_couÁ_mu‹x
);

351 
tx_couÁ
--;

352 
	`as£¹
(
tx_couÁ
 >= 0);

354 ià(
tx_ov”æow
 !ğ0 && 
tx_couÁ
 == 0) {

356 
	`mem£t
((*)
locks
, 0, 
LOCK_ARRAY_SIZE
 * (
¡m_wÜd_t
));

357 
CLOCK
 = 0;

358 
tx_ov”æow
 = 0;

360 
	`gc_»£t
();

362 
	`±h»ad_cÚd_brßdÿ¡
(&
tx_»£t
);

364 
	`±h»ad_mu‹x_uÆock
(&
tx_couÁ_mu‹x
);

365 
	}
}

370 
šlše
 
	$¡m_ov”æow
(
¡m_tx_t
 *
tx
)

372 
	`PRINT_DEBUG
("==> stm_ov”æow(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

374 
	`±h»ad_mu‹x_lock
(&
tx_couÁ_mu‹x
);

376 
tx_ov”æow
 = 1;

378 
tx_couÁ
--;

379 
	`as£¹
(
tx_couÁ
 >= 0);

381 ià(
tx_couÁ
 == 0) {

383 
	`mem£t
((*)
locks
, 0, 
LOCK_ARRAY_SIZE
 * (
¡m_wÜd_t
));

384 
CLOCK
 = 0;

385 
tx_ov”æow
 = 0;

387 
	`gc_»£t
();

389 
	`±h»ad_cÚd_brßdÿ¡
(&
tx_»£t
);

392 
	`±h»ad_cÚd_wa™
(&
tx_»£t
, &
tx_couÁ_mu‹x
);

395 
tx_couÁ
++;

396 
	`±h»ad_mu‹x_uÆock
(&
tx_couÁ_mu‹x
);

397 
	}
}

402 
šlše
 
r_’Œy_t
 *
	$¡m_has_»ad
(
¡m_tx_t
 *
tx
, vŞ©
¡m_wÜd_t
 *
lock
)

404 
r_’Œy_t
 *
r
;

405 
i
;

407 
	`PRINT_DEBUG
("==> stm_has_»ad(%p[%lu-%lu],%p)\n", 
tx
, (éx->
¡¬t
, (éx->
’d
, 
lock
);

410 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

413 
r
 = 
tx
->
r_£t
.
’Œ›s
;

414 
i
 = 
tx
->
r_£t
.
nb_’Œ›s
; i > 0; i--, 
r
++) {

415 ià(
r
->
lock
 ==†ock) {

417  
r
;

420  
NULL
;

421 
	}
}

426 
šlše
 
	$¡m_®loÿ‹_rs_’Œ›s
(
¡m_tx_t
 *
tx
, 
ex‹nd
)

428 ià(
ex‹nd
) {

430 
tx
->
r_£t
.
size
 *= 2;

431 
	`PRINT_DEBUG2
("==>„—Îoÿ‹„—d s‘ (%p[%lu-%lu],%d)\n", 
tx
, (éx->
¡¬t
, (éx->
’d
,x->
r_£t
.
size
);

432 ià((
tx
->
r_£t
.
’Œ›s
 = (
r_’Œy_t
 *)
	`»®loc
Ñx->r_£t.’Œ›s,x->r_£t.
size
 * Ô_’Œy_t))è=ğ
NULL
) {

433 
	`³¼Ü
("realloc");

434 
	`ex™
(1);

438 ià((
tx
->
r_£t
.
’Œ›s
 = (
r_’Œy_t
 *)
	`m®loc
Ñx->r_£t.
size
 * Ô_’Œy_t))è=ğ
NULL
) {

439 
	`³¼Ü
("malloc");

440 
	`ex™
(1);

443 
	}
}

448 
šlše
 
	$¡m_®loÿ‹_ws_’Œ›s
(
¡m_tx_t
 *
tx
, 
ex‹nd
)

451 ià(
ex‹nd
) {

453 
tx
->
w_£t
.
size
 *= 2;

454 
	`PRINT_DEBUG
("==>„—Îoÿ‹ wr™£ˆ(%p[%lu-%lu],%d)\n", 
tx
, (éx->
¡¬t
, (éx->
’d
,x->
w_£t
.
size
);

455 ià((
tx
->
w_£t
.
’Œ›s
 = (
w_’Œy_t
 *)
	`»®loc
Ñx->w_£t.’Œ›s,x->w_£t.
size
 * (w_’Œy_t))è=ğ
NULL
) {

456 
	`³¼Ü
("realloc");

457 
	`ex™
(1);

461 ià((
tx
->
w_£t
.
’Œ›s
 = (
w_’Œy_t
 *)
	`m®loc
Ñx->w_£t.
size
 * (w_’Œy_t))è=ğ
NULL
) {

462 
	`³¼Ü
("malloc");

463 
	`ex™
(1);

467 
	}
}

472 
šlše
 
	$¡m_v®id©e
(
¡m_tx_t
 *
tx
)

474 
r_’Œy_t
 *
r
;

475 
i
;

476 
¡m_wÜd_t
 
l
;

478 
	`PRINT_DEBUG
("==> stm_v®id©e(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

481 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

484 
r
 = 
tx
->
r_£t
.
’Œ›s
;

485 
i
 = 
tx
->
r_£t
.
nb_’Œ›s
; i > 0; i--, 
r
++) {

487 
l
 = 
	`ATOMIC_LOAD
(
r
->
lock
);

489 ià(
	`LOCK_GET_OWNED
(
l
)) {

491 
w_’Œy_t
 *
w
 = (w_’Œy_ˆ*)
	`LOCK_GET_ADDR
(
l
);

493 ià(!(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
))

500 ià(
	`LOCK_GET_TIMESTAMP
(
l
è!ğ
r
->
v”siÚ
) {

508 
	}
}

513 
šlše
 
	$¡m_ex‹nd
(
¡m_tx_t
 *
tx
)

515 
¡m_wÜd_t
 
now
;

517 
	`PRINT_DEBUG
("==> stm_ex‹nd(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

520 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

523 
now
 = 
GET_CLOCK
;

524 ià(
now
 >ğ
VERSION_MAX
) {

529 ià(
	`¡m_v®id©e
(
tx
)) {

531 
tx
->
’d
 = 
now
;

535 
	}
}

540 
šlše
 
	$¡m_rŞlback
(
¡m_tx_t
 *
tx
)

542 
w_’Œy_t
 *
w
;

543 
i
;

545 
	`PRINT_DEBUG
("==> stm_rŞlback(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

548 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

551 
i
 = 
tx
->
w_£t
.
nb_’Œ›s
;

552 ià(
i
 > 0) {

553 
w
 = 
tx
->
w_£t
.
’Œ›s
;

554 ; 
i
 > 0; i--, 
w
++) {

555 ià(
w
->
Ãxt
 =ğ
NULL
) {

557 
	`ATOMIC_STORE
(
w
->
lock
, 
	`LOCK_SET_TIMESTAMP
(w->
v”siÚ
));

559 
	`PRINT_DEBUG2
("==> discard(t=%p[%lu-%lu],a=%p,d=%p-%lu,v=%lu)\n",

560 
tx
, (éx->
¡¬t
, (éx->
’d
, 
w
->
addr
, (*)w->
v®ue
, ()w->v®ue, ()w->
v”siÚ
);

563 
ATOMIC_MB_WRITE
;

566 
tx
->
»Œ›s
++;

567 
tx
->
abÜts
++;

568 ià(
tx
->
max_»Œ›s
 <x->
»Œ›s
)

569 
tx
->
max_»Œ›s
 =x->
»Œ›s
;

572 ià(
nb_abÜt_cb
 != 0) {

573 
cb
;

574 
cb
 = 0; cb < 
nb_abÜt_cb
; cb++)

575 
abÜt_cb
[
cb
].
	`f
(
TXARGS
‡bÜt_cb[cb].
¬g
);

579 
tx
->
¡©us
 = 
TX_ABORTED
;

582 
tx
->
Ã¡šg
 = 0;

586 ià(
tx
->
jmp
 !ğ
NULL
)

587 
	`siglÚgjmp
(*
tx
->
jmp
, 1);

588 
	}
}

593 
šlše
 
w_’Œy_t
 *
	$¡m_wr™e
(
¡m_tx_t
 *
tx
, vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
)

595 vŞ©
¡m_wÜd_t
 *
lock
;

596 
¡m_wÜd_t
 
l
, 
v”siÚ
;

597 
w_’Œy_t
 *
w
;

598 
w_’Œy_t
 *
´ev
 = 
NULL
;

600 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,d=%p-%lu,m=0x%lx)\n",

601 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, (*)
v®ue
, ()v®ue, ()
mask
);

604 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

606 ià(
tx
->
ro
) {

608 
	`as£¹
(
tx
->
©Œ
 !ğ
NULL
);

609 
tx
->
©Œ
->
ro
 = 0;

610 
tx
->
abÜts_ro
++;

611 
	`¡m_rŞlback
(
tx
);

612  
NULL
;

616 
lock
 = 
	`GET_LOCK
(
addr
);

619 
»¡¬t
:

620 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

621 ià(
	`LOCK_GET_OWNED
(
l
)) {

624 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

626 ià(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
) {

628 
´ev
 = 
w
;

631 ià(
addr
 =ğ
´ev
->addr) {

632 ià(
mask
 == 0)

633  
´ev
;

635 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu,m=0x%lx)\n",

636 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()v®ue, ()
mask
);

637 ià(
mask
 !ğ~(
¡m_wÜd_t
)0) {

638 ià(
´ev
->
mask
 == 0)

639 
´ev
->
v®ue
 = 
	`ATOMIC_LOAD
(
addr
);

640 
v®ue
 = (
´ev
->v®u& ~
mask
) | (value & mask);

642 
´ev
->
v®ue
 = value;

643 
´ev
->
mask
 |= mask;

644  
´ev
;

646 ià(
´ev
->
Ãxt
 =ğ
NULL
) {

650 
´ev
 =…»v->
Ãxt
;

653 
v”siÚ
 = 
´ev
->version;

655 ià(
tx
->
w_£t
.
nb_’Œ›s
 =ğtx->w_£t.
size
) {

657 
tx
->
w_£t
.
size
 *= 2;

658 
tx
->
w_£t
.
»®loÿ‹
 = 1;

659 
tx
->
abÜts_»®loÿ‹
++;

660 
	`¡m_rŞlback
(
tx
);

661  
NULL
;

663 
w
 = &
tx
->
w_£t
.
’Œ›s
[tx->w_£t.
nb_’Œ›s
];

664 
do_wr™e
;

667 
tx
->
abÜts_locked_wr™e
++;

668 
	`¡m_rŞlback
(
tx
);

669  
NULL
;

673 
v”siÚ
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

674 ià(
v”siÚ
 > 
tx
->
’d
) {

676 ià(!
tx
->
ÿn_ex‹nd
 || 
	`¡m_has_»ad
Ñx, 
lock
è!ğ
NULL
) {

679 
tx
->
abÜts_v®id©e_wr™e
++;

680 
	`¡m_rŞlback
(
tx
);

681  
NULL
;

685 ià(
tx
->
w_£t
.
nb_’Œ›s
 =ğtx->w_£t.
size
) {

687 
tx
->
w_£t
.
size
 *= 2;

688 
tx
->
w_£t
.
»®loÿ‹
 = 1;

689 
tx
->
abÜts_»®loÿ‹
++;

690 
	`¡m_rŞlback
(
tx
);

691  
NULL
;

693 
w
 = &
tx
->
w_£t
.
’Œ›s
[tx->w_£t.
nb_’Œ›s
];

694 ià(
	`ATOMIC_CAS_FULL
(
lock
, 
l
, 
	`LOCK_SET_ADDR
((
¡m_wÜd_t
)
w
)) == 0)

695 
»¡¬t
;

698 
do_wr™e
:

699 
	`PRINT_DEBUG2
("==> stm_write(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu,m=0x%lx)\n",

700 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()v®ue, ()
mask
);

703 
w
->
addr
 =‡ddr;

704 
w
->
mask
 = mask;

705 
w
->
lock
 =†ock;

706 ià(
mask
 == 0) {

708 #iâdeà
NDEBUG


709 
w
->
v®ue
 = 0;

714 ià(
mask
 !ğ~(
¡m_wÜd_t
)0)

715 
v®ue
 = (
	`ATOMIC_LOAD
(
addr
è& ~
mask
) | (value & mask);

716 
w
->
v®ue
 = value;

718 
w
->
v”siÚ
 = version;

719 
w
->
Ãxt
 = 
NULL
;

720 ià(
´ev
 !ğ
NULL
) {

722 
´ev
->
Ãxt
 = 
w
;

724 
tx
->
w_£t
.
nb_’Œ›s
++;

726  
w
;

727 
	}
}

734 
	$sigÇl_ÿtch”
(
sig
)

736 
¡m_tx_t
 *
tx
 = 
	`¡m_g‘_tx
();

739 
	`PRINT_DEBUG
("CaughˆsigÇl: %d\n", 
sig
);

741 ià(
tx
 =ğ
NULL
 ||x->
jmp
 == NULL) {

743 
	`årštf
(
¡d”r
, "Error: invalid memory‡ccessed‡nd‚o†ongjmp destination\n");

744 
	`ex™
(1);

747 
tx
->
abÜts_šv®id_memÜy
++;

749 
	`¡m_rŞlback
(
tx
);

750 
	}
}

759 
	$¡m_š™
()

761 
sigaùiÚ
 
aù
;

763 
	`PRINT_DEBUG
("==> stm_init()\n");

765 
	`PRINT_DEBUG
("\tsizeof(wÜd)=%d\n", ()(
¡m_wÜd_t
));

767 
	`PRINT_DEBUG
("\tVERSION_MAX=0x%lx\n", ()
VERSION_MAX
);

769 
	`COMPILE_TIME_ASSERT
((
¡m_wÜd_t
) == (*));

770 
	`COMPILE_TIME_ASSERT
((
¡m_wÜd_t
è=ğ(
©omic_t
));

772 
	`gc_š™
(
¡m_g‘_şock
);

774 
	`mem£t
((*)
locks
, 0, 
LOCK_ARRAY_SIZE
 * (
¡m_wÜd_t
));

777 
CLOCK
 = 0;

778 ià(
	`±h»ad_mu‹x_š™
(&
tx_couÁ_mu‹x
, 
NULL
) != 0) {

779 
	`årštf
(
¡d”r
, "Error creating mutex\n");

780 
	`ex™
(1);

782 ià(
	`±h»ad_cÚd_š™
(&
tx_»£t
, 
NULL
) != 0) {

783 
	`årštf
(
¡d”r
, "Error creating condition variable\n");

784 
	`ex™
(1);

786 
tx_couÁ
 = 0;

787 
tx_ov”æow
 = 0;

789 #iâdeà
TLS


790 ià(
	`±h»ad_key_ü—‹
(&
th»ad_tx
, 
NULL
) != 0) {

791 
	`årštf
(
¡d”r
, "Error creatinghread†ocal\n");

792 
	`ex™
(1);

797 
aù
.
§_hªdËr
 = 
sigÇl_ÿtch”
;

798 
aù
.
§_æags
 = 0;

799 
	`sigem±y£t
(&
aù
.
§_mask
);

800 ià(
	`sigaùiÚ
(
SIGBUS
, &
aù
, 
NULL
è< 0 || sigaùiÚ(
SIGSEGV
, &act, NULL) < 0) {

801 
	`³¼Ü
("sigaction");

802 
	`ex™
(1);

805 
	}
}

810 
	$¡m_ex™
()

812 
	`PRINT_DEBUG
("==> stm_exit()\n");

814 #iâdeà
TLS


815 
	`±h»ad_key_d–‘e
(
th»ad_tx
);

817 
	`±h»ad_cÚd_de¡roy
(&
tx_»£t
);

818 
	`±h»ad_mu‹x_de¡roy
(&
tx_couÁ_mu‹x
);

820 
	`gc_ex™
();

821 
	}
}

826 
TXTYPE
 
	$¡m_š™_th»ad
()

828 
¡m_tx_t
 *
tx
;

830 
	`PRINT_DEBUG
("==> stm_init_thread()\n");

832 
	`gc_š™_th»ad
();

835 ià((
tx
 = (
¡m_tx_t
 *)
	`m®loc
((¡m_tx_t))è=ğ
NULL
) {

836 
	`³¼Ü
("malloc");

837 
	`ex™
(1);

840 
tx
->
¡©us
 = 
TX_IDLE
;

842 
tx
->
r_£t
.
nb_’Œ›s
 = 0;

843 
tx
->
r_£t
.
size
 = 
RW_SET_SIZE
;

844 
	`¡m_®loÿ‹_rs_’Œ›s
(
tx
, 0);

846 
tx
->
w_£t
.
nb_’Œ›s
 = 0;

847 
tx
->
w_£t
.
size
 = 
RW_SET_SIZE
;

848 
tx
->
w_£t
.
»®loÿ‹
 = 0;

849 
	`¡m_®loÿ‹_ws_’Œ›s
(
tx
, 0);

851 
tx
->
Ã¡šg
 = 0;

853 
	`mem£t
(
tx
->
d©a
, 0, 
MAX_SPECIFIC
 * (*));

854 
tx
->
»Œ›s
 = 0;

856 
tx
->
abÜts
 = 0;

857 
tx
->
abÜts_ro
 = 0;

858 
tx
->
abÜts_locked_»ad
 = 0;

859 
tx
->
abÜts_locked_wr™e
 = 0;

860 
tx
->
abÜts_v®id©e_»ad
 = 0;

861 
tx
->
abÜts_v®id©e_wr™e
 = 0;

862 
tx
->
abÜts_v®id©e_comm™
 = 0;

863 
tx
->
abÜts_šv®id_memÜy
 = 0;

864 
tx
->
abÜts_»®loÿ‹
 = 0;

865 
tx
->
abÜts_rŞlov”
 = 0;

866 
tx
->
max_»Œ›s
 = 0;

868 #ifdeà
TLS


869 
th»ad_tx
 = 
tx
;

871 
	`±h»ad_£t¥ecific
(
th»ad_tx
, 
tx
);

873 
	`¡m_rŞlov”_’‹r
(
tx
);

876 ià(
nb_š™_cb
 != 0) {

877 
cb
;

878 
cb
 = 0; cb < 
nb_š™_cb
; cb++)

879 
š™_cb
[
cb
].
	`f
(
TXARGS
 in™_cb[cb].
¬g
);

882 
	`PRINT_DEBUG
("==> %p\n", 
tx
);

884 
TX_RETURN
;

885 
	}
}

890 
	$¡m_ex™_th»ad
(
TXPARAM
)

892 
¡m_wÜd_t
 
t
;

893 
TX_GET
;

895 
	`PRINT_DEBUG
("==> stm_ex™_th»ad(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

898 ià(
nb_ex™_cb
 != 0) {

899 
cb
;

900 
cb
 = 0; cb < 
nb_ex™_cb
; cb++)

901 
ex™_cb
[
cb
].
	`f
(
TXARGS
ƒx™_cb[cb].
¬g
);

904 
	`¡m_rŞlov”_ex™
(
tx
);

906 
t
 = 
GET_CLOCK
;

907 
	`gc_ä“
(
tx
->
r_£t
.
’Œ›s
, 
t
);

908 
	`gc_ä“
(
tx
->
w_£t
.
’Œ›s
, 
t
);

909 
	`gc_ä“
(
tx
, 
t
);

910 
	`gc_ex™_th»ad
();

911 
	}
}

916 
šlše
 
	$¡m_–a¡ic_¡¬t
(
TXPARAMS
 
sigjmp_buf
 *
’v
, 
¡m_tx_©Œ_t
 *
©Œ
)

918 
TX_GET
;

919 
tx
->
ty³
 = 
EL
;

921 
	`mem£t
(
tx
->
Ï¡¿ddr
, 0, 
ELASTICITY
 * (*));

922 
tx
->
m¬k”
 = 0;

924 
	`PRINT_DEBUG
("==> stm_–a¡ic_¡¬t(%p)\n", 
tx
);

927 ià(
tx
->
Ã¡šg
++ > 0)

931 
tx
->
jmp
 = 
’v
;

933 
tx
->
©Œ
 =‡ttr;

934 
tx
->
ro
 = (
©Œ
 =ğ
NULL
 ? 0 :‡ttr->ro);

936 
tx
->
¡©us
 = 
TX_ACTIVE
;

937 
¡¬t
:

939 
tx
->
¡¬t
 =x->
’d
 = 
GET_CLOCK
;

941 
tx
->
ÿn_ex‹nd
 = 0;

942 ià(
tx
->
¡¬t
 >ğ
VERSION_MAX
) {

944 
	`¡m_ov”æow
(
tx
);

945 
¡¬t
;

948 ià(
tx
->
w_£t
.
»®loÿ‹
) {

950 
	`gc_ä“
(
tx
->
w_£t
.
’Œ›s
,x->
¡¬t
);

951 
	`¡m_®loÿ‹_ws_’Œ›s
(
tx
, 0);

952 
tx
->
w_£t
.
»®loÿ‹
 = 0;

954 
tx
->
w_£t
.
nb_’Œ›s
 = 0;

955 
tx
->
r_£t
.
nb_’Œ›s
 = 0;

957 
	`gc_£t_•och
(
tx
->
¡¬t
);

960 ià(
nb_¡¬t_cb
 != 0) {

961 
cb
;

962 
cb
 = 0; cb < 
nb_¡¬t_cb
; cb++)

963 
¡¬t_cb
[
cb
].
	`f
(
TXARGS
 s¹_cb[cb].
¬g
);

965 
	}
}

970 
šlše
 
	$¡m_nÜm®_¡¬t
(
TXPARAMS
 
sigjmp_buf
 *
’v
, 
¡m_tx_©Œ_t
 *
©Œ
)

972 
TX_GET
;

973 
tx
->
ty³
 = 
NL
;

975 
	`PRINT_DEBUG
("==> stm_nÜm®_¡¬t(%p)\n", 
tx
);

978 ià(
tx
->
Ã¡šg
++ > 0)

982 
tx
->
jmp
 = 
’v
;

984 
tx
->
©Œ
 =‡ttr;

985 
tx
->
ro
 = (
©Œ
 =ğ
NULL
 ? 0 :‡ttr->ro);

987 
tx
->
¡©us
 = 
TX_ACTIVE
;

988 
¡¬t
:

990 
tx
->
¡¬t
 =x->
’d
 = 
GET_CLOCK
;

992 
tx
->
ÿn_ex‹nd
 = 1;

993 ià(
tx
->
¡¬t
 >ğ
VERSION_MAX
) {

995 
	`¡m_ov”æow
(
tx
);

996 
¡¬t
;

999 ià(
tx
->
w_£t
.
»®loÿ‹
) {

1001 
	`gc_ä“
(
tx
->
w_£t
.
’Œ›s
,x->
¡¬t
);

1002 
	`¡m_®loÿ‹_ws_’Œ›s
(
tx
, 0);

1003 
tx
->
w_£t
.
»®loÿ‹
 = 0;

1005 
tx
->
w_£t
.
nb_’Œ›s
 = 0;

1006 
tx
->
r_£t
.
nb_’Œ›s
 = 0;

1008 
	`gc_£t_•och
(
tx
->
¡¬t
);

1011 ià(
nb_¡¬t_cb
 != 0) {

1012 
cb
;

1013 
cb
 = 0; cb < 
nb_¡¬t_cb
; cb++)

1014 
¡¬t_cb
[
cb
].
	`f
(
TXARGS
 s¹_cb[cb].
¬g
);

1016 
	}
}

1018 
	$¡m_¡¬t
(
TXPARAMS
 
sigjmp_buf
 *
’v
, 
¡m_tx_©Œ_t
 *
©Œ
, 
ty³
) {

1019 
	`PRINT_DEBUG
("==> stm_start\n");

1020 ià(
ty³
 =ğ
NL
è
	`¡m_nÜm®_¡¬t
(
’v
, 
©Œ
);

1021 
	`¡m_–a¡ic_¡¬t
(
’v
, 
©Œ
);

1022 
	}
}

1027 
šlše
 
	$¡m_–a¡ic_comm™
(
TXPARAM
)

1029 
TX_GET
;

1031 
	`PRINT_DEBUG
("==> stm_–a¡ic_comm™(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

1034 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1037 ià(--
tx
->
Ã¡šg
 > 0)

1040 
tx
->
»Œ›s
 = 0;

1043 ià(
nb_comm™_cb
 != 0) {

1044 
cb
;

1045 
cb
 = 0; cb < 
nb_comm™_cb
; cb++)

1046 
comm™_cb
[
cb
].
	`f
(
TXARGS
 comm™_cb[cb].
¬g
);

1050 
tx
->
¡©us
 = 
TX_COMMITTED
;

1053 
	}
}

1058 
šlše
 
	$¡m_nÜm®_comm™
(
TXPARAM
)

1060 
w_’Œy_t
 *
w
;

1061 
¡m_wÜd_t
 
t
;

1062 
i
;

1063 
TX_GET
;

1065 
	`PRINT_DEBUG
("==> stm_nÜm®_comm™(%p[%lu-%lu])\n", 
tx
, (éx->
¡¬t
, (éx->
’d
);

1068 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1071 ià(--
tx
->
Ã¡šg
 > 0)

1074 ià(
tx
->
w_£t
.
nb_’Œ›s
 > 0) {

1079 
t
 = 
FETCH_INC_CLOCK
 + 1;

1080 ià(
t
 >ğ
VERSION_MAX
) {

1082 
tx
->
abÜts_rŞlov”
++;

1083 
	`¡m_rŞlback
(
tx
);

1088 ià(
tx
->
¡¬t
 !ğ
t
 - 1 && !
	`¡m_v®id©e
(tx)) {

1090 
tx
->
abÜts_v®id©e_comm™
++;

1091 
	`¡m_rŞlback
(
tx
);

1096 
w
 = 
tx
->
w_£t
.
’Œ›s
;

1097 
i
 = 
tx
->
w_£t
.
nb_’Œ›s
; i > 0; i--, 
w
++) {

1098 ià(
w
->
mask
 != 0)

1099 
	`ATOMIC_STORE
(
w
->
addr
, w->
v®ue
);

1101 ià(
w
->
Ãxt
 =ğ
NULL
)

1102 
	`ATOMIC_STORE_REL
(
w
->
lock
, 
	`LOCK_SET_TIMESTAMP
(
t
));

1104 
	`PRINT_DEBUG2
("==> write(t=%p[%lu-%lu],a=%p,d=%p-%d,v=%d)\n",

1105 
tx
, (éx->
¡¬t
, (éx->
’d
, 
w
->
addr
, (*)w->
v®ue
, ()w->v®ue, ()w->
v”siÚ
);

1109 
tx
->
»Œ›s
 = 0;

1114 ià(
nb_comm™_cb
 != 0) {

1115 
cb
;

1116 
cb
 = 0; cb < 
nb_comm™_cb
; cb++)

1117 
comm™_cb
[
cb
].
	`f
(
TXARGS
 comm™_cb[cb].
¬g
);

1121 
tx
->
¡©us
 = 
TX_COMMITTED
;

1124 
	}
}

1126 
	$¡m_comm™
(
TXPARAM
) {

1127 
TX_GET
;

1128 ià(
tx
->
ty³
 =ğ
NL
è 
	`¡m_nÜm®_comm™
();

1129  
	`¡m_–a¡ic_comm™
();

1130 
	}
}

1135 
	$¡m_abÜt
(
TXPARAM
)

1137 
TX_GET
;

1138 
	`¡m_rŞlback
(
tx
);

1139 
	}
}

1144 
šlše
 
¡m_wÜd_t
 
	$¡m_v”v®v”
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ*
time¡amp
)

1146 vŞ©
¡m_wÜd_t
 *
lock
;

1147 
¡m_wÜd_t
 
l
, 
l2
, 
v®ue
;

1148 
w_’Œy_t
 *
w
;

1150 
TX_GET
;

1152 
	`PRINT_DEBUG2
("==> stm_v”v®v”×=%p)\n", 
addr
);

1155 
lock
 = 
	`GET_LOCK
(
addr
);

1158 
»¡¬t
:

1159 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1160 
»¡¬t_no_lßd
:

1161 ià(
	`LOCK_GET_OWNED
(
l
)) {

1163 ià((
¡m_tx_t
 *)
	`LOCK_GET_ADDR
(
l
è=ğ
tx
) {

1165 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

1167 ià(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
) {

1170 ià(
addr
 =ğ
w
->addr) {

1172 
v®ue
 = (
w
->
mask
 =ğ0 ? 
	`ATOMIC_LOAD
(
addr
) : w->value);

1175 ià(
w
->
Ãxt
 =ğ
NULL
) {

1177 
v®ue
 = 
	`ATOMIC_LOAD
(
addr
);

1180 
w
 = w->
Ãxt
;

1183 
	`PRINT_DEBUG2
("==> stm_normal_load(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu)\n",

1184 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()value);

1185  
v®ue
;

1190 
»¡¬t
;

1193 
v®ue
 = 
	`ATOMIC_LOAD_ACQ
(
addr
);

1194 
l2
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1195 ià(
l
 !ğ
l2
) {

1196 
l
 = 
l2
;

1197 
»¡¬t_no_lßd
;

1200 *
time¡amp
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

1202 
	`PRINT_DEBUG2
("==> stm_vervalver(a=%p,l=%p,*l=%lu,d=%p-%lu)\n",

1203 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()value);

1205  
v®ue
;

1206 
	}
}

1212 
šlše
 
¡m_wÜd_t
 
	$¡m_–a¡ic_lßd
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
x
)

1214 
i
;

1215 
¡m_wÜd_t
 
v_x
;

1216 
¡m_wÜd_t
 *
y
;

1217 
¡m_wÜd_t
 
ts_x
 = 0;

1218 
¡m_wÜd_t
 
ts_y
 = 0;

1220 
TX_GET
;

1223 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1225 
	`PRINT_DEBUG2
("==> stm_–a¡ic_lßdÑ=%p[%lu-%lu],a=%p)\n", 
tx
,

1226 ()
tx
->
¡¬t
, (éx->
’d
, 
addr
);

1228 
v_x
 = 
	`¡m_v”v®v”
(
x
, &
ts_x
);

1230 ià(
ts_x
 > 
tx
->
¡¬t
) {

1232 
i
=0; i<
ELASTICITY
; i++) {

1233 ià((
y
=
tx
->
Ï¡¿ddr
[
i
])) {

1234 
	`¡m_v”v®v”
(
y
, &
ts_y
);

1235 ià(
ts_y
 > 
tx
->
¡¬t
) {

1236 
tx
->
abÜts_ro
++;

1237 
	`¡m_rŞlback
(
tx
);

1242 
tx
->
¡¬t
 = 
ts_x
;

1246 
tx
->
Ï¡¿ddr
[tx->
m¬k”
] = (
¡m_wÜd_t
 *)
x
;

1248 
tx
->
m¬k”
 = ++tx->m¬k” % 
ELASTICITY
;

1250  
v_x
;

1251 
	}
}

1257 
šlše
 
¡m_wÜd_t
 
	$¡m_nÜm®_lßd
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
)

1259 vŞ©
¡m_wÜd_t
 *
lock
;

1260 
¡m_wÜd_t
 
l
, 
l2
, 
v®ue
, 
v”siÚ
;

1261 
r_’Œy_t
 *
r
;

1262 
w_’Œy_t
 *
w
;

1263 
TX_GET
;

1265 
	`PRINT_DEBUG2
("==> stm_nÜm®_lßdÑ=%p[%lu-%lu],a=%p)\n", 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
);

1268 
	`as£¹
(
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1271 
lock
 = 
	`GET_LOCK
(
addr
);

1276 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1277 
»¡¬t_no_lßd
:

1278 ià(
	`LOCK_GET_OWNED
(
l
)) {

1281 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

1283 ià(
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
) {

1286 ià(
addr
 =ğ
w
->addr) {

1288 
v®ue
 = (
w
->
mask
 =ğ0 ? 
	`ATOMIC_LOAD
(
addr
) : w->value);

1291 ià(
w
->
Ãxt
 =ğ
NULL
) {

1293 
v®ue
 = 
	`ATOMIC_LOAD
(
addr
);

1296 
w
 = w->
Ãxt
;

1299 
	`PRINT_DEBUG2
("==> stm_normal_load(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu)\n",

1300 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()value);

1301  
v®ue
;

1304 
tx
->
abÜts_locked_»ad
++;

1305 
	`¡m_rŞlback
(
tx
);

1309 
v®ue
 = 
	`ATOMIC_LOAD_ACQ
(
addr
);

1310 
l2
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1311 ià(
l
 !ğ
l2
) {

1312 
l
 = 
l2
;

1313 
»¡¬t_no_lßd
;

1316 
v”siÚ
 = 
	`LOCK_GET_TIMESTAMP
(
l
);

1318 ià(
v”siÚ
 > 
tx
->
’d
) {

1320 ià(
tx
->
ro
 || !tx->
ÿn_ex‹nd
 || !
	`¡m_ex‹nd
(tx)) {

1322 
tx
->
abÜts_v®id©e_»ad
++;

1323 
	`¡m_rŞlback
(
tx
);

1329 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1330 ià(
l
 !ğ
l2
) {

1331 
l
 = 
l2
;

1332 
»¡¬t_no_lßd
;

1339 ià(!
tx
->
ro
) {

1341 ià(
tx
->
r_£t
.
nb_’Œ›s
 =ğtx->r_£t.
size
)

1342 
	`¡m_®loÿ‹_rs_’Œ›s
(
tx
, 1);

1343 
r
 = &
tx
->
r_£t
.
’Œ›s
[tx->r_£t.
nb_’Œ›s
++];

1344 
r
->
v”siÚ
 = version;

1345 
r
->
lock
 =†ock;

1348 
	`PRINT_DEBUG2
("==> stm_normal_load(t=%p[%lu-%lu],a=%p,l=%p,*l=%lu,d=%p-%lu,v=%lu)\n",

1349 
tx
, (éx->
¡¬t
, (éx->
’d
, 
addr
, 
lock
, ()
l
, (*)
v®ue
, ()v®ue, ()
v”siÚ
);

1351  
v®ue
;

1352 
	}
}

1358 
¡m_wÜd_t
 
	$¡m_lßd
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
) {

1359 
TX_GET
;

1360 ià(
tx
->
ty³
 =ğ
NL
è 
	`¡m_nÜm®_lßd
(
addr
);

1361  
	`¡m_–a¡ic_lßd
(
addr
);

1362 
	}
}

1368 
šlše
 
	$¡m_–a¡ic_¡Üe
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
)

1370 
i
;

1371 
¡m_wÜd_t
 
ts_x
;

1372 vŞ©
¡m_wÜd_t
 *
lock
;

1373 
¡m_wÜd_t
 
l
;

1374 
w_’Œy_t
 *
w
;

1376 
TX_GET
;

1378 
	`PRINT_DEBUG2
("==> stm_–a¡ic_¡ÜeÑ=%p[%lu-%lu],a=%p)\n", 
tx
,

1379 ()
tx
->
¡¬t
, (éx->
’d
, 
addr
);

1381 
tx
->
ty³
 = 
NL
;

1382 
	`¡m_wr™e
(
tx
, 
addr
, 
v®ue
, 
mask
);

1385 
i
=0; i<
ELASTICITY
; i++) {

1387 ià(
tx
->
Ï¡¿ddr
[
i
]) {

1388 
lock
 = 
	`GET_LOCK
(
tx
->
Ï¡¿ddr
[
i
]);

1389 
l
 = 
	`ATOMIC_LOAD_ACQ
(
lock
);

1390 ià(
	`LOCK_GET_OWNED
(
l
)) {

1392 
w
 = (
w_’Œy_t
 *)
	`LOCK_GET_ADDR
(
l
);

1394 ià((
tx
->
w_£t
.
’Œ›s
 <ğ
w
 && w <x->w_£t.’Œ› +x->w_£t.
nb_’Œ›s
))

1397 
tx
->
abÜts_locked_wr™e
++;

1398 
	`¡m_rŞlback
(
tx
);

1402 
ts_x
 = (
¡m_wÜd_t
)
	`LOCK_GET_TIMESTAMP
(
l
);

1403 ià(
ts_x
 > 
tx
->
¡¬t
) {

1405 
tx
->
abÜts_v®id©e_wr™e
++;

1406 
	`¡m_rŞlback
(
tx
);

1412 
	`mem£t
(
tx
->
Ï¡¿ddr
, 0, 
ELASTICITY
 * (*));

1415 
	}
}

1421 
šlše
 
	$¡m_nÜm®_¡Üe
(vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
)

1423 
TX_GET
;

1424 
	`¡m_wr™e
(
tx
, 
addr
, 
v®ue
, ~(
¡m_wÜd_t
)0);

1425 
	}
}

1431 
	$¡m_¡Üe
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
)

1433 
TX_GET
;

1434 ià(
tx
->
ty³
 =ğ
EL
è
	`¡m_–a¡ic_¡Üe
(
addr
, 
v®ue
, ~(
¡m_wÜd_t
)0);

1435 
	`¡m_wr™e
(
tx
, 
addr
, 
v®ue
, ~(
¡m_wÜd_t
)0);

1436 
	}
}

1442 
	$¡m_¡Üe2
(
TXPARAMS
 vŞ©
¡m_wÜd_t
 *
addr
, stm_wÜd_ˆ
v®ue
, stm_wÜd_ˆ
mask
)

1444 
TX_GET
;

1445 ià(
tx
->
ty³
 =ğ
EL
è
	`¡m_–a¡ic_¡Üe
(
addr
, 
v®ue
, 
mask
);

1446 
	`¡m_wr™e
(
tx
, 
addr
, 
v®ue
, 
mask
);

1447 
	}
}

1452 
	$¡m_aùive
(
TXPARAM
)

1454 
TX_GET
;

1456  (
tx
->
¡©us
 =ğ
TX_ACTIVE
);

1457 
	}
}

1462 
	$¡m_abÜ‹d
(
TXPARAM
)

1464 
TX_GET
;

1466  (
tx
->
¡©us
 =ğ
TX_ABORTED
);

1467 
	}
}

1472 
sigjmp_buf
 *
	$¡m_g‘_’v
(
TXPARAM
)

1474 
TX_GET
;

1476  
tx
->
Ã¡šg
 =ğ0 ? &tx->
’v
 : 
NULL
;

1477 
	}
}

1482 
¡m_tx_©Œ_t
 *
	$¡m_g‘_©Œibu‹s
(
TXPARAM
)

1484 
TX_GET
;

1486  
tx
->
©Œ
;

1487 
	}
}

1492 
	$¡m_g‘_¡©s
(
TXPARAMS
 cÚ¡ *
Çme
, *
v®
)

1494 
TX_GET
;

1496 ià(
	`¡rcmp
("»ad_£t_size", 
Çme
) == 0) {

1497 *(*)
v®
 = 
tx
->
r_£t
.
size
;

1500 ià(
	`¡rcmp
("wr™e_£t_size", 
Çme
) == 0) {

1501 *(*)
v®
 = 
tx
->
w_£t
.
size
;

1504 ià(
	`¡rcmp
("»ad_£t_nb_’Œ›s", 
Çme
) == 0) {

1505 *(*)
v®
 = 
tx
->
r_£t
.
nb_’Œ›s
;

1508 ià(
	`¡rcmp
("wr™e_£t_nb_’Œ›s", 
Çme
) == 0) {

1509 *(*)
v®
 = 
tx
->
w_£t
.
nb_’Œ›s
;

1512 ià(
	`¡rcmp
("»ad_Úly", 
Çme
) == 0) {

1513 *(*)
v®
 = 
tx
->
ro
;

1516 ià(
	`¡rcmp
("nb_abÜts", 
Çme
) == 0) {

1517 *(*)
v®
 = 
tx
->
abÜts
;

1520 ià(
	`¡rcmp
("nb_abÜts_ro", 
Çme
) == 0) {

1521 *(*)
v®
 = 
tx
->
abÜts_ro
;

1524 ià(
	`¡rcmp
("nb_abÜts_locked_»ad", 
Çme
) == 0) {

1525 *(*)
v®
 = 
tx
->
abÜts_locked_»ad
;

1528 ià(
	`¡rcmp
("nb_abÜts_locked_wr™e", 
Çme
) == 0) {

1529 *(*)
v®
 = 
tx
->
abÜts_locked_wr™e
;

1532 ià(
	`¡rcmp
("nb_abÜts_v®id©e_»ad", 
Çme
) == 0) {

1533 *(*)
v®
 = 
tx
->
abÜts_v®id©e_»ad
;

1536 ià(
	`¡rcmp
("nb_abÜts_v®id©e_wr™e", 
Çme
) == 0) {

1537 *(*)
v®
 = 
tx
->
abÜts_v®id©e_wr™e
;

1540 ià(
	`¡rcmp
("nb_abÜts_v®id©e_comm™", 
Çme
) == 0) {

1541 *(*)
v®
 = 
tx
->
abÜts_v®id©e_comm™
;

1544 ià(
	`¡rcmp
("nb_abÜts_šv®id_memÜy", 
Çme
) == 0) {

1545 *(*)
v®
 = 
tx
->
abÜts_šv®id_memÜy
;

1548 ià(
	`¡rcmp
("nb_abÜts_doubË_wr™e", 
Çme
) == 0) {

1549 *(*)
v®
 = 
tx
->
abÜts_doubË_wr™e
;

1552 ià(
	`¡rcmp
("nb_abÜts_»®loÿ‹", 
Çme
) == 0) {

1553 *(*)
v®
 = 
tx
->
abÜts_»®loÿ‹
;

1556 ià(
	`¡rcmp
("nb_abÜts_rŞlov”", 
Çme
) == 0) {

1557 *(*)
v®
 = 
tx
->
abÜts_rŞlov”
;

1560 ià(
	`¡rcmp
("max_»Œ›s", 
Çme
) == 0) {

1561 *(*)
v®
 = 
tx
->
max_»Œ›s
;

1565 
	}
}

1570 
	$¡m_g‘_·¿m‘”
(cÚ¡ *
Çme
, *
v®
)

1572 ià(
	`¡rcmp
("cÚ‹ÁiÚ_mªag”", 
Çme
) == 0) {

1573 *(cÚ¡ **)
v®
 = 0;

1576 ià(
	`¡rcmp
("design", 
Çme
) == 0) {

1577 *(cÚ¡ **)
v®
 = 0;

1580 ià(
	`¡rcmp
("š™Ÿl_rw_£t_size", 
Çme
) == 0) {

1581 *(*)
v®
 = 
RW_SET_SIZE
;

1584 #ifdeà
COMPILE_FLAGS


1585 ià(
	`¡rcmp
("compe_æags", 
Çme
) == 0) {

1586 *(cÚ¡ **)
v®
 = 
	`XSTR
(
COMPILE_FLAGS
);

1591 
	}
}

1596 
	$¡m_£t_·¿m‘”
(cÚ¡ *
Çme
, *
v®
)

1599 
	}
}

1604 
	$¡m_ü—‹_¥ecific
()

1606 ià(
nb_¥ecific
 >ğ
MAX_SPECIFIC
) {

1607 
	`årštf
(
¡d”r
, "Error: maximum‚umber of specific slots„eached\n");

1610  
nb_¥ecific
++;

1611 
	}
}

1616 
	$¡m_£t_¥ecific
(
TXPARAMS
 
key
, *
d©a
)

1618 
TX_GET
;

1620 
	`as£¹
 (
key
 >ğ0 && key < 
nb_¥ecific
);

1621 
tx
->
d©a
[
key
] = data;

1622 
	}
}

1627 *
	$¡m_g‘_¥ecific
(
TXPARAMS
 
key
)

1629 
TX_GET
;

1631 
	`as£¹
 (
key
 >ğ0 && key < 
nb_¥ecific
);

1632  
tx
->
d©a
[
key
];

1633 
	}
}

1638 
¡m_»gi¡”
((*
Ú_th»ad_š™
)(
TXPARAMS
 *
¬g
),

1639 (*
Ú_th»ad_ex™
)(
TXPARAMS
 *
¬g
),

1640 (*
Ú_¡¬t
)(
TXPARAMS
 *
¬g
),

1641 (*
Ú_comm™
)(
TXPARAMS
 *
¬g
),

1642 (*
Ú_abÜt
)(
TXPARAMS
 *
¬g
),

1643 *
¬g
)

1645 ià((
Ú_th»ad_š™
 !ğ
NULL
 && 
nb_š™_cb
 >ğ
MAX_CB
) ||

1646 (
Ú_th»ad_ex™
 !ğ
NULL
 && 
nb_ex™_cb
 >ğ
MAX_CB
) ||

1647 (
Ú_¡¬t
 !ğ
NULL
 && 
nb_¡¬t_cb
 >ğ
MAX_CB
) ||

1648 (
Ú_comm™
 !ğ
NULL
 && 
nb_comm™_cb
 >ğ
MAX_CB
) ||

1649 (
Ú_abÜt
 !ğ
NULL
 && 
nb_abÜt_cb
 >ğ
MAX_CB
)) {

1650 
	`årštf
(
¡d”r
, "Error: maximum‚umber of modules„eached\n");

1654 ià(
Ú_th»ad_š™
 !ğ
NULL
) {

1655 
š™_cb
[
nb_š™_cb
].
f
 = 
Ú_th»ad_š™
;

1656 
š™_cb
[
nb_š™_cb
++].
¬g
 =‡rg;

1659 ià(
Ú_th»ad_ex™
 !ğ
NULL
) {

1660 
ex™_cb
[
nb_ex™_cb
].
f
 = 
Ú_th»ad_ex™
;

1661 
ex™_cb
[
nb_ex™_cb
++].
¬g
 =‡rg;

1664 ià(
Ú_¡¬t
 !ğ
NULL
) {

1665 
¡¬t_cb
[
nb_¡¬t_cb
].
f
 = 
Ú_¡¬t
;

1666 
¡¬t_cb
[
nb_¡¬t_cb
++].
¬g
 =‡rg;

1669 ià(
Ú_comm™
 !ğ
NULL
) {

1670 
comm™_cb
[
nb_comm™_cb
].
f
 = 
Ú_comm™
;

1671 
comm™_cb
[
nb_comm™_cb
++].
¬g
 =‡rg;

1674 ià(
Ú_abÜt
 !ğ
NULL
) {

1675 
abÜt_cb
[
nb_abÜt_cb
].
f
 = 
Ú_abÜt
;

1676 
abÜt_cb
[
nb_abÜt_cb
++].
¬g
 =‡rg;

1680 
	}
}

1685 
¡m_wÜd_t
 
	$¡m_g‘_şock
()

1687  
GET_CLOCK
;

1688 
	}
}

1693 
¡m_tx_t
 *
	$¡m_cu¼’t_tx
()

1695  
	`¡m_g‘_tx
();

1696 
	}
}

	@utils/estm-0.3.0/src/wrappers.c

22 
	~<as£¹.h
>

24 
	~"w¿µ”s.h
"

26 
	#COMPILE_TIME_ASSERT
(
´ed
è0è{ 0: ´ed: ; }

	)

28 
	ucÚv”t_64
 {

29 
ušt64_t
 
	mu64
;

30 
ušt32_t
 
	mu32
[2];

31 
ušt16_t
 
	mu16
[4];

32 
ušt8_t
 
	mu8
[8];

33 
št64_t
 
	ms64
;

34 
	md
;

35 } 
	tcÚv”t_64_t
;

37 
	ucÚv”t_32
 {

38 
ušt32_t
 
	mu32
;

39 
ušt16_t
 
	mu16
[2];

40 
ušt8_t
 
	mu8
[4];

41 
št32_t
 
	ms32
;

42 
	mf
;

43 } 
	tcÚv”t_32_t
;

45 
	ucÚv”t_16
 {

46 
ušt16_t
 
	mu16
;

47 
št16_t
 
	ms16
;

48 } 
	tcÚv”t_16_t
;

50 
	ucÚv”t_8
 {

51 
ušt8_t
 
	mu8
;

52 
št8_t
 
	ms8
;

53 } 
	tcÚv”t_8_t
;

55 
	ucÚv”t
 {

56 
¡m_wÜd_t
 
	mw
;

57 
ušt8_t
 
	mb
[(
¡m_wÜd_t
)];

58 } 
	tcÚv”t_t
;

64 
ušt8_t
 
	$¡m_lßd8
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
)

66 ià((
¡m_wÜd_t
) == 4) {

67 
cÚv”t_32_t
 
v®
;

68 
v®
.
u32
 = (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x03));

69  
v®
.
u8
[(
ušŒ_t
)
addr
 & 0x03];

71 
cÚv”t_64_t
 
v®
;

72 
v®
.
u64
 = (
ušt64_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x07));

73  
v®
.
u8
[(
ušŒ_t
)
addr
 & 0x07];

75 
	}
}

77 
ušt16_t
 
	$¡m_lßd16
(
TXPARAMS
 vŞ©
ušt16_t
 *
addr
)

79 ià(((
ušŒ_t
)
addr
 & 0x01) != 0) {

80 
ušt16_t
 
v®
;

81 
	`¡m_lßd_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®
, (
ušt16_t
));

82  
v®
;

83 } ià((
¡m_wÜd_t
) == 4) {

84 
cÚv”t_32_t
 
v®
;

85 
v®
.
u32
 = (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x03));

86  
v®
.
u16
[((
ušŒ_t
)
addr
 & 0x03) >> 1];

88 
cÚv”t_64_t
 
v®
;

89 
v®
.
u64
 = (
ušt64_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x07));

90  
v®
.
u16
[((
ušŒ_t
)
addr
 & 0x07) >> 1];

92 
	}
}

94 
ušt32_t
 
	$¡m_lßd32
(
TXPARAMS
 vŞ©
ušt32_t
 *
addr
)

96 ià(((
ušŒ_t
)
addr
 & 0x03) != 0) {

97 
ušt32_t
 
v®
;

98 
	`¡m_lßd_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®
, (
ušt32_t
));

99  
v®
;

100 } ià((
¡m_wÜd_t
) == 4) {

101  (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
);

103 
cÚv”t_64_t
 
v®
;

104 
v®
.
u64
 = (
ušt64_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)0x07));

105  
v®
.
u32
[((
ušŒ_t
)
addr
 & 0x07) >> 2];

107 
	}
}

109 
ušt64_t
 
	$¡m_lßd64
(
TXPARAMS
 vŞ©
ušt64_t
 *
addr
)

111 ià(((
ušŒ_t
)
addr
 & 0x07) != 0) {

112 
ušt64_t
 
v®
;

113 
	`¡m_lßd_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®
, (
ušt64_t
));

114  
v®
;

115 } ià((
¡m_wÜd_t
) == 4) {

116 
cÚv”t_64_t
 
v®
;

117 
v®
.
u32
[0] = (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
);

118 
v®
.
u32
[1] = (
ušt32_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
 + 1);

119  
v®
.
u64
;

121  (
ušt64_t
)
	`¡m_lßd
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
);

123 
	}
}

125 
	$¡m_lßd_ch¬
(
TXPARAMS
 vŞ©*
addr
)

127 
cÚv”t_8_t
 
v®
;

128 
v®
.
u8
 = 
	`¡m_lßd8
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
);

129  
v®
.
s8
;

130 
	}
}

132 
	$¡m_lßd_uch¬
(
TXPARAMS
 vŞ©*
addr
)

134  ()
	`¡m_lßd8
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
);

135 
	}
}

137 
	$¡m_lßd_shÜt
(
TXPARAMS
 vŞ©*
addr
)

139 
cÚv”t_16_t
 
v®
;

140 
v®
.
u16
 = 
	`¡m_lßd16
(
	`TXARGS
 (vŞ©
ušt16_t
 *)
addr
);

141  
v®
.
s16
;

142 
	}
}

144 
	$¡m_lßd_ushÜt
(
TXPARAMS
 vŞ©*
addr
)

146  ()
	`¡m_lßd16
(
	`TXARGS
 (vŞ©
ušt16_t
 *)
addr
);

147 
	}
}

149 
	$¡m_lßd_št
(
TXPARAMS
 vŞ©*
addr
)

151 
cÚv”t_32_t
 
v®
;

152 
v®
.
u32
 = 
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

153  
v®
.
s32
;

154 
	}
}

156 
	$¡m_lßd_ušt
(
TXPARAMS
 vŞ©*
addr
)

158  ()
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

159 
	}
}

161 
	$¡m_lßd_lÚg
(
TXPARAMS
 vŞ©*
addr
)

164 
cÚv”t_32_t
 
v®
;

165 
v®
.
u32
 = 
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

166  
v®
.
s32
;

168 
cÚv”t_64_t
 
v®
;

169 
v®
.
u64
 = 
	`¡m_lßd64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
);

170  
v®
.
s64
;

172 
	}
}

174 
	$¡m_lßd_ulÚg
(
TXPARAMS
 vŞ©*
addr
)

177  ()
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

179  ()
	`¡m_lßd64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
);

181 
	}
}

183 
	$¡m_lßd_æßt
(
TXPARAMS
 vŞ©*
addr
)

185 
cÚv”t_32_t
 
v®
;

186 
v®
.
u32
 = 
	`¡m_lßd32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
);

187  
v®
.
f
;

188 
	}
}

190 
	$¡m_lßd_doubË
(
TXPARAMS
 vŞ©*
addr
)

192 
cÚv”t_64_t
 
v®
;

193 
v®
.
u64
 = 
	`¡m_lßd64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
);

194  
v®
.
d
;

195 
	}
}

197 *
	$¡m_lßd_±r
(
TXPARAMS
 vŞ©**
addr
)

199 uniÚ { 
¡m_wÜd_t
 
w
; *
v
; } 
cÚv”t
;

200 
cÚv”t
.
w
 = 
	`¡m_lßd
(
	`TXARGS
 (
¡m_wÜd_t
 *)
addr
);

201  
cÚv”t
.
v
;

202 
	}
}

204 
	$¡m_lßd_by‹s
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ*
buf
, 
size_t
 
size
)

206 
cÚv”t_t
 
v®
;

207 
i
;

208 
¡m_wÜd_t
 *
a
;

210 ià(
size
 == 0)

212 
i
 = (
ušŒ_t
)
addr
 & ((
¡m_wÜd_t
) - 1);

213 ià(
i
 != 0) {

215 
a
 = (
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)((stm_word_t) - 1));

216 
v®
.
w
 = 
	`¡m_lßd
(
TXARGS
 
a
++);

217 ; 
i
 < (
¡m_wÜd_t
è&& 
size
 > 0; i++, size--)

218 *
buf
++ = 
v®
.
b
[
i
];

220 
a
 = (
¡m_wÜd_t
 *)
addr
;

222 
size
 >ğ(
¡m_wÜd_t
)) {

223 #ifdeà
ALLOW_MISALIGNED_ACCESSES


224 *((
¡m_wÜd_t
 *)
buf
èğ
	`¡m_lßd
(
TXARGS
 
a
++);

225 
buf
 +ğ(
¡m_wÜd_t
);

227 
v®
.
w
 = 
	`¡m_lßd
(
TXARGS
 
a
++);

228 
i
 = 0; i < (
¡m_wÜd_t
); i++)

229 *
buf
++ = 
v®
.
b
[
i
];

231 
size
 -ğ(
¡m_wÜd_t
);

233 ià(
size
 > 0) {

235 
v®
.
w
 = 
	`¡m_lßd
(
TXARGS
 
a
);

236 
i
 = 0;

237 
i
 = 0; 
size
 > 0; i++, size--)

238 *
buf
++ = 
v®
.
b
[
i
];

240 
	}
}

246 
	$¡m_¡Üe8
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ
v®ue
)

248 ià((
¡m_wÜd_t
) == 4) {

249 
cÚv”t_32_t
 
v®
, 
mask
;

250 
v®
.
u8
[(
ušŒ_t
)
addr
 & 0x03] = 
v®ue
;

251 
mask
.
u32
 = 0;

252 
mask
.
u8
[(
ušŒ_t
)
addr
 & 0x03] = ~(
ušt8_t
)0;

253 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x03), (¡m_wÜd_t)
v®
.
u32
, (¡m_wÜd_t)
mask
.u32);

255 
cÚv”t_64_t
 
v®
, 
mask
;

256 
v®
.
u8
[(
ušŒ_t
)
addr
 & 0x07] = 
v®ue
;

257 
mask
.
u64
 = 0;

258 
mask
.
u8
[(
ušŒ_t
)
addr
 & 0x07] = ~(
ušt8_t
)0;

259 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x07), (¡m_wÜd_t)
v®
.
u64
, (¡m_wÜd_t)
mask
.u64);

261 
	}
}

263 
	$¡m_¡Üe16
(
TXPARAMS
 vŞ©
ušt16_t
 *
addr
, ušt16_ˆ
v®ue
)

265 ià(((
ušŒ_t
)
addr
 & 0x01) != 0) {

266 
	`¡m_¡Üe_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®ue
, (
ušt16_t
));

267 } ià((
¡m_wÜd_t
) == 4) {

268 
cÚv”t_32_t
 
v®
, 
mask
;

269 
v®
.
u16
[((
ušŒ_t
)
addr
 & 0x03è>> 1] = 
v®ue
;

270 
mask
.
u32
 = 0;

271 
mask
.
u16
[((
ušŒ_t
)
addr
 & 0x03è>> 1] = ~(
ušt16_t
)0;

272 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x03), (¡m_wÜd_t)
v®
.
u32
, (¡m_wÜd_t)
mask
.u32);

274 
cÚv”t_64_t
 
v®
, 
mask
;

275 
v®
.
u16
[((
ušŒ_t
)
addr
 & 0x07è>> 1] = 
v®ue
;

276 
mask
.
u64
 = 0;

277 
mask
.
u16
[((
ušŒ_t
)
addr
 & 0x07è>> 1] = ~(
ušt16_t
)0;

278 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x07), (¡m_wÜd_t)
v®
.
u64
, (¡m_wÜd_t)
mask
.u64);

280 
	}
}

282 
	$¡m_¡Üe32
(
TXPARAMS
 vŞ©
ušt32_t
 *
addr
, ušt32_ˆ
v®ue
)

284 ià(((
ušŒ_t
)
addr
 & 0x03) != 0) {

285 
	`¡m_¡Üe_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®ue
, (
ušt32_t
));

286 } ià((
¡m_wÜd_t
) == 4) {

287 
	`¡m_¡Üe
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
, (¡m_wÜd_t)
v®ue
);

289 
cÚv”t_64_t
 
v®
, 
mask
;

290 
v®
.
u32
[((
ušŒ_t
)
addr
 & 0x07è>> 2] = 
v®ue
;

291 
mask
.
u64
 = 0;

292 
mask
.
u32
[((
ušŒ_t
)
addr
 & 0x07è>> 2] = ~(
ušt32_t
)0;

293 
	`¡m_¡Üe2
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(ušŒ_t)0x07), (¡m_wÜd_t)
v®
.
u64
, (¡m_wÜd_t)
mask
.u64);

295 
	}
}

297 
	$¡m_¡Üe64
(
TXPARAMS
 vŞ©
ušt64_t
 *
addr
, ušt64_ˆ
v®ue
)

299 ià(((
ušŒ_t
)
addr
 & 0x07) != 0) {

300 
	`¡m_¡Üe_by‹s
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_ˆ*)&
v®ue
, (
ušt64_t
));

301 } ià((
¡m_wÜd_t
) == 4) {

302 
cÚv”t_64_t
 
v®
;

303 
v®
.
u64
 = 
v®ue
;

304 
	`¡m_¡Üe
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
, (¡m_wÜd_t)
v®
.
u32
[0]);

305 
	`¡m_¡Üe
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
 + 1, (¡m_wÜd_t)
v®
.
u32
[1]);

307  
	`¡m_¡Üe
(
	`TXARGS
 (vŞ©
¡m_wÜd_t
 *)
addr
, (¡m_wÜd_t)
v®ue
);

309 
	}
}

311 
	$¡m_¡Üe_ch¬
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

313 
cÚv”t_8_t
 
v®
;

314 
v®
.
s8
 = 
v®ue
;

315 
	`¡m_¡Üe8
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, 
v®
.
u8
);

316 
	}
}

318 
	$¡m_¡Üe_uch¬
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

320 
	`¡m_¡Üe8
(
	`TXARGS
 (vŞ©
ušt8_t
 *)
addr
, (ušt8_t)
v®ue
);

321 
	}
}

323 
	$¡m_¡Üe_shÜt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

325 
cÚv”t_16_t
 
v®
;

326 
v®
.
s16
 = 
v®ue
;

327 
	`¡m_¡Üe16
(
	`TXARGS
 (vŞ©
ušt16_t
 *)
addr
, 
v®
.
u16
);

328 
	}
}

330 
	$¡m_¡Üe_ushÜt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

332 
	`¡m_¡Üe16
(
	`TXARGS
 (vŞ©
ušt16_t
 *)
addr
, (ušt16_t)
v®ue
);

333 
	}
}

335 
	$¡m_¡Üe_št
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

337 
cÚv”t_32_t
 
v®
;

338 
v®
.
s32
 = 
v®ue
;

339 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, 
v®
.
u32
);

340 
	}
}

342 
	$¡m_¡Üe_ušt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

344 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, (ušt32_t)
v®ue
);

345 
	}
}

347 
	$¡m_¡Üe_lÚg
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

350 
cÚv”t_32_t
 
v®
;

351 
v®
.
s32
 = 
v®ue
;

352 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, 
v®
.
u32
);

354 
cÚv”t_64_t
 
v®
;

355 
v®
.
s64
 = 
v®ue
;

356 
	`¡m_¡Üe64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
, 
v®
.
u64
);

358 
	}
}

360 
	$¡m_¡Üe_ulÚg
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

363 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, (ušt32_t)
v®ue
);

365 
	`¡m_¡Üe64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
, (ušt64_t)
v®ue
);

367 
	}
}

369 
	$¡m_¡Üe_æßt
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

371 
cÚv”t_32_t
 
v®
;

372 
v®
.
f
 = 
v®ue
;

373 
	`¡m_¡Üe32
(
	`TXARGS
 (vŞ©
ušt32_t
 *)
addr
, 
v®
.
u32
);

374 
	}
}

376 
	$¡m_¡Üe_doubË
(
TXPARAMS
 vŞ©*
addr
, 
v®ue
)

378 
cÚv”t_64_t
 
v®
;

379 
v®
.
d
 = 
v®ue
;

380 
	`¡m_¡Üe64
(
	`TXARGS
 (vŞ©
ušt64_t
 *)
addr
, 
v®
.
u64
);

381 
	}
}

383 
	$¡m_¡Üe_±r
(
TXPARAMS
 vŞ©**
addr
, *
v®ue
)

385 uniÚ { 
¡m_wÜd_t
 
w
; *
v
; } 
cÚv”t
;

386 
cÚv”t
.
v
 = 
v®ue
;

387 
	`¡m_¡Üe
(
	`TXARGS
 (
¡m_wÜd_t
 *)
addr
, 
cÚv”t
.
w
);

388 
	}
}

390 
	$¡m_¡Üe_by‹s
(
TXPARAMS
 vŞ©
ušt8_t
 *
addr
, ušt8_ˆ*
buf
, 
size_t
 
size
)

392 
cÚv”t_t
 
v®
, 
mask
;

393 
i
;

394 
¡m_wÜd_t
 *
a
;

396 ià(
size
 == 0)

398 
i
 = (
ušŒ_t
)
addr
 & ((
¡m_wÜd_t
) - 1);

399 ià(
i
 != 0) {

401 
a
 = (
¡m_wÜd_t
 *)((
ušŒ_t
)
addr
 & ~(uintptr_t)((stm_word_t) - 1));

402 
v®
.
w
 = 
mask
.w = 0;

403 ; 
i
 < (
¡m_wÜd_t
è&& 
size
 > 0; i++, size--) {

404 
mask
.
b
[
i
] = 0xFF;

405 
v®
.
b
[
i
] = *
buf
++;

407 
	`¡m_¡Üe2
(
TXARGS
 
a
++, 
v®
.
w
, 
mask
.w);

409 
a
 = (
¡m_wÜd_t
 *)
addr
;

411 
size
 >ğ(
¡m_wÜd_t
)) {

412 #ifdeà
ALLOW_MISALIGNED_ACCESSES


413 
	`¡m_¡Üe
(
TXARGS
 
a
++, *((
¡m_wÜd_t
 *)
buf
));

414 
buf
 +ğ(
¡m_wÜd_t
);

416 
i
 = 0; i < (
¡m_wÜd_t
); i++)

417 
v®
.
b
[
i
] = *
buf
++;

418 
	`¡m_¡Üe
(
TXARGS
 
a
++, 
v®
.
w
);

420 
size
 -ğ(
¡m_wÜd_t
);

422 ià(
size
 > 0) {

424 
v®
.
w
 = 
mask
.w = 0;

425 
i
 = 0; 
size
 > 0; i++, size--) {

426 
mask
.
b
[
i
] = 0xFF;

427 
v®
.
b
[
i
] = *
buf
++;

429 
	`¡m_¡Üe2
(
TXARGS
 
a
, 
v®
.
w
, 
mask
.w);

431 
	}
}

	@utils/versioned-lock/versioned-lock.c

22 
	~"v”siÚed-lock.h
"

24 
v”lock_t
 
g‘_v”siÚ
(
_Atomic
(v”lock_t)* 
lock
) {

25  (
©omic_lßd
(
lock
è& ~((
	gv”lock_t
)1));

28 
Œy_lock_©_v”siÚ
(
_Atomic
(
v”lock_t
)* 
lock
, v”lock_ˆ
v”siÚ
) {

29  
©omic_com·»_exchªge_¡rÚg
(
lock
, &
v”siÚ
, version+1);

32 
¥šlock
(
_Atomic
(
v”lock_t
)* 
lock
) {

33 !
Œy_lock_©_v”siÚ
(
lock
, 
g‘_v”siÚ
(lock))) {};

36 
uÆock_ªd_šüem’t_v”siÚ
(
_Atomic
(
v”lock_t
)* 
lock
) {

37 
©omic_ãtch_add
(
lock
, 1);

40 
v”lock_t
 
uÆock_šüem’t_ªd_g‘_v”siÚ
(
_Atomic
(v”lock_t)* 
lock
) {

41 
v”lock_t
 
	gÃxt_v”siÚ
 = 
g‘_v”siÚ
(
lock
)+2;

42 
©omic_ãtch_add
(
lock
, 1);

43  
	gÃxt_v”siÚ
;

46 
uÆock_w™hout_šüem’t_v”siÚ
(
_Atomic
(
v”lock_t
)* 
lock
) {

47 
©omic_ãtch_sub
(
lock
, 1);

	@utils/versioned-lock/versioned-lock.h

22 #iâdeà
_VERSIONED_LOCK_H


23 
	#_VERSIONED_LOCK_H


	)

25 
	~<¡dšt.h
>

26 
	~<¡d©omic.h
>

28 
ušt32_t
 
	tv”lock_t
;

30 
v”lock_t
 
g‘_v”siÚ
(
_Atomic
(v”lock_t)* 
lock
);

31 
Œy_lock_©_v”siÚ
(
_Atomic
(
v”lock_t
)* 
lock
, v”lock_ˆ
v”siÚ
);

32 
¥šlock
(
_Atomic
(
v”lock_t
)* 
lock
);

33 
uÆock_ªd_šüem’t_v”siÚ
(
_Atomic
(
v”lock_t
)* 
lock
);

34 
v”lock_t
 
uÆock_šüem’t_ªd_g‘_v”siÚ
(
_Atomic
(v”lock_t)* 
lock
);

35 
uÆock_w™hout_šüem’t_v”siÚ
(
_Atomic
(
v”lock_t
)* 
lock
);

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


88 
	#as£¹
(
ex´
) \

89 ((
ex´
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£¹_ç
 (
	`__STRING
(
ex´
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£¹_³¼Ü
(
”ºum
) \

95 (!(
”ºum
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

118 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


120 #undeà
¡©ic_as£¹


121 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/atomic_ops.h

23 #iâdeà
AO_ATOMIC_OPS_H


24 
	#AO_ATOMIC_OPS_H


	)

26 
	~"©omic_İs/ao_v”siÚ.h
"

30 
	~<as£¹.h
>

31 
	~<¡ddef.h
>

155 
	#AO_t
 
size_t


	)

160 
	#AO_TS_INITIALIZER
 (
AO_t
)
AO_TS_CLEAR


	)

163 #ià(
defšed
(
__GNUC__
è|| defšed(
_MSC_VER
è|| defšed(
__INTEL_COMPILER
) \

164 || 
defšed
(
__DMC__
è|| defšed(
__WATCOMC__
)è&& !
	$defšed
(
AO_NO_INLINE
)

165 
	#AO_INLINE
 
__šlše


	)

166 #–ià
	`defšed
(
__sun
è&& !defšed(
AO_NO_INLINE
)

167 
	#AO_INLINE
 
šlše


	)

169 
	#AO_INLINE
 

	)

172 #ià
__GNUC__
 >ğ3 && !
	`defšed
(
LINT2
)

173 
	#AO_EXPECT_FALSE
(
ex´
è
	`__butš_ex³ù
Óx´, 0)

	)

176 
	#AO_EXPECT_FALSE
(
ex´
èÓx´)

	)

179 #ià
	`defšed
(
__GNUC__
è&& !defšed(
__INTEL_COMPILER
)

180 
	#AO_comp”_b¬r›r
(è
__asm__
 
	`__vŞ©e__
("" : : : "memÜy")

	)

181 #–ià
	`defšed
(
_MSC_VER
è|| defšed(
__DMC__
è|| defšed(
__BORLANDC__
) \

182 || 
	$defšed
(
__WATCOMC__
)

183 #ià
	`defšed
(
_AMD64_
è|| defšed(
_M_X64
è|| 
_MSC_VER
 >= 1400

184 #ià
	`defšed
(
_WIN32_WCE
)

186 #–ià
	`defšed
(
_MSC_VER
)

187 
	~<šŒš.h
>

189 #´agm¨
	`šŒšsic
(
_R—dWr™eB¬r›r
)

190 
	#AO_comp”_b¬r›r
(è
	`_R—dWr™eB¬r›r
()

	)

194 
	#AO_comp”_b¬r›r
(è
__asm
 { 
	}

	)
}

198 #–ià
defšed
(
__INTEL_COMPILER
)

199 
	#AO_comp”_b¬r›r
(è
	`__memÜy_b¬r›r
()

	)

201 #–ià
defšed
(
_HPUX_SOURCE
)

202 #ià
defšed
(
__Ÿ64
)

203 
	~<machše/sys/šlše.h
>

204 
	#AO_comp”_b¬r›r
(è
	`_Asm_sched_ãnû
()

	)

208 vŞ©
	gAO_b¬r›r_dummy
;

209 
	#AO_comp”_b¬r›r
(è()(
AO_b¬r›r_dummy
 = AO_b¬r›r_dummy)

	)

214 
	#AO_comp”_b¬r›r
(è
	`asm
("")

	)

217 #ià
defšed
(
AO_USE_PTHREAD_DEFS
)

218 
	~"©omic_İs/sysd•s/g’”ic_±h»ad.h
"

221 #ià(
defšed
(
__CC_ARM
è|| defšed(
__ARMCC__
)è&& !defšed(
__GNUC__
) \

222 && !
	$defšed
(
AO_USE_PTHREAD_DEFS
)

223 
	~"©omic_İs/sysd•s/¬mcc/¬m_v6.h
"

224 
	#AO_GENERALIZE_TWICE


	)

227 #ià
	`defšed
(
__GNUC__
è&& !defšed(
AO_USE_PTHREAD_DEFS
) \

228 && !
	$defšed
(
__INTEL_COMPILER
)

229 #ià
	`defšed
(
__i386__
)

233 
	~"©omic_İs/sysd•s/gcc/x86.h
"

235 #ià
	`defšed
(
__x86_64__
)

236 #ià(
__GNUC__
 > 4 || (__GNUC__ =ğ4 && 
__GNUC_MINOR__
 >= 2)) \

237 && !
	$defšed
(
AO_USE_SYNC_CAS_BUILTIN
)

239 
	#AO_USE_SYNC_CAS_BUILTIN


	)

241 
	~"©omic_İs/sysd•s/gcc/x86.h
"

243 #ià
	`defšed
(
__Ÿ64__
)

244 
	~"©omic_İs/sysd•s/gcc/Ÿ64.h
"

245 
	#AO_GENERALIZE_TWICE


	)

247 #ià
	`defšed
(
__hµa__
)

248 
	~"©omic_İs/sysd•s/gcc/hµa.h
"

249 
	#AO_CAN_EMUL_CAS


	)

251 #ià
	`defšed
(
__®pha__
)

252 
	~"©omic_İs/sysd•s/gcc/®pha.h
"

253 
	#AO_GENERALIZE_TWICE


	)

255 #ià
	`defšed
(
__s390__
)

256 
	~"©omic_İs/sysd•s/gcc/s390.h
"

258 #ià
	`defšed
(
__¥¬c__
)

259 
	~"©omic_İs/sysd•s/gcc/¥¬c.h
"

260 
	#AO_CAN_EMUL_CAS


	)

262 #ià
	`defšed
(
__m68k__
)

263 
	~"©omic_İs/sysd•s/gcc/m68k.h
"

265 #ià
	`defšed
(
__pow”pc__
è|| defšed(
__µc__
è|| defšed(
__PPC__
) \

266 || 
	`defšed
(
__pow”pc64__
è|| 
	$defšed
(
__µc64__
)

267 
	~"©omic_İs/sysd•s/gcc/pow”pc.h
"

269 #ià
	`defšed
(
__¯rch64__
)

270 
	~"©omic_İs/sysd•s/gcc/¯rch64.h
"

271 
	#AO_CAN_EMUL_CAS


	)

273 #ià
	`defšed
(
__¬m__
)

274 
	~"©omic_İs/sysd•s/gcc/¬m.h
"

275 
	#AO_CAN_EMUL_CAS


	)

277 #ià
	`defšed
(
__üis__
è|| defšed(
CRIS
)

278 
	~"©omic_İs/sysd•s/gcc/üis.h
"

279 
	#AO_GENERALIZE_TWICE


	)

281 #ià
	`defšed
(
__ms__
)

282 
	~"©omic_İs/sysd•s/gcc/ms.h
"

284 #ià
	`defšed
(
__sh__
è|| defšed(
SH4
)

285 
	~"©omic_İs/sysd•s/gcc/sh.h
"

286 
	#AO_CAN_EMUL_CAS


	)

288 #ià
	`defšed
(
__avr32__
)

289 
	~"©omic_İs/sysd•s/gcc/avr32.h
"

291 #ià
	`defšed
(
__hexagÚ__
)

292 
	~"©omic_İs/sysd•s/gcc/hexagÚ.h
"

296 #ià(
	`defšed
(
__IBMC__
è|| defšed(
__IBMCPP__
)è&& !defšed(
__GNUC__
) \

297 && !
	$defšed
(
AO_USE_PTHREAD_DEFS
)

298 #ià
	`defšed
(
__pow”pc__
è|| defšed(
__pow”pc
è|| defšed(
__µc__
) \

299 || 
	`defšed
(
__PPC__
è|| defšed(
_M_PPC
è|| defšed(
_ARCH_PPC
) \

300 || 
	$defšed
(
_ARCH_PWR
)

301 
	~"©omic_İs/sysd•s/ibmc/pow”pc.h
"

302 
	#AO_GENERALIZE_TWICE


	)

306 #ià
	`defšed
(
__INTEL_COMPILER
è&& !defšed(
AO_USE_PTHREAD_DEFS
)

307 #ià
	`defšed
(
__Ÿ64__
)

308 
	~"©omic_İs/sysd•s/icc/Ÿ64.h
"

309 
	#AO_GENERALIZE_TWICE


	)

311 #ià
	`defšed
(
__GNUC__
)

313 #ià
	`defšed
(
__i386__
)

314 
	~"©omic_İs/sysd•s/gcc/x86.h
"

316 #ià
	`defšed
(
__x86_64__
)

317 #ià(
__INTEL_COMPILER
 > 1110è&& !
	`defšed
(
AO_USE_SYNC_CAS_BUILTIN
)

318 
	#AO_USE_SYNC_CAS_BUILTIN


	)

320 
	~"©omic_İs/sysd•s/gcc/x86.h
"

325 #ià
	`defšed
(
_HPUX_SOURCE
è&& !defšed(
__GNUC__
è&& !defšed(
AO_USE_PTHREAD_DEFS
)

326 #ià
	`defšed
(
__Ÿ64
)

327 
	~"©omic_İs/sysd•s/hpc/Ÿ64.h
"

328 
	#AO_GENERALIZE_TWICE


	)

330 
	~"©omic_İs/sysd•s/hpc/hµa.h
"

331 
	#AO_CAN_EMUL_CAS


	)

335 #ià
	`defšed
(
_MSC_VER
è|| defšed(
__DMC__
è|| defšed(
__BORLANDC__
) \

336 || (
	`defšed
(
__WATCOMC__
è&& 
	$defšed
(
__NT__
))

337 #ià
	`defšed
(
_AMD64_
è|| defšed(
_M_X64
)

338 
	~"©omic_İs/sysd•s/msác/x86_64.h
"

339 #–ià
	`defšed
(
_M_IX86
è|| defšed(
x86
)

340 
	~"©omic_İs/sysd•s/msác/x86.h
"

341 #–ià
	`defšed
(
_M_ARM
è|| defšed(
ARM
è|| defšed(
_ARM_
)

342 
	~"©omic_İs/sysd•s/msác/¬m.h
"

343 
	#AO_GENERALIZE_TWICE


	)

347 #ià
	`defšed
(
__sun
è&& !defšed(
__GNUC__
è&& !defšed(
AO_USE_PTHREAD_DEFS
)

349 #ià
	`defšed
(
__i386
è|| defšed(
__x86_64
è|| defšed(
__amd64
)

350 
	~"©omic_İs/sysd•s/sunc/x86.h
"

354 #ià!
	`defšed
(
__GNUC__
è&& (defšed(
¥¬c
è|| defšed(
__¥¬c
)) \

355 && !
	$defšed
(
AO_USE_PTHREAD_DEFS
)

356 
	~"©omic_İs/sysd•s/sunc/¥¬c.h
"

357 
	#AO_CAN_EMUL_CAS


	)

360 #ià
	`defšed
(
AO_REQUIRE_CAS
è&& !defšed(
AO_HAVE_com·»_ªd_sw­
) \

361 && !
	`defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­
) \

362 && !
	`defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
) \

363 && !
	`defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ
) \

364 && !
	`defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
) \

365 && !
	$defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­_acquœe
)

366 #ià
	`defšed
(
AO_CAN_EMUL_CAS
)

367 
	~"©omic_İs/sysd•s/emul_ÿs.h
"

369 #”rÜ 
CªnÙ
 
im¶em’t
 
AO_com·»_ªd_sw­_fuÎ
 
Ú
 
this
 
¬ch™eùu»
.

375 #ià
AO_AO_TS_T
 && !
	`defšed
(
AO_CLEAR
)

376 
	#AO_CLEAR
(
addr
è
	`AO_¡Üe_»Ëa£
((
AO_TS_t
 *)×ddr), 
AO_TS_CLEAR
)

	)

378 #ià
AO_CHAR_TS_T
 && !
	`defšed
(
AO_CLEAR
)

379 
	#AO_CLEAR
(
addr
è
	`AO_ch¬_¡Üe_»Ëa£
((
AO_TS_t
 *)×ddr), 
AO_TS_CLEAR
)

	)

383 #ià!
	`defšed
(
AO_GENERALIZE_TWICE
è&& defšed(
AO_CAN_EMUL_CAS
) \

384 && !
	`defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
) \

385 && !
	$defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ
)

386 
	#AO_GENERALIZE_TWICE


	)

392 
	~"©omic_İs/g’”®ize.h
"

394 #ià!
	`defšed
(
AO_GENERALIZE_TWICE
) \

395 && 
	`defšed
(
AO_HAVE_com·»_doubË_ªd_sw­_doubË
) \

396 && (!
	`defšed
(
AO_HAVE_doubË_lßd
è|| !
	$defšed
(
AO_HAVE_doubË_¡Üe
))

397 
	#AO_GENERALIZE_TWICE


	)

400 #ifdeà
AO_T_IS_INT


402 
	~"©omic_İs/sysd•s/ao_t_is_št.h
"

403 #iâdeà
AO_GENERALIZE_TWICE


405 
	#AO_GENERALIZE_TWICE


	)

409 #ifdeà
AO_GENERALIZE_TWICE


410 
	~"©omic_İs/g’”®ize.h
"

414 
	#AO_TS_T
 
AO_TS_t


	)

415 
	#AO_T
 
AO_t


	)

416 
	#AO_TS_VAL
 
AO_TS_VAL_t


	)

	@/usr/include/atomic_ops/sysdeps/emul_cas.h

38 #iâdeà
AO_ATOMIC_OPS_H


39 #”rÜ 
This
 
fe
 
should
 
nÙ
 
be
 
šşuded
 
dœeùly
.

42 #iâdeà
AO_HAVE_doubË_t


43 
	~"¡ªd¬d_ao_doubË_t.h
"

46 
AO_t
 
AO_ãtch_com·»_ªd_sw­_emuÏtiÚ
(vŞ©AO_ˆ*
addr
, AO_ˆ
Şd_v®
,

47 
AO_t
 
Ãw_v®
);

49 
AO_com·»_doubË_ªd_sw­_doubË_emuÏtiÚ
(vŞ©
AO_doubË_t
 *
addr
,

50 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

51 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
);

53 
AO_¡Üe_fuÎ_emuÏtiÚ
(vŞ©
AO_t
 *
addr
, AO_ˆ
v®
);

55 #iâdeà
AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ


56 
	#AO_ãtch_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãwv®
) \

57 
	`AO_ãtch_com·»_ªd_sw­_emuÏtiÚ
(
addr
, 
Şd
, 
Ãwv®
)

	)

58 
	#AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ


	)

61 #iâdeà
AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


62 
	#AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(
addr
, 
Şd1
, 
Şd2
, \

63 
Ãwv®1
, 
Ãwv®2
) \

64 
	`AO_com·»_doubË_ªd_sw­_doubË_emuÏtiÚ
(
addr
, 
Şd1
, 
Şd2
, \

65 
Ãwv®1
, 
Ãwv®2
)

	)

66 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

69 #undeà
AO_¡Üe


70 #undeà
AO_HAVE_¡Üe


71 #undeà
AO_¡Üe_wr™e


72 #undeà
AO_HAVE_¡Üe_wr™e


73 #undeà
AO_¡Üe_»Ëa£


74 #undeà
AO_HAVE_¡Üe_»Ëa£


75 #undeà
AO_¡Üe_fuÎ


76 #undeà
AO_HAVE_¡Üe_fuÎ


77 
	#AO_¡Üe_fuÎ
(
addr
, 
v®
è
	`AO_¡Üe_fuÎ_emuÏtiÚ
×ddr, v®)

	)

78 
	#AO_HAVE_¡Üe_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/gcc/alpha.h

18 
	~"../lßd¡Üe/©omic_lßd.h
"

19 
	~"../lßd¡Üe/©omic_¡Üe.h
"

21 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

23 
	#AO_NO_DD_ORDERING


	)

26 
AO_INLINE
 

27 
	$AO_nİ_fuÎ
()

29 
__asm__
 
	`__vŞ©e__
("mb" : : : "memory");

30 
	}
}

31 
	#AO_HAVE_nİ_fuÎ


	)

33 
AO_INLINE
 

34 
	$AO_nİ_wr™e
()

36 
__asm__
 
	`__vŞ©e__
("wmb" : : : "memory");

37 
	}
}

38 
	#AO_HAVE_nİ_wr™e


	)

45 
AO_INLINE
 

46 
	$AO_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
,

47 
AO_t
 
Şd
, AO_ˆ
Ãw_v®
)

49 
was_equ®
;

50 
‹mp
;

52 
__asm__
 
	`__vŞ©e__
(

60 : "=&r" (
‹mp
), "+m" (*
addr
), "=&r" (
was_equ®
)

61 : "r" (
Ãw_v®
), "Ir" (
Şd
)

63  ()
was_equ®
;

64 
	}
}

65 
	#AO_HAVE_com·»_ªd_sw­


	)

	@/usr/include/atomic_ops/sysdeps/gcc/arm.h

18 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

20 #ià
defšed
(
__thumb__
è&& !defšed(
__thumb2__
)

24 
	#AO_THUMB_GO_ARM
 \

29 "4:\n"

	)

30 
	#AO_THUMB_RESTORE_MODE
 \

34 "5:\n"

	)

35 
	#AO_THUMB_SWITCH_CLOBBERS
 "r3",

	)

37 
	#AO_THUMB_GO_ARM


	)

38 
	#AO_THUMB_RESTORE_MODE


	)

39 
	#AO_THUMB_SWITCH_CLOBBERS


	)

44 #ià!
defšed
(
__ARM_ARCH_2__
è&& !defšed(
__ARM_ARCH_3__
) \

45 && !
defšed
(
__ARM_ARCH_3M__
è&& !defšed(
__ARM_ARCH_4__
) \

46 && !
defšed
(
__ARM_ARCH_4T__
) \

47 && ((!
defšed
(
__ARM_ARCH_5__
è&& !defšed(
__ARM_ARCH_5E__
) \

48 && !
defšed
(
__ARM_ARCH_5T__
è&& !defšed(
__ARM_ARCH_5TE__
) \

49 && !
defšed
(
__ARM_ARCH_5TEJ__
è&& !defšed(
__ARM_ARCH_6M__
)) \

50 || 
defšed
(
__ARM_ARCH_7__
è|| defšed(
__ARM_ARCH_7A__
) \

51 || 
	$defšed
(
__ARM_ARCH_8A__
))

52 
	#AO_ARM_HAVE_LDREX


	)

53 #ià!
	`defšed
(
__ARM_ARCH_6__
è&& !defšed(
__ARM_ARCH_6J__
) \

54 && !
	$defšed
(
__ARM_ARCH_6T2__
)

56 
	#AO_ARM_HAVE_LDREXBH


	)

58 #ià!
	`defšed
(
__ARM_ARCH_6__
è&& !defšed(
__ARM_ARCH_6J__
) \

59 && !
	`defšed
(
__ARM_ARCH_6T2__
è&& !defšed(
__ARM_ARCH_6Z__
) \

60 && !
	$defšed
(
__ARM_ARCH_6ZT2__
)

61 #ià!
	`defšed
(
__ARM_ARCH_6K__
è&& !defšed(
__ARM_ARCH_6ZK__
)

63 
	#AO_ARM_HAVE_DMB


	)

65 #ià(!
	`defšed
(
__thumb__
) \

66 || (
	`defšed
(
__thumb2__
è&& !defšed(
__ARM_ARCH_7__
) \

67 && !
	`defšed
(
__ARM_ARCH_7M__
è&& !defšed(
__ARM_ARCH_7EM__
))) \

68 && (!
	`defšed
(
__şªg__
è|| (
__şªg_majÜ__
 > 3) \

69 || (
__şªg_majÜ__
 =ğ3 && 
__şªg_mšÜ__
 >= 3))

75 
	#AO_ARM_HAVE_LDREXD


	)

80 #ià!
	`defšed
(
__ARM_ARCH_2__
è&& !defšed(
__ARM_ARCH_6M__
) \

81 && !
	`defšed
(
__ARM_ARCH_8A__
è&& !
	$defšed
(
__thumb2__
)

82 
	#AO_ARM_HAVE_SWP


	)

87 #ifdeà
AO_UNIPROCESSOR


90 
AO_INLINE
 

91 
	$AO_nİ_fuÎ
()

93 
	`AO_comp”_b¬r›r
();

94 
	}
}

95 
	#AO_HAVE_nİ_fuÎ


	)

97 #–ià
defšed
(
AO_ARM_HAVE_DMB
)

102 
AO_INLINE
 

103 
	$AO_nİ_fuÎ
()

106 
__asm__
 
	`__vŞ©e__
("dmb" : : : "memory");

107 
	}
}

108 
	#AO_HAVE_nİ_fuÎ


	)

110 
AO_INLINE
 

111 
	$AO_nİ_wr™e
()

114 
__asm__
 
	`__vŞ©e__
("dmb st" : : : "memory");

115 
	}
}

116 
	#AO_HAVE_nİ_wr™e


	)

118 #–ià
defšed
(
AO_ARM_HAVE_LDREX
)

121 
AO_INLINE
 

122 
	$AO_nİ_fuÎ
()

124 
de¡
 = 0;

128 
__asm__
 
	`__vŞ©e__
("@AO_nop_full\n"

129 
AO_THUMB_GO_ARM


131 
AO_THUMB_RESTORE_MODE


132 : "=&r"(
de¡
)

134 : 
AO_THUMB_SWITCH_CLOBBERS
 "memory");

135 
	}
}

136 
	#AO_HAVE_nİ_fuÎ


	)

142 #ifdeà
AO_ARM_HAVE_LDREX


146 
	#AO_ACCESS_CHECK_ALIGNED


	)

147 
	#AO_ACCESS_shÜt_CHECK_ALIGNED


	)

148 
	#AO_ACCESS_št_CHECK_ALIGNED


	)

149 
	~"../®l_©omic_Úly_lßd.h
"

166 #ifdeà
AO_BROKEN_TASKSWITCH_CLREX


167 
AO_INLINE
 
	$AO_¡Üe
(vŞ©
AO_t
 *
addr
, AO_ˆ
v®ue
)

169 
æag
;

171 
__asm__
 
	`__vŞ©e__
("@AO_store\n"

172 
AO_THUMB_GO_ARM


177 
AO_THUMB_RESTORE_MODE


178 : "=&r" (
æag
), "+m" (*
addr
)

179 : "r" (
addr
), "r" (
v®ue
)

180 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

181 
	}
}

182 
	#AO_HAVE_¡Üe


	)

184 #ifdeà
AO_ARM_HAVE_LDREXBH


185 
AO_INLINE
 
	$AO_ch¬_¡Üe
(vŞ©*
addr
,

186 
v®ue
)

188 
æag
;

190 
__asm__
 
	`__vŞ©e__
("@AO_char_store\n"

191 
AO_THUMB_GO_ARM


196 
AO_THUMB_RESTORE_MODE


197 : "=&r" (
æag
), "+m" (*
addr
)

198 : "r" (
addr
), "r" (
v®ue
)

199 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

200 
	}
}

201 
	#AO_HAVE_ch¬_¡Üe


	)

203 
AO_INLINE
 
	$AO_shÜt_¡Üe
(vŞ©*
addr
,

204 
v®ue
)

206 
æag
;

208 
__asm__
 
	`__vŞ©e__
("@AO_short_store\n"

209 
AO_THUMB_GO_ARM


214 
AO_THUMB_RESTORE_MODE


215 : "=&r" (
æag
), "+m" (*
addr
)

216 : "r" (
addr
), "r" (
v®ue
)

217 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

218 
	}
}

219 
	#AO_HAVE_shÜt_¡Üe


	)

223 
	~"../lßd¡Üe/©omic_¡Üe.h
"

227 #iâdeà
AO_HAVE_ch¬_¡Üe


228 
	~"../lßd¡Üe/ch¬_©omic_¡Üe.h
"

229 
	~"../lßd¡Üe/shÜt_©omic_¡Üe.h
"

242 #iâdeà
AO_PREFER_GENERALIZED


243 #ià!
defšed
(
AO_FORCE_USE_SWP
è|| !defšed(
AO_ARM_HAVE_SWP
)

250 
AO_INLINE
 
AO_TS_VAL_t


251 
	$AO_‹¡_ªd_£t
(vŞ©
AO_TS_t
 *
addr
)

253 
AO_TS_VAL_t
 
Şdv®
;

254 
æag
;

256 
__asm__
 
	`__vŞ©e__
("@AO_test_and_set\n"

257 
AO_THUMB_GO_ARM


262 
AO_THUMB_RESTORE_MODE


263 : "=&r"(
Şdv®
), "=&r"(
æag
), "+m"(*
addr
)

264 : "r"(
addr
), "r"(1)

265 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

266  
Şdv®
;

267 
	}
}

268 
	#AO_HAVE_‹¡_ªd_£t


	)

271 
AO_INLINE
 
AO_t


272 
	$AO_ãtch_ªd_add
(vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

274 
AO_t
 
»suÉ
, 
tmp
;

275 
æag
;

277 
__asm__
 
	`__vŞ©e__
("@AO_fetch_and_add\n"

278 
AO_THUMB_GO_ARM


284 
AO_THUMB_RESTORE_MODE


285 : "=&r"(
»suÉ
), "=&r"(
æag
), "=&r"(
tmp
), "+m"(*
p
)

286 : "r"(
šü
), "r"(
p
)

287 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

288  
»suÉ
;

289 
	}
}

290 
	#AO_HAVE_ãtch_ªd_add


	)

292 
AO_INLINE
 
AO_t


293 
	$AO_ãtch_ªd_add1
(vŞ©
AO_t
 *
p
)

295 
AO_t
 
»suÉ
, 
tmp
;

296 
æag
;

298 
__asm__
 
	`__vŞ©e__
("@AO_fetch_and_add1\n"

299 
AO_THUMB_GO_ARM


305 
AO_THUMB_RESTORE_MODE


306 : "=&r"(
»suÉ
), "=&r"(
tmp
), "=&r"(
æag
), "+m"(*
p
)

307 : "r"(
p
)

308 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

309  
»suÉ
;

310 
	}
}

311 
	#AO_HAVE_ãtch_ªd_add1


	)

313 
AO_INLINE
 
AO_t


314 
	$AO_ãtch_ªd_sub1
(vŞ©
AO_t
 *
p
)

316 
AO_t
 
»suÉ
, 
tmp
;

317 
æag
;

319 
__asm__
 
	`__vŞ©e__
("@AO_fetch_and_sub1\n"

320 
AO_THUMB_GO_ARM


326 
AO_THUMB_RESTORE_MODE


327 : "=&r"(
»suÉ
), "=&r"(
tmp
), "=&r"(
æag
), "+m"(*
p
)

328 : "r"(
p
)

329 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

330  
»suÉ
;

331 
	}
}

332 
	#AO_HAVE_ãtch_ªd_sub1


	)

334 
AO_INLINE
 

335 
	$AO_ªd
(vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

337 
AO_t
 
tmp
, 
»suÉ
;

339 
__asm__
 
	`__vŞ©e__
("@AO_and\n"

340 
AO_THUMB_GO_ARM


346 
AO_THUMB_RESTORE_MODE


347 : "=&r" (
tmp
), "=&r" (
»suÉ
), "+m" (*
p
)

348 : "r" (
v®ue
), "r" (
p
)

349 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

350 
	}
}

351 
	#AO_HAVE_ªd


	)

353 
AO_INLINE
 

354 
	$AO_Ü
(vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

356 
AO_t
 
tmp
, 
»suÉ
;

358 
__asm__
 
	`__vŞ©e__
("@AO_or\n"

359 
AO_THUMB_GO_ARM


365 
AO_THUMB_RESTORE_MODE


366 : "=&r" (
tmp
), "=&r" (
»suÉ
), "+m" (*
p
)

367 : "r" (
v®ue
), "r" (
p
)

368 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

369 
	}
}

370 
	#AO_HAVE_Ü


	)

372 
AO_INLINE
 

373 
	$AO_xÜ
(vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

375 
AO_t
 
tmp
, 
»suÉ
;

377 
__asm__
 
	`__vŞ©e__
("@AO_xor\n"

378 
AO_THUMB_GO_ARM


384 
AO_THUMB_RESTORE_MODE


385 : "=&r" (
tmp
), "=&r" (
»suÉ
), "+m" (*
p
)

386 : "r" (
v®ue
), "r" (
p
)

387 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

388 
	}
}

389 
	#AO_HAVE_xÜ


	)

392 #ifdeà
AO_ARM_HAVE_LDREXBH


393 
AO_INLINE
 

394 
	$AO_ch¬_ãtch_ªd_add
(vŞ©*
p
, 
šü
)

396 
»suÉ
, 
tmp
;

397 
æag
;

399 
__asm__
 
	`__vŞ©e__
("@AO_char_fetch_and_add\n"

400 
AO_THUMB_GO_ARM


406 
AO_THUMB_RESTORE_MODE


407 : "=&r" (
»suÉ
), "=&r" (
æag
), "=&r" (
tmp
), "+m" (*
p
)

408 : "r" (()
šü
), "r" (
p
)

409 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

410  ()
»suÉ
;

411 
	}
}

412 
	#AO_HAVE_ch¬_ãtch_ªd_add


	)

414 
AO_INLINE
 

415 
	$AO_shÜt_ãtch_ªd_add
(vŞ©*
p
, 
šü
)

417 
»suÉ
, 
tmp
;

418 
æag
;

420 
__asm__
 
	`__vŞ©e__
("@AO_short_fetch_and_add\n"

421 
AO_THUMB_GO_ARM


427 
AO_THUMB_RESTORE_MODE


428 : "=&r" (
»suÉ
), "=&r" (
æag
), "=&r" (
tmp
), "+m" (*
p
)

429 : "r" (()
šü
), "r" (
p
)

430 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

431  ()
»suÉ
;

432 
	}
}

433 
	#AO_HAVE_shÜt_ãtch_ªd_add


	)

436 #iâdeà
AO_GENERALIZE_ASM_BOOL_CAS


438 
AO_INLINE
 

439 
	$AO_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
, AO_ˆ
Ãw_v®
)

441 
AO_t
 
»suÉ
, 
tmp
;

443 
__asm__
 
	`__vŞ©e__
("@AO_compare_and_swap\n"

444 
AO_THUMB_GO_ARM


448 #ifdeà
__thumb2__


456 
AO_THUMB_RESTORE_MODE


457 : "=&r"(
»suÉ
), "=&r"(
tmp
), "+m"(*
addr
)

458 : "r"(
addr
), "r"(
Şd_v®
), "r"(
Ãw_v®
)

459 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

460  !(
»suÉ
&2);

461 
	}
}

462 
	#AO_HAVE_com·»_ªd_sw­


	)

465 
AO_INLINE
 
AO_t


466 
	$AO_ãtch_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
, AO_ˆ
Ãw_v®
)

468 
AO_t
 
ãtched_v®
;

469 
æag
;

471 
__asm__
 
	`__vŞ©e__
("@AO_fetch_compare_and_swap\n"

472 
AO_THUMB_GO_ARM


476 #ifdeà
__thumb2__


482 
AO_THUMB_RESTORE_MODE


483 : "=&r"(
æag
), "=&r"(
ãtched_v®
), "+m"(*
addr
)

484 : "r"(
addr
), "r"(
Şd_v®
), "r"(
Ãw_v®
)

485 : 
AO_THUMB_SWITCH_CLOBBERS
 "cc");

486  
ãtched_v®
;

487 
	}
}

488 
	#AO_HAVE_ãtch_com·»_ªd_sw­


	)

490 #ifdeà
AO_ARM_HAVE_LDREXD


491 
	~"../¡ªd¬d_ao_doubË_t.h
"

499 
AO_INLINE
 
AO_doubË_t


500 
	$AO_doubË_lßd
(cÚ¡ vŞ©
AO_doubË_t
 *
addr
)

502 
AO_doubË_t
 
»suÉ
;

505 
__asm__
 
	`__vŞ©e__
("@AO_double_load\n"

507 : "=&r" (
»suÉ
.
AO_whŞe
)

508 : "r" (
addr
)

510  
»suÉ
;

511 
	}
}

512 
	#AO_HAVE_doubË_lßd


	)

514 
AO_INLINE
 

515 
	$AO_doubË_¡Üe
(vŞ©
AO_doubË_t
 *
addr
, AO_doubË_ˆ
Ãw_v®
)

517 
AO_doubË_t
 
Şd_v®
;

518 
¡©us
;

522 
__asm__
 
	`__vŞ©e__
("@AO_double_store\n"

525 : "=&r" (
Şd_v®
.
AO_whŞe
), "=&r" (
¡©us
), "+m" (*
addr
)

526 : "r" (
addr
), "r" (
Ãw_v®
.
AO_whŞe
)

528 } 
	`AO_EXPECT_FALSE
(
¡©us
));

529 
	}
}

530 
	#AO_HAVE_doubË_¡Üe


	)

532 
AO_INLINE
 

533 
	$AO_doubË_com·»_ªd_sw­
(vŞ©
AO_doubË_t
 *
addr
,

534 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

536 
doubË_±r_¡Üage
 
tmp
;

537 
»suÉ
 = 1;

541 
__asm__
 
	`__vŞ©e__
("@AO_double_compare_and_swap\n"

543 : "=&r"(
tmp
)

544 : "r"(
addr
)

546 ià(
tmp
 !ğ
Şd_v®
.
AO_whŞe
)

548 
__asm__
 
	`__vŞ©e__
(

550 : "=&r"(
»suÉ
), "+m"(*
addr
)

551 : "r" (
addr
), "r" (
Ãw_v®
.
AO_whŞe
)

553 } 
	`AO_EXPECT_FALSE
(
»suÉ
));

554  !
»suÉ
;

555 
	}
}

556 
	#AO_HAVE_doubË_com·»_ªd_sw­


	)

566 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

572 #ià!
defšed
(
AO_HAVE_‹¡_ªd_£t_fuÎ
è&& !defšed(
AO_HAVE_‹¡_ªd_£t
) \

573 && 
defšed
 (
AO_ARM_HAVE_SWP
è&& (!defšed(
AO_PREFER_GENERALIZED
) \

574 || !
	$defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­
))

575 
AO_INLINE
 
AO_TS_VAL_t


576 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

578 
AO_TS_VAL_t
 
Şdv®
;

587 
__asm__
 
	`__vŞ©e__
("@AO_test_and_set_full\n"

588 
AO_THUMB_GO_ARM


592 
AO_THUMB_RESTORE_MODE


593 : "=&r"(
Şdv®
), "=&r"(
addr
)

594 : "r"(1), "1"(
addr
)

595 : 
AO_THUMB_SWITCH_CLOBBERS
 "memory");

596  
Şdv®
;

597 
	}
}

598 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

601 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/gcc/cris.h

28 
	~"../®l_©omic_lßd_¡Üe.h
"

30 
	~"../Üd”ed.h
"

32 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

49 
AO_INLINE
 
AO_TS_VAL_t


50 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
) {

52 
»t
;

56 
__asm__
 
	`__vŞ©e__
("clearf\n"

63 : "=&r" (
»t
), "=m" (*
addr
)

64 : "r" (
addr
), "r" (() 1), "m" (*addr)

66  
»t
;

67 
	}
}

68 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/gcc/hppa.h

23 
	~"../®l_©omic_lßd_¡Üe.h
"

29 
	~"../Üd”ed.h
"

34 
	sAO_·_ş—¿bË_loc
 {

35 
	md©a
[4];

38 #undeà
AO_TS_INITIALIZER


39 
	#AO_TS_t
 
AO_·_ş—¿bË_loc


	)

40 
	#AO_TS_INITIALIZER
 {1,1,1,1}

	)

43 ’um {
	mAO_PA_TS_£t
 = 0, 
	mAO_PA_TS_ş—r
 = 1} 
	tAO_PA_TS_v®
;

44 
	#AO_TS_VAL_t
 
AO_PA_TS_v®


	)

45 
	#AO_TS_CLEAR
 
AO_PA_TS_ş—r


	)

46 
	#AO_TS_SET
 
AO_PA_TS_£t


	)

52 
	#AO_ldcw
(
a
, 
»t
) \

53 
__asm__
 
	`__vŞ©e__
("ldcw 0(%2), %0" \

54 : "ô" (
»t
), "=m" (*(
a
)è: "r" (a))

	)

63 
	#AO_PA_LDCW_ALIGNMENT
 16

	)

64 
	#AO_ldcw_®ign
(
addr
) \

65 ((vŞ©*)((()(
addr
) \

66 + (
AO_PA_LDCW_ALIGNMENT
 - 1)) \

67 & ~(
AO_PA_LDCW_ALIGNMENT
 - 1)))

	)

70 
AO_INLINE
 
AO_TS_VAL_t


71 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 * 
addr
)

73 vŞ©
»t
;

74 vŞ©*
a
 = 
	`AO_ldcw_®ign
(
addr
);

76 
	`AO_ldcw
(
a
, 
»t
);

77  (
AO_TS_VAL_t
)
»t
;

78 
	}
}

79 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

81 
AO_INLINE
 

82 
	$AO_·_ş—r
(vŞ©
AO_TS_t
 * 
addr
)

84 vŞ©*
a
 = 
	`AO_ldcw_®ign
(
addr
);

86 
	`AO_comp”_b¬r›r
();

87 *
a
 = 1;

88 
	}
}

89 
	#AO_CLEAR
(
addr
è
	`AO_·_ş—r
×ddr)

	)

	@/usr/include/atomic_ops/sysdeps/gcc/m68k.h

20 #undeà
AO_t


21 
	tAO_t
 
	t__©Œibu‹__
 ((
	t®igÃd
 (4)));

24 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

28 
	~"../Üd”ed.h
"

30 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

32 
AO_INLINE
 
AO_TS_VAL_t


33 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
) {

34 
AO_TS_t
 
Şdv®
;

40 
__asm__
 
	`__vŞ©e__
(

42 : "=d" (
Şdv®
), "=m" (*
addr
)

43 : "m" (*
addr
)

46  (
AO_TS_VAL_t
)
Şdv®
;

47 
	}
}

48 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

51 
AO_INLINE
 

52 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
,

53 
AO_t
 
Şd
, AO_ˆ
Ãw_v®
)

55 
»suÉ
;

57 
__asm__
 
	`__vŞ©e__
(

59 : "=d" (
»suÉ
), "=m" (*
addr
)

60 : "m" (*
addr
), "d" (
Şd
), "d" (
Ãw_v®
)

62  -
»suÉ
;

63 
	}
}

64 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

68 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/gcc/mips.h

21 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

23 
	~"../lßd¡Üe/acquœe_»Ëa£_vŞ©e.h
"

25 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

28 
	#AO_NO_DD_ORDERING


	)

30 #ifdeà
AO_ICE9A1_LLSC_WAR


34 
	#AO_MIPS_LL_FIX
(
¬gs_¡r
) \

35 "†È " 
¬gs_¡r
 "\n"

	)

37 
	#AO_MIPS_LL_FIX
(
¬gs_¡r
è""

	)

40 
AO_INLINE
 

41 
	$AO_nİ_fuÎ
()

43 
__asm__
 
	`__vŞ©e__
(

51 
	}
}

52 
	#AO_HAVE_nİ_fuÎ


	)

54 #iâdeà
AO_PREFER_GENERALIZED


55 
AO_INLINE
 
AO_t


56 
	$AO_ãtch_ªd_add
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
)

58 
»suÉ
;

59 
‹mp
;

61 
__asm__
 
	`__vŞ©e__
(

67 
	`AO_MIPS_LL_FIX
("%0, %2")

73 : "=&r" (
»suÉ
), "=&r" (
‹mp
), "+m" (*
addr
)

74 : "Ir" (
šü
)

76  (
AO_t
)
»suÉ
;

77 
	}
}

78 
	#AO_HAVE_ãtch_ªd_add


	)

80 
AO_INLINE
 
AO_TS_VAL_t


81 
	$AO_‹¡_ªd_£t
(vŞ©
AO_TS_t
 *
addr
)

83 
Şdv®
;

84 
‹mp
;

86 
__asm__
 
	`__vŞ©e__
(

92 
	`AO_MIPS_LL_FIX
("%0, %2")

98 : "=&r" (
Şdv®
), "=&r" (
‹mp
), "+m" (*
addr
)

101  (
AO_TS_VAL_t
)
Şdv®
;

102 
	}
}

103 
	#AO_HAVE_‹¡_ªd_£t


	)

108 #iâdeà
AO_GENERALIZE_ASM_BOOL_CAS


109 
AO_INLINE
 

110 
	$AO_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

112 
was_equ®
 = 0;

113 
‹mp
;

115 
__asm__
 
	`__vŞ©e__
(

121 
	`AO_MIPS_LL_FIX
("%0, %1")

129 : "=&r" (
‹mp
), "+m" (*
addr
), "+r" (
was_equ®
)

130 : "r" (
Ãw_v®
), "r" (
Şd
)

132  
was_equ®
;

133 
	}
}

134 
	#AO_HAVE_com·»_ªd_sw­


	)

137 
AO_INLINE
 
AO_t


138 
	$AO_ãtch_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

140 
ãtched_v®
;

141 
‹mp
;

143 
__asm__
 
	`__vŞ©e__
(

149 
	`AO_MIPS_LL_FIX
("%0, %2")

157 : "=&r" (
ãtched_v®
), "=&r" (
‹mp
), "+m" (*
addr
)

158 : "r" (
Ãw_v®
), "Jr" (
Şd
)

160  (
AO_t
)
ãtched_v®
;

161 
	}
}

162 
	#AO_HAVE_ãtch_com·»_ªd_sw­


	)

172 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/gcc/s390.h

33 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

35 
	~"../Üd”ed_exû±_wr.h
"

37 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

44 
AO_INLINE
 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
,

45 
AO_t
 
Şd
, AO_ˆ
Ãw_v®
)

47 
»tv®
;

48 
__asm__
 
	`__vŞ©e__
 (

49 #iâdeà
__s390x__


56 : "=&d" (
»tv®
), "+d" (
Şd
)

57 : "d" (
Ãw_v®
), "a" (
addr
)

59  
»tv®
 == 0;

60 
	}
}

61 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/gcc/sh.h

15 
	~"../®l_©omic_lßd_¡Üe.h
"

16 
	~"../Üd”ed.h
"

19 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

21 
AO_INLINE
 
AO_TS_VAL_t


22 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

24 
Şdv®
;

25 
__asm__
 
	`__vŞ©e__
(

27 : "ô" (
Şdv®
)

28 : "r" (
addr
)

30  
Şdv®
? 
AO_TS_CLEAR
 : 
AO_TS_SET
;

31 
	}
}

32 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/generic_pthread.h

30 
	~<±h»ad.h
>

32 
	~"‹¡_ªd_£t_t_is_ao_t.h
"

38 
±h»ad_mu‹x_t
 
AO_±_lock
;

40 
AO_INLINE
 

41 
	$AO_nİ_fuÎ
()

43 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

44 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

45 
	}
}

46 
	#AO_HAVE_nİ_fuÎ


	)

48 
AO_INLINE
 
AO_t


49 
	$AO_lßd_fuÎ
(cÚ¡ vŞ©
AO_t
 *
addr
)

51 
AO_t
 
»suÉ
;

52 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

53 
»suÉ
 = *
addr
;

54 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

55  
»suÉ
;

56 
	}
}

57 
	#AO_HAVE_lßd_fuÎ


	)

59 
AO_INLINE
 

60 
	$AO_¡Üe_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
v®
)

62 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

63 *
addr
 = 
v®
;

64 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

65 
	}
}

66 
	#AO_HAVE_¡Üe_fuÎ


	)

68 
AO_INLINE
 

69 
	$AO_ch¬_lßd_fuÎ
(cÚ¡ vŞ©*
addr
)

71 
»suÉ
;

72 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

73 
»suÉ
 = *
addr
;

74 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

75  
»suÉ
;

76 
	}
}

77 
	#AO_HAVE_ch¬_lßd_fuÎ


	)

79 
AO_INLINE
 

80 
	$AO_ch¬_¡Üe_fuÎ
(vŞ©*
addr
, 
v®
)

82 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

83 *
addr
 = 
v®
;

84 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

85 
	}
}

86 
	#AO_HAVE_ch¬_¡Üe_fuÎ


	)

88 
AO_INLINE
 

89 
	$AO_shÜt_lßd_fuÎ
(cÚ¡ vŞ©*
addr
)

91 
»suÉ
;

92 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

93 
»suÉ
 = *
addr
;

94 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

95  
»suÉ
;

96 
	}
}

97 
	#AO_HAVE_shÜt_lßd_fuÎ


	)

99 
AO_INLINE
 

100 
	$AO_shÜt_¡Üe_fuÎ
(vŞ©*
addr
, 
v®
)

102 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

103 *
addr
 = 
v®
;

104 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

105 
	}
}

106 
	#AO_HAVE_shÜt_¡Üe_fuÎ


	)

108 
AO_INLINE
 

109 
	$AO_št_lßd_fuÎ
(cÚ¡ vŞ©*
addr
)

111 
»suÉ
;

112 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

113 
»suÉ
 = *
addr
;

114 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

115  
»suÉ
;

116 
	}
}

117 
	#AO_HAVE_št_lßd_fuÎ


	)

119 
AO_INLINE
 

120 
	$AO_št_¡Üe_fuÎ
(vŞ©*
addr
, 
v®
)

122 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

123 *
addr
 = 
v®
;

124 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

125 
	}
}

126 
	#AO_HAVE_št_¡Üe_fuÎ


	)

128 
AO_INLINE
 
AO_TS_VAL_t


129 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

131 
AO_TS_VAL_t
 
»suÉ
;

132 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

133 
»suÉ
 = (
AO_TS_VAL_t
)(*
addr
);

134 *
addr
 = 
AO_TS_SET
;

135 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

136 
	`as£¹
(
»suÉ
 =ğ
AO_TS_SET
 ||„esuÉ =ğ
AO_TS_CLEAR
);

137  
»suÉ
;

138 
	}
}

139 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

141 
AO_INLINE
 
AO_t


142 
	$AO_ãtch_ªd_add_fuÎ
(vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

144 
AO_t
 
Şd_v®
;

146 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

147 
Şd_v®
 = *
p
;

148 *
p
 = 
Şd_v®
 + 
šü
;

149 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

150  
Şd_v®
;

151 
	}
}

152 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

154 
AO_INLINE
 

155 
	$AO_ch¬_ãtch_ªd_add_fuÎ
(vŞ©*
p
, 
šü
)

157 
Şd_v®
;

159 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

160 
Şd_v®
 = *
p
;

161 *
p
 = 
Şd_v®
 + 
šü
;

162 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

163  
Şd_v®
;

164 
	}
}

165 
	#AO_HAVE_ch¬_ãtch_ªd_add_fuÎ


	)

167 
AO_INLINE
 

168 
	$AO_shÜt_ãtch_ªd_add_fuÎ
(vŞ©*
p
, 
šü
)

170 
Şd_v®
;

172 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

173 
Şd_v®
 = *
p
;

174 *
p
 = 
Şd_v®
 + 
šü
;

175 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

176  
Şd_v®
;

177 
	}
}

178 
	#AO_HAVE_shÜt_ãtch_ªd_add_fuÎ


	)

180 
AO_INLINE
 

181 
	$AO_št_ãtch_ªd_add_fuÎ
(vŞ©*
p
, 
šü
)

183 
Şd_v®
;

185 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

186 
Şd_v®
 = *
p
;

187 *
p
 = 
Şd_v®
 + 
šü
;

188 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

189  
Şd_v®
;

190 
	}
}

191 
	#AO_HAVE_št_ãtch_ªd_add_fuÎ


	)

193 
AO_INLINE
 

194 
	$AO_ªd_fuÎ
(vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

196 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

197 *
p
 &ğ
v®ue
;

198 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

199 
	}
}

200 
	#AO_HAVE_ªd_fuÎ


	)

202 
AO_INLINE
 

203 
	$AO_Ü_fuÎ
(vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

205 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

206 *
p
 |ğ
v®ue
;

207 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

208 
	}
}

209 
	#AO_HAVE_Ü_fuÎ


	)

211 
AO_INLINE
 

212 
	$AO_xÜ_fuÎ
(vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

214 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

215 *
p
 ^ğ
v®ue
;

216 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

217 
	}
}

218 
	#AO_HAVE_xÜ_fuÎ


	)

220 
AO_INLINE
 

221 
	$AO_ch¬_ªd_fuÎ
(vŞ©*
p
, 
v®ue
)

223 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

224 *
p
 &ğ
v®ue
;

225 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

226 
	}
}

227 
	#AO_HAVE_ch¬_ªd_fuÎ


	)

229 
AO_INLINE
 

230 
	$AO_ch¬_Ü_fuÎ
(vŞ©*
p
, 
v®ue
)

232 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

233 *
p
 |ğ
v®ue
;

234 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

235 
	}
}

236 
	#AO_HAVE_ch¬_Ü_fuÎ


	)

238 
AO_INLINE
 

239 
	$AO_ch¬_xÜ_fuÎ
(vŞ©*
p
, 
v®ue
)

241 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

242 *
p
 ^ğ
v®ue
;

243 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

244 
	}
}

245 
	#AO_HAVE_ch¬_xÜ_fuÎ


	)

247 
AO_INLINE
 

248 
	$AO_shÜt_ªd_fuÎ
(vŞ©*
p
, 
v®ue
)

250 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

251 *
p
 &ğ
v®ue
;

252 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

253 
	}
}

254 
	#AO_HAVE_shÜt_ªd_fuÎ


	)

256 
AO_INLINE
 

257 
	$AO_shÜt_Ü_fuÎ
(vŞ©*
p
, 
v®ue
)

259 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

260 *
p
 |ğ
v®ue
;

261 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

262 
	}
}

263 
	#AO_HAVE_shÜt_Ü_fuÎ


	)

265 
AO_INLINE
 

266 
	$AO_shÜt_xÜ_fuÎ
(vŞ©*
p
, 
v®ue
)

268 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

269 *
p
 ^ğ
v®ue
;

270 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

271 
	}
}

272 
	#AO_HAVE_shÜt_xÜ_fuÎ


	)

274 
AO_INLINE
 

275 
	$AO_št_ªd_fuÎ
(vŞ©*
p
, 
v®ue
)

277 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

278 *
p
 &ğ
v®ue
;

279 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

280 
	}
}

281 
	#AO_HAVE_št_ªd_fuÎ


	)

283 
AO_INLINE
 

284 
	$AO_št_Ü_fuÎ
(vŞ©*
p
, 
v®ue
)

286 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

287 *
p
 |ğ
v®ue
;

288 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

289 
	}
}

290 
	#AO_HAVE_št_Ü_fuÎ


	)

292 
AO_INLINE
 

293 
	$AO_št_xÜ_fuÎ
(vŞ©*
p
, 
v®ue
)

295 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

296 *
p
 ^ğ
v®ue
;

297 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

298 
	}
}

299 
	#AO_HAVE_št_xÜ_fuÎ


	)

301 
AO_INLINE
 
AO_t


302 
	$AO_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

303 
AO_t
 
Ãw_v®
)

305 
AO_t
 
ãtched_v®
;

307 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

308 
ãtched_v®
 = *
addr
;

309 ià(
ãtched_v®
 =ğ
Şd_v®
)

310 *
addr
 = 
Ãw_v®
;

311 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

312  
ãtched_v®
;

313 
	}
}

314 
	#AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ


	)

316 
AO_INLINE
 

317 
	$AO_ch¬_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©*
addr
,

318 
Şd_v®
,

319 
Ãw_v®
)

321 
ãtched_v®
;

323 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

324 
ãtched_v®
 = *
addr
;

325 ià(
ãtched_v®
 =ğ
Şd_v®
)

326 *
addr
 = 
Ãw_v®
;

327 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

328  
ãtched_v®
;

329 
	}
}

330 
	#AO_HAVE_ch¬_ãtch_com·»_ªd_sw­_fuÎ


	)

332 
AO_INLINE
 

333 
	$AO_shÜt_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©*
addr
,

334 
Şd_v®
,

335 
Ãw_v®
)

337 
ãtched_v®
;

339 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

340 
ãtched_v®
 = *
addr
;

341 ià(
ãtched_v®
 =ğ
Şd_v®
)

342 *
addr
 = 
Ãw_v®
;

343 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

344  
ãtched_v®
;

345 
	}
}

346 
	#AO_HAVE_shÜt_ãtch_com·»_ªd_sw­_fuÎ


	)

348 
AO_INLINE
 

349 
	$AO_št_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©*
addr
, 
Şd_v®
,

350 
Ãw_v®
)

352 
ãtched_v®
;

354 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

355 
ãtched_v®
 = *
addr
;

356 ià(
ãtched_v®
 =ğ
Şd_v®
)

357 *
addr
 = 
Ãw_v®
;

358 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

359  
ãtched_v®
;

360 
	}
}

361 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_fuÎ


	)

366 
AO_t
 
	mAO_v®1
;

367 
AO_t
 
	mAO_v®2
;

368 } 
	tAO_doubË_t
;

369 
	#AO_HAVE_doubË_t


	)

371 
	#AO_DOUBLE_T_INITIALIZER
 { (
AO_t
)0, (AO_t)0 }

	)

373 
AO_INLINE
 
AO_doubË_t


374 
	$AO_doubË_lßd_fuÎ
(cÚ¡ vŞ©
AO_doubË_t
 *
addr
)

376 
AO_doubË_t
 
»suÉ
;

378 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

379 
»suÉ
.
AO_v®1
 = 
addr
->AO_val1;

380 
»suÉ
.
AO_v®2
 = 
addr
->AO_val2;

381 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

382  
»suÉ
;

383 
	}
}

384 
	#AO_HAVE_doubË_lßd_fuÎ


	)

386 
AO_INLINE
 

387 
	$AO_doubË_¡Üe_fuÎ
(vŞ©
AO_doubË_t
 *
addr
, AO_doubË_ˆ
v®ue
)

389 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

390 
addr
->
AO_v®1
 = 
v®ue
.AO_val1;

391 
addr
->
AO_v®2
 = 
v®ue
.AO_val2;

392 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

393 
	}
}

394 
	#AO_HAVE_doubË_¡Üe_fuÎ


	)

396 
AO_INLINE
 

397 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

398 
AO_t
 
Şd1
, AO_ˆ
Şd2
,

399 
AO_t
 
Ãw1
, AO_ˆ
Ãw2
)

401 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

402 ià(
addr
 -> 
AO_v®1
 =ğ
Şd1
 &&‡dd¸-> 
AO_v®2
 =ğ
Şd2
)

404 
addr
 -> 
AO_v®1
 = 
Ãw1
;

405 
addr
 -> 
AO_v®2
 = 
Ãw2
;

406 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

410 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

412 
	}
}

413 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

415 
AO_INLINE
 

416 
	$AO_com·»_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

417 
AO_t
 
Şd1
, AO_ˆ
Ãw1
, AO_ˆ
Ãw2
)

419 
	`±h»ad_mu‹x_lock
(&
AO_±_lock
);

420 ià(
addr
 -> 
AO_v®1
 =ğ
Şd1
)

422 
addr
 -> 
AO_v®1
 = 
Ãw1
;

423 
addr
 -> 
AO_v®2
 = 
Ãw2
;

424 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

428 
	`±h»ad_mu‹x_uÆock
(&
AO_±_lock
);

430 
	}
}

431 
	#AO_HAVE_com·»_ªd_sw­_doubË_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/hpc/hppa.h

25 
	~"../lßd¡Üe/©omic_lßd.h
"

26 
	~"../lßd¡Üe/©omic_¡Üe.h
"

35 
	~"../Üd”ed.h
"

37 
	~<machše/šlše.h
>

42 
	sAO_·_ş—¿bË_loc
 {

43 
	md©a
[4];

46 #undeà
AO_TS_INITIALIZER


47 
	#AO_TS_t
 
AO_·_ş—¿bË_loc


	)

48 
	#AO_TS_INITIALIZER
 {1,1,1,1}

	)

51 ’um {
	mAO_PA_TS_£t
 = 0, 
	mAO_PA_TS_ş—r
 = 1} 
	tAO_PA_TS_v®
;

52 
	#AO_TS_VAL_t
 
AO_PA_TS_v®


	)

53 
	#AO_TS_CLEAR
 
AO_PA_TS_ş—r


	)

54 
	#AO_TS_SET
 
AO_PA_TS_£t


	)

60 
	#AO_ldcw
(
a
, 
»t
) \

61 
	`_LDCWX
(0 , 0 , 
a
 , 
»t
)

	)

70 
	#AO_PA_LDCW_ALIGNMENT
 16

	)

71 
	#AO_ldcw_®ign
(
addr
) \

72 ((vŞ©*)((()(
addr
) \

73 + (
AO_PA_LDCW_ALIGNMENT
 - 1)) \

74 & ~(
AO_PA_LDCW_ALIGNMENT
 - 1)))

	)

77 
AO_INLINE
 
AO_TS_VAL_t


78 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 * 
addr
)

80 
»t
;

81 
a
 = ()
	`AO_ldcw_®ign
(
addr
);

83 
	`AO_ldcw
(
a
, 
»t
);

84  (
AO_TS_VAL_t
)
»t
;

85 
	}
}

86 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

88 
AO_INLINE
 

89 
	$AO_·_ş—r
(vŞ©
AO_TS_t
 * 
addr
)

91 vŞ©*
a
 = 
	`AO_ldcw_®ign
(
addr
);

93 
	`AO_comp”_b¬r›r
();

94 *
a
 = 1;

95 
	}
}

96 
	#AO_CLEAR
(
addr
è
	`AO_·_ş—r
×ddr)

	)

	@/usr/include/atomic_ops/sysdeps/hpc/ia64.h

29 
	~"../®l_©omic_lßd_¡Üe.h
"

31 
	~"../®l_acquœe_»Ëa£_vŞ©e.h
"

33 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

35 
	~<machše/sys/šlše.h
>

37 #ifdeà
__LP64__


38 
	#AO_T_FASIZE
 
_FASZ_D


	)

39 
	#AO_T_SIZE
 
_SZ_D


	)

41 
	#AO_T_FASIZE
 
_FASZ_W


	)

42 
	#AO_T_SIZE
 
_SZ_W


	)

45 
AO_INLINE
 

46 
	$AO_nİ_fuÎ
()

48 
	`_Asm_mf
();

49 
	}
}

50 
	#AO_HAVE_nİ_fuÎ


	)

52 #iâdeà
AO_PREFER_GENERALIZED


53 
AO_INLINE
 
AO_t


54 
	$AO_ãtch_ªd_add1_acquœe
 (vŞ©
AO_t
 *
p
)

56  
	`_Asm_ãtchadd
(
AO_T_FASIZE
, 
_SEM_ACQ
, 
p
, 1,

57 
_LDHINT_NONE
, 
_DOWN_MEM_FENCE
);

58 
	}
}

59 
	#AO_HAVE_ãtch_ªd_add1_acquœe


	)

61 
AO_INLINE
 
AO_t


62 
	$AO_ãtch_ªd_add1_»Ëa£
 (vŞ©
AO_t
 *
p
)

64  
	`_Asm_ãtchadd
(
AO_T_FASIZE
, 
_SEM_REL
, 
p
, 1,

65 
_LDHINT_NONE
, 
_UP_MEM_FENCE
);

66 
	}
}

67 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£


	)

69 
AO_INLINE
 
AO_t


70 
	$AO_ãtch_ªd_sub1_acquœe
 (vŞ©
AO_t
 *
p
)

72  
	`_Asm_ãtchadd
(
AO_T_FASIZE
, 
_SEM_ACQ
, 
p
, -1,

73 
_LDHINT_NONE
, 
_DOWN_MEM_FENCE
);

74 
	}
}

75 
	#AO_HAVE_ãtch_ªd_sub1_acquœe


	)

77 
AO_INLINE
 
AO_t


78 
	$AO_ãtch_ªd_sub1_»Ëa£
 (vŞ©
AO_t
 *
p
)

80  
	`_Asm_ãtchadd
(
AO_T_FASIZE
, 
_SEM_REL
, 
p
, -1,

81 
_LDHINT_NONE
, 
_UP_MEM_FENCE
);

82 
	}
}

83 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£


	)

86 
AO_INLINE
 
AO_t


87 
	$AO_ãtch_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

88 
AO_t
 
Ãw_v®
)

90 
	`_Asm_mov_to_¬
(
_AREG_CCV
, 
Şd_v®
, 
_DOWN_MEM_FENCE
);

91  
	`_Asm_cmpxchg
(
AO_T_SIZE
, 
_SEM_ACQ
, 
addr
,

92 
Ãw_v®
, 
_LDHINT_NONE
, 
_DOWN_MEM_FENCE
);

93 
	}
}

94 
	#AO_HAVE_ãtch_com·»_ªd_sw­_acquœe


	)

96 
AO_INLINE
 
AO_t


97 
	$AO_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

98 
AO_t
 
Ãw_v®
)

100 
	`_Asm_mov_to_¬
(
_AREG_CCV
, 
Şd_v®
, 
_UP_MEM_FENCE
);

101  
	`_Asm_cmpxchg
(
AO_T_SIZE
, 
_SEM_REL
, 
addr
,

102 
Ãw_v®
, 
_LDHINT_NONE
, 
_UP_MEM_FENCE
);

104 
	}
}

105 
	#AO_HAVE_ãtch_com·»_ªd_sw­_»Ëa£


	)

107 
AO_INLINE
 

108 
	$AO_ch¬_ãtch_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

109 
Şd_v®
, 
Ãw_v®
)

111 
	`_Asm_mov_to_¬
(
_AREG_CCV
, 
Şd_v®
, 
_DOWN_MEM_FENCE
);

112  
	`_Asm_cmpxchg
(
_SZ_B
, 
_SEM_ACQ
, 
addr
,

113 
Ãw_v®
, 
_LDHINT_NONE
, 
_DOWN_MEM_FENCE
);

115 
	}
}

116 
	#AO_HAVE_ch¬_ãtch_com·»_ªd_sw­_acquœe


	)

118 
AO_INLINE
 

119 
	$AO_ch¬_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

120 
Şd_v®
, 
Ãw_v®
)

122 
	`_Asm_mov_to_¬
(
_AREG_CCV
, 
Şd_v®
, 
_UP_MEM_FENCE
);

123  
	`_Asm_cmpxchg
(
_SZ_B
, 
_SEM_REL
, 
addr
,

124 
Ãw_v®
, 
_LDHINT_NONE
, 
_UP_MEM_FENCE
);

126 
	}
}

127 
	#AO_HAVE_ch¬_ãtch_com·»_ªd_sw­_»Ëa£


	)

129 
AO_INLINE
 

130 
	$AO_shÜt_ãtch_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

131 
Şd_v®
,

132 
Ãw_v®
)

134 
	`_Asm_mov_to_¬
(
_AREG_CCV
, 
Şd_v®
, 
_DOWN_MEM_FENCE
);

135  
	`_Asm_cmpxchg
(
_SZ_B
, 
_SEM_ACQ
, 
addr
,

136 
Ãw_v®
, 
_LDHINT_NONE
, 
_DOWN_MEM_FENCE
);

138 
	}
}

139 
	#AO_HAVE_shÜt_ãtch_com·»_ªd_sw­_acquœe


	)

141 
AO_INLINE
 

142 
	$AO_shÜt_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

143 
Şd_v®
,

144 
Ãw_v®
)

146 
	`_Asm_mov_to_¬
(
_AREG_CCV
, 
Şd_v®
, 
_UP_MEM_FENCE
);

147  
	`_Asm_cmpxchg
(
_SZ_B
, 
_SEM_REL
, 
addr
,

148 
Ãw_v®
, 
_LDHINT_NONE
, 
_UP_MEM_FENCE
);

150 
	}
}

151 
	#AO_HAVE_shÜt_ãtch_com·»_ªd_sw­_»Ëa£


	)

153 #iâdeà
__LP64__


154 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/msftc/arm.h

23 #iâdeà
AO_ASSUME_WINDOWS98


25 
	#AO_ASSUME_WINDOWS98


	)

27 
	~"commÚ32_defs.h
"

31 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

38 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

41 #ifdeà
AO_UNIPROCESSOR


42 
AO_INLINE
 
	$AO_nİ_fuÎ
()

44 
	`AO_comp”_b¬r›r
();

45 
	}
}

46 
	#AO_HAVE_nİ_fuÎ


	)

51 #ià
_M_ARM
 >= 6

63 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/msftc/x86.h

27 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

29 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

31 #ià
defšed
(
AO_ASSUME_VISTA
è&& !defšed(
AO_ASSUME_WINDOWS98
)

32 
	#AO_ASSUME_WINDOWS98


	)

35 #iâdeà
AO_USE_INTERLOCKED_INTRINSICS


37 
	#AO_USE_INTERLOCKED_INTRINSICS


	)

39 
	~"commÚ32_defs.h
"

48 #ià
defšed
(
AO_USE_PENTIUM4_INSTRS
)

50 
AO_INLINE
 

51 
	$AO_nİ_fuÎ
()

53 
__asm
 { 
mãnû
 }

54 
	}
}

55 
	#AO_HAVE_nİ_fuÎ


	)

65 #iâdeà
AO_NO_ASM_XADD


66 
AO_INLINE
 

67 
	$AO_ch¬_ãtch_ªd_add_fuÎ
(vŞ©*
p
, 
šü
)

69 
__asm


71 
mov
 
®
, 
šü


72 
mov
 
ebx
, 
p


73 
lock
 
xadd
 
by‹
 
±r
 [
ebx
], 
®


76 
	}
}

77 
	#AO_HAVE_ch¬_ãtch_ªd_add_fuÎ


	)

79 
AO_INLINE
 

80 
	$AO_shÜt_ãtch_ªd_add_fuÎ
(vŞ©*
p
, 
šü
)

82 
__asm


84 
mov
 
ax
, 
šü


85 
mov
 
ebx
, 
p


86 
lock
 
xadd
 
wÜd
 
±r
 [
ebx
], 
ax


89 
	}
}

90 
	#AO_HAVE_shÜt_ãtch_ªd_add_fuÎ


	)

93 
AO_INLINE
 
AO_TS_VAL_t


94 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

96 
__asm


98 
mov
 
—x
,0xff ;

99 
mov
 
ebx
,
addr
 ;

100 
xchg
 
by‹
 
±r
 [
ebx
],
®
 ;

103 
	}
}

104 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

106 #ifdeà
_WIN64


107 #”rÜ 
wrÚg
 
¬ch™eùu»


110 #ifdeà
AO_ASSUME_VISTA


111 
	~"../¡ªd¬d_ao_doubË_t.h
"

115 
	#AO_ACCESS_doubË_CHECK_ALIGNED


	)

116 
	~"../lßd¡Üe/doubË_©omic_lßd_¡Üe.h
"

120 #´agm¨
šŒšsic
 (
_IÁ”lockedCom·»Exchªge64
)

123 
AO_INLINE
 

124 
	$AO_doubË_com·»_ªd_sw­_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

125 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

127  (
doubË_±r_¡Üage
)
	`_IÁ”lockedCom·»Exchªge64
(

128 (
__št64
 vŞ©*)
addr
,

129 
Ãw_v®
.
AO_whŞe
 ,

130 
Şd_v®
.
AO_whŞe
) == old_val.AO_whole;

131 
	}
}

132 
	#AO_HAVE_doubË_com·»_ªd_sw­_fuÎ


	)

135 
	#AO_T_IS_INT


	)

143 
	~"../Üd”ed_exû±_wr.h
"

	@/usr/include/atomic_ops/sysdeps/msftc/x86_64.h

23 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

32 
	~"../Üd”ed_exû±_wr.h
"

34 #ifdeà
AO_ASM_X64_AVAILABLE


35 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

37 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

40 
	~<wšdows.h
>

45 
	~<šŒš.h
>

47 #´agm¨
šŒšsic
 (
_IÁ”lockedExchªgeAdd
)

48 #´agm¨
šŒšsic
 (
_IÁ”lockedCom·»Exchªge64
)

50 #iâdeà
AO_PREFER_GENERALIZED


52 #´agm¨
šŒšsic
 (
_IÁ”lockedInüem’t64
)

53 #´agm¨
šŒšsic
 (
_IÁ”lockedDeüem’t64
)

54 #´agm¨
šŒšsic
 (
_IÁ”lockedExchªgeAdd64
)

56 
AO_INLINE
 
AO_t


57 
	$AO_ãtch_ªd_add_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

59  
	`_IÁ”lockedExchªgeAdd64
((
LONGLONG
 vŞ©*)
p
, (LONGLONG)
šü
);

60 
	}
}

61 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

63 
AO_INLINE
 
AO_t


64 
	$AO_ãtch_ªd_add1_fuÎ
 (vŞ©
AO_t
 *
p
)

66  
	`_IÁ”lockedInüem’t64
((
LONGLONG
 vŞ©*)
p
) - 1;

67 
	}
}

68 
	#AO_HAVE_ãtch_ªd_add1_fuÎ


	)

70 
AO_INLINE
 
AO_t


71 
	$AO_ãtch_ªd_sub1_fuÎ
 (vŞ©
AO_t
 *
p
)

73  
	`_IÁ”lockedDeüem’t64
((
LONGLONG
 vŞ©*)
p
) + 1;

74 
	}
}

75 
	#AO_HAVE_ãtch_ªd_sub1_fuÎ


	)

78 
AO_INLINE
 
AO_t


79 
	$AO_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

80 
AO_t
 
Ãw_v®
)

82  (
AO_t
)
	`_IÁ”lockedCom·»Exchªge64
((
LONGLONG
 vŞ©*)
addr
,

83 (
LONGLONG
)
Ãw_v®
, (LONGLONG)
Şd_v®
);

84 
	}
}

85 
	#AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ


	)

87 
AO_INLINE
 

88 
	$AO_št_ãtch_ªd_add_fuÎ
(vŞ©*
p
, 
šü
)

90  
	`_IÁ”lockedExchªgeAdd
((
LONG
 vŞ©*)
p
, 
šü
);

91 
	}
}

92 
	#AO_HAVE_št_ãtch_ªd_add_fuÎ


	)

94 #ifdeà
AO_ASM_X64_AVAILABLE


96 
AO_INLINE
 

97 
	$AO_ch¬_ãtch_ªd_add_fuÎ
(vŞ©*
p
, 
šü
)

99 
__asm


101 
mov
 
®
, 
šü


102 
mov
 
rbx
, 
p


103 
lock
 
xadd
 
by‹
 
±r
 [
rbx
], 
®


105 
	}
}

106 
	#AO_HAVE_ch¬_ãtch_ªd_add_fuÎ


	)

108 
AO_INLINE
 

109 
	$AO_shÜt_ãtch_ªd_add_fuÎ
(vŞ©*
p
, 
šü
)

111 
__asm


113 
mov
 
ax
, 
šü


114 
mov
 
rbx
, 
p


115 
lock
 
xadd
 
wÜd
 
±r
 [
rbx
], 
ax


117 
	}
}

118 
	#AO_HAVE_shÜt_ãtch_ªd_add_fuÎ


	)

123 
AO_INLINE
 

124 
	$AO_nİ_fuÎ
()

127 
__asm
 { 
mãnû
 }

128 
	}
}

129 
	#AO_HAVE_nİ_fuÎ


	)

131 
AO_INLINE
 
AO_TS_VAL_t


132 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

134 
__asm


136 
mov
 
¿x
,
AO_TS_SET
 ;

137 
mov
 
rbx
,
addr
 ;

138 
xchg
 
by‹
 
±r
 [
rbx
],
®
 ;

140 
	}
}

141 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

145 #ifdeà
AO_CMPXCHG16B_AVAILABLE


150 #ià
_MSC_VER
 >= 1500

152 
	~"../¡ªd¬d_ao_doubË_t.h
"

154 #´agm¨
šŒšsic
 (
_IÁ”lockedCom·»Exchªge128
)

156 
AO_INLINE
 

157 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

158 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

159 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

161 
__št64
 
com·¿ndResuÉ
[2];

162 
com·¿ndResuÉ
[0] = 
Şd_v®1
;

163 
com·¿ndResuÉ
[1] = 
Şd_v®2
;

164  
	`_IÁ”lockedCom·»Exchªge128
((vŞ©
__št64
 *)
addr
,

165 
Ãw_v®2
 , 
Ãw_v®1
 , 
com·¿ndResuÉ
);

166 
	}
}

167 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

169 #–ià
defšed
(
AO_ASM_X64_AVAILABLE
)

171 
	~"../¡ªd¬d_ao_doubË_t.h
"

175 
AO_INLINE
 

176 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

177 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

178 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

180 
__asm


182 
mov
 
rdx
,
QWORD
 
PTR
 [
Şd_v®2
] ;

183 
mov
 
¿x
,
QWORD
 
PTR
 [
Şd_v®1
] ;

184 
mov
 
rcx
,
QWORD
 
PTR
 [
Ãw_v®2
] ;

185 
mov
 
rbx
,
QWORD
 
PTR
 [
Ãw_v®1
] ;

186 
lock
 
cmpxchg16b
 [
addr
] ;

187 
£tz
 
¿x
 ;

189 
	}
}

190 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/sunc/sparc.h

23 
	~"../®l_©omic_lßd_¡Üe.h
"

26 
	~"../Üd”ed_exû±_wr.h
"

29 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

31 
AO_TS_VAL_t


32 
AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
);

34 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/sunc/x86.h

21 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

23 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

25 #ià!
defšed
(
AO_USE_PENTIUM4_INSTRS
è&& !defšed(
__i386
)

27 
	#AO_USE_PENTIUM4_INSTRS


	)

30 #ià
defšed
(
AO_USE_PENTIUM4_INSTRS
)

31 
AO_INLINE
 

32 
	$AO_nİ_fuÎ
()

34 
__asm__
 
	`__vŞ©e__
 ("mfence" : : : "memory");

35 
	}
}

36 
	#AO_HAVE_nİ_fuÎ


	)

48 #iâdeà
AO_PREFER_GENERALIZED


49 
AO_INLINE
 
AO_t


50 
	$AO_ãtch_ªd_add_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

52 
AO_t
 
»suÉ
;

54 
__asm__
 
	`__vŞ©e__
 ("lock; xadd %0, %1"

55 : "ô" (
»suÉ
), "+m" (*
p
)

56 : "0" (
šü
)

58  
»suÉ
;

59 
	}
}

60 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

63 
AO_INLINE
 

64 
	$AO_ch¬_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

66 
»suÉ
;

68 
__asm__
 
	`__vŞ©e__
 ("lock; xaddb %0, %1"

69 : "=q" (
»suÉ
), "+m" (*
p
)

70 : "0" (
šü
)

72  
»suÉ
;

73 
	}
}

74 
	#AO_HAVE_ch¬_ãtch_ªd_add_fuÎ


	)

76 
AO_INLINE
 

77 
	$AO_shÜt_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

79 
»suÉ
;

81 
__asm__
 
	`__vŞ©e__
 ("lock; xaddw %0, %1"

82 : "ô" (
»suÉ
), "+m" (*
p
)

83 : "0" (
šü
)

85  
»suÉ
;

86 
	}
}

87 
	#AO_HAVE_shÜt_ãtch_ªd_add_fuÎ


	)

89 #iâdeà
AO_PREFER_GENERALIZED


91 
AO_INLINE
 

92 
	$AO_ªd_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

94 
__asm__
 
	`__vŞ©e__
 ("lock;‡nd %1, %0"

95 : "+m" (*
p
)

96 : "r" (
v®ue
)

98 
	}
}

99 
	#AO_HAVE_ªd_fuÎ


	)

101 
AO_INLINE
 

102 
	$AO_Ü_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

104 
__asm__
 
	`__vŞ©e__
 ("lock; or %1, %0"

105 : "+m" (*
p
)

106 : "r" (
v®ue
)

108 
	}
}

109 
	#AO_HAVE_Ü_fuÎ


	)

111 
AO_INLINE
 

112 
	$AO_xÜ_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

114 
__asm__
 
	`__vŞ©e__
 ("lock; xor %1, %0"

115 : "+m" (*
p
)

116 : "r" (
v®ue
)

118 
	}
}

119 
	#AO_HAVE_xÜ_fuÎ


	)

122 
AO_INLINE
 
AO_TS_VAL_t


123 
	$AO_‹¡_ªd_£t_fuÎ
 (vŞ©
AO_TS_t
 *
addr
)

125 
AO_TS_t
 
Şdv®
;

127 
__asm__
 
	`__vŞ©e__
 ("xchg %b0, %1"

128 : "=q" (
Şdv®
), "+m" (*
addr
)

131  (
AO_TS_VAL_t
)
Şdv®
;

132 
	}
}

133 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

135 #iâdeà
AO_GENERALIZE_ASM_BOOL_CAS


137 
AO_INLINE
 

138 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

140 
»suÉ
;

141 
__asm__
 
	`__vŞ©e__
 ("lock; cmpxchg %2, %0; setz %1"

142 : "+m" (*
addr
), "÷" (
»suÉ
)

143 : "r" (
Ãw_v®
), "a" (
Şd
)

145  (è
»suÉ
;

146 
	}
}

147 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

150 
AO_INLINE
 
AO_t


151 
	$AO_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

152 
AO_t
 
Ãw_v®
)

154 
AO_t
 
ãtched_v®
;

155 
__asm__
 
	`__vŞ©e__
 ("lock; cmpxchg %2, %0"

156 : "+m" (*
addr
), "÷" (
ãtched_v®
)

157 : "r" (
Ãw_v®
), "a" (
Şd_v®
)

159  
ãtched_v®
;

160 
	}
}

161 
	#AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ


	)

163 #ià
defšed
(
__i386
)

165 #iâdeà
AO_NO_CMPXCHG8B


166 
	~"../¡ªd¬d_ao_doubË_t.h
"

170 
	#AO_ACCESS_doubË_CHECK_ALIGNED


	)

171 
	~"../lßd¡Üe/doubË_©omic_lßd_¡Üe.h
"

175 
AO_INLINE
 

176 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

177 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

178 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

180 
»suÉ
;

182 
__asm__
 
	`__vŞ©e__
 ("lock; cmpxchg8b %0; setz %1"

183 : "+m" (*
addr
), "÷" (
»suÉ
)

184 : "d" (
Şd_v®2
), "a" (
Şd_v®1
),

185 "c" (
Ãw_v®2
), "b" (
Ãw_v®1
)

187  (è
»suÉ
;

188 
	}
}

189 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

192 
	#AO_T_IS_INT


	)

196 
AO_INLINE
 

197 
	$AO_št_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

199 
»suÉ
;

201 
__asm__
 
	`__vŞ©e__
 ("lock; xaddl %0, %1"

202 : "ô" (
»suÉ
), "+m" (*
p
)

203 : "0" (
šü
)

205  
»suÉ
;

206 
	}
}

207 
	#AO_HAVE_št_ãtch_ªd_add_fuÎ


	)

209 #ifdeà
AO_CMPXCHG16B_AVAILABLE


210 
	~"../¡ªd¬d_ao_doubË_t.h
"

214 
AO_INLINE
 

215 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
 (vŞ©
AO_doubË_t
 *
addr
,

216 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

217 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

219 
»suÉ
;

220 
__asm__
 
	`__vŞ©e__
 ("lock; cmpxchg16b %0; setz %1"

221 : "+m" (*
addr
), "÷" (
»suÉ
)

222 : "d" (
Şd_v®2
), "a" (
Şd_v®1
),

223 "c" (
Ãw_v®2
), "b" (
Ãw_v®1
)

225  (è
»suÉ
;

226 
	}
}

227 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

238 
	~"../Üd”ed_exû±_wr.h
"

	@/usr/include/getopt.h

19 #iâdeà
_GETOPT_H


21 #iâdeà
__Ãed_g‘İt


22 
	#_GETOPT_H
 1

	)

32 #ià!
defšed
 
__GNU_LIBRARY__


33 
	~<ùy³.h
>

36 #iâdeà
__THROW


37 #iâdeà
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

40 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__ılu¥lus


57 *
İrg
;

71 
İtšd
;

76 
İ‹¼
;

80 
İtİt
;

82 #iâdeà
__Ãed_g‘İt


104 
	sİtiÚ


106 cÚ¡ *
	gÇme
;

109 
	ghas_¬g
;

110 *
	gæag
;

111 
	gv®
;

116 
	#no_¬gum’t
 0

	)

117 
	#»quœed_¬gum’t
 1

	)

118 
	#İtiÚ®_¬gum’t
 2

	)

146 #ifdeà
__GNU_LIBRARY__


150 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

151 
__THROW
;

153 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

154 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


158 #ifdeà
__REDIRECT


159 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
),

161 
__posix_g‘İt
);

163 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
è
__THROW
;

165 
	#g‘İt
 
__posix_g‘İt


	)

169 
g‘İt
 ();

172 #iâdeà
__Ãed_g‘İt


173 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

174 cÚ¡ *
__shÜtİts
,

175 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

176 
__THROW
;

177 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

178 cÚ¡ *
__shÜtİts
,

179 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

180 
__THROW
;

184 #ifdef 
__ılu¥lus


189 #undeà
__Ãed_g‘İt


	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<ã©u»s.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

41 #iâdeà
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<b™s/wÜdsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifdeà
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #ià
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #ià
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifdeà
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


123 #šşude_Ãxˆ<
lim™s
.
h
>

129 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


130 #iâdeà
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #iâdeà
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #iâdeà
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<b™s/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<b™s/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<b™s/xİ’_lim.h
>

	@/usr/include/memory.h

22 #iâdef 
_MEMORY_H


23 
	#_MEMORY_H
 1

	)

25 
	~<ã©u»s.h
>

28 #iâdef 
_STRING_H


29 
	~<¡ršg.h
>

	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifdeà
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifdeà
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


86 #ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 1

87 
	#__PTHREAD_SPINS
 0, 0

	)

88 #–ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 2

89 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

91 
	#__PTHREAD_SPINS
 0

	)

94 #ifdeà
__PTHREAD_MUTEX_HAVE_PREV


95 
	#PTHREAD_MUTEX_INITIALIZER
 \

96 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

97 #ifdeà
__USE_GNU


98 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

100 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

101 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

102 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

104 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

109 
	#PTHREAD_MUTEX_INITIALIZER
 \

110 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

111 #ifdeà
__USE_GNU


112 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

113 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

115 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

116 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

117 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

124 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


127 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

128 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

129 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

130 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


136 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 #ià
__WORDSIZE
 == 64

138 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

143 
	#PTHREAD_RWLOCK_INITIALIZER
 \

144 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

145 #ifdeà
__USE_GNU


146 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


147 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

149 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

151 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


152 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

153 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

154 0, 0, 0, 0 } }

	)

156 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

157 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

158 0 } }

	)

168 
	mPTHREAD_INHERIT_SCHED
,

169 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

170 
	mPTHREAD_EXPLICIT_SCHED


171 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

178 
	mPTHREAD_SCOPE_SYSTEM
,

179 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

180 
	mPTHREAD_SCOPE_PROCESS


181 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

188 
	mPTHREAD_PROCESS_PRIVATE
,

189 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

190 
	mPTHREAD_PROCESS_SHARED


191 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

197 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

201 
	s_±h»ad_ş—nup_bufãr


203 (*
	m__routše
) (*);

204 *
	m__¬g
;

205 
	m__ÿnûÉy³
;

206 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

212 
	mPTHREAD_CANCEL_ENABLE
,

213 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

214 
	mPTHREAD_CANCEL_DISABLE


215 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

219 
	mPTHREAD_CANCEL_DEFERRED
,

220 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

221 
	mPTHREAD_CANCEL_ASYNCHRONOUS


222 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

224 
	#PTHREAD_CANCELED
 ((*è-1)

	)

228 
	#PTHREAD_ONCE_INIT
 0

	)

231 #ifdeà
__USE_XOPEN2K


235 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

239 
__BEGIN_DECLS


244 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

245 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

246 *(*
__¡¬t_routše
) (*),

247 *
__»¡riù
 
__¬g
è
__THROWNL
 
__nÚnuÎ
 ((1, 3));

253 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

261 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

263 #ifdeà
__USE_GNU


266 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

274 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

275 cÚ¡ 
time¥ec
 *
__ab¡ime
);

282 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

286 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

289 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

290 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

298 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

301 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

302 
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

306 *
__d‘ach¡©e
)

307 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

310 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

311 
__d‘ach¡©e
)

312 
__THROW
 
	`__nÚnuÎ
 ((1));

316 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

317 
size_t
 *
__gu¬dsize
)

318 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

321 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

322 
size_t
 
__gu¬dsize
)

323 
__THROW
 
	`__nÚnuÎ
 ((1));

327 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

328 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

333 cÚ¡ 
sched_·¿m
 *
__»¡riù


334 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

337 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


338 
__©Œ
, *
__»¡riù
 
__pŞicy
)

339 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

342 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

343 
__THROW
 
	`__nÚnuÎ
 ((1));

346 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


347 
__©Œ
, *
__»¡riù
 
__šh”™
)

348 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

351 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

352 
__šh”™
)

353 
__THROW
 
	`__nÚnuÎ
 ((1));

357 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

358 *
__»¡riù
 
__scİe
)

359 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

362 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

363 
__THROW
 
	`__nÚnuÎ
 ((1));

366 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


367 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

368 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

374 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

375 *
__¡ackaddr
)

376 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

379 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


380 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

381 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

386 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

387 
size_t
 
__¡acksize
)

388 
__THROW
 
	`__nÚnuÎ
 ((1));

390 #ifdeà
__USE_XOPEN2K


392 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

393 **
__»¡riù
 
__¡ackaddr
,

394 
size_t
 *
__»¡riù
 
__¡acksize
)

395 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

400 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

401 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

404 #ifdeà
__USE_GNU


407 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

408 
size_t
 
__ıu£tsize
,

409 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

410 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

414 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

415 
size_t
 
__ıu£tsize
,

416 
ıu_£t_t
 *
__ıu£t
)

417 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

420 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

421 
__THROW
 
	`__nÚnuÎ
 ((1));

425 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

426 
__THROW
 
	`__nÚnuÎ
 ((1));

431 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

441 cÚ¡ 
sched_·¿m
 *
__·¿m
)

442 
__THROW
 
	`__nÚnuÎ
 ((3));

445 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

446 *
__»¡riù
 
__pŞicy
,

447 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

448 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

451 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

452 
__THROW
;

455 #ifdeà
__USE_GNU


457 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

458 
size_t
 
__buæ’
)

459 
__THROW
 
	`__nÚnuÎ
 ((2));

462 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

463 
__THROW
 
	`__nÚnuÎ
 ((2));

467 #ifdeà
__USE_UNIX98


469 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

472 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

475 #ifdeà
__USE_GNU


480 
	$±h»ad_y›ld
 (è
__THROW
;

485 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

486 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

487 
__THROW
 
	`__nÚnuÎ
 ((3));

490 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

491 
ıu_£t_t
 *
__ıu£t
)

492 
__THROW
 
	`__nÚnuÎ
 ((3));

505 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

506 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

517 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

521 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

524 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

529 
	`±h»ad_‹¡ÿnûl
 ();

538 
__jmp_buf
 
__ÿnûl_jmp_buf
;

539 
__mask_was_§ved
;

540 } 
__ÿnûl_jmp_buf
[1];

541 *
__·d
[4];

542 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

545 #iâdeà
__ş—nup_fù_©Œibu‹


546 
	#__ş—nup_fù_©Œibu‹


	)

551 
	s__±h»ad_ş—nup_äame


553 (*
__ÿnûl_routše
) (*);

554 *
__ÿnûl_¬g
;

555 
__do_™
;

556 
__ÿnûl_ty³
;

559 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


560 #ifdeà
__ılu¥lus


562 şas 
	c__±h»ad_ş—nup_şass


564 (*
__ÿnûl_routše
) (*);

565 *
__ÿnûl_¬g
;

566 
__do_™
;

567 
__ÿnûl_ty³
;

569 
public
:

570 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

571 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

572 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

573 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

574 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

575 &
__ÿnûl_ty³
); 
	}
}

576 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

586 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

588 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

592 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

593 
__şäame
.
	`__£tdo™
 (
execu‹
); \

594 } 0)

	)

596 #ifdeà
__USE_GNU


600 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

602 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

603 
__şäame
.
	`__deãr
 ()

	)

608 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

609 
__şäame
.
	`__»¡Üe
 (); \

610 
__şäame
.
	`__£tdo™
 (
execu‹
); \

611 } 0)

	)

618 
__ex‹º_šlše
 

619 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

621 ià(
__äame
->
__do_™
)

622 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

623 
	}
}

632 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

634 
__±h»ad_ş—nup_äame
 
__şäame
 \

635 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

636 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

637 .
__do_™
 = 1 };

	)

641 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

642 
__şäame
.
__do_™
 = (
execu‹
); \

643 } 0)

	)

645 #ifdeà
__USE_GNU


649 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

651 
__±h»ad_ş—nup_äame
 
__şäame
 \

652 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

653 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

654 .
__do_™
 = 1 }; \

655 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

656 &
__şäame
.
__ÿnûl_ty³
)

	)

661 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

662 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

663 
__şäame
.
__do_™
 = (
execu‹
); \

664 } 0)

	)

675 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

677 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

678 (*
__ÿnûl_routše
è(*èğ(
routše
); \

679 *
__ÿnûl_¬g
 = (
¬g
); \

680 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

681 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

682 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

684 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

685 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

689 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

690 dØ{

	)

691 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

692 
__ş—nup_fù_©Œibu‹
;

696 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

699 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

700 ià(
execu‹
) \

701 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

702 } 0)

	)

703 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

704 
__ş—nup_fù_©Œibu‹
;

706 #ifdeà
__USE_GNU


710 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

712 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

713 (*
__ÿnûl_routše
è(*èğ(
routše
); \

714 *
__ÿnûl_¬g
 = (
¬g
); \

715 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

716 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

717 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

719 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

720 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

724 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

725 dØ{

	)

726 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

727 
__ş—nup_fù_©Œibu‹
;

732 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

735 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

736 ià(
execu‹
) \

737 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

738 
	}
} 0)

	)

739 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

740 
__ş—nup_fù_©Œibu‹
;

744 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

745 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

746 #iâdeà
SHARED


747 
	`__©Œibu‹__
 ((
__w—k__
))

753 
__jmp_buf_g
;

754 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

760 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

761 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

762 
__THROW
 
	`__nÚnuÎ
 ((1));

765 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

766 
__THROW
 
	`__nÚnuÎ
 ((1));

769 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

770 
__THROWNL
 
	`__nÚnuÎ
 ((1));

773 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

774 
__THROWNL
 
	`__nÚnuÎ
 ((1));

776 #ifdeà
__USE_XOPEN2K


778 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

779 cÚ¡ 
time¥ec
 *
__»¡riù


780 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

784 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

785 
__THROWNL
 
	`__nÚnuÎ
 ((1));

789 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

790 
__»¡riù
 
__mu‹x
,

791 *
__»¡riù
 
__´ioûšg
)

792 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

796 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

797 
__´ioûšg
,

798 *
__»¡riù
 
__Şd_ûšg
)

799 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

802 #ifdeà
__USE_XOPEN2K8


804 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

805 
__THROW
 
	`__nÚnuÎ
 ((1));

806 #ifdeà
__USE_GNU


807 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

808 
__THROW
 
	`__nÚnuÎ
 ((1));

817 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

818 
__THROW
 
	`__nÚnuÎ
 ((1));

821 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

825 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

826 
__»¡riù
 
__©Œ
,

827 *
__»¡riù
 
__psh¬ed
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

831 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

832 
__psh¬ed
)

833 
__THROW
 
	`__nÚnuÎ
 ((1));

835 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


837 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


838 
__©Œ
, *
__»¡riù
 
__kšd
)

839 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

844 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

845 
__THROW
 
	`__nÚnuÎ
 ((1));

849 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

850 
__»¡riù
 
__©Œ
,

851 *
__»¡riù
 
__´ÙocŞ
)

852 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

856 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

857 
__´ÙocŞ
)

858 
__THROW
 
	`__nÚnuÎ
 ((1));

861 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

862 
__»¡riù
 
__©Œ
,

863 *
__»¡riù
 
__´ioûšg
)

864 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

867 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

868 
__´ioûšg
)

869 
__THROW
 
	`__nÚnuÎ
 ((1));

871 #ifdeà
__USE_XOPEN2K


873 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

874 *
__robu¡Ãss
)

875 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

876 #ifdeà
__USE_GNU


877 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

878 *
__robu¡Ãss
)

879 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

883 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

884 
__robu¡Ãss
)

885 
__THROW
 
	`__nÚnuÎ
 ((1));

886 #ifdeà
__USE_GNU


887 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

888 
__robu¡Ãss
)

889 
__THROW
 
	`__nÚnuÎ
 ((1));

894 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


899 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

900 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


901 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

904 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

905 
__THROW
 
	`__nÚnuÎ
 ((1));

908 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

909 
__THROWNL
 
	`__nÚnuÎ
 ((1));

912 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__nÚnuÎ
 ((1));

915 #ifdeà
__USE_XOPEN2K


917 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

918 cÚ¡ 
time¥ec
 *
__»¡riù


919 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

923 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

924 
__THROWNL
 
	`__nÚnuÎ
 ((1));

927 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__nÚnuÎ
 ((1));

930 #ifdeà
__USE_XOPEN2K


932 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

933 cÚ¡ 
time¥ec
 *
__»¡riù


934 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

938 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

939 
__THROWNL
 
	`__nÚnuÎ
 ((1));

945 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

946 
__THROW
 
	`__nÚnuÎ
 ((1));

949 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

954 
__»¡riù
 
__©Œ
,

955 *
__»¡riù
 
__psh¬ed
)

956 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

959 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

960 
__psh¬ed
)

961 
__THROW
 
	`__nÚnuÎ
 ((1));

964 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

965 
__»¡riù
 
__©Œ
,

966 *
__»¡riù
 
__´ef
)

967 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

970 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

971 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

979 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

980 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

981 
__THROW
 
	`__nÚnuÎ
 ((1));

984 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

985 
__THROW
 
	`__nÚnuÎ
 ((1));

988 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

989 
__THROWNL
 
	`__nÚnuÎ
 ((1));

992 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

993 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1000 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1001 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

1002 
	`__nÚnuÎ
 ((1, 2));

1011 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1012 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1013 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1014 
	`__nÚnuÎ
 ((1, 2, 3));

1019 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1020 
__THROW
 
	`__nÚnuÎ
 ((1));

1023 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1024 
__THROW
 
	`__nÚnuÎ
 ((1));

1027 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1028 
__»¡riù
 
__©Œ
,

1029 *
__»¡riù
 
__psh¬ed
)

1030 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1033 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1034 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1036 #ifdeà
__USE_XOPEN2K


1038 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1039 
__»¡riù
 
__©Œ
,

1040 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1041 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1044 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1045 
__şockid_t
 
__şock_id
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1050 #ifdeà
__USE_XOPEN2K


1055 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1056 
__THROW
 
	`__nÚnuÎ
 ((1));

1059 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1060 
__THROW
 
	`__nÚnuÎ
 ((1));

1063 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1064 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1067 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1068 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1071 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1072 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1079 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1080 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1081 
__©Œ
, 
__couÁ
)

1082 
__THROW
 
	`__nÚnuÎ
 ((1));

1085 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1086 
__THROW
 
	`__nÚnuÎ
 ((1));

1089 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1090 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1094 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1095 
__THROW
 
	`__nÚnuÎ
 ((1));

1098 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1099 
__THROW
 
	`__nÚnuÎ
 ((1));

1102 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1103 
__»¡riù
 
__©Œ
,

1104 *
__»¡riù
 
__psh¬ed
)

1105 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1108 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1109 
__psh¬ed
)

1110 
__THROW
 
	`__nÚnuÎ
 ((1));

1122 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1123 (*
__de¡r_funùiÚ
) (*))

1124 
__THROW
 
	`__nÚnuÎ
 ((1));

1127 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1130 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1133 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1134 cÚ¡ *
__poš‹r
è
__THROW
 ;

1137 #ifdeà
__USE_XOPEN2K


1139 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1140 
__şockid_t
 *
__şock_id
)

1141 
__THROW
 
	`__nÚnuÎ
 ((2));

1156 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1157 (*
__·»Á
) (),

1158 (*
__chd
è()è
__THROW
;

1161 #ifdeà
__USE_EXTERN_INLINES


1163 
__ex‹º_šlše
 

1164 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1166  
__th»ad1
 =ğ
__th»ad2
;

1167 
	}
}

1170 
	g__END_DECLS


	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

30 
	#__Ãed_time_t


	)

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

34 #iâdeà
__pid_t_defšed


35 
__pid_t
 
	tpid_t
;

36 
	#__pid_t_defšed


	)

41 
	~<b™s/sched.h
>

43 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

46 
__BEGIN_DECLS


49 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

50 
__THROW
;

53 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

56 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

57 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

60 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

63 
	$sched_y›ld
 (è
__THROW
;

66 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

69 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

72 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

75 #ifdeà
__USE_GNU


77 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

78 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

80 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

81 
ıu£
)

	)

82 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

83 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

86 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

87 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

88 
ıu£
)

	)

89 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

90 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

92 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

93 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

94 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

95 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

97 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

103 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

104 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

105 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

107 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

110 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

111 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

112 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

116 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

117 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

120 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

121 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

124 
__END_DECLS


	@/usr/include/setjmp.h

22 #iâdef 
_SETJMP_H


23 
	#_SETJMP_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/£tjmp.h
>

30 
	~<b™s/sig£t.h
>

34 
	s__jmp_buf_g


40 
__jmp_buf
 
	m__jmpbuf
;

41 
	m__mask_was_§ved
;

42 
__sig£t_t
 
	m__§ved_mask
;

46 
__BEGIN_NAMESPACE_STD


48 
__jmp_buf_g
 
	tjmp_buf
[1];

52 
	$£tjmp
 (
jmp_buf
 
__’v
è
__THROWNL
;

54 
__END_NAMESPACE_STD


59 
	$__sig£tjmp
 (
__jmp_buf_g
 
__’v
[1], 
__§vemask
è
__THROWNL
;

63 
	$_£tjmp
 (
__jmp_buf_g
 
__’v
[1]è
__THROWNL
;

67 
	#£tjmp
(
’v
è
	`_£tjmp
 (’v)

	)

70 
__BEGIN_NAMESPACE_STD


74 
	$lÚgjmp
 (
__jmp_buf_g
 
__’v
[1], 
__v®
)

75 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

77 
__END_NAMESPACE_STD


79 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


83 
	$_lÚgjmp
 (
__jmp_buf_g
 
__’v
[1], 
__v®
)

84 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

88 #ifdef 
__USE_POSIX


92 
__jmp_buf_g
 
	tsigjmp_buf
[1];

96 
	#sig£tjmp
(
’v
, 
§vemask
è
	`__sig£tjmp
 (’v, savemask)

	)

102 
	$siglÚgjmp
 (
sigjmp_buf
 
__’v
, 
__v®
)

103 
__THROWNL
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

108 #ià
__USE_FORTIFY_LEVEL
 > 0

109 
	~<b™s/£tjmp2.h
>

112 
__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


24 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	~<b™s/sig£t.h
>

36 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


37 #iâdeà
__sig_©omic_t_defšed


38 
	#__sig_©omic_t_defšed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #undeà
__Ãed_sig_©omic_t


46 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

47 #iâdeà
__sig£t_t_defšed


48 
	#__sig£t_t_defšed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #undeà
__Ãed_sig£t_t


54 #ifdeà
_SIGNAL_H


56 
	~<b™s/ty³s.h
>

57 
	~<b™s/signum.h
>

59 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


60 #iâdeà
__pid_t_defšed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defšed


	)

64 #ifdeà
__USE_XOPEN


66 #iâdeà
__uid_t_defšed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defšed


	)

72 #ifdeà
__USE_POSIX199309


74 
	#__Ãed_time¥ec


	)

75 
	~<time.h
>

78 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


80 
	~<b™s/sigšfo.h
>

85 (*
	t__sighªdËr_t
) ();

90 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

91 
__THROW
;

92 #ifdeà
__USE_GNU


93 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifdeà
__USE_BSD


102 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

103 
__THROW
;

106 #ifdeà
__REDIRECT_NTH


107 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

108 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

109 
__sysv_sigÇl
);

111 
	#sigÇl
 
__sysv_sigÇl


	)

114 
__END_NAMESPACE_STD


116 #ifdeà
__USE_XOPEN


119 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

120 
__THROW
;

126 #ifdeà
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

130 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


134 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$¿i£
 (
__sig
è
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifdeà
__USE_SVID


144 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

145 
__THROW
;

146 
	$gsigÇl
 (
__sig
è
__THROW
;

149 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K


151 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

154 #ifdeà
__USE_XOPEN2K


156 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

167 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

169 #ifdeà
__USE_XOPEN


170 #ifdeà
__GNUC__


171 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

174 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

179 #ifdeà
__USE_BSD


186 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

189 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

192 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

195 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

199 #ifdeà
__USE_MISC


200 
	#NSIG
 
_NSIG


	)

203 #ifdeà
__USE_GNU


204 
__sighªdËr_t
 
	tsighªdËr_t
;

208 #ifdeà
__USE_BSD


209 
__sighªdËr_t
 
	tsig_t
;

212 #ifdeà
__USE_POSIX


215 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

224 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

227 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

228 
__THROW
 
	`__nÚnuÎ
 ((1));

230 #ifdeà
__USE_GNU


232 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

235 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

236 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

239 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

240 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

245 
	~<b™s/sigaùiÚ.h
>

248 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

249 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

256 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

259 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

260 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

263 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

270 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

271 
	`__nÚnuÎ
 ((1, 2));

273 #ifdeà
__USE_POSIX199309


278 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

279 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

286 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

287 
sigšfo_t
 *
__»¡riù
 
__šfo
,

288 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

289 
	`__nÚnuÎ
 ((1));

293 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

294 
__THROW
;

299 #ifdeà
__USE_BSD


303 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

304 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

307 
	ssigvec


309 
__sighªdËr_t
 
sv_hªdËr
;

310 
sv_mask
;

312 
sv_æags
;

313 
	#sv_Ú¡ack
 
sv_æags


	)

317 
	#SV_ONSTACK
 (1 << 0)

	)

318 
	#SV_INTERRUPT
 (1 << 1)

	)

319 
	#SV_RESETHAND
 (1 << 2)

	)

327 
	$sigvec
 (
__sig
, cÚ¡ 
sigvec
 *
__vec
,

328 
sigvec
 *
__ovec
è
__THROW
;

332 
	~<b™s/sigcÚ‹xt.h
>

335 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

340 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


341 
	#__Ãed_size_t


	)

342 
	~<¡ddef.h
>

347 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

349 
	~<b™s/sig¡ack.h
>

350 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


352 
	~<sys/ucÚ‹xt.h
>

358 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

359 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

363 
	$sig®t¡ack
 (cÚ¡ 
sig®t¡ack
 *
__»¡riù
 
__ss
,

364 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

368 #ifdeà
__USE_XOPEN_EXTENDED


372 
	$sighŞd
 (
__sig
è
__THROW
;

375 
	$sig»l£
 (
__sig
è
__THROW
;

378 
	$sigignÜe
 (
__sig
è
__THROW
;

381 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

384 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


387 
	~<b™s/±h»adty³s.h
>

388 
	~<b™s/sigth»ad.h
>

395 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

397 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

401 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #iâdeà
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
è
	)
c

279 
	#INT16_C
(
c
è
	)
c

280 
	#INT32_C
(
c
è
	)
c

281 #ià
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
èø## 
L


	)

284 
	#INT64_C
(
c
èø## 
LL


	)

288 
	#UINT8_C
(
c
è
	)
c

289 
	#UINT16_C
(
c
è
	)
c

290 
	#UINT32_C
(
c
èø## 
U


	)

291 #ià
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
èø## 
UL


	)

294 
	#UINT64_C
(
c
èø## 
ULL


	)

298 #ià
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
èø## 
L


	)

300 
	#UINTMAX_C
(
c
èø## 
UL


	)

302 
	#INTMAX_C
(
c
èø## 
LL


	)

303 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


25 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	#__Ãed_FILE


	)

37 
	#__Ãed___FILE


	)

41 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

51 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

52 || 
defšed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defšed
 1

	)

58 #undeà
__Ãed_FILE


61 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defšed
 1

	)

68 #undeà
__Ãed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


77 #ifdeà
__GNUC__


78 #iâdeà
_VA_LIST_DEFINED


79 
_G_va_li¡
 
	tva_li¡
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<¡d¬g.h
>

87 #ifdeà
__USE_XOPEN2K8


88 #iâdeà
__off_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defšed


	)

96 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defšed


	)

101 #iâdeà
__ssize_t_defšed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defšed


	)

108 
__BEGIN_NAMESPACE_STD


109 #iâdeà
__USE_FILE_OFFSET64


110 
_G_åos_t
 
	tåos_t
;

112 
_G_åos64_t
 
	tåos_t
;

114 
__END_NAMESPACE_STD


115 #ifdeà
__USE_LARGEFILE64


116 
_G_åos64_t
 
	tåos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #iâdeà
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #iâdeà
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifdeà
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


151 
	#P_tmpdœ
 "/tmp"

	)

164 
	~<b™s/¡dio_lim.h
>

168 
_IO_FILE
 *
¡dš
;

169 
_IO_FILE
 *
¡dout
;

170 
_IO_FILE
 *
¡d”r
;

172 
	#¡dš
 
¡dš


	)

173 
	#¡dout
 
¡dout


	)

174 
	#¡d”r
 
¡d”r


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

180 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifdeà
__USE_ATFILE


185 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

186 cÚ¡ *
__Ãw
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #iâdeà
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (è
__wur
;

197 #ifdeà
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifdeà
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (è
__wur
;

209 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifdeà
__USE_MISC


215 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

219 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


227 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

228 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fşo£
 (
FILE
 *
__¡»am
);

242 
	`fæush
 (
FILE
 *
__¡»am
);

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_MISC


252 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

255 #ifdeà
__USE_GNU


262 
	`fşo£®l
 ();

266 
__BEGIN_NAMESPACE_STD


267 #iâdeà
__USE_FILE_OFFSET64


272 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

278 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

279 cÚ¡ *
__»¡riù
 
__modes
,

280 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

282 #ifdeà
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

284 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

287 cÚ¡ *
__»¡riù
 
__modes
,

288 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

289 
__wur
;

291 
	#fİ’
 
fİ’64


	)

292 
	#äeİ’
 
äeİ’64


	)

295 
__END_NAMESPACE_STD


296 #ifdeà
__USE_LARGEFILE64


297 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

298 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

299 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

300 cÚ¡ *
__»¡riù
 
__modes
,

301 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

313 cÚ¡ *
__»¡riù
 
__modes
,

314 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

317 #ifdeà
__USE_XOPEN2K8


319 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

337 
__modes
, 
size_t
 
__n
è
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

344 
size_t
 
__size
è
__THROW
;

347 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

357 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

362 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

364 
	$¥rštf
 (*
__»¡riù
 
__s
,

365 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

371 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

372 
_G_va_li¡
 
__¬g
);

377 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

379 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

380 
_G_va_li¡
 
__¬g
è
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

387 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

388 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

390 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

391 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

392 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifdeà
__USE_GNU


399 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

400 
_G_va_li¡
 
__¬g
)

401 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

402 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

403 cÚ¡ *
__»¡riù
 
__fmt
, ...)

404 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

405 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

406 cÚ¡ *
__»¡riù
 
__fmt
, ...)

407 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

410 #ifdeà
__USE_XOPEN2K8


412 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

413 
_G_va_li¡
 
__¬g
)

414 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

415 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

416 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

426 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

431 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

434 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

436 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

444 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

445 
__isoc99_fsÿnf
è
__wur
;

446 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

447 
__isoc99_sÿnf
è
__wur
;

448 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

449 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

450 
__isoc99_ssÿnf
);

452 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

454 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

455 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

456 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

457 
	#fsÿnf
 
__isoc99_fsÿnf


	)

458 
	#sÿnf
 
__isoc99_sÿnf


	)

459 
	#ssÿnf
 
__isoc99_ssÿnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

472 
_G_va_li¡
 
__¬g
)

473 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

479 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

483 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

484 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

485 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

487 #ià!
defšed
 
__USE_GNU
 \

488 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

489 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

490 #ifdeà
__REDIRECT


494 
	`__REDIRECT
 (
vfsÿnf
,

495 (
FILE
 *
__»¡riù
 
__s
,

496 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

497 
__isoc99_vfsÿnf
)

498 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

499 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

500 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

501 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

502 
	`__REDIRECT_NTH
 (
vssÿnf
,

503 (cÚ¡ *
__»¡riù
 
__s
,

504 cÚ¡ *
__»¡riù
 
__fÜm©
,

505 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

506 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

508 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

509 cÚ¡ *
__»¡riù
 
__fÜm©
,

510 
_G_va_li¡
 
__¬g
è
__wur
;

511 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

512 
_G_va_li¡
 
__¬g
è
__wur
;

513 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

514 cÚ¡ *
__»¡riù
 
__fÜm©
,

515 
_G_va_li¡
 
__¬g
è
__THROW
;

516 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

517 
	#vsÿnf
 
__isoc99_vsÿnf


	)

518 
	#vssÿnf
 
__isoc99_vssÿnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fg‘c
 (
FILE
 *
__¡»am
);

532 
	`g‘c
 (
FILE
 *
__¡»am
);

538 
	`g‘ch¬
 ();

539 
__END_NAMESPACE_STD


543 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

545 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


550 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

551 
	`g‘ch¬_uÆocked
 ();

554 #ifdeà
__USE_MISC


561 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

574 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

580 
	`putch¬
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

587 #ifdeà
__USE_MISC


594 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

597 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


602 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

603 
	`putch¬_uÆocked
 (
__c
);

607 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

608 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

610 
	`g‘w
 (
FILE
 *
__¡»am
);

613 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

623 
__wur
;

625 #ià!
defšed
 
__USE_ISOC11
 \

626 || (
defšed
 
__ılu¥lus
 && __cplusplus <= 201103L)

638 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

640 
__END_NAMESPACE_STD


642 #ifdeà
__USE_GNU


649 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

650 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

666 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

667 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

668 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

669 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

670 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

678 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

679 
size_t
 *
__»¡riù
 
__n
,

680 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

695 
	`puts
 (cÚ¡ *
__s
);

702 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

709 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

715 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

716 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_GNU


726 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

727 
FILE
 *
__»¡riù
 
__¡»am
);

730 #ifdeà
__USE_MISC


737 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

739 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

740 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

754 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

759 
	`»wšd
 (
FILE
 *
__¡»am
);

760 
__END_NAMESPACE_STD


767 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


768 #iâdeà
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

778 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

780 #ifdeà
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#á–lo
 
á–lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #iâdeà
__USE_FILE_OFFSET64


798 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

803 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

805 #ifdeà
__REDIRECT


806 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

807 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

808 
	`__REDIRECT
 (
f£os
,

809 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

811 
	#fg‘pos
 
fg‘pos64


	)

812 
	#f£os
 
f£os64


	)

815 
__END_NAMESPACE_STD


817 #ifdeà
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

819 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

820 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

821 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

828 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifdeà
__USE_MISC


835 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

836 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

837 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`³¼Ü
 (cÚ¡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<b™s/sys_”¾i¡.h
>

856 #ifdef 
__USE_POSIX


858 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

861 #ifdeà
__USE_MISC


863 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

867 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

868 
defšed
 
__USE_MISC
)

873 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

879 
	`pşo£
 (
FILE
 *
__¡»am
);

883 #ifdef 
__USE_POSIX


885 *
	$ù”mid
 (*
__s
è
__THROW
;

889 #ifdeà
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob¡ack
;

899 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

900 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

901 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

902 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

903 cÚ¡ *
__»¡riù
 
__fÜm©
,

904 
_G_va_li¡
 
__¬gs
)

905 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

909 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


913 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

917 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

920 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

923 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


927 
	#__Ãed_g‘İt


	)

928 
	~<g‘İt.h
>

933 #ifdeà
__USE_EXTERN_INLINES


934 
	~<b™s/¡dio.h
>

936 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


937 
	~<b™s/¡dio2.h
>

939 #ifdeà
__LDBL_COMPAT


940 
	~<b™s/¡dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_BSD


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_BSD


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_BSD


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	`©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	`©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 \

610 || 
defšed
 
__USE_XOPEN2K8


619 #iâdeà
__USE_FILE_OFFSET64


620 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

622 #ifdeà
__REDIRECT


623 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

624 
	`__nÚnuÎ
 ((1)è
__wur
;

626 
	#mk¡emp
 
mk¡emp64


	)

629 #ifdeà
__USE_LARGEFILE64


630 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

634 #ifdeà
__USE_MISC


641 #iâdeà
__USE_FILE_OFFSET64


642 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

644 #ifdeà
__REDIRECT


645 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

646 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

648 
	#mk¡emps
 
mk¡emps64


	)

651 #ifdeà
__USE_LARGEFILE64


652 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

653 
	`__nÚnuÎ
 ((1)è
__wur
;

657 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K8


663 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

666 #ifdeà
__USE_GNU


673 #iâdeà
__USE_FILE_OFFSET64


674 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

676 #ifdeà
__REDIRECT


677 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

678 
	`__nÚnuÎ
 ((1)è
__wur
;

680 
	#mko¡emp
 
mko¡emp64


	)

683 #ifdeà
__USE_LARGEFILE64


684 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

693 #iâdeà
__USE_FILE_OFFSET64


694 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

695 
	`__nÚnuÎ
 ((1)è
__wur
;

697 #ifdeà
__REDIRECT


698 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

699 
__æags
), 
mko¡emps64
)

700 
	`__nÚnuÎ
 ((1)è
__wur
;

702 
	#mko¡emps
 
mko¡emps64


	)

705 #ifdeà
__USE_LARGEFILE64


706 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

707 
	`__nÚnuÎ
 ((1)è
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

725 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

728 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


734 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

735 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

740 #iâdeà
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com·r_â_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com·r_â_t
 
	tcom·risÚ_â_t
;

748 #ifdeà
__USE_GNU


749 (*
	t__com·r_d_â_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

756 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

757 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

759 #ifdeà
__USE_EXTERN_INLINES


760 
	~<b™s/¡dlib-b£¬ch.h
>

765 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

766 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

767 #ifdeà
__USE_GNU


768 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

769 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

770 
	`__nÚnuÎ
 ((1, 4));

775 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

777 
__END_NAMESPACE_STD


779 #ifdeà
__USE_ISOC99


780 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

781 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__num”
, 
__d’om
)

790 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

792 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

793 
__END_NAMESPACE_STD


795 #ifdeà
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

798 
__d’om
)

799 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

800 
__END_NAMESPACE_C99


804 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

805 || 
defšed
 
__USE_SVID


812 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

813 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

818 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

819 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

824 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

825 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

828 #ifdeà
__USE_MISC


830 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

831 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

832 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

833 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

834 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

835 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

836 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

837 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

842 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

843 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

844 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

846 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

847 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

850 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

851 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

852 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

854 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

855 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

856 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

866 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

867 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

870 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

874 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

875 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

877 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

878 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifdeà
__USE_SVID


888 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


899 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

900 *cÚ¡ *
__»¡riù
 
__tok’s
,

901 **
__»¡riù
 
__v®u•
)

902 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

906 #ifdeà
__USE_XOPEN


908 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

914 #ifdeà
__USE_XOPEN2KXSI


916 
	$posix_İ’±
 (
__oæag
è
__wur
;

919 #ifdeà
__USE_XOPEN


924 
	$g¿Á±
 (
__fd
è
__THROW
;

928 
	$uÆock±
 (
__fd
è
__THROW
;

933 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

936 #ifdeà
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

941 
__THROW
 
	`__nÚnuÎ
 ((2));

944 
	`g‘±
 ();

947 #ifdeà
__USE_BSD


951 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

952 
__THROW
 
	`__nÚnuÎ
 ((1));

955 
	~<b™s/¡dlib-æßt.h
>

958 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


959 
	~<b™s/¡dlib.h
>

961 #ifdeà
__LDBL_COMPAT


962 
	~<b™s/¡dlib-ldbl.h
>

966 #undeà
__Ãed_m®loc_ªd_ÿÎoc


968 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

39 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

47 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

50 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

51 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


58 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

69 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

73 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


91  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifdeà
__USE_GNU


104 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

107 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

110 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

111 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

115 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

118 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

133 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

137 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

138 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

141 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

144 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

151 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

154 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

155 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

156 
__THROW
 
	`__nÚnuÎ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifdeà
__USE_XOPEN2K8


163 
	~<xloÿË.h
>

166 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

167 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

169 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

170 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

173 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

174 || 
defšed
 
__USE_XOPEN2K8


176 *
	$¡rdup
 (cÚ¡ *
__s
)

177 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_XOPEN2K8


184 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

185 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

188 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


190 
	#¡rdu·
(
s
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

196 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

197 
	}
}))

	)

200 
	#¡ºdu·
(
s
, 
n
) \

201 (
__ex‹nsiÚ__
 \

203 cÚ¡ *
__Şd
 = (
s
); \

204 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

205 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

206 
__Ãw
[
__Ën
] = '\0'; \

207 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
¡rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

218 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

221 #ifdeà
__OPTIMIZE__


222 
__ex‹º_®ways_šlše
 *

223 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


225  
__butš_¡rchr
 (
__s
, 
__c
);

228 
__ex‹º_®ways_šlše
 const *

229 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


231  
__butš_¡rchr
 (
__s
, 
__c
);

236 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

237 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`¡¼chr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

245 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

248 #ifdeà
__OPTIMIZE__


249 
__ex‹º_®ways_šlše
 *

250 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


252  
	`__butš_¡¼chr
 (
__s
, 
__c
);

255 
__ex‹º_®ways_šlše
 const *

256 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


258  
	`__butš_¡¼chr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

264 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifdeà
__USE_GNU


271 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

274 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

278 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

286 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

289 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

290 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

296 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

298 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

300 #ifdeà
__OPTIMIZE__


301 
__ex‹º_®ways_šlše
 *

302 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


304  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

307 
__ex‹º_®ways_šlše
 const *

308 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


310  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

313 
	}
}

315 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

316 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

323 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

324 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

325 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__OPTIMIZE__


328 
__ex‹º_®ways_šlše
 *

329 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


331  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

334 
__ex‹º_®ways_šlše
 const *

335 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


337  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

340 
	}
}

342 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

343 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

348 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

349 
__THROW
 
	`__nÚnuÎ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

355 cÚ¡ *
__»¡riù
 
__d–im
,

356 **
__»¡riù
 
__§ve_±r
)

357 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

358 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


359 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

360 **
__»¡riù
 
__§ve_±r
)

361 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

364 #ifdeà
__USE_GNU


366 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

368 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

369 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

370 cÚ¡ *
__ÃedË
)

371 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

374 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

378 #ifdeà
__USE_GNU


382 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

383 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

384 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

388 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

389 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

390 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

391 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

392 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

400 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

407 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

414 
__END_NAMESPACE_STD


415 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


423 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


426 #ifdeà
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

428 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

429 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

431 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

433 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

438 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

439 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

443 #ifdeà
__USE_XOPEN2K8


445 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

451 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

453 #ifdeà
__USE_BSD


455 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

462 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

466 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`šdex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

471 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

474 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__ex‹º_®ways_šlše
 *

476 
	`šdex
 (*
__s
, 
__c
è
__THROW


478  
	`__butš_šdex
 (
__s
, 
__c
);

481 
__ex‹º_®ways_šlše
 const *

482 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


484  
	`__butš_šdex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

490 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`ršdex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

499 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

502 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__ex‹º_®ways_šlše
 *

504 
	`ršdex
 (*
__s
, 
__c
è
__THROW


506  
	`__butš_ršdex
 (
__s
, 
__c
);

509 
__ex‹º_®ways_šlše
 const *

510 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


512  
	`__butš_ršdex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

518 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

523 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdef 
__USE_GNU


528 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

530 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

534 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

535 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

538 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

546 
__loÿË_t
 
__loc
)

547 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

549 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

550 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

551 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

558 cÚ¡ *
__»¡riù
 
__d–im
)

559 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

567 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

568 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

574 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

575 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

578 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

585 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

588 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 #iâdeà
ba£Çme


598 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£Çme
 (*
__f’ame
)

600 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

601 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

604 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

610 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

611 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

612 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


632 
	~<b™s/¡ršg.h
>

635 
	~<b™s/¡ršg2.h
>

638 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


640 
	~<b™s/¡ršg3.h
>

644 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_SVID


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifdeà
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #–ià
defšed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #–ià
defšed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<b™s/posix_İt.h
>

205 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


206 
	~<b™s/’vœÚm’ts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<b™s/ty³s.h
>

219 #iâdef 
__ssize_t_defšed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_defšed


	)

224 
	#__Ãed_size_t


	)

225 
	#__Ãed_NULL


	)

226 
	~<¡ddef.h
>

228 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


231 #iâdeà
__gid_t_defšed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_defšed


	)

236 #iâdeà
__uid_t_defšed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_defšed


	)

241 #iâdeà
__off_t_defšed


242 #iâdeà
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_defšed


	)

249 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_defšed


	)

254 #iâdeà
__u£cÚds_t_defšed


255 
__u£cÚds_t
 
	tu£cÚds_t
;

256 
	#__u£cÚds_t_defšed


	)

259 #iâdeà
__pid_t_defšed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_defšed


	)

265 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


266 #iâdeà
__šŒ_t_defšed


267 
__šŒ_t
 
	tšŒ_t
;

268 
	#__šŒ_t_defšed


	)

272 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


273 #iâdeà
__sockËn_t_defšed


274 
__sockËn_t
 
	tsockËn_t
;

275 
	#__sockËn_t_defšed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

289 #ifdeà
__USE_GNU


292 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

293 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

297 
__THROW
 
	`__nÚnuÎ
 ((1));

300 #ifdeà
__USE_ATFILE


304 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

310 #iâdef 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifdeà
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #iâdeà
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

336 #ifdeà
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifdeà
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

346 
__THROW
;

353 
	`şo£
 (
__fd
);

360 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

366 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

368 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


369 #iâdeà
__USE_FILE_OFFSET64


376 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

377 
__off_t
 
__off£t
è
__wur
;

384 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
è
__wur
;

387 #ifdeà
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

389 
__off64_t
 
__off£t
),

390 
´—d64
è
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

392 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

393 
pwr™e64
è
__wur
;

395 
	#´—d
 
´—d64


	)

396 
	#pwr™e
 
pwr™e64


	)

400 #ifdeà
__USE_LARGEFILE64


404 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

405 
__off64_t
 
__off£t
è
__wur
;

408 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
è
__wur
;

417 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

419 #ifdeà
__USE_GNU


422 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

432 
	$®¬m
 (
__£cÚds
è
__THROW
;

444 
	`¦“p
 (
__£cÚds
);

446 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

447 || 
defšed
 
__USE_BSD


452 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

453 
__THROW
;

460 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

469 
	`·u£
 ();

473 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

476 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

483 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

488 #ifdeà
__USE_ATFILE


491 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

492 
__gid_t
 
__group
, 
__æag
)

493 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

497 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

499 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


501 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

511 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

520 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

521 || 
defšed
 
__USE_BSD


525 *
	$g‘wd
 (*
__buf
)

526 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

531 
	$dup
 (
__fd
è
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

536 #ifdeà
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

543 **
__’vœÚ
;

544 #ifdeà
__USE_GNU


545 **
’vœÚ
;

551 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

552 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

554 #ifdeà
__USE_XOPEN2K8


557 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

558 
__THROW
 
	`__nÚnuÎ
 ((2));

563 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

564 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

568 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

569 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

573 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

578 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

585 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 #ifdeà
__USE_GNU


590 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

591 *cÚ¡ 
__’vp
[])

592 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

596 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


598 
	$niû
 (
__šc
è
__THROW
 
__wur
;

603 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

609 
	~<b™s/cÚâame.h
>

612 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

613 
__THROW
 
	`__nÚnuÎ
 ((1));

616 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

619 
	$syscÚf
 (
__Çme
è
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

628 
__pid_t
 
	$g‘pid
 (è
__THROW
;

631 
__pid_t
 
	$g‘µid
 (è
__THROW
;

634 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

637 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

638 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


639 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

646 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

648 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


660 
	$£g½
 (è
__THROW
;

667 
__pid_t
 
	$£tsid
 (è
__THROW
;

669 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


671 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

675 
__uid_t
 
	$g‘uid
 (è
__THROW
;

678 
__uid_t
 
	$g‘euid
 (è
__THROW
;

681 
__gid_t
 
	$g‘gid
 (è
__THROW
;

684 
__gid_t
 
	$g‘egid
 (è
__THROW
;

689 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

702 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


705 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

708 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


710 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

719 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


722 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


727 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

730 #ifdeà
__USE_GNU


733 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

734 
__THROW
;

738 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

739 
__THROW
;

743 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

744 
__THROW
 
__wur
;

748 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

758 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

759 || 
defšed
 
__USE_BSD


764 
__pid_t
 
	$vfÜk
 (è
__THROW
;

770 *
	$‰yÇme
 (
__fd
è
__THROW
;

774 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

775 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

779 
	$i§‰y
 (
__fd
è
__THROW
;

781 #ià
defšed
 
__USE_BSD
 \

782 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

785 
	$‰y¦Ù
 (è
__THROW
;

790 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

791 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

793 #ifdeà
__USE_ATFILE


796 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

797 cÚ¡ *
__to
, 
__æags
)

798 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

801 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


803 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

804 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

809 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

810 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

811 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

814 #ifdeà
__USE_ATFILE


816 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

817 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

820 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

821 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

822 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

826 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

828 #ifdeà
__USE_ATFILE


830 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

831 
__THROW
 
	`__nÚnuÎ
 ((2));

835 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

839 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

842 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

849 *
	`g‘logš
 ();

850 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


857 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__Ãed_g‘İt


	)

871 
	~<g‘İt.h
>

875 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


879 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

883 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

886 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

887 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

897 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

898 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

899 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

900 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

906 
	$vhªgup
 (è
__THROW
;

909 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

917 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sÿË
)

919 
__THROW
 
	`__nÚnuÎ
 ((1));

925 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

929 *
	$g‘u£rsh–l
 (è
__THROW
;

930 
	$’du£rsh–l
 (è
__THROW
;

931 
	$£tu£rsh–l
 (è
__THROW
;

937 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

941 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

944 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

948 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifdeà
__USE_GNU


962 
	$syncfs
 (
__fd
è
__THROW
;

966 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


969 
	`g‘ho¡id
 ();

972 
	$sync
 (è
__THROW
;

975 #ià
defšed
 
__USE_BSD
 || !defšed 
__USE_XOPEN2K


978 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

983 
	$g‘dbËsize
 (è
__THROW
;

989 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


992 #iâdeà
__USE_FILE_OFFSET64


993 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

994 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

996 #ifdeà
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

998 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

999 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1001 
	#Œunÿ‹
 
Œunÿ‹64


	)

1004 #ifdeà
__USE_LARGEFILE64


1005 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1006 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1011 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_POSIX199309
 \

1012 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1015 #iâdeà
__USE_FILE_OFFSET64


1016 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1018 #ifdeà
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1020 
árunÿ‹64
è
__wur
;

1022 
	#árunÿ‹
 
árunÿ‹64


	)

1025 #ifdeà
__USE_LARGEFILE64


1026 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1032 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1033 || 
defšed
 
__USE_MISC


1037 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1043 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1047 #ifdeà
__USE_MISC


1058 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1063 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #iâdeà
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1083 #ifdeà
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1085 
lockf64
è
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifdeà
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1096 #ifdeà
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1102 (
__ex‹nsiÚ__
 \

1103 ({ 
__»suÉ
; \

1104 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1105 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1106 
__»suÉ
; 
	}
}))

	)

1109 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1112 
fd©async
 (
__fdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1121 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1125 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1126 
__THROW
 
	`__nÚnuÎ
 ((1));

1133 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1134 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1140 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1142 *
	$ù”mid
 (*
__s
è
__THROW
;

1147 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1148 
	~<b™s/uni¡d.h
>

1151 
__END_DECLS


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/atomic_ops/ao_version.h

23 #iâdeà
AO_ATOMIC_OPS_H


24 #”rÜ 
This
 
fe
 
should
 
nÙ
 
be
 
šşuded
 
dœeùly
.

35 
	#AO_VERSION_MAJOR
 7

	)

36 
	#AO_VERSION_MINOR
 4

	)

37 
	#AO_VERSION_MICRO
 0

	)

	@/usr/include/atomic_ops/sysdeps/ao_t_is_int.h

26 #ià
defšed
(
AO_HAVE_lßd
è&& !defšed(
AO_HAVE_št_lßd
)

27 
	#AO_št_lßd
(
addr
) \

28 ()
	`AO_lßd
((cÚ¡ vŞ©
AO_t
 *)(
addr
))

	)

29 
	#AO_HAVE_št_lßd


	)

32 #ià
defšed
(
AO_HAVE_¡Üe
è&& !defšed(
AO_HAVE_št_¡Üe
)

33 
	#AO_št_¡Üe
(
addr
, 
v®
) \

34 
	`AO_¡Üe
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

35 
	#AO_HAVE_št_¡Üe


	)

38 #ià
defšed
(
AO_HAVE_ãtch_ªd_add
) \

39 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add
)

40 
	#AO_št_ãtch_ªd_add
(
addr
, 
šü
) \

41 ()
	`AO_ãtch_ªd_add
((vŞ©
AO_t
 *)(
addr
), \

42 (
AO_t
)(
šü
))

	)

43 
	#AO_HAVE_št_ãtch_ªd_add


	)

46 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1
) \

47 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1
)

48 
	#AO_št_ãtch_ªd_add1
(
addr
) \

49 ()
	`AO_ãtch_ªd_add1
((vŞ©
AO_t
 *)(
addr
))

	)

50 
	#AO_HAVE_št_ãtch_ªd_add1


	)

53 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1
) \

54 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1
)

55 
	#AO_št_ãtch_ªd_sub1
(
addr
) \

56 ()
	`AO_ãtch_ªd_sub1
((vŞ©
AO_t
 *)(
addr
))

	)

57 
	#AO_HAVE_št_ãtch_ªd_sub1


	)

60 #ià
	`defšed
(
AO_HAVE_ªd
è&& !defšed(
AO_HAVE_št_ªd
)

61 
	#AO_št_ªd
(
addr
, 
v®
) \

62 
	`AO_ªd
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

63 
	#AO_HAVE_št_ªd


	)

66 #ià
	`defšed
(
AO_HAVE_Ü
è&& !defšed(
AO_HAVE_št_Ü
)

67 
	#AO_št_Ü
(
addr
, 
v®
) \

68 
	`AO_Ü
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

69 
	#AO_HAVE_št_Ü


	)

72 #ià
	`defšed
(
AO_HAVE_xÜ
è&& !defšed(
AO_HAVE_št_xÜ
)

73 
	#AO_št_xÜ
(
addr
, 
v®
) \

74 
	`AO_xÜ
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

75 
	#AO_HAVE_št_xÜ


	)

78 #ià
	`defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­
) \

79 && !
	$defšed
(
AO_HAVE_št_ãtch_com·»_ªd_sw­
)

80 
	#AO_št_ãtch_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
) \

81 ()
	`AO_ãtch_com·»_ªd_sw­
((vŞ©
AO_t
 *)(
addr
), \

82 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

83 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­


	)

86 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­
) \

87 && !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­
)

88 
	#AO_št_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
) \

89 
	`AO_com·»_ªd_sw­
((vŞ©
AO_t
 *)(
addr
), \

90 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

91 
	#AO_HAVE_št_com·»_ªd_sw­


	)

118 #ià
	`defšed
(
AO_HAVE_lßd_fuÎ
è&& !defšed(
AO_HAVE_št_lßd_fuÎ
)

119 
	#AO_št_lßd_fuÎ
(
addr
) \

120 ()
	`AO_lßd_fuÎ
((cÚ¡ vŞ©
AO_t
 *)(
addr
))

	)

121 
	#AO_HAVE_št_lßd_fuÎ


	)

124 #ià
	`defšed
(
AO_HAVE_¡Üe_fuÎ
è&& !defšed(
AO_HAVE_št_¡Üe_fuÎ
)

125 
	#AO_št_¡Üe_fuÎ
(
addr
, 
v®
) \

126 
	`AO_¡Üe_fuÎ
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

127 
	#AO_HAVE_št_¡Üe_fuÎ


	)

130 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_fuÎ
) \

131 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_fuÎ
)

132 
	#AO_št_ãtch_ªd_add_fuÎ
(
addr
, 
šü
) \

133 ()
	`AO_ãtch_ªd_add_fuÎ
((vŞ©
AO_t
 *)(
addr
), \

134 (
AO_t
)(
šü
))

	)

135 
	#AO_HAVE_št_ãtch_ªd_add_fuÎ


	)

138 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_fuÎ
) \

139 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_fuÎ
)

140 
	#AO_št_ãtch_ªd_add1_fuÎ
(
addr
) \

141 ()
	`AO_ãtch_ªd_add1_fuÎ
((vŞ©
AO_t
 *)(
addr
))

	)

142 
	#AO_HAVE_št_ãtch_ªd_add1_fuÎ


	)

145 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_fuÎ
) \

146 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_fuÎ
)

147 
	#AO_št_ãtch_ªd_sub1_fuÎ
(
addr
) \

148 ()
	`AO_ãtch_ªd_sub1_fuÎ
((vŞ©
AO_t
 *)(
addr
))

	)

149 
	#AO_HAVE_št_ãtch_ªd_sub1_fuÎ


	)

152 #ià
	`defšed
(
AO_HAVE_ªd_fuÎ
è&& !defšed(
AO_HAVE_št_ªd_fuÎ
)

153 
	#AO_št_ªd_fuÎ
(
addr
, 
v®
) \

154 
	`AO_ªd_fuÎ
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

155 
	#AO_HAVE_št_ªd_fuÎ


	)

158 #ià
	`defšed
(
AO_HAVE_Ü_fuÎ
è&& !defšed(
AO_HAVE_št_Ü_fuÎ
)

159 
	#AO_št_Ü_fuÎ
(
addr
, 
v®
) \

160 
	`AO_Ü_fuÎ
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

161 
	#AO_HAVE_št_Ü_fuÎ


	)

164 #ià
	`defšed
(
AO_HAVE_xÜ_fuÎ
è&& !defšed(
AO_HAVE_št_xÜ_fuÎ
)

165 
	#AO_št_xÜ_fuÎ
(
addr
, 
v®
) \

166 
	`AO_xÜ_fuÎ
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

167 
	#AO_HAVE_št_xÜ_fuÎ


	)

170 #ià
	`defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ
) \

171 && !
	$defšed
(
AO_HAVE_št_ãtch_com·»_ªd_sw­_fuÎ
)

172 
	#AO_št_ãtch_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãw_v®
) \

173 ()
	`AO_ãtch_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)(
addr
), \

174 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

175 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_fuÎ


	)

178 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_fuÎ
) \

179 && !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_fuÎ
)

180 
	#AO_št_com·»_ªd_sw­_fuÎ
(
addr
, 
Şd
, 
Ãw_v®
) \

181 
	`AO_com·»_ªd_sw­_fuÎ
((vŞ©
AO_t
 *)(
addr
), \

182 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

183 
	#AO_HAVE_št_com·»_ªd_sw­_fuÎ


	)

210 #ià
	`defšed
(
AO_HAVE_lßd_acquœe
è&& !defšed(
AO_HAVE_št_lßd_acquœe
)

211 
	#AO_št_lßd_acquœe
(
addr
) \

212 ()
	`AO_lßd_acquœe
((cÚ¡ vŞ©
AO_t
 *)(
addr
))

	)

213 
	#AO_HAVE_št_lßd_acquœe


	)

216 #ià
	`defšed
(
AO_HAVE_¡Üe_acquœe
è&& !defšed(
AO_HAVE_št_¡Üe_acquœe
)

217 
	#AO_št_¡Üe_acquœe
(
addr
, 
v®
) \

218 
	`AO_¡Üe_acquœe
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

219 
	#AO_HAVE_št_¡Üe_acquœe


	)

222 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_acquœe
) \

223 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_acquœe
)

224 
	#AO_št_ãtch_ªd_add_acquœe
(
addr
, 
šü
) \

225 ()
	`AO_ãtch_ªd_add_acquœe
((vŞ©
AO_t
 *)(
addr
), \

226 (
AO_t
)(
šü
))

	)

227 
	#AO_HAVE_št_ãtch_ªd_add_acquœe


	)

230 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_acquœe
) \

231 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_acquœe
)

232 
	#AO_št_ãtch_ªd_add1_acquœe
(
addr
) \

233 ()
	`AO_ãtch_ªd_add1_acquœe
((vŞ©
AO_t
 *)(
addr
))

	)

234 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe


	)

237 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_acquœe
) \

238 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_acquœe
)

239 
	#AO_št_ãtch_ªd_sub1_acquœe
(
addr
) \

240 ()
	`AO_ãtch_ªd_sub1_acquœe
((vŞ©
AO_t
 *)(
addr
))

	)

241 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe


	)

244 #ià
	`defšed
(
AO_HAVE_ªd_acquœe
è&& !defšed(
AO_HAVE_št_ªd_acquœe
)

245 
	#AO_št_ªd_acquœe
(
addr
, 
v®
) \

246 
	`AO_ªd_acquœe
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

247 
	#AO_HAVE_št_ªd_acquœe


	)

250 #ià
	`defšed
(
AO_HAVE_Ü_acquœe
è&& !defšed(
AO_HAVE_št_Ü_acquœe
)

251 
	#AO_št_Ü_acquœe
(
addr
, 
v®
) \

252 
	`AO_Ü_acquœe
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

253 
	#AO_HAVE_št_Ü_acquœe


	)

256 #ià
	`defšed
(
AO_HAVE_xÜ_acquœe
è&& !defšed(
AO_HAVE_št_xÜ_acquœe
)

257 
	#AO_št_xÜ_acquœe
(
addr
, 
v®
) \

258 
	`AO_xÜ_acquœe
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

259 
	#AO_HAVE_št_xÜ_acquœe


	)

262 #ià
	`defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­_acquœe
) \

263 && !
	$defšed
(
AO_HAVE_št_ãtch_com·»_ªd_sw­_acquœe
)

264 
	#AO_št_ãtch_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, 
Ãw_v®
) \

265 ()
	`AO_ãtch_com·»_ªd_sw­_acquœe
((vŞ©
AO_t
 *)(
addr
), \

266 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

267 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_acquœe


	)

270 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_acquœe
) \

271 && !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_acquœe
)

272 
	#AO_št_com·»_ªd_sw­_acquœe
(
addr
, 
Şd
, 
Ãw_v®
) \

273 
	`AO_com·»_ªd_sw­_acquœe
((vŞ©
AO_t
 *)(
addr
), \

274 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

275 
	#AO_HAVE_št_com·»_ªd_sw­_acquœe


	)

302 #ià
	`defšed
(
AO_HAVE_lßd_»Ëa£
è&& !defšed(
AO_HAVE_št_lßd_»Ëa£
)

303 
	#AO_št_lßd_»Ëa£
(
addr
) \

304 ()
	`AO_lßd_»Ëa£
((cÚ¡ vŞ©
AO_t
 *)(
addr
))

	)

305 
	#AO_HAVE_št_lßd_»Ëa£


	)

308 #ià
	`defšed
(
AO_HAVE_¡Üe_»Ëa£
è&& !defšed(
AO_HAVE_št_¡Üe_»Ëa£
)

309 
	#AO_št_¡Üe_»Ëa£
(
addr
, 
v®
) \

310 
	`AO_¡Üe_»Ëa£
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

311 
	#AO_HAVE_št_¡Üe_»Ëa£


	)

314 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_»Ëa£
) \

315 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_»Ëa£
)

316 
	#AO_št_ãtch_ªd_add_»Ëa£
(
addr
, 
šü
) \

317 ()
	`AO_ãtch_ªd_add_»Ëa£
((vŞ©
AO_t
 *)(
addr
), \

318 (
AO_t
)(
šü
))

	)

319 
	#AO_HAVE_št_ãtch_ªd_add_»Ëa£


	)

322 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_»Ëa£
) \

323 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»Ëa£
)

324 
	#AO_št_ãtch_ªd_add1_»Ëa£
(
addr
) \

325 ()
	`AO_ãtch_ªd_add1_»Ëa£
((vŞ©
AO_t
 *)(
addr
))

	)

326 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£


	)

329 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_»Ëa£
) \

330 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»Ëa£
)

331 
	#AO_št_ãtch_ªd_sub1_»Ëa£
(
addr
) \

332 ()
	`AO_ãtch_ªd_sub1_»Ëa£
((vŞ©
AO_t
 *)(
addr
))

	)

333 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£


	)

336 #ià
	`defšed
(
AO_HAVE_ªd_»Ëa£
è&& !defšed(
AO_HAVE_št_ªd_»Ëa£
)

337 
	#AO_št_ªd_»Ëa£
(
addr
, 
v®
) \

338 
	`AO_ªd_»Ëa£
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

339 
	#AO_HAVE_št_ªd_»Ëa£


	)

342 #ià
	`defšed
(
AO_HAVE_Ü_»Ëa£
è&& !defšed(
AO_HAVE_št_Ü_»Ëa£
)

343 
	#AO_št_Ü_»Ëa£
(
addr
, 
v®
) \

344 
	`AO_Ü_»Ëa£
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

345 
	#AO_HAVE_št_Ü_»Ëa£


	)

348 #ià
	`defšed
(
AO_HAVE_xÜ_»Ëa£
è&& !defšed(
AO_HAVE_št_xÜ_»Ëa£
)

349 
	#AO_št_xÜ_»Ëa£
(
addr
, 
v®
) \

350 
	`AO_xÜ_»Ëa£
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

351 
	#AO_HAVE_št_xÜ_»Ëa£


	)

354 #ià
	`defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­_»Ëa£
) \

355 && !
	$defšed
(
AO_HAVE_št_ãtch_com·»_ªd_sw­_»Ëa£
)

356 
	#AO_št_ãtch_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, 
Ãw_v®
) \

357 ()
	`AO_ãtch_com·»_ªd_sw­_»Ëa£
((vŞ©
AO_t
 *)(
addr
), \

358 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

359 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_»Ëa£


	)

362 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_»Ëa£
) \

363 && !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_»Ëa£
)

364 
	#AO_št_com·»_ªd_sw­_»Ëa£
(
addr
, 
Şd
, 
Ãw_v®
) \

365 
	`AO_com·»_ªd_sw­_»Ëa£
((vŞ©
AO_t
 *)(
addr
), \

366 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

367 
	#AO_HAVE_št_com·»_ªd_sw­_»Ëa£


	)

394 #ià
	`defšed
(
AO_HAVE_lßd_wr™e
è&& !defšed(
AO_HAVE_št_lßd_wr™e
)

395 
	#AO_št_lßd_wr™e
(
addr
) \

396 ()
	`AO_lßd_wr™e
((cÚ¡ vŞ©
AO_t
 *)(
addr
))

	)

397 
	#AO_HAVE_št_lßd_wr™e


	)

400 #ià
	`defšed
(
AO_HAVE_¡Üe_wr™e
è&& !defšed(
AO_HAVE_št_¡Üe_wr™e
)

401 
	#AO_št_¡Üe_wr™e
(
addr
, 
v®
) \

402 
	`AO_¡Üe_wr™e
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

403 
	#AO_HAVE_št_¡Üe_wr™e


	)

406 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_wr™e
) \

407 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_wr™e
)

408 
	#AO_št_ãtch_ªd_add_wr™e
(
addr
, 
šü
) \

409 ()
	`AO_ãtch_ªd_add_wr™e
((vŞ©
AO_t
 *)(
addr
), \

410 (
AO_t
)(
šü
))

	)

411 
	#AO_HAVE_št_ãtch_ªd_add_wr™e


	)

414 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_wr™e
) \

415 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_wr™e
)

416 
	#AO_št_ãtch_ªd_add1_wr™e
(
addr
) \

417 ()
	`AO_ãtch_ªd_add1_wr™e
((vŞ©
AO_t
 *)(
addr
))

	)

418 
	#AO_HAVE_št_ãtch_ªd_add1_wr™e


	)

421 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_wr™e
) \

422 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_wr™e
)

423 
	#AO_št_ãtch_ªd_sub1_wr™e
(
addr
) \

424 ()
	`AO_ãtch_ªd_sub1_wr™e
((vŞ©
AO_t
 *)(
addr
))

	)

425 
	#AO_HAVE_št_ãtch_ªd_sub1_wr™e


	)

428 #ià
	`defšed
(
AO_HAVE_ªd_wr™e
è&& !defšed(
AO_HAVE_št_ªd_wr™e
)

429 
	#AO_št_ªd_wr™e
(
addr
, 
v®
) \

430 
	`AO_ªd_wr™e
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

431 
	#AO_HAVE_št_ªd_wr™e


	)

434 #ià
	`defšed
(
AO_HAVE_Ü_wr™e
è&& !defšed(
AO_HAVE_št_Ü_wr™e
)

435 
	#AO_št_Ü_wr™e
(
addr
, 
v®
) \

436 
	`AO_Ü_wr™e
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

437 
	#AO_HAVE_št_Ü_wr™e


	)

440 #ià
	`defšed
(
AO_HAVE_xÜ_wr™e
è&& !defšed(
AO_HAVE_št_xÜ_wr™e
)

441 
	#AO_št_xÜ_wr™e
(
addr
, 
v®
) \

442 
	`AO_xÜ_wr™e
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

443 
	#AO_HAVE_št_xÜ_wr™e


	)

446 #ià
	`defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­_wr™e
) \

447 && !
	$defšed
(
AO_HAVE_št_ãtch_com·»_ªd_sw­_wr™e
)

448 
	#AO_št_ãtch_com·»_ªd_sw­_wr™e
(
addr
, 
Şd
, 
Ãw_v®
) \

449 ()
	`AO_ãtch_com·»_ªd_sw­_wr™e
((vŞ©
AO_t
 *)(
addr
), \

450 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

451 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_wr™e


	)

454 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_wr™e
) \

455 && !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_wr™e
)

456 
	#AO_št_com·»_ªd_sw­_wr™e
(
addr
, 
Şd
, 
Ãw_v®
) \

457 
	`AO_com·»_ªd_sw­_wr™e
((vŞ©
AO_t
 *)(
addr
), \

458 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

459 
	#AO_HAVE_št_com·»_ªd_sw­_wr™e


	)

486 #ià
	`defšed
(
AO_HAVE_lßd_»ad
è&& !defšed(
AO_HAVE_št_lßd_»ad
)

487 
	#AO_št_lßd_»ad
(
addr
) \

488 ()
	`AO_lßd_»ad
((cÚ¡ vŞ©
AO_t
 *)(
addr
))

	)

489 
	#AO_HAVE_št_lßd_»ad


	)

492 #ià
	`defšed
(
AO_HAVE_¡Üe_»ad
è&& !defšed(
AO_HAVE_št_¡Üe_»ad
)

493 
	#AO_št_¡Üe_»ad
(
addr
, 
v®
) \

494 
	`AO_¡Üe_»ad
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

495 
	#AO_HAVE_št_¡Üe_»ad


	)

498 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add_»ad
) \

499 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add_»ad
)

500 
	#AO_št_ãtch_ªd_add_»ad
(
addr
, 
šü
) \

501 ()
	`AO_ãtch_ªd_add_»ad
((vŞ©
AO_t
 *)(
addr
), \

502 (
AO_t
)(
šü
))

	)

503 
	#AO_HAVE_št_ãtch_ªd_add_»ad


	)

506 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_add1_»ad
) \

507 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_add1_»ad
)

508 
	#AO_št_ãtch_ªd_add1_»ad
(
addr
) \

509 ()
	`AO_ãtch_ªd_add1_»ad
((vŞ©
AO_t
 *)(
addr
))

	)

510 
	#AO_HAVE_št_ãtch_ªd_add1_»ad


	)

513 #ià
	`defšed
(
AO_HAVE_ãtch_ªd_sub1_»ad
) \

514 && !
	$defšed
(
AO_HAVE_št_ãtch_ªd_sub1_»ad
)

515 
	#AO_št_ãtch_ªd_sub1_»ad
(
addr
) \

516 ()
	`AO_ãtch_ªd_sub1_»ad
((vŞ©
AO_t
 *)(
addr
))

	)

517 
	#AO_HAVE_št_ãtch_ªd_sub1_»ad


	)

520 #ià
	`defšed
(
AO_HAVE_ªd_»ad
è&& !defšed(
AO_HAVE_št_ªd_»ad
)

521 
	#AO_št_ªd_»ad
(
addr
, 
v®
) \

522 
	`AO_ªd_»ad
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

523 
	#AO_HAVE_št_ªd_»ad


	)

526 #ià
	`defšed
(
AO_HAVE_Ü_»ad
è&& !defšed(
AO_HAVE_št_Ü_»ad
)

527 
	#AO_št_Ü_»ad
(
addr
, 
v®
) \

528 
	`AO_Ü_»ad
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

529 
	#AO_HAVE_št_Ü_»ad


	)

532 #ià
	`defšed
(
AO_HAVE_xÜ_»ad
è&& !defšed(
AO_HAVE_št_xÜ_»ad
)

533 
	#AO_št_xÜ_»ad
(
addr
, 
v®
) \

534 
	`AO_xÜ_»ad
((vŞ©
AO_t
 *)(
addr
), (AO_t)(
v®
))

	)

535 
	#AO_HAVE_št_xÜ_»ad


	)

538 #ià
	`defšed
(
AO_HAVE_ãtch_com·»_ªd_sw­_»ad
) \

539 && !
	$defšed
(
AO_HAVE_št_ãtch_com·»_ªd_sw­_»ad
)

540 
	#AO_št_ãtch_com·»_ªd_sw­_»ad
(
addr
, 
Şd
, 
Ãw_v®
) \

541 ()
	`AO_ãtch_com·»_ªd_sw­_»ad
((vŞ©
AO_t
 *)(
addr
), \

542 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

543 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_»ad


	)

546 #ià
	`defšed
(
AO_HAVE_com·»_ªd_sw­_»ad
) \

547 && !
	$defšed
(
AO_HAVE_št_com·»_ªd_sw­_»ad
)

548 
	#AO_št_com·»_ªd_sw­_»ad
(
addr
, 
Şd
, 
Ãw_v®
) \

549 
	`AO_com·»_ªd_sw­_»ad
((vŞ©
AO_t
 *)(
addr
), \

550 (
AO_t
)(
Şd
), (AO_t)(
Ãw_v®
))

	)

551 
	#AO_HAVE_št_com·»_ªd_sw­_»ad


	)

	@/usr/include/atomic_ops/sysdeps/armcc/arm_v6.h

23 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

25 #ià
__TARGET_ARCH_ARM
 < 6

26 
DÚt
 
u£
 
w™h
 
ARM
 
š¡ruùiÚ
 
£ts
 
low”
 
thª
 
	gv6


29 
	#AO_ACCESS_CHECK_ALIGNED


	)

30 
	#AO_ACCESS_shÜt_CHECK_ALIGNED


	)

31 
	#AO_ACCESS_št_CHECK_ALIGNED


	)

32 
	~"../®l_©omic_Úly_lßd.h
"

34 
	~"../¡ªd¬d_ao_doubË_t.h
"

48 
AO_INLINE
 

49 
	$AO_nİ_fuÎ
()

51 #iâdeà
AO_UNIPROCESSOR


52 
de¡
=0;

55 
__asm
 {

56 
mü
 
p15
,0,
de¡
,
c7
,
c10
,5

59 
	`AO_comp”_b¬r›r
();

61 
	}
}

62 
	#AO_HAVE_nİ_fuÎ


	)

73 
AO_INLINE
 
	$AO_¡Üe
(vŞ©
AO_t
 *
addr
, AO_ˆ
v®ue
)

75 
tmp
;

77 
»Œy
:

78 
__asm
 {

79 
ld»x
 
tmp
, [
addr
]

80 
¡»x
 
tmp
, 
v®ue
, [
addr
]

81 
‹q
 
tmp
, #0

82 
bÃ
 
»Œy


84 
	}
}

85 
	#AO_HAVE_¡Üe


	)

98 #iâdeà
AO_PREFER_GENERALIZED


99 
AO_INLINE
 
AO_TS_VAL_t


100 
	$AO_‹¡_ªd_£t
(vŞ©
AO_TS_t
 *
addr
) {

102 
AO_TS_VAL_t
 
Şdv®
;

103 
tmp
;

104 
Úe
 = 1;

105 
»Œy
:

106 
__asm
 {

107 
ld»x
 
Şdv®
, [
addr
]

108 
¡»x
 
tmp
, 
Úe
, [
addr
]

109 
‹q
 
tmp
, #0

110 
bÃ
 
»Œy


113  
Şdv®
;

114 
	}
}

115 
	#AO_HAVE_‹¡_ªd_£t


	)

117 
AO_INLINE
 
AO_t


118 
	$AO_ãtch_ªd_add
(vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

120 
tmp
,
tmp2
;

121 
AO_t
 
»suÉ
;

123 
»Œy
:

124 
__asm
 {

125 
ld»x
 
»suÉ
, [
p
]

126 
add
 
tmp
, 
šü
, 
»suÉ


127 
¡»x
 
tmp2
, 
tmp
, [
p
]

128 
‹q
 
tmp2
, #0

129 
bÃ
 
»Œy


132  
»suÉ
;

133 
	}
}

134 
	#AO_HAVE_ãtch_ªd_add


	)

136 
AO_INLINE
 
AO_t


137 
	$AO_ãtch_ªd_add1
(vŞ©
AO_t
 *
p
)

139 
tmp
,
tmp2
;

140 
AO_t
 
»suÉ
;

142 
»Œy
:

143 
__asm
 {

144 
ld»x
 
»suÉ
, [
p
]

145 
add
 
tmp
, 
»suÉ
, #1

146 
¡»x
 
tmp2
, 
tmp
, [
p
]

147 
‹q
 
tmp2
, #0

148 
bÃ
 
»Œy


151  
»suÉ
;

152 
	}
}

153 
	#AO_HAVE_ãtch_ªd_add1


	)

155 
AO_INLINE
 
AO_t


156 
	$AO_ãtch_ªd_sub1
(vŞ©
AO_t
 *
p
)

158 
tmp
,
tmp2
;

159 
AO_t
 
»suÉ
;

161 
»Œy
:

162 
__asm
 {

163 
ld»x
 
»suÉ
, [
p
]

164 
sub
 
tmp
, 
»suÉ
, #1

165 
¡»x
 
tmp2
, 
tmp
, [
p
]

166 
‹q
 
tmp2
, #0

167 
bÃ
 
»Œy


170  
»suÉ
;

171 
	}
}

172 
	#AO_HAVE_ãtch_ªd_sub1


	)

175 #iâdeà
AO_GENERALIZE_ASM_BOOL_CAS


177 
AO_INLINE
 

178 
	$AO_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
, AO_ˆ
Ãw_v®
)

180 
AO_t
 
»suÉ
, 
tmp
;

182 
»Œy
:

183 
__asm__
 {

184 
mov
 
»suÉ
, #2

185 
ld»x
 
tmp
, [
addr
]

186 
‹q
 
tmp
, 
Şd_v®


187 #ifdeà
__thumb__


188 
™
 
eq


190 
¡»xeq
 
»suÉ
, 
Ãw_v®
, [
addr
]

191 
‹q
 
»suÉ
, #1

192 
beq
 
»Œy


194  !(
»suÉ
&2);

195 
	}
}

196 
	#AO_HAVE_com·»_ªd_sw­


	)

199 
AO_INLINE
 
AO_t


200 
	$AO_ãtch_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
, AO_ˆ
Ãw_v®
)

202 
AO_t
 
ãtched_v®
, 
tmp
;

204 
»Œy
:

205 
__asm__
 {

206 
mov
 
tmp
, #2

207 
ld»x
 
ãtched_v®
, [
addr
]

208 
‹q
 
ãtched_v®
, 
Şd_v®


209 #ifdeà
__thumb__


210 
™
 
eq


212 
¡»xeq
 
tmp
, 
Ãw_v®
, [
addr
]

213 
‹q
 
tmp
, #1

214 
beq
 
»Œy


216  
ãtched_v®
;

217 
	}
}

218 
	#AO_HAVE_ãtch_com·»_ªd_sw­


	)

223 
__asm
 
šlše
 
doubË_±r_¡Üage
 
	$AO_lßd_ex
(cÚ¡ vŞ©
AO_doubË_t
 *
addr
) {

224 
LDREXD
 
r0
,
r1
,[r0]

225 
	}
}

227 
__asm
 
šlše
 
	$AO_¡Üe_ex
(
AO_t
 
v®1
, AO_ˆ
v®2
, vŞ©
AO_doubË_t
 *
addr
) {

228 
STREXD
 
r3
,
r0
,
r1
,[
r2
]

229 
MOV
 
r0
,
r3


230 
	}
}

232 
AO_INLINE
 
AO_doubË_t


233 
	$AO_doubË_lßd
(cÚ¡ vŞ©
AO_doubË_t
 *
addr
)

235 
AO_doubË_t
 
»suÉ
;

237 
»suÉ
.
AO_whŞe
 = 
	`AO_lßd_ex
(
addr
);

238  
»suÉ
;

239 
	}
}

240 
	#AO_HAVE_doubË_lßd


	)

242 
AO_INLINE
 

243 
	$AO_com·»_doubË_ªd_sw­_doubË
(vŞ©
AO_doubË_t
 *
addr
,

244 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

245 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

247 
doubË_±r_¡Üage
 
Şd_v®
 =

248 ((
doubË_±r_¡Üage
)
Şd_v®2
 << 32è| 
Şd_v®1
;

249 
doubË_±r_¡Üage
 
tmp
;

250 
»suÉ
;

253 
tmp
 = 
	`AO_lßd_ex
(
addr
);

254 if(
tmp
 !ğ
Şd_v®
)  0;

255 
»suÉ
 = 
	`AO_¡Üe_ex
(
Ãw_v®1
, 
Ãw_v®2
, 
addr
);

256 if(!
»suÉ
)  1;

258 
	}
}

259 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË


	)

263 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/gcc/aarch64.h

18 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

20 
	~"../¡ªd¬d_ao_doubË_t.h
"

22 #iâdeà
AO_UNIPROCESSOR


23 
AO_INLINE
 

24 
	$AO_nİ_wr™e
()

26 
__asm__
 
	`__vŞ©e__
("dmb st" : : : "memory");

27 
	}
}

28 
	#AO_HAVE_nİ_wr™e


	)

32 #ià
__GNUC__
 == 4

34 
AO_INLINE
 
AO_doubË_t


35 
	$AO_doubË_lßd
(cÚ¡ vŞ©
AO_doubË_t
 *
addr
)

37 
AO_doubË_t
 
»suÉ
;

38 
¡©us
;

43 
__asm__
 
	`__vŞ©e__
("//AO_double_load\n"

46 : "=&r" (
»suÉ
.
AO_v®1
), "=&r" (»suÉ.
AO_v®2
), "=&r" (
¡©us
)

47 : "Q" (*
addr
));

48 } 
	`AO_EXPECT_FALSE
(
¡©us
));

49  
»suÉ
;

50 
	}
}

51 
	#AO_HAVE_doubË_lßd


	)

53 
AO_INLINE
 
AO_doubË_t


54 
	$AO_doubË_lßd_acquœe
(cÚ¡ vŞ©
AO_doubË_t
 *
addr
)

56 
AO_doubË_t
 
»suÉ
;

57 
¡©us
;

60 
__asm__
 
	`__vŞ©e__
("//AO_double_load_acquire\n"

63 : "=&r" (
»suÉ
.
AO_v®1
), "=&r" (»suÉ.
AO_v®2
), "=&r" (
¡©us
)

64 : "Q" (*
addr
));

65 } 
	`AO_EXPECT_FALSE
(
¡©us
));

66  
»suÉ
;

67 
	}
}

68 
	#AO_HAVE_doubË_lßd_acquœe


	)

70 
AO_INLINE
 

71 
	$AO_doubË_¡Üe
(vŞ©
AO_doubË_t
 *
addr
, AO_doubË_ˆ
v®ue
)

73 
AO_doubË_t
 
Şd_v®
;

74 
¡©us
;

77 
__asm__
 
	`__vŞ©e__
("//AO_double_store\n"

80 : "=&r" (
Şd_v®
.
AO_v®1
), "=&r" (Şd_v®.
AO_v®2
), "=&r" (
¡©us
),

81 "=Q" (*
addr
)

82 : "r" (
v®ue
.
AO_v®1
), "r" (v®ue.
AO_v®2
));

85 } 
	`AO_EXPECT_FALSE
(
¡©us
));

86 
	}
}

87 
	#AO_HAVE_doubË_¡Üe


	)

89 
AO_INLINE
 

90 
	$AO_doubË_¡Üe_»Ëa£
(vŞ©
AO_doubË_t
 *
addr
, AO_doubË_ˆ
v®ue
)

92 
AO_doubË_t
 
Şd_v®
;

93 
¡©us
;

96 
__asm__
 
	`__vŞ©e__
("//AO_double_store_release\n"

99 : "=&r" (
Şd_v®
.
AO_v®1
), "=&r" (Şd_v®.
AO_v®2
), "=&r" (
¡©us
),

100 "=Q" (*
addr
)

101 : "r" (
v®ue
.
AO_v®1
), "r" (v®ue.
AO_v®2
));

102 } 
	`AO_EXPECT_FALSE
(
¡©us
));

103 
	}
}

104 
	#AO_HAVE_doubË_¡Üe_»Ëa£


	)

106 
AO_INLINE
 

107 
	$AO_doubË_com·»_ªd_sw­
(vŞ©
AO_doubË_t
 *
addr
,

108 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

110 
AO_doubË_t
 
tmp
;

111 
»suÉ
 = 1;

114 
__asm__
 
	`__vŞ©e__
("//AO_double_compare_and_swap\n"

116 : "=&r" (
tmp
.
AO_v®1
), "=&r" (tmp.
AO_v®2
)

117 : "Q" (*
addr
));

118 ià(
tmp
.
AO_v®1
 !ğ
Şd_v®
.AO_v®1 ||mp.
AO_v®2
 != old_val.AO_val2)

120 
__asm__
 
	`__vŞ©e__
(

122 : "=&r" (
»suÉ
), "=Q" (*
addr
)

123 : "r" (
Ãw_v®
.
AO_v®1
), "r" (Ãw_v®.
AO_v®2
));

124 } 
	`AO_EXPECT_FALSE
(
»suÉ
));

125  !
»suÉ
;

126 
	}
}

127 
	#AO_HAVE_doubË_com·»_ªd_sw­


	)

129 
AO_INLINE
 

130 
	$AO_doubË_com·»_ªd_sw­_acquœe
(vŞ©
AO_doubË_t
 *
addr
,

131 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

133 
AO_doubË_t
 
tmp
;

134 
»suÉ
 = 1;

137 
__asm__
 
	`__vŞ©e__
("//AO_double_compare_and_swap_acquire\n"

139 : "=&r" (
tmp
.
AO_v®1
), "=&r" (tmp.
AO_v®2
)

140 : "Q" (*
addr
));

141 ià(
tmp
.
AO_v®1
 !ğ
Şd_v®
.AO_v®1 ||mp.
AO_v®2
 != old_val.AO_val2)

143 
__asm__
 
	`__vŞ©e__
(

145 : "=&r" (
»suÉ
), "=Q" (*
addr
)

146 : "r" (
Ãw_v®
.
AO_v®1
), "r" (Ãw_v®.
AO_v®2
));

147 } 
	`AO_EXPECT_FALSE
(
»suÉ
));

148  !
»suÉ
;

149 
	}
}

150 
	#AO_HAVE_doubË_com·»_ªd_sw­_acquœe


	)

152 
AO_INLINE
 

153 
	$AO_doubË_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_doubË_t
 *
addr
,

154 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

156 
AO_doubË_t
 
tmp
;

157 
»suÉ
 = 1;

160 
__asm__
 
	`__vŞ©e__
("//AO_double_compare_and_swap_release\n"

162 : "=&r" (
tmp
.
AO_v®1
), "=&r" (tmp.
AO_v®2
)

163 : "Q" (*
addr
));

164 ià(
tmp
.
AO_v®1
 !ğ
Şd_v®
.AO_v®1 ||mp.
AO_v®2
 != old_val.AO_val2)

166 
__asm__
 
	`__vŞ©e__
(

168 : "=&r" (
»suÉ
), "=Q" (*
addr
)

169 : "r" (
Ãw_v®
.
AO_v®1
), "r" (Ãw_v®.
AO_v®2
));

170 } 
	`AO_EXPECT_FALSE
(
»suÉ
));

171  !
»suÉ
;

172 
	}
}

173 
	#AO_HAVE_doubË_com·»_ªd_sw­_»Ëa£


	)

175 
AO_INLINE
 

176 
	$AO_doubË_com·»_ªd_sw­_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

177 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

179 
AO_doubË_t
 
tmp
;

180 
»suÉ
 = 1;

183 
__asm__
 
	`__vŞ©e__
("//AO_double_compare_and_swap_full\n"

185 : "=&r" (
tmp
.
AO_v®1
), "=&r" (tmp.
AO_v®2
)

186 : "Q" (*
addr
));

187 ià(
tmp
.
AO_v®1
 !ğ
Şd_v®
.AO_v®1 ||mp.
AO_v®2
 != old_val.AO_val2)

189 
__asm__
 
	`__vŞ©e__
(

191 : "=&r" (
»suÉ
), "=Q" (*
addr
)

192 : "r" (
Ãw_v®
.
AO_v®1
), "r" (Ãw_v®.
AO_v®2
));

193 } 
	`AO_EXPECT_FALSE
(
»suÉ
));

194  !
»suÉ
;

195 
	}
}

196 
	#AO_HAVE_doubË_com·»_ªd_sw­_fuÎ


	)

199 
	~"g’”ic.h
"

	@/usr/include/atomic_ops/sysdeps/gcc/avr32.h

25 
	~"../®l_©omic_lßd_¡Üe.h
"

27 
	~"../Üd”ed.h
"

29 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

31 #iâdeà
AO_PREFER_GENERALIZED


32 
AO_INLINE
 
AO_TS_VAL_t


33 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

35 
»t
;

37 
__asm__
 
	`__vŞ©e__
(

39 : [
Şdv®
] "=&r"(
»t
)

40 : [
mem
] "r"(
addr
), [
Ãwv®
] "r"(1)

43  (
AO_TS_VAL_t
)
»t
;

44 
	}
}

45 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

48 
AO_INLINE
 

49 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

51 
»t
;

53 
__asm__
 
	`__vŞ©e__
(

61 : [
»s
] "=&r"(
»t
), [
mem
] "=m"(*
addr
)

62 : "m"(*
addr
), [
Ãwv®
] "r"(
Ãw_v®
), [
Şdv®
] "r"(
Şd
)

65  ()
»t
;

66 
	}
}

67 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

71 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/gcc/hexagon.h

12 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

14 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

20 
AO_INLINE
 

21 
	$AO_nİ_fuÎ
()

23 
__asm__
 
	`__vŞ©e__
("syncht" : : : "memory");

24 
	}
}

25 
	#AO_HAVE_nİ_fuÎ


	)

30 #iâdeà
AO_PREFER_GENERALIZED


31 
AO_INLINE
 
AO_t


32 
	$AO_ãtch_ªd_add
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
)

34 
AO_t
 
Şdv®
;

35 
AO_t
 
Ãwv®
;

36 
__asm__
 
	`__vŞ©e__
(

42 : "=&r"(
Şdv®
), "=&r"(
Ãwv®
), "+m"(*
addr
)

43 : "r"(
addr
), "r"(
šü
)

45  
Şdv®
;

46 
	}
}

47 
	#AO_HAVE_ãtch_ªd_add


	)

49 
AO_INLINE
 
AO_TS_VAL_t


50 
	$AO_‹¡_ªd_£t
(vŞ©
AO_TS_t
 *
addr
)

52 
Şdv®
;

53 
locked_v®ue
 = 1;

55 
__asm__
 
	`__vŞ©e__
(

65 : "=&r"(
Şdv®
), "+m"(*
addr
)

66 : "r"(
addr
), "r"(
locked_v®ue
)

68  (
AO_TS_VAL_t
)
Şdv®
;

69 
	}
}

70 
	#AO_HAVE_‹¡_ªd_£t


	)

73 #iâdeà
AO_GENERALIZE_ASM_BOOL_CAS


74 
AO_INLINE
 

75 
	$AO_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

77 
AO_t
 
__Şdv®
;

78 
»suÉ
 = 0;

79 
__asm__
 
	`__vŞ©e__
(

90 : "=&r" (
__Şdv®
), "+r" (
»suÉ
), "+m"(*
addr
)

91 : "r" (
addr
), "r" (
Şd
), "r" (
Ãw_v®
)

94  
»suÉ
;

95 
	}
}

96 
	#AO_HAVE_com·»_ªd_sw­


	)

99 
AO_INLINE
 
AO_t


100 
	$AO_ãtch_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
, AO_ˆ
Ãw_v®
)

102 
AO_t
 
__Şdv®
;

104 
__asm__
 
	`__vŞ©e__
(

114 : "=&r" (
__Şdv®
), "+m"(*
addr
)

115 : "r" (
addr
), "r" (
Şd_v®
), "r" (
Ãw_v®
)

118  
__Şdv®
;

119 
	}
}

120 
	#AO_HAVE_ãtch_com·»_ªd_sw­


	)

122 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/gcc/ia64.h

23 
	~"../®l_©omic_lßd_¡Üe.h
"

25 
	~"../®l_acquœe_»Ëa£_vŞ©e.h
"

27 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

29 #ifdeà
_ILP32


34 
	#AO_LEN
 "4"

	)

45 
	#AO_IN_ADDR
 "1"(
addr
)

	)

46 
	#AO_OUT_ADDR
 , "ô"(
addr
)

	)

47 
	#AO_SWIZZLE
 "addp4 %1=0,%1;;\n"

	)

48 
	#AO_MASK
(
±r
è
__asm__
 
	`__vŞ©e__
("zxt4 %1=%1": "ô"ÕŒè: "0"ÕŒ))

	)

50 
	#AO_LEN
 "8"

	)

51 
	#AO_IN_ADDR
 "r"(
addr
)

	)

52 
	#AO_OUT_ADDR


	)

53 
	#AO_SWIZZLE


	)

54 
	#AO_MASK
(
±r
è

	)

57 
AO_INLINE
 

58 
	$AO_nİ_fuÎ
()

60 
__asm__
 
	`__vŞ©e__
("mf" : : : "memory");

61 
	}
}

62 
	#AO_HAVE_nİ_fuÎ


	)

64 #iâdeà
AO_PREFER_GENERALIZED


65 
AO_INLINE
 
AO_t


66 
	$AO_ãtch_ªd_add1_acquœe
 (vŞ©
AO_t
 *
addr
)

68 
AO_t
 
»suÉ
;

70 
__asm__
 
	`__vŞ©e__
 (
AO_SWIZZLE


71 "ãtchadd" 
AO_LEN
 ".acq %0=[%1],1":

72 "ô" (
»suÉ
è
AO_OUT_ADDR
: 
AO_IN_ADDR
 :"memory");

73  
»suÉ
;

74 
	}
}

75 
	#AO_HAVE_ãtch_ªd_add1_acquœe


	)

77 
AO_INLINE
 
AO_t


78 
	$AO_ãtch_ªd_add1_»Ëa£
 (vŞ©
AO_t
 *
addr
)

80 
AO_t
 
»suÉ
;

82 
__asm__
 
	`__vŞ©e__
 (
AO_SWIZZLE


83 "ãtchadd" 
AO_LEN
 ".rel %0=[%1],1":

84 "ô" (
»suÉ
è
AO_OUT_ADDR
: 
AO_IN_ADDR
 :"memory");

85  
»suÉ
;

86 
	}
}

87 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£


	)

89 
AO_INLINE
 
AO_t


90 
	$AO_ãtch_ªd_sub1_acquœe
 (vŞ©
AO_t
 *
addr
)

92 
AO_t
 
»suÉ
;

94 
__asm__
 
	`__vŞ©e__
 (
AO_SWIZZLE


95 "ãtchadd" 
AO_LEN
 ".acq %0=[%1],-1":

96 "ô" (
»suÉ
è
AO_OUT_ADDR
: 
AO_IN_ADDR
 :"memory");

97  
»suÉ
;

98 
	}
}

99 
	#AO_HAVE_ãtch_ªd_sub1_acquœe


	)

101 
AO_INLINE
 
AO_t


102 
	$AO_ãtch_ªd_sub1_»Ëa£
 (vŞ©
AO_t
 *
addr
)

104 
AO_t
 
»suÉ
;

106 
__asm__
 
	`__vŞ©e__
 (
AO_SWIZZLE


107 "ãtchadd" 
AO_LEN
 ".rel %0=[%1],-1":

108 "ô" (
»suÉ
è
AO_OUT_ADDR
: 
AO_IN_ADDR
 :"memory");

109  
»suÉ
;

110 
	}
}

111 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£


	)

114 
AO_INLINE
 
AO_t


115 
	$AO_ãtch_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

117 
AO_t
 
ãtched_v®
;

118 
	`AO_MASK
(
Şd
);

119 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


120 "mov‡r.ccv=%[Şd] ;; cmpxchg" 
AO_LEN


122 : "ô"(
ãtched_v®
è
AO_OUT_ADDR


123 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"(old)

125  
ãtched_v®
;

126 
	}
}

127 
	#AO_HAVE_ãtch_com·»_ªd_sw­_acquœe


	)

129 
AO_INLINE
 
AO_t


130 
	$AO_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

132 
AO_t
 
ãtched_v®
;

133 
	`AO_MASK
(
Şd
);

134 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


135 "mov‡r.ccv=%[Şd] ;; cmpxchg" 
AO_LEN


137 : "ô"(
ãtched_v®
è
AO_OUT_ADDR


138 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"(old)

140  
ãtched_v®
;

141 
	}
}

142 
	#AO_HAVE_ãtch_com·»_ªd_sw­_»Ëa£


	)

144 
AO_INLINE
 

145 
	$AO_ch¬_ãtch_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

146 
Şd
, 
Ãw_v®
)

148 
ãtched_v®
;

149 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


151 : "ô"(
ãtched_v®
è
AO_OUT_ADDR


152 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"((
AO_t
)old)

154  
ãtched_v®
;

155 
	}
}

156 
	#AO_HAVE_ch¬_ãtch_com·»_ªd_sw­_acquœe


	)

158 
AO_INLINE
 

159 
	$AO_ch¬_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

160 
Şd
, 
Ãw_v®
)

162 
ãtched_v®
;

163 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


165 : "ô"(
ãtched_v®
è
AO_OUT_ADDR


166 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"((
AO_t
)old)

168  
ãtched_v®
;

169 
	}
}

170 
	#AO_HAVE_ch¬_ãtch_com·»_ªd_sw­_»Ëa£


	)

172 
AO_INLINE
 

173 
	$AO_shÜt_ãtch_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

174 
Şd
, 
Ãw_v®
)

176 
ãtched_v®
;

177 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


179 : "ô"(
ãtched_v®
è
AO_OUT_ADDR


180 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"((
AO_t
)old)

182  
ãtched_v®
;

183 
	}
}

184 
	#AO_HAVE_shÜt_ãtch_com·»_ªd_sw­_acquœe


	)

186 
AO_INLINE
 

187 
	$AO_shÜt_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

188 
Şd
, 
Ãw_v®
)

190 
ãtched_v®
;

191 
__asm__
 
	`__vŞ©e__
(
AO_SWIZZLE


193 : "ô"(
ãtched_v®
è
AO_OUT_ADDR


194 : 
AO_IN_ADDR
, [
Ãw_v®
]"r"Òew_v®), [
Şd
]"r"((
AO_t
)old)

196  
ãtched_v®
;

197 
	}
}

198 
	#AO_HAVE_shÜt_ãtch_com·»_ªd_sw­_»Ëa£


	)

200 #ifdeà
_ILP32


202 
	#AO_T_IS_INT


	)

207 #iâdeà
AO_PREFER_GENERALIZED


208 
AO_INLINE
 

209 
	$AO_št_ãtch_ªd_add1_acquœe
(vŞ©*
addr
)

211 
»suÉ
;

212 
__asm__
 
	`__vŞ©e__
("fetchadd4.acq %0=[%1],1"

213 : "ô" (
»suÉ
è: 
AO_IN_ADDR


215  
»suÉ
;

216 
	}
}

217 
	#AO_HAVE_št_ãtch_ªd_add1_acquœe


	)

219 
AO_INLINE
 

220 
	$AO_št_ãtch_ªd_add1_»Ëa£
(vŞ©*
addr
)

222 
»suÉ
;

223 
__asm__
 
	`__vŞ©e__
("fetchadd4.rel %0=[%1],1"

224 : "ô" (
»suÉ
è: 
AO_IN_ADDR


226  
»suÉ
;

227 
	}
}

228 
	#AO_HAVE_št_ãtch_ªd_add1_»Ëa£


	)

230 
AO_INLINE
 

231 
	$AO_št_ãtch_ªd_sub1_acquœe
(vŞ©*
addr
)

233 
»suÉ
;

234 
__asm__
 
	`__vŞ©e__
("fetchadd4.acq %0=[%1],-1"

235 : "ô" (
»suÉ
è: 
AO_IN_ADDR


237  
»suÉ
;

238 
	}
}

239 
	#AO_HAVE_št_ãtch_ªd_sub1_acquœe


	)

241 
AO_INLINE
 

242 
	$AO_št_ãtch_ªd_sub1_»Ëa£
(vŞ©*
addr
)

244 
»suÉ
;

245 
__asm__
 
	`__vŞ©e__
("fetchadd4.rel %0=[%1],-1"

246 : "ô" (
»suÉ
è: 
AO_IN_ADDR


248  
»suÉ
;

249 
	}
}

250 
	#AO_HAVE_št_ãtch_ªd_sub1_»Ëa£


	)

253 
AO_INLINE
 

254 
	$AO_št_ãtch_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

255 
Şd
, 
Ãw_v®
)

257 
ãtched_v®
;

258 
__asm__
 
	`__vŞ©e__
("mov‡r.ccv=%3 ;; cmpxchg4.acq %0=[%1],%2,ar.ccv"

259 : "ô"(
ãtched_v®
)

260 : 
AO_IN_ADDR
, "r"(
Ãw_v®
), "r"((
AO_t
)
Şd
)

262  
ãtched_v®
;

263 
	}
}

264 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_acquœe


	)

266 
AO_INLINE
 

267 
	$AO_št_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

268 
Şd
, 
Ãw_v®
)

270 
ãtched_v®
;

271 
__asm__
 
	`__vŞ©e__
("mov‡r.ccv=%3 ;; cmpxchg4.rel %0=[%1],%2,ar.ccv"

272 : "ô"(
ãtched_v®
)

273 : 
AO_IN_ADDR
, "r"(
Ãw_v®
), "r"((
AO_t
)
Şd
)

275  
ãtched_v®
;

276 
	}
}

277 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_»Ëa£


	)

	@/usr/include/atomic_ops/sysdeps/gcc/powerpc.h

30 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

32 
	#AO_lßd
(
addr
è
	`AO_lßd_acquœe
×ddr)

	)

34 
	~"../‹¡_ªd_£t_t_is_ao_t.h
"

38 
AO_INLINE
 

39 
	$AO_nİ_fuÎ
()

41 
__asm__
 
	`__vŞ©e__
("sync" : : : "memory");

42 
	}
}

43 
	#AO_HAVE_nİ_fuÎ


	)

46 
AO_INLINE
 

47 
	$AO_lwsync
()

49 #ifdeà
__NO_LWSYNC__


50 
__asm__
 
	`__vŞ©e__
("sync" : : : "memory");

52 
__asm__
 
	`__vŞ©e__
("lwsync" : : : "memory");

54 
	}
}

56 
	#AO_nİ_wr™e
(è
	`AO_lwsync
()

	)

57 
	#AO_HAVE_nİ_wr™e


	)

59 
	#AO_nİ_»ad
(è
	`AO_lwsync
()

	)

60 
	#AO_HAVE_nİ_»ad


	)

69 
AO_INLINE
 
AO_t


70 
	$AO_lßd_acquœe
(cÚ¡ vŞ©
AO_t
 *
addr
)

72 
AO_t
 
»suÉ
;

73 #ià
	`defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

74 
__asm__
 
	`__vŞ©e__
 (

79 : "ô" (
»suÉ
)

80 : "m"(*
addr
) : "memory", "cr0");

85 
__asm__
 
	`__vŞ©e__
 (

90 : "ô" (
»suÉ
)

91 : "m"(*
addr
) : "memory", "cc");

93  
»suÉ
;

94 
	}
}

95 
	#AO_HAVE_lßd_acquœe


	)

99 
AO_INLINE
 

100 
	$AO_¡Üe_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
v®ue
)

102 
	`AO_lwsync
();

103 *
addr
 = 
v®ue
;

104 
	}
}

105 
	#AO_HAVE_¡Üe_»Ëa£


	)

107 #iâdeà
AO_PREFER_GENERALIZED


111 
AO_INLINE
 
AO_TS_VAL_t


112 
	$AO_‹¡_ªd_£t
(vŞ©
AO_TS_t
 *
addr
) {

113 #ià
	`defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

115 
Şdv®
;

116 
‹mp
 = 1;

118 
__asm__
 
	`__vŞ©e__
(

125 : "=&r"(
Şdv®
)

126 : "r"(
addr
), "r"(
‹mp
)

129 
Şdv®
;

130 
‹mp
 = 1;

132 
__asm__
 
	`__vŞ©e__
(

139 : "=&r"(
Şdv®
)

140 : "r"(
addr
), "r"(
‹mp
)

143  (
AO_TS_VAL_t
)
Şdv®
;

144 
	}
}

145 
	#AO_HAVE_‹¡_ªd_£t


	)

147 
AO_INLINE
 
AO_TS_VAL_t


148 
	$AO_‹¡_ªd_£t_acquœe
(vŞ©
AO_TS_t
 *
addr
) {

149 
AO_TS_VAL_t
 
»suÉ
 = 
	`AO_‹¡_ªd_£t
(
addr
);

150 
	`AO_lwsync
();

151  
»suÉ
;

152 
	}
}

153 
	#AO_HAVE_‹¡_ªd_£t_acquœe


	)

155 
AO_INLINE
 
AO_TS_VAL_t


156 
	$AO_‹¡_ªd_£t_»Ëa£
(vŞ©
AO_TS_t
 *
addr
) {

157 
	`AO_lwsync
();

158  
	`AO_‹¡_ªd_£t
(
addr
);

159 
	}
}

160 
	#AO_HAVE_‹¡_ªd_£t_»Ëa£


	)

162 
AO_INLINE
 
AO_TS_VAL_t


163 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
) {

164 
AO_TS_VAL_t
 
»suÉ
;

165 
	`AO_lwsync
();

166 
»suÉ
 = 
	`AO_‹¡_ªd_£t
(
addr
);

167 
	`AO_lwsync
();

168  
»suÉ
;

169 
	}
}

170 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

173 #iâdeà
AO_GENERALIZE_ASM_BOOL_CAS


175 
AO_INLINE
 

176 
	$AO_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

178 
AO_t
 
Şdv®
;

179 
»suÉ
 = 0;

180 #ià
	`defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

181 
__asm__
 
	`__vŞ©e__
(

189 : "=&r"(
Şdv®
), "=&r"(
»suÉ
)

190 : "r"(
addr
), "r"(
Ãw_v®
), "r"(
Şd
), "1"(
»suÉ
)

193 
__asm__
 
	`__vŞ©e__
(

201 : "=&r"(
Şdv®
), "=&r"(
»suÉ
)

202 : "r"(
addr
), "r"(
Ãw_v®
), "r"(
Şd
), "1"(
»suÉ
)

205  
»suÉ
;

206 
	}
}

207 
	#AO_HAVE_com·»_ªd_sw­


	)

209 
AO_INLINE
 

210 
	$AO_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

212 
»suÉ
 = 
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

213 
	`AO_lwsync
();

214  
»suÉ
;

215 
	}
}

216 
	#AO_HAVE_com·»_ªd_sw­_acquœe


	)

218 
AO_INLINE
 

219 
	$AO_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

221 
	`AO_lwsync
();

222  
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

223 
	}
}

224 
	#AO_HAVE_com·»_ªd_sw­_»Ëa£


	)

226 
AO_INLINE
 

227 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

229 
»suÉ
;

230 
	`AO_lwsync
();

231 
»suÉ
 = 
	`AO_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®
);

232 
	`AO_lwsync
();

233  
»suÉ
;

234 
	}
}

235 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

239 
AO_INLINE
 
AO_t


240 
	$AO_ãtch_com·»_ªd_sw­
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
, AO_ˆ
Ãw_v®
)

242 
AO_t
 
ãtched_v®
;

243 #ià
	`defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

244 
__asm__
 
	`__vŞ©e__
(

251 : "=&r"(
ãtched_v®
)

252 : "r"(
addr
), "r"(
Ãw_v®
), "r"(
Şd_v®
)

255 
__asm__
 
	`__vŞ©e__
(

262 : "=&r"(
ãtched_v®
)

263 : "r"(
addr
), "r"(
Ãw_v®
), "r"(
Şd_v®
)

266  
ãtched_v®
;

267 
	}
}

268 
	#AO_HAVE_ãtch_com·»_ªd_sw­


	)

270 
AO_INLINE
 
AO_t


271 
	$AO_ãtch_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

272 
AO_t
 
Ãw_v®
)

274 
AO_t
 
»suÉ
 = 
	`AO_ãtch_com·»_ªd_sw­
(
addr
, 
Şd_v®
, 
Ãw_v®
);

275 
	`AO_lwsync
();

276  
»suÉ
;

277 
	}
}

278 
	#AO_HAVE_ãtch_com·»_ªd_sw­_acquœe


	)

280 
AO_INLINE
 
AO_t


281 
	$AO_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

282 
AO_t
 
Ãw_v®
)

284 
	`AO_lwsync
();

285  
	`AO_ãtch_com·»_ªd_sw­
(
addr
, 
Şd_v®
, 
Ãw_v®
);

286 
	}
}

287 
	#AO_HAVE_ãtch_com·»_ªd_sw­_»Ëa£


	)

289 
AO_INLINE
 
AO_t


290 
	$AO_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

291 
AO_t
 
Ãw_v®
)

293 
AO_t
 
»suÉ
;

294 
	`AO_lwsync
();

295 
»suÉ
 = 
	`AO_ãtch_com·»_ªd_sw­
(
addr
, 
Şd_v®
, 
Ãw_v®
);

296 
	`AO_lwsync
();

297  
»suÉ
;

298 
	}
}

299 
	#AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ


	)

301 #iâdeà
AO_PREFER_GENERALIZED


302 
AO_INLINE
 
AO_t


303 
	$AO_ãtch_ªd_add
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

304 
AO_t
 
Şdv®
;

305 
AO_t
 
Ãwv®
;

306 #ià
	`defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

307 
__asm__
 
	`__vŞ©e__
(

312 : "=&r"(
Şdv®
), "=&r"(
Ãwv®
)

313 : "r"(
addr
), "r"(
šü
)

316 
__asm__
 
	`__vŞ©e__
(

321 : "=&r"(
Şdv®
), "=&r"(
Ãwv®
)

322 : "r"(
addr
), "r"(
šü
)

325  
Şdv®
;

326 
	}
}

327 
	#AO_HAVE_ãtch_ªd_add


	)

329 
AO_INLINE
 
AO_t


330 
	$AO_ãtch_ªd_add_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

331 
AO_t
 
»suÉ
 = 
	`AO_ãtch_ªd_add
(
addr
, 
šü
);

332 
	`AO_lwsync
();

333  
»suÉ
;

334 
	}
}

335 
	#AO_HAVE_ãtch_ªd_add_acquœe


	)

337 
AO_INLINE
 
AO_t


338 
	$AO_ãtch_ªd_add_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

339 
	`AO_lwsync
();

340  
	`AO_ãtch_ªd_add
(
addr
, 
šü
);

341 
	}
}

342 
	#AO_HAVE_ãtch_ªd_add_»Ëa£


	)

344 
AO_INLINE
 
AO_t


345 
	$AO_ãtch_ªd_add_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
šü
) {

346 
AO_t
 
»suÉ
;

347 
	`AO_lwsync
();

348 
»suÉ
 = 
	`AO_ãtch_ªd_add
(
addr
, 
šü
);

349 
	`AO_lwsync
();

350  
»suÉ
;

351 
	}
}

352 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

355 #ià
defšed
(
__pow”pc64__
è|| defšed(
__µc64__
è|| defšed(
__64BIT__
)

358 
	#AO_T_IS_INT


	)

	@/usr/include/atomic_ops/sysdeps/gcc/sparc.h

21 
	~"../®l_©omic_lßd_¡Üe.h
"

24 
	~"../Üd”ed_exû±_wr.h
"

27 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

29 
AO_INLINE
 
AO_TS_VAL_t


30 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
) {

31 
AO_TS_VAL_t
 
Şdv®
;

33 
__asm__
 
	`__vŞ©e__
("ldstub %1,%0"

34 : "ô"(
Şdv®
), "=m"(*
addr
)

35 : "m"(*
addr
) : "memory");

36  
Şdv®
;

37 
	}
}

38 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

40 #iâdeà
AO_NO_SPARC_V9


42 
AO_INLINE
 

43 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
) {

44 
»t
;

45 
__asm__
 
	`__vŞ©e__
 ("membar #StoreLoad | #LoadLoad\n\t"

46 #ià
	`defšed
(
__¬ch64__
)

57 : "ô" (
»t
), "+r" (
Ãw_v®
)

58 : "r" (
addr
), "0" (
Şd
)

60  ()
»t
;

61 
	}
}

62 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/gcc/x86.h

24 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

26 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

28 #ià
defšed
(
__SSE2__
è&& !defšed(
AO_USE_PENTIUM4_INSTRS
)

30 
	#AO_USE_PENTIUM4_INSTRS


	)

33 #ià
defšed
(
AO_USE_PENTIUM4_INSTRS
)

34 
AO_INLINE
 

35 
	$AO_nİ_fuÎ
()

37 
__asm__
 
	`__vŞ©e__
("mfence" : : : "memory");

38 
	}
}

39 
	#AO_HAVE_nİ_fuÎ


	)

51 #iâdeà
AO_PREFER_GENERALIZED


52 
AO_INLINE
 
AO_t


53 
	$AO_ãtch_ªd_add_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
šü
)

55 
AO_t
 
»suÉ
;

57 
__asm__
 
	`__vŞ©e__
 ("lock; xadd %0, %1" :

58 "ô" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

60  
»suÉ
;

61 
	}
}

62 
	#AO_HAVE_ãtch_ªd_add_fuÎ


	)

65 
AO_INLINE
 

66 
	$AO_ch¬_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

68 
»suÉ
;

70 
__asm__
 
	`__vŞ©e__
 ("lock; xaddb %0, %1" :

71 "=q" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

73  
»suÉ
;

74 
	}
}

75 
	#AO_HAVE_ch¬_ãtch_ªd_add_fuÎ


	)

77 
AO_INLINE
 

78 
	$AO_shÜt_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

80 
»suÉ
;

82 
__asm__
 
	`__vŞ©e__
 ("lock; xaddw %0, %1" :

83 "ô" (
»suÉ
), "=m" (*
p
è: "0" (
šü
), "m" (*p)

85  
»suÉ
;

86 
	}
}

87 
	#AO_HAVE_shÜt_ãtch_ªd_add_fuÎ


	)

89 #iâdeà
AO_PREFER_GENERALIZED


91 
AO_INLINE
 

92 
	$AO_ªd_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

94 
__asm__
 
	`__vŞ©e__
 ("lock;‡nd %1, %0" :

95 "=m" (*
p
è: "r" (
v®ue
), "m" (*p)

97 
	}
}

98 
	#AO_HAVE_ªd_fuÎ


	)

100 
AO_INLINE
 

101 
	$AO_Ü_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

103 
__asm__
 
	`__vŞ©e__
 ("lock; or %1, %0" :

104 "=m" (*
p
è: "r" (
v®ue
), "m" (*p)

106 
	}
}

107 
	#AO_HAVE_Ü_fuÎ


	)

109 
AO_INLINE
 

110 
	$AO_xÜ_fuÎ
 (vŞ©
AO_t
 *
p
, AO_ˆ
v®ue
)

112 
__asm__
 
	`__vŞ©e__
 ("lock; xor %1, %0" :

113 "=m" (*
p
è: "r" (
v®ue
), "m" (*p)

115 
	}
}

116 
	#AO_HAVE_xÜ_fuÎ


	)

123 
AO_INLINE
 
AO_TS_VAL_t


124 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
)

126 
Şdv®
;

128 
__asm__
 
	`__vŞ©e__
 ("xchgb %0, %1"

129 : "=q" (
Şdv®
), "=m" (*
addr
)

130 : "0" (()0xff), "m" (*
addr
)

132  (
AO_TS_VAL_t
)
Şdv®
;

133 
	}
}

134 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

136 #iâdeà
AO_GENERALIZE_ASM_BOOL_CAS


138 
AO_INLINE
 

139 
	$AO_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd
, AO_ˆ
Ãw_v®
)

141 #ifdeà
AO_USE_SYNC_CAS_BUILTIN


142  ()
	`__sync_boŞ_com·»_ªd_sw­
(
addr
, 
Şd
, 
Ãw_v®


148 
»suÉ
;

149 
__asm__
 
	`__vŞ©e__
 ("lock; cmpxchg %3, %0; setz %1"

150 : "=m" (*
addr
), "÷" (
»suÉ
)

151 : "m" (*
addr
), "r" (
Ãw_v®
), "a" (
Şd
)

153  ()
»suÉ
;

155 
	}
}

156 
	#AO_HAVE_com·»_ªd_sw­_fuÎ


	)

159 
AO_INLINE
 
AO_t


160 
	$AO_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

161 
AO_t
 
Ãw_v®
)

163 #ifdeà
AO_USE_SYNC_CAS_BUILTIN


164  
	`__sync_v®_com·»_ªd_sw­
(
addr
, 
Şd_v®
, 
Ãw_v®


167 
AO_t
 
ãtched_v®
;

168 
__asm__
 
	`__vŞ©e__
 ("lock; cmpxchg %3, %4"

169 : "÷" (
ãtched_v®
), "=m" (*
addr
)

170 : "a" (
Şd_v®
), "r" (
Ãw_v®
), "m" (*
addr
)

172  
ãtched_v®
;

174 
	}
}

175 
	#AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ


	)

177 #ià!
defšed
(
__x86_64__
è&& !defšed(
AO_USE_SYNC_CAS_BUILTIN
)

178 
	~"../¡ªd¬d_ao_doubË_t.h
"

183 
	#AO_ACCESS_doubË_CHECK_ALIGNED


	)

184 
	~"../lßd¡Üe/doubË_©omic_lßd_¡Üe.h
"

188 
AO_INLINE
 

189 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

190 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

191 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

193 
»suÉ
;

194 #ifdeà
__PIC__


195 
AO_t
 
§ved_ebx
;

205 #ifdeà
__OPTIMIZE__


206 
__asm__
 
	`__vŞ©e__
("mov %%ebx, %2\n\t"

212 : "=m" (*
addr
), "÷" (
»suÉ
), "=m" (
§ved_ebx
)

213 : "m" (*
addr
), "d" (
Şd_v®2
), "a" (
Şd_v®1
),

214 "c" (
Ãw_v®2
), "m" (
Ãw_v®1
)

220 
AO_t
 
§ved_edi
;

221 
__asm__
 
	`__vŞ©e__
("mov %%edi, %3\n\t"

229 : "=m" (*
addr
), "÷" (
»suÉ
),

230 "=m" (
§ved_ebx
), "=m" (
§ved_edi
)

231 : "m" (*
addr
), "d" (
Şd_v®2
), "a" (
Şd_v®1
),

232 "c" (
Ãw_v®2
), "m" (
Ãw_v®1
) : "memory");

238 
__asm__
 
	`__vŞ©e__
 ("lock; cmpxchg8b %0; setz %1"

239 : "=m" (*
addr
), "÷" (
»suÉ
)

240 : "m" (*
addr
), "d" (
Şd_v®2
), "a" (
Şd_v®1
),

241 "c" (
Ãw_v®2
), "b" (
Ãw_v®1
)

244  (è
»suÉ
;

245 
	}
}

246 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

248 
	#AO_T_IS_INT


	)

250 #–ià
defšed
(
__ILP32__
è|| !defšed(
__x86_64__
)

251 
	~"../¡ªd¬d_ao_doubË_t.h
"

255 
	#AO_ACCESS_doubË_CHECK_ALIGNED


	)

256 
	~"../lßd¡Üe/doubË_©omic_lßd_¡Üe.h
"

261 
AO_INLINE
 

262 
	$AO_doubË_com·»_ªd_sw­_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

263 
AO_doubË_t
 
Şd_v®
, AO_doubË_ˆ
Ãw_v®
)

266  
	`__sync_boŞ_com·»_ªd_sw­
(&
addr
->
AO_whŞe
,

267 
Şd_v®
.
AO_whŞe
, 
Ãw_v®
.AO_whole

269 
	}
}

270 
	#AO_HAVE_doubË_com·»_ªd_sw­_fuÎ


	)

272 
	#AO_T_IS_INT


	)

276 
AO_INLINE
 

277 
	$AO_št_ãtch_ªd_add_fuÎ
 (vŞ©*
p
, 
šü
)

279 
»suÉ
;

281 
__asm__
 
	`__vŞ©e__
 ("lock; xaddl %0, %1"

282 : "ô" (
»suÉ
), "=m" (*
p
)

283 : "0" (
šü
), "m" (*
p
)

285  
»suÉ
;

286 
	}
}

287 
	#AO_HAVE_št_ãtch_ªd_add_fuÎ


	)

303 #ifdeà
AO_CMPXCHG16B_AVAILABLE


304 
	~"../¡ªd¬d_ao_doubË_t.h
"

314 
AO_INLINE
 

315 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

316 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

317 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

319 
»suÉ
;

320 
__asm__
 
	`__vŞ©e__
("lock; cmpxchg16b %0; setz %1"

321 : "=m"(*
addr
), "÷"(
»suÉ
)

322 : "m"(*
addr
), "d" (
Şd_v®2
), "a" (
Şd_v®1
),

323 "c" (
Ãw_v®2
), "b" (
Ãw_v®1
)

325  (è
»suÉ
;

326 
	}
}

327 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

329 #–ià
defšed
(
AO_WEAK_DOUBLE_CAS_EMULATION
)

330 
	~"../¡ªd¬d_ao_doubË_t.h
"

336 
AO_com·»_doubË_ªd_sw­_doubË_emuÏtiÚ
(

337 vŞ©
AO_doubË_t
 *
addr
,

338 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

339 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
);

341 
AO_INLINE
 

342 
	$AO_com·»_doubË_ªd_sw­_doubË_fuÎ
(vŞ©
AO_doubË_t
 *
addr
,

343 
AO_t
 
Şd_v®1
, AO_ˆ
Şd_v®2
,

344 
AO_t
 
Ãw_v®1
, AO_ˆ
Ãw_v®2
)

346  
	`AO_com·»_doubË_ªd_sw­_doubË_emuÏtiÚ
(
addr
,

347 
Şd_v®1
, 
Şd_v®2
, 
Ãw_v®1
, 
Ãw_v®2
);

348 
	}
}

349 
	#AO_HAVE_com·»_doubË_ªd_sw­_doubË_fuÎ


	)

360 
	~"../Üd”ed_exû±_wr.h
"

	@/usr/include/atomic_ops/sysdeps/ibmc/powerpc.h

17 
	~"../®l_®igÃd_©omic_lßd_¡Üe.h
"

19 
AO_sync
();

20 #´agm¨
mc_func
 
AO_sync
 { "7c0004ac" }

22 #ifdeà
__NO_LWSYNC__


23 
	#AO_lwsync
 
AO_sync


	)

25 
AO_lwsync
();

26 #´agm¨
mc_func
 
AO_lwsync
 { "7c2004ac" }

29 
	#AO_nİ_wr™e
(è
	`AO_lwsync
()

	)

30 
	#AO_HAVE_nİ_wr™e


	)

32 
	#AO_nİ_»ad
(è
	`AO_lwsync
()

	)

33 
	#AO_HAVE_nİ_»ad


	)

37 
AO_INLINE
 
AO_t


38 
	$AO_lßd_acquœe
(cÚ¡ vŞ©
AO_t
 *
addr
)

40 
AO_t
 
»suÉ
 = *
addr
;

41 
	`AO_lwsync
();

42  
»suÉ
;

43 
	}
}

44 
	#AO_HAVE_lßd_acquœe


	)

46 
AO_INLINE
 

47 
	$AO_¡Üe_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
v®ue
)

49 
	`AO_lwsync
();

50 *
addr
 = 
v®ue
;

51 
	}
}

52 
	#AO_HAVE_¡Üe_»Ëa£


	)

54 #iâdeà
AO_PREFER_GENERALIZED


64 
AO_INLINE
 
AO_TS_VAL_t


65 
	$AO_‹¡_ªd_£t_acquœe
(vŞ©
AO_TS_t
 *
addr
) {

66 
AO_TS_VAL_t
 
»suÉ
 = 
	`AO_‹¡_ªd_£t
(
addr
);

67 
	`AO_lwsync
();

68  
»suÉ
;

69 
	}
}

70 
	#AO_HAVE_‹¡_ªd_£t_acquœe


	)

72 
AO_INLINE
 
AO_TS_VAL_t


73 
	$AO_‹¡_ªd_£t_»Ëa£
(vŞ©
AO_TS_t
 *
addr
) {

74 
	`AO_lwsync
();

75  
	`AO_‹¡_ªd_£t
(
addr
);

76 
	}
}

77 
	#AO_HAVE_‹¡_ªd_£t_»Ëa£


	)

79 
AO_INLINE
 
AO_TS_VAL_t


80 
	$AO_‹¡_ªd_£t_fuÎ
(vŞ©
AO_TS_t
 *
addr
) {

81 
AO_TS_VAL_t
 
»suÉ
;

82 
	`AO_lwsync
();

83 
»suÉ
 = 
	`AO_‹¡_ªd_£t
(
addr
);

84 
	`AO_lwsync
();

85  
»suÉ
;

86 
	}
}

87 
	#AO_HAVE_‹¡_ªd_£t_fuÎ


	)

97 
AO_INLINE
 
AO_t


98 
	$AO_ãtch_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

99 
AO_t
 
Ãw_v®
)

101 
AO_t
 
»suÉ
 = 
	`AO_ãtch_com·»_ªd_sw­
(
addr
, 
Şd_v®
, 
Ãw_v®
);

102 
	`AO_lwsync
();

103  
»suÉ
;

104 
	}
}

105 
	#AO_HAVE_ãtch_com·»_ªd_sw­_acquœe


	)

107 
AO_INLINE
 
AO_t


108 
	$AO_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

109 
AO_t
 
Ãw_v®
)

111 
	`AO_lwsync
();

112  
	`AO_ãtch_com·»_ªd_sw­
(
addr
, 
Şd_v®
, 
Ãw_v®
);

113 
	}
}

114 
	#AO_HAVE_ãtch_com·»_ªd_sw­_»Ëa£


	)

116 
AO_INLINE
 
AO_t


117 
	$AO_ãtch_com·»_ªd_sw­_fuÎ
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

118 
AO_t
 
Ãw_v®
)

120 
AO_t
 
»suÉ
;

121 
	`AO_lwsync
();

122 
»suÉ
 = 
	`AO_ãtch_com·»_ªd_sw­
(
addr
, 
Şd_v®
, 
Ãw_v®
);

123 
	`AO_lwsync
();

124  
»suÉ
;

125 
	}
}

126 
	#AO_HAVE_ãtch_com·»_ªd_sw­_fuÎ


	)

	@/usr/include/atomic_ops/sysdeps/icc/ia64.h

29 
	~"../®l_©omic_lßd_¡Üe.h
"

31 
	~"../‹¡_ªd_£t_t_is_ch¬.h
"

33 
	~<Ÿ64šŒš.h
>

39 
	#AO_INTEL_PTR_t
 *

	)

41 
AO_INLINE
 
AO_t


42 
	$AO_lßd_acquœe
(cÚ¡ vŞ©
AO_t
 *
p
)

44  (
AO_t
)(
	`__ld8_acq
((
AO_INTEL_PTR_t
)
p
));

45 
	}
}

46 
	#AO_HAVE_lßd_acquœe


	)

48 
AO_INLINE
 

49 
	$AO_¡Üe_»Ëa£
(vŞ©
AO_t
 *
p
, AO_ˆ
v®
)

51 
	`__¡8_»l
((
AO_INTEL_PTR_t
)
p
, (
__št64
)
v®
);

52 
	}
}

53 
	#AO_HAVE_¡Üe_»Ëa£


	)

55 
AO_INLINE
 

56 
	$AO_ch¬_lßd_acquœe
(cÚ¡ vŞ©*
p
)

59  (
	`__ld1_acq
((
AO_INTEL_PTR_t
)
p
));

60 
	}
}

61 
	#AO_HAVE_ch¬_lßd_acquœe


	)

63 
AO_INLINE
 

64 
	$AO_ch¬_¡Üe_»Ëa£
(vŞ©*
p
, 
v®
)

66 
	`__¡1_»l
((
AO_INTEL_PTR_t
)
p
, 
v®
);

67 
	}
}

68 
	#AO_HAVE_ch¬_¡Üe_»Ëa£


	)

70 
AO_INLINE
 

71 
	$AO_shÜt_lßd_acquœe
(cÚ¡ vŞ©*
p
)

74  (
	`__ld2_acq
((
AO_INTEL_PTR_t
)
p
));

75 
	}
}

76 
	#AO_HAVE_shÜt_lßd_acquœe


	)

78 
AO_INLINE
 

79 
	$AO_shÜt_¡Üe_»Ëa£
(vŞ©*
p
, 
v®
)

81 
	`__¡2_»l
((
AO_INTEL_PTR_t
)
p
, 
v®
);

82 
	}
}

83 
	#AO_HAVE_shÜt_¡Üe_»Ëa£


	)

85 
AO_INLINE
 

86 
	$AO_št_lßd_acquœe
(cÚ¡ vŞ©*
p
)

89  (
	`__ld4_acq
((
AO_INTEL_PTR_t
)
p
));

90 
	}
}

91 
	#AO_HAVE_št_lßd_acquœe


	)

93 
AO_INLINE
 

94 
	$AO_št_¡Üe_»Ëa£
(vŞ©*
p
, 
v®
)

96 
	`__¡4_»l
((
AO_INTEL_PTR_t
)
p
, 
v®
);

97 
	}
}

98 
	#AO_HAVE_št_¡Üe_»Ëa£


	)

100 
AO_INLINE
 

101 
	$AO_nİ_fuÎ
()

103 
	`__mf
();

104 
	}
}

105 
	#AO_HAVE_nİ_fuÎ


	)

107 #iâdeà
AO_PREFER_GENERALIZED


108 
AO_INLINE
 
AO_t


109 
	$AO_ãtch_ªd_add1_acquœe
(vŞ©
AO_t
 *
p
)

111  
	`__ãtchadd8_acq
((
__št64
 *)
p
, 1);

112 
	}
}

113 
	#AO_HAVE_ãtch_ªd_add1_acquœe


	)

115 
AO_INLINE
 
AO_t


116 
	$AO_ãtch_ªd_add1_»Ëa£
(vŞ©
AO_t
 *
p
)

118  
	`__ãtchadd8_»l
((
__št64
 *)
p
, 1);

119 
	}
}

120 
	#AO_HAVE_ãtch_ªd_add1_»Ëa£


	)

122 
AO_INLINE
 
AO_t


123 
	$AO_ãtch_ªd_sub1_acquœe
(vŞ©
AO_t
 *
p
)

125  
	`__ãtchadd8_acq
((
__št64
 *)
p
, -1);

126 
	}
}

127 
	#AO_HAVE_ãtch_ªd_sub1_acquœe


	)

129 
AO_INLINE
 
AO_t


130 
	$AO_ãtch_ªd_sub1_»Ëa£
(vŞ©
AO_t
 *
p
)

132  
	`__ãtchadd8_»l
((
__št64
 *)
p
, -1);

133 
	}
}

134 
	#AO_HAVE_ãtch_ªd_sub1_»Ëa£


	)

137 
AO_INLINE
 
AO_t


138 
	$AO_ãtch_com·»_ªd_sw­_acquœe
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

139 
AO_t
 
Ãw_v®
)

141  
	`_IÁ”lockedCom·»Exchªge64_acq
(
addr
, 
Ãw_v®
, 
Şd_v®
);

142 
	}
}

143 
	#AO_HAVE_ãtch_com·»_ªd_sw­_acquœe


	)

145 
AO_INLINE
 
AO_t


146 
	$AO_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©
AO_t
 *
addr
, AO_ˆ
Şd_v®
,

147 
AO_t
 
Ãw_v®
)

149  
	`_IÁ”lockedCom·»Exchªge64_»l
(
addr
, 
Ãw_v®
, 
Şd_v®
);

150 
	}
}

151 
	#AO_HAVE_ãtch_com·»_ªd_sw­_»Ëa£


	)

153 
AO_INLINE
 

154 
	$AO_ch¬_ãtch_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

155 
Şd_v®
,

156 
Ãw_v®
)

158  
	`_IÁ”lockedCom·»Exchªge8_acq
(
addr
, 
Ãw_v®
, 
Şd_v®
);

159 
	}
}

160 
	#AO_HAVE_ch¬_ãtch_com·»_ªd_sw­_acquœe


	)

162 
AO_INLINE
 

163 
	$AO_ch¬_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

164 
Şd_v®
,

165 
Ãw_v®
)

167  
	`_IÁ”lockedCom·»Exchªge8_»l
(
addr
, 
Ãw_v®
, 
Şd_v®
);

168 
	}
}

169 
	#AO_HAVE_ch¬_ãtch_com·»_ªd_sw­_»Ëa£


	)

171 
AO_INLINE
 

172 
	$AO_shÜt_ãtch_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

173 
Şd_v®
,

174 
Ãw_v®
)

176  
	`_IÁ”lockedCom·»Exchªge16_acq
(
addr
, 
Ãw_v®
, 
Şd_v®
);

177 
	}
}

178 
	#AO_HAVE_shÜt_ãtch_com·»_ªd_sw­_acquœe


	)

180 
AO_INLINE
 

181 
	$AO_shÜt_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

182 
Şd_v®
,

183 
Ãw_v®
)

185  
	`_IÁ”lockedCom·»Exchªge16_»l
(
addr
, 
Ãw_v®
, 
Şd_v®
);

186 
	}
}

187 
	#AO_HAVE_shÜt_ãtch_com·»_ªd_sw­_»Ëa£


	)

189 
AO_INLINE
 

190 
	$AO_št_ãtch_com·»_ªd_sw­_acquœe
(vŞ©*
addr
,

191 
Şd_v®
,

192 
Ãw_v®
)

194  
	`_IÁ”lockedCom·»Exchªge_acq
(
addr
, 
Ãw_v®
, 
Şd_v®
);

195 
	}
}

196 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_acquœe


	)

198 
AO_INLINE
 

199 
	$AO_št_ãtch_com·»_ªd_sw­_»Ëa£
(vŞ©*
addr
,

200 
Şd_v®
,

201 
Ãw_v®
)

203  
	`_IÁ”lockedCom·»Exchªge_»l
(
addr
, 
Ãw_v®
, 
Şd_v®
);

204 
	}
}

205 
	#AO_HAVE_št_ãtch_com·»_ªd_sw­_»Ëa£


	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exùy³
 (
i§Êum
);

111 
__exùy³
 (
i§Íha
);

112 
__exùy³
 (
isúŒl
);

113 
__exùy³
 (
isdig™
);

114 
__exùy³
 (
i¦ow”
);

115 
__exùy³
 (
isg¿ph
);

116 
__exùy³
 (
i¥ršt
);

117 
__exùy³
 (
i¥unù
);

118 
__exùy³
 (
is¥aû
);

119 
__exùy³
 (
isuµ”
);

120 
__exùy³
 (
isxdig™
);

124 
	$tŞow”
 (
__c
è
__THROW
;

127 
	$touµ”
 (
__c
è
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exùy³
 (
isbÏnk
);

138 
__END_NAMESPACE_C99


141 #ifdeà
__USE_GNU


143 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

146 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


150 
	$i§scii
 (
__c
è
__THROW
;

154 
	$tßscii
 (
__c
è
__THROW
;

158 
	`__exùy³
 (
_touµ”
);

159 
	`__exùy³
 (
_tŞow”
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
__»s
; \

166 ià( (
c
) > 1) \

168 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

174 
__»s
 = 
f
 
¬gs
; \

177 
__»s
 = (
a
)[(è(
c
)]; \

178 
__»s
; 
	}
}))

	)

180 #ià!
defšed
 
__NO_CTYPE


181 #ifdeà
__isùy³_f


182 
	$__isùy³_f
 (
®num
)

183 
	$__isùy³_f
 (
®pha
)

184 
	$__isùy³_f
 (
úŒl
)

185 
	$__isùy³_f
 (
dig™
)

186 
	$__isùy³_f
 (
low”
)

187 
	$__isùy³_f
 (
g¿ph
)

188 
	$__isùy³_f
 (
´št
)

189 
	$__isùy³_f
 (
punù
)

190 
	$__isùy³_f
 (
¥aû
)

191 
	$__isùy³_f
 (
uµ”
)

192 
	$__isùy³_f
 (
xdig™
)

193 #ifdeà
__USE_ISOC99


194 
	$__isùy³_f
 (
bÏnk
)

196 #–ià
defšed
 
__isùy³


197 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

198 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

199 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

200 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

201 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

202 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

203 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

204 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

205 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

206 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

207 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

208 #ifdeà
__USE_ISOC99


209 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

213 #ifdeà
__USE_EXTERN_INLINES


214 
__ex‹º_šlše
 

215 
	`__NTH
 (
	$tŞow”
 (
__c
))

217  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex‹º_šlše
 

221 
__NTH
 (
	$touµ”
 (
__c
))

223  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

224 
	}
}

227 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


228 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

229 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

232 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


233 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

234 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

236 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

237 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

243 #ifdeà
__USE_XOPEN2K8


257 
	~<xloÿË.h
>

261 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

262 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

264 
	#__exùy³_l
(
Çme
) \

265 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

271 
__exùy³_l
 (
i§Êum_l
);

272 
__exùy³_l
 (
i§Íha_l
);

273 
__exùy³_l
 (
isúŒl_l
);

274 
__exùy³_l
 (
isdig™_l
);

275 
__exùy³_l
 (
i¦ow”_l
);

276 
__exùy³_l
 (
isg¿ph_l
);

277 
__exùy³_l
 (
i¥ršt_l
);

278 
__exùy³_l
 (
i¥unù_l
);

279 
__exùy³_l
 (
is¥aû_l
);

280 
__exùy³_l
 (
isuµ”_l
);

281 
__exùy³_l
 (
isxdig™_l
);

283 
__exùy³_l
 (
isbÏnk_l
);

287 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

288 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

291 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

292 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


295 
	#__tŞow”_l
(
c
, 
loÿË
) \

296 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

297 
	#__touµ”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

299 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

300 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

304 #iâdeà
__NO_CTYPE


305 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

306 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

307 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

308 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

309 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

310 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

311 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

312 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

313 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

314 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

315 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

317 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


320 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

321 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

324 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

325 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

326 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

327 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

328 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

329 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

330 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

331 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

332 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

333 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

334 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

336 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

338 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


339 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

340 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_BSD
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

62 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


63 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

64 
	#htŞe16
(
x
è(x)

	)

65 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

66 
	#Ë16toh
(
x
è(x)

	)

68 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

69 
	#htŞe32
(
x
è(x)

	)

70 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

71 
	#Ë32toh
(
x
è(x)

	)

73 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

74 
	#htŞe64
(
x
è(x)

	)

75 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

76 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #undeà
__USE_ISOC11


102 #undeà
__USE_ISOC99


103 #undeà
__USE_ISOC95


104 #undeà
__USE_ISOCXX11


105 #undeà
__USE_POSIX


106 #undeà
__USE_POSIX2


107 #undeà
__USE_POSIX199309


108 #undeà
__USE_POSIX199506


109 #undeà
__USE_XOPEN


110 #undeà
__USE_XOPEN_EXTENDED


111 #undeà
__USE_UNIX98


112 #undeà
__USE_XOPEN2K


113 #undeà
__USE_XOPEN2KXSI


114 #undeà
__USE_XOPEN2K8


115 #undeà
__USE_XOPEN2K8XSI


116 #undeà
__USE_LARGEFILE


117 #undeà
__USE_LARGEFILE64


118 #undeà
__USE_FILE_OFFSET64


119 #undeà
__USE_BSD


120 #undeà
__USE_SVID


121 #undeà
__USE_MISC


122 #undeà
__USE_ATFILE


123 #undeà
__USE_GNU


124 #undeà
__USE_REENTRANT


125 #undeà
__USE_FORTIFY_LEVEL


126 #undeà
__KERNEL_STRICT_NAMES


130 #iâdeà
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

143 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

150 #ifdeà
_GNU_SOURCE


151 #undeà
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #undeà
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #undeà
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #undeà
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #undeà
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #undeà
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #undeà
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #undeà
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #undeà
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #undeà
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #undeà
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #undeà
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #ià(
defšed
 
_DEFAULT_SOURCE
 \

180 || (!
defšed
 
	g__STRICT_ANSI__
 \

181 && !
defšed
 
	g_ISOC99_SOURCE
 \

182 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

183 && !
defšed
 
	g_XOPEN_SOURCE
 \

184 && !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
))

185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #undeà
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #undeà
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #ià(
defšed
 
_ISOC11_SOURCE
 \

195 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

201 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

207 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

216 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifdeà
_DEFAULT_SOURCE


224 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #undeà
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #undeà
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #undeà
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #undeà
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #undeà
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #ià(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #undeà
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #ià(
_XOPEN_SOURCE
 - 0) >= 600

285 #ià(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #undeà
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #undeà
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifdeà
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifdeà
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifdeà
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #ià
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<¡dc-´edef.h
>

360 #undeà
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

369 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

372 #iâdeà
__ASSEMBLER__


373 #iâdeà
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

388 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

389 && 
defšed
 
	g__ex‹º_šlše


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/¡ubs.h
>

	@/usr/include/libio.h

28 #iâdeà
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cÚfig.h
>

33 
	#_IO_åos_t
 
_G_åos_t


	)

34 
	#_IO_åos64_t
 
_G_åos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li¡
 
_G_va_li¡


	)

45 
	#_IO_wšt_t
 
wšt_t


	)

48 
	#__Ãed___va_li¡


	)

49 
	~<¡d¬g.h
>

50 #ifdeà
__GNUC_VA_LIST


51 #undeà
_IO_va_li¡


52 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

55 #iâdeà
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #iâdeà
EOF


62 
	#EOF
 (-1)

	)

64 #iâdeà
NULL


65 #ià
defšed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuÎ
)

	)

69 #ià!
defšed
(
__ılu¥lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifdeà
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifdeà
_IO_MTSAFE_IO


148 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<b™s/¡dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¬k”
 {

161 
_IO_m¬k”
 *
	m_Ãxt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

169 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

170 
	mpublic
:

171 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

172 ~
¡»amm¬k”
();

173 
§všg
(è{  
	m_¥os
 == -2; }

174 
d–
(
¡»amm¬k”
&);

175 
d–
();

180 
	e__codecvt_»suÉ


182 
	m__codecvt_ok
,

183 
	m__codecvt_·¹Ÿl
,

184 
	m__codecvt_”rÜ
,

185 
	m__codecvt_nocÚv


188 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

194 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

195 
	m__mb¡©e_t
 *,

196 cÚ¡ 
	mwch¬_t
 *,

197 cÚ¡ 
	mwch¬_t
 *,

198 cÚ¡ 
	mwch¬_t
 **, *,

200 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

201 
	m__mb¡©e_t
 *, *,

203 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

204 
	m__mb¡©e_t
 *,

206 cÚ¡ **, 
	mwch¬_t
 *,

207 
	mwch¬_t
 *, wchar_t **);

208 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

211 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

214 
_IO_icÚv_t
 
	m__cd_š
;

215 
_IO_icÚv_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¬_t
 *
	m_IO_»ad_±r
;

222 
wch¬_t
 *
	m_IO_»ad_’d
;

223 
wch¬_t
 *
	m_IO_»ad_ba£
;

224 
wch¬_t
 *
	m_IO_wr™e_ba£
;

225 
wch¬_t
 *
	m_IO_wr™e_±r
;

226 
wch¬_t
 *
	m_IO_wr™e_’d
;

227 
wch¬_t
 *
	m_IO_buf_ba£
;

228 
wch¬_t
 *
	m_IO_buf_’d
;

230 
wch¬_t
 *
	m_IO_§ve_ba£
;

231 
wch¬_t
 *
	m_IO_backup_ba£
;

233 
wch¬_t
 *
	m_IO_§ve_’d
;

235 
__mb¡©e_t
 
	m_IO_¡©e
;

236 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¬_t
 
	m_shÜtbuf
[1];

241 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

245 
	s_IO_FILE
 {

246 
	m_æags
;

247 
	#_IO_fe_æags
 
_æags


	)

251 * 
	m_IO_»ad_±r
;

252 * 
	m_IO_»ad_’d
;

253 * 
	m_IO_»ad_ba£
;

254 * 
	m_IO_wr™e_ba£
;

255 * 
	m_IO_wr™e_±r
;

256 * 
	m_IO_wr™e_’d
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_’d
;

260 *
	m_IO_§ve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_§ve_’d
;

264 
_IO_m¬k”
 *
	m_m¬k”s
;

266 
_IO_FILE
 *
	m_chaš
;

268 
	m_f’o
;

270 
	m_blksize
;

272 
	m_æags2
;

274 
_IO_off_t
 
	m_Şd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cŞumn
;

279 sigÃd 
	m_vbË_off£t
;

280 
	m_shÜtbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifdeà
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com¶‘e


290 
_IO_FILE
 
	m_fe
;

292 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_ä“»s_li¡
;

299 *
	m_ä“»s_buf
;

300 
size_t
 
	m_ä“»s_size
;

302 *
	m__·d1
;

303 *
	m__·d2
;

304 *
	m__·d3
;

305 *
	m__·d4
;

306 
size_t
 
	m__·d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

314 #iâdeà
__ılu¥lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_¶us
;

320 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

321 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

322 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

323 #iâdeà
_LIBC


324 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

325 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

326 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

328 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

329 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

330 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

338 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

346 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_şo£_â
 (*
	t__cook›
);

361 #ifdeà
_GNU_SOURCE


363 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

364 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

365 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

366 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

371 
__io_»ad_â
 *
	m»ad
;

372 
__io_wr™e_â
 *
	mwr™e
;

373 
__io_£ek_â
 *
	m£ek
;

374 
__io_şo£_â
 *
	mşo£
;

375 } 
	t_IO_cook›_io_funùiÚs_t
;

376 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

378 
	g_IO_cook›_fe
;

381 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

382 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

386 #ifdeà
__ılu¥lus


390 
__und”æow
 (
_IO_FILE
 *);

391 
__uæow
 (
_IO_FILE
 *);

392 
__ov”æow
 (
_IO_FILE
 *, );

393 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

395 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

396 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

399 #ià 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

402 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

405 
	#_IO_g‘c_uÆocked
(
_å
) \

406 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

407 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

408 
	#_IO_³ekc_uÆocked
(
_å
) \

409 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

410 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

411 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

412 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

413 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

414 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

415 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

417 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_g‘wc_uÆocked
(
_å
) \

419 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

420 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

421 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

422 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

423 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

424 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

425 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

426 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

427 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

428 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

431 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

432 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

434 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

436 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

437 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

439 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

443 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

445 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

446 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

447 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

449 #ifdeà
_IO_MTSAFE_IO


450 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

451 
	#_IO_æockfe
(
_å
) \

452 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

453 
	#_IO_fuÆockfe
(
_å
) \

454 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

456 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

457 
	#_IO_æockfe
(
_å
è

	)

458 
	#_IO_fuÆockfe
(
_å
è

	)

459 
	#_IO_árylockfe
(
_å
è

	)

460 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

461 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

464 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

465 
_IO_va_li¡
, *
__»¡riù
);

466 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

467 
_IO_va_li¡
);

468 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

476 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

478 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

479 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

480 #ià
__GNUC__
 >= 2

483 #ià
defšed
 
_LIBC
 && defšed 
SHARED


484 
	~<shlib-com·t.h
>

485 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_šcom·tibË
 \

487 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

488 cÚ¡ 
_IO_¡dš_u£d
;

489 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

492 #iâdeà
_IO_fwide_maybe_šcom·tibË


493 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

497 
	#_IO_fwide
(
__å
, 
__mode
) \

498 ({ 
__»suÉ
 = (
__mode
); \

499 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

501 ià((
__å
)->
_mode
 == 0) \

503 (
__å
)->
_mode
 = -1; \

504 
__»suÉ
 = (
__å
)->
_mode
; \

506 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

507 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

509 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

510 
__»suÉ
; })

	)

513 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

514 
_IO_va_li¡
, *
__»¡riù
);

515 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

516 
_IO_va_li¡
);

517 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

518 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

521 #ifdeà
__LDBL_COMPAT


522 
	~<b™s/libio-ldbl.h
>

525 #ifdeà
__ılu¥lus


	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

23 
__off_t
 
	m__pos
;

24 
__mb¡©e_t
 
	m__¡©e
;

25 } 
	t_G_åos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos64_t
;

31 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcÚv.h
>

35 
__gcÚv_šfo
 
	m__cd
;

38 
__gcÚv_šfo
 
	m__cd
;

39 
__gcÚv_¡•_d©a
 
	m__d©a
;

40 } 
	m__combšed
;

41 } 
	t_G_icÚv_t
;

46 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	#__Ãed_mb¡©e_t


	)

27 
	#__Ãed_wšt_t


	)

28 
	~<wch¬.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
) (*, const *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 cÚ¡ *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


25 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<ã©u»s.h
>

30 #ifdeà
_WCHAR_H


32 
	#__Ãed___FILE


	)

33 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_FILE


	)

36 
	~<¡dio.h
>

38 
	#__Ãed___va_li¡


	)

39 
	~<¡d¬g.h
>

41 
	~<b™s/wch¬.h
>

44 
	#__Ãed_size_t


	)

45 
	#__Ãed_wch¬_t


	)

46 
	#__Ãed_NULL


	)

48 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


49 #undeà
__Ãed_wšt_t


50 
	#__Ãed_wšt_t


	)

51 
	~<¡ddef.h
>

55 #iâdeà
_WINT_T


60 
	#_WINT_T


	)

61 
	twšt_t
;

65 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defšed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twšt_t
;

69 
	g__END_NAMESPACE_STD


74 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
____mb¡©e_t_defšed


80 
	#____mb¡©e_t_defšed
 1

	)

84 
	m__couÁ
;

87 #ifdeà
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wšt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__v®ue
;

94 } 
	t__mb¡©e_t
;

96 #undeà
__Ãed_mb¡©e_t


101 #ifdeà
_WCHAR_H


103 #iâdeà
__mb¡©e_t_defšed


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb¡©e_t_defšed
 1

	)

111 #ifdeà
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

115 #iâdeà
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #iâdeà
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


128 
	~<wùy³.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

150 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

151 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

156 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

158 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

159 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

164 
__THROW
 
__©Œibu‹_pu»__
;

166 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©Œibu‹_pu»__
;

168 
__END_NAMESPACE_STD


170 #ifdeà
__USE_XOPEN2K8


172 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

175 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

176 
size_t
 
__n
è
__THROW
;

180 
	~<xloÿË.h
>

182 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

183 
__loÿË_t
 
__loc
è
__THROW
;

185 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

186 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

196 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

197 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifdeà
__USE_XOPEN2K8


206 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

207 
__loÿË_t
 
__loc
è
__THROW
;

212 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

213 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

216 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

224 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

227 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

228 
__THROW
 
__©Œibu‹_pu»__
;

231 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

233 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

234 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

235 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

237 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

238 
__THROW
 
__©Œibu‹_pu»__
;

240 
__END_NAMESPACE_STD


242 #ifdeà
__USE_GNU


245 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

246 
__THROW
 
__©Œibu‹_pu»__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

253 
__THROW
 
__©Œibu‹_pu»__
;

256 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

257 
__THROW
 
__©Œibu‹_pu»__
;

259 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

261 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

262 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

263 cÚ¡ 
wch¬_t
 *
__acû±
)

264 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

266 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

267 
__THROW
 
__©Œibu‹_pu»__
;

270 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

272 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

273 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

274 cÚ¡ 
wch¬_t
 *
__ÃedË
)

275 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

277 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

278 
__THROW
 
__©Œibu‹_pu»__
;

282 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

283 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

284 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

287 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

288 
__END_NAMESPACE_STD


290 #ifdeà
__USE_XOPEN


292 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

294 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

295 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

296 cÚ¡ 
wch¬_t
 *
__ÃedË
)

297 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

299 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

300 
__THROW
 
__©Œibu‹_pu»__
;

304 #ifdeà
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

307 
__THROW
 
__©Œibu‹_pu»__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

316 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

320 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©Œibu‹_pu»__
;

325 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©Œibu‹_pu»__
;

329 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

330 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

334 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifdeà
__USE_GNU


344 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

345 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

357 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

361 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

365 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

366 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

367 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

370 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

371 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

374 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

375 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

377 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifdeà
__USE_EXTERN_INLINES


386 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

387 
__ex‹º_šlše
 
wšt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

392 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

393 
__ex‹º_šlše
 

394 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

395 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

396 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

398 
__ex‹º_šlše
 
size_t


399 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

400 
mb¡©e_t
 *
__»¡riù
 
__ps
))

401 {  (
__ps
 !ğ
NULL


402 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

409 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

410 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

414 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

415 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

416 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

424 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

425 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

429 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

430 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

431 
size_t
 
__nwc
, size_ˆ
__Ën
,

432 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

437 #ifdeà
__USE_XOPEN


439 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

443 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

451 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifdeà
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

459 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

460 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

469 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

473 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifdeà
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__ex‹nsiÚ__


483 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

484 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

485 
__THROW
;

489 
__ex‹nsiÚ__


490 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

491 
wch¬_t
 **
__»¡riù
 
__’d±r
,

492 
__ba£
è
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifdeà
__USE_GNU


499 
__ex‹nsiÚ__


500 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

502 
__THROW
;

506 
__ex‹nsiÚ__


507 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

508 
wch¬_t
 **
__»¡riù
 
__’d±r
,

509 
__ba£
è
__THROW
;

512 #ifdeà
__USE_GNU


526 
	~<xloÿË.h
>

530 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

531 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

532 
__loÿË_t
 
__loc
è
__THROW
;

534 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

535 
wch¬_t
 **
__»¡riù
 
__’d±r
,

536 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

538 
__ex‹nsiÚ__


539 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

540 
wch¬_t
 **
__»¡riù
 
__’d±r
,

541 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

543 
__ex‹nsiÚ__


544 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

545 
wch¬_t
 **
__»¡riù
 
__’d±r
,

546 
__ba£
, 
__loÿË_t
 
__loc
)

547 
__THROW
;

549 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

550 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

551 
__THROW
;

553 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

554 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

555 
__THROW
;

557 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

558 
wch¬_t
 **
__»¡riù
 
__’d±r
,

559 
__loÿË_t
 
__loc
è
__THROW
;

563 #ifdeà
__USE_XOPEN2K8


566 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

567 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

571 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

572 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

583 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

594 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

595 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

601 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

605 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

606 
__THROW
 ;

612 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

613 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

614 
__gnuc_va_li¡
 
__¬g
)

620 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

621 
__gnuc_va_li¡
 
__¬g
)

625 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

626 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

627 
__gnuc_va_li¡
 
__¬g
)

628 
__THROW
 ;

635 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

636 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

642 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

646 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

647 
__THROW
 ;

649 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

650 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

651 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

652 #ifdeà
__REDIRECT


656 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

657 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

658 
__isoc99_fwsÿnf
)

660 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

661 
__isoc99_wsÿnf
)

663 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

664 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

665 ...), 
__isoc99_swsÿnf
)

668 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

669 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

670 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

671 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

672 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

673 
__THROW
;

674 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

675 
	#wsÿnf
 
__isoc99_wsÿnf


	)

676 
	#swsÿnf
 
__isoc99_swsÿnf


	)

680 
__END_NAMESPACE_STD


683 #ifdeà
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

690 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

691 
__gnuc_va_li¡
 
__¬g
)

697 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

698 
__gnuc_va_li¡
 
__¬g
)

701 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
)

704 
__THROW
 ;

706 #ià!
defšed
 
__USE_GNU
 \

707 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

708 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

711 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

712 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

714 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

715 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

717 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

718 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

719 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

722 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

723 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

724 
__gnuc_va_li¡
 
__¬g
);

725 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

726 
__gnuc_va_li¡
 
__¬g
);

727 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

728 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

729 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

730 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

731 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

732 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

746 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

752 
wšt_t
 
	`g‘wch¬
 ();

759 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

760 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

766 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

774 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

775 
__FILE
 *
__»¡riù
 
__¡»am
);

781 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

782 
__FILE
 *
__»¡riù
 
__¡»am
);

789 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

790 
__END_NAMESPACE_STD


793 #ifdeà
__USE_GNU


801 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

802 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

810 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

818 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

827 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

828 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

837 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

838 
__FILE
 *
__»¡riù
 
__¡»am
);

846 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

847 
__FILE
 *
__»¡riù
 
__¡»am
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

856 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

857 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifdeà
__USE_GNU


861 
	~<xloÿË.h
>

865 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

866 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

867 cÚ¡ 
tm
 *
__»¡riù
 
__
,

868 
__loÿË_t
 
__loc
è
__THROW
;

877 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


878 
	#__Ãed_iswxxx


	)

879 
	~<wùy³.h
>

883 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


884 
	~<b™s/wch¬2.h
>

887 #ifdeà
__LDBL_COMPAT


888 
	~<b™s/wch¬-ldbl.h
>

891 
__END_DECLS


899 #undeà
__Ãed_mb¡©e_t


900 #undeà
__Ãed_wšt_t


	@/usr/include/wctype.h

23 #iâdeà
_WCTYPE_H


25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 #iâdeà
__Ãed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__Ãed_wšt_t


	)

33 
	~<wch¬.h
>

37 #iâdeà
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #undeà
__Ãed_iswxxx


46 #iâdeà
__iswxxx_defšed


47 
	#__iswxxx_defšed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twùy³_t
;

53 
	g__END_NAMESPACE_C99


55 #iâdeà
_ISwb™


60 
	~<’dŸn.h
>

61 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


62 
	#_ISwb™
(
b™
è(1 << (b™))

	)

64 
	#_ISwb™
(
b™
) \

65 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (è((1UL << (
b™
)è>> 24))))

	)

73 
	m__ISwuµ”
 = 0,

74 
	m__ISwlow”
 = 1,

75 
	m__ISw®pha
 = 2,

76 
	m__ISwdig™
 = 3,

77 
	m__ISwxdig™
 = 4,

78 
	m__ISw¥aû
 = 5,

79 
	m__ISw´št
 = 6,

80 
	m__ISwg¿ph
 = 7,

81 
	m__ISwbÏnk
 = 8,

82 
	m__ISwúŒl
 = 9,

83 
	m__ISwpunù
 = 10,

84 
	m__ISw®num
 = 11,

86 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

87 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

88 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

89 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

90 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

91 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

92 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

93 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

94 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

95 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

96 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

97 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

124 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

128 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

133 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

136 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

141 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

146 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

151 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

156 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

161 #ifdeà
__USE_ISOC99


162 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

171 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

175 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cÚ¡ 
	t__št32_t
 *
	twù¿ns_t
;

187 
__END_NAMESPACE_C99


188 #ifdeà
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

197 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifdeà
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wù¿ns_t
 
	$wù¿ns
 (cÚ¡ *
__´İ”ty
è
__THROW
;

221 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifdeà
__USE_XOPEN2K8


226 
	~<xloÿË.h
>

230 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

236 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

239 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

243 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

247 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

252 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

255 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

260 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

265 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

270 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

275 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

280 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

284 
wùy³_t
 
	$wùy³_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

285 
__THROW
;

289 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

290 
__THROW
;

298 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

301 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

305 
wù¿ns_t
 
	$wù¿ns_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

306 
__THROW
;

309 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

310 
__loÿË_t
 
__loÿË
è
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
195
6699
atomic_ops/aligned_atomic_load_store.h
atomic_ops/all_acquire_release_volatile.h
atomic_ops/ao_t_is_int.h
atomic_ops/atomic_ops.h
atomic_ops/generalize-small.h
atomic_ops/generalize.h
atomic_ops/ia64.h
atomic_ops/ordered_except_wr.h
atomic_ops/powerpc.h
atomic_ops/read_ordered.h
atomic_ops/sparc.h
atomic_ops/standard_ao_double_t.h
atomic_ops/test_and_set_t_is_ao_t.h
atomic_ops/test_and_set_t_is_char.h
atomic_ops/x86.h
atomic_ops/x86_64.h
hashtables/lockbased-ht/hashtable-lock.c
hashtables/lockbased-ht/hashtable-lock.h
hashtables/lockbased-ht/test.c
hashtables/lockfree-ht/hashtable.c
hashtables/lockfree-ht/hashtable.h
hashtables/lockfree-ht/intset.c
hashtables/lockfree-ht/intset.h
hashtables/lockfree-ht/test.c
include/estm.h
include/icc.h
include/lockfree.h
include/lpdwstm.h
include/sequential.h
include/tinystm.h
include/tl2-mbench.h
include/tm.h
linkedlists/lazy-list/coupling.c
linkedlists/lazy-list/coupling.h
linkedlists/lazy-list/intset.c
linkedlists/lazy-list/intset.h
linkedlists/lazy-list/lazy.c
linkedlists/lazy-list/lazy.h
linkedlists/lazy-list/linkedlist-lock.c
linkedlists/lazy-list/linkedlist-lock.h
linkedlists/lazy-list/test.c
linkedlists/lock-coupling-list/coupling.c
linkedlists/lock-coupling-list/coupling.h
linkedlists/lock-coupling-list/intset.c
linkedlists/lock-coupling-list/intset.h
linkedlists/lock-coupling-list/lazy.c
linkedlists/lock-coupling-list/lazy.h
linkedlists/lock-coupling-list/linkedlist-lock.c
linkedlists/lock-coupling-list/linkedlist-lock.h
linkedlists/lock-coupling-list/test.c
linkedlists/lockfree-list/harris.c
linkedlists/lockfree-list/harris.h
linkedlists/lockfree-list/intset.c
linkedlists/lockfree-list/intset.h
linkedlists/lockfree-list/linkedlist.c
linkedlists/lockfree-list/linkedlist.h
linkedlists/lockfree-list/test.c
linkedlists/selfish/fomitchev.c
linkedlists/selfish/fomitchev.h
linkedlists/selfish/intset.h
linkedlists/selfish/mixin.c
linkedlists/selfish/selfish.c
linkedlists/selfish/selfish.h
linkedlists/selfish/test.c
linkedlists/versioned/intset.h
linkedlists/versioned/mixin.c
linkedlists/versioned/test.c
linkedlists/versioned/versioned-linkedlist.c
linkedlists/versioned/versioned-linkedlist.h
rtm-charlie/hash_hle/hashtable.cpp
rtm-charlie/hash_hle/hashtable.h
rtm-charlie/hash_hle/main.cpp
rtm-charlie/hash_rtm/hashtable.cpp
rtm-charlie/hash_rtm/hashtable.h
rtm-charlie/hash_rtm/main.cpp
rtm-charlie/list_hle/listNode.cpp
rtm-charlie/list_hle/listNode.h
rtm-charlie/list_hle/list_cgl.cpp
rtm-charlie/list_hle/test_list.cpp
rtm-charlie/list_rtm/listNode.cpp
rtm-charlie/list_rtm/listNode.h
rtm-charlie/list_rtm/list_cgl.cpp
rtm-charlie/list_rtm/test_list.cpp
utils/estm-0.2.4.3/bench/lf-deque/herlihy.c
utils/estm-0.2.4.3/bench/lf-deque/herlihy.h
utils/estm-0.2.4.3/bench/lf-deque/intset.c
utils/estm-0.2.4.3/bench/lf-deque/intset.h
utils/estm-0.2.4.3/bench/lf-deque/lf-ll.c
utils/estm-0.2.4.3/bench/lf-deque/linkedlist.c
utils/estm-0.2.4.3/bench/lf-deque/linkedlist.h
utils/estm-0.2.4.3/bench/lf-hashtable/lf-ht.c
utils/estm-0.2.4.3/bench/lf-linkedlist/harris.c
utils/estm-0.2.4.3/bench/lf-linkedlist/harris.h
utils/estm-0.2.4.3/bench/lf-linkedlist/intset.c
utils/estm-0.2.4.3/bench/lf-linkedlist/intset.h
utils/estm-0.2.4.3/bench/lf-linkedlist/lf-ll.c
utils/estm-0.2.4.3/bench/lf-linkedlist/linkedlist.c
utils/estm-0.2.4.3/bench/lf-linkedlist/linkedlist.h
utils/estm-0.2.4.3/bench/lf-linkedlist/recursive.c
utils/estm-0.2.4.3/bench/lf-linkedlist/recursive.h
utils/estm-0.2.4.3/bench/lf-rbtree/intset.c
utils/estm-0.2.4.3/bench/lf-rbtree/rbtree.c
utils/estm-0.2.4.3/bench/lf-rbtree/rbtree.h
utils/estm-0.2.4.3/bench/lf-rbtree/types.h
utils/estm-0.2.4.3/bench/lf-skiplist/intset.c
utils/estm-0.2.4.3/bench/lf-skiplist/lf-sl.c
utils/estm-0.2.4.3/bench/lf-skiplist/lf-sl.h
utils/estm-0.2.4.3/include/mod_local.h
utils/estm-0.2.4.3/include/mod_mem.h
utils/estm-0.2.4.3/include/mod_print.h
utils/estm-0.2.4.3/include/mod_stats.h
utils/estm-0.2.4.3/include/stm.h
utils/estm-0.2.4.3/include/wrappers.h
utils/estm-0.2.4.3/src/atomic.h
utils/estm-0.2.4.3/src/gc.c
utils/estm-0.2.4.3/src/gc.h
utils/estm-0.2.4.3/src/mod_local.c
utils/estm-0.2.4.3/src/mod_mem.c
utils/estm-0.2.4.3/src/mod_print.c
utils/estm-0.2.4.3/src/mod_stats.c
utils/estm-0.2.4.3/src/stm.c
utils/estm-0.2.4.3/src/wrappers.c
utils/estm-0.3.0/include/mod_local.h
utils/estm-0.3.0/include/mod_mem.h
utils/estm-0.3.0/include/mod_print.h
utils/estm-0.3.0/include/mod_stats.h
utils/estm-0.3.0/include/stm.h
utils/estm-0.3.0/include/wrappers.h
utils/estm-0.3.0/src/atomic.h
utils/estm-0.3.0/src/gc.c
utils/estm-0.3.0/src/gc.h
utils/estm-0.3.0/src/mod_local.c
utils/estm-0.3.0/src/mod_mem.c
utils/estm-0.3.0/src/mod_print.c
utils/estm-0.3.0/src/mod_stats.c
utils/estm-0.3.0/src/stm.c
utils/estm-0.3.0/src/wrappers.c
utils/versioned-lock/versioned-lock.c
utils/versioned-lock/versioned-lock.h
/usr/include/assert.h
/usr/include/atomic_ops.h
/usr/include/atomic_ops/sysdeps/emul_cas.h
/usr/include/atomic_ops/sysdeps/gcc/alpha.h
/usr/include/atomic_ops/sysdeps/gcc/arm.h
/usr/include/atomic_ops/sysdeps/gcc/cris.h
/usr/include/atomic_ops/sysdeps/gcc/hppa.h
/usr/include/atomic_ops/sysdeps/gcc/m68k.h
/usr/include/atomic_ops/sysdeps/gcc/mips.h
/usr/include/atomic_ops/sysdeps/gcc/s390.h
/usr/include/atomic_ops/sysdeps/gcc/sh.h
/usr/include/atomic_ops/sysdeps/generic_pthread.h
/usr/include/atomic_ops/sysdeps/hpc/hppa.h
/usr/include/atomic_ops/sysdeps/hpc/ia64.h
/usr/include/atomic_ops/sysdeps/msftc/arm.h
/usr/include/atomic_ops/sysdeps/msftc/x86.h
/usr/include/atomic_ops/sysdeps/msftc/x86_64.h
/usr/include/atomic_ops/sysdeps/sunc/sparc.h
/usr/include/atomic_ops/sysdeps/sunc/x86.h
/usr/include/getopt.h
/usr/include/inttypes.h
/usr/include/limits.h
/usr/include/memory.h
/usr/include/pthread.h
/usr/include/sched.h
/usr/include/setjmp.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/atomic_ops/ao_version.h
/usr/include/atomic_ops/sysdeps/ao_t_is_int.h
/usr/include/atomic_ops/sysdeps/armcc/arm_v6.h
/usr/include/atomic_ops/sysdeps/gcc/aarch64.h
/usr/include/atomic_ops/sysdeps/gcc/avr32.h
/usr/include/atomic_ops/sysdeps/gcc/hexagon.h
/usr/include/atomic_ops/sysdeps/gcc/ia64.h
/usr/include/atomic_ops/sysdeps/gcc/powerpc.h
/usr/include/atomic_ops/sysdeps/gcc/sparc.h
/usr/include/atomic_ops/sysdeps/gcc/x86.h
/usr/include/atomic_ops/sysdeps/ibmc/powerpc.h
/usr/include/atomic_ops/sysdeps/icc/ia64.h
/usr/include/ctype.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/libio.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
